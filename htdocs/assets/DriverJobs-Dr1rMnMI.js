var Be=Object.defineProperty,Qe=Object.defineProperties;var Ke=Object.getOwnPropertyDescriptors;var fe=Object.getOwnPropertySymbols;var $e=Object.prototype.hasOwnProperty,We=Object.prototype.propertyIsEnumerable;var ye=(g,a,x)=>a in g?Be(g,a,{enumerable:!0,configurable:!0,writable:!0,value:x}):g[a]=x,L=(g,a)=>{for(var x in a||(a={}))$e.call(a,x)&&ye(g,x,a[x]);if(fe)for(var x of fe(a))We.call(a,x)&&ye(g,x,a[x]);return g},R=(g,a)=>Qe(g,Ke(a));var X=(g,a,x)=>new Promise((D,F)=>{var P=y=>{try{J(x.next(y))}catch(l){F(l)}},te=y=>{try{J(x.throw(y))}catch(l){F(l)}},J=y=>y.done?D(y.value):Promise.resolve(y.value).then(P,te);J((x=x.apply(g,a)).next())});import{j as e}from"./ui-vendor-DMUr7mTx.js";import{r as I}from"./react-vendor-BvqlMsL5.js";import{u as Ge,l as Xe,s as ie,B as m,C as c,d,h as Ze,i as es,j as E,k as M,a as h,b as u,I as re,S as we,q as _e,r as Ce,t as Ie,v as S,D as Se,F as ss,m as ke,n as De,o as Pe,e as j}from"./index-ZwIgorfy.js";import{a as ts,u as as,b as Je}from"./query-vendor-B2F_wWlc.js";import{V as k,T as Te,M as T,J as U,j as ce,a1 as O,a2 as ls,aa as ns,$ as Fe,f as Ae,g as Le,D as Z,m as Re,bn as is,G as z,bo as ee,F as se,p as rs}from"./icons-vendor-b0I7fGSL.js";import{N as Ee}from"./router-vendor-CEyBJ8vK.js";import{L as de,p as oe,M as cs,N as ds,f as os}from"./utils-vendor-B2FlkASS.js";import"./supabase-vendor-B984m0TI.js";import"./ui-components-7w1-MJre.js";const fs=()=>{const{user:g,profile:a,loading:x}=Ge(),{toast:D}=Xe(),F=ts(),[P,te]=I.useState(""),[J,y]=I.useState("all"),[l,Me]=I.useState(null),[He,ae]=I.useState(!1),[i,H]=I.useState([]),[me,xe]=I.useState(""),[w,q]=I.useState("select"),[r,V]=I.useState({invoiceNumber:"",totalAmount:0,jobsIncluded:[],notes:"",dueDate:"",specialRequests:"",paymentTerms:"30 days",contactInfo:""}),{data:A=[],isLoading:qe,error:Ve}=as({queryKey:["driver-jobs",a==null?void 0:a.id],queryFn:()=>X(void 0,null,function*(){if(!(a!=null&&a.id))throw new Error("No driver ID found");const{data:s,error:t}=yield ie.from("jobs").select("*").eq("assigned_driver_id",a.id).order("created_at",{ascending:!1});if(t)throw console.error("Error fetching jobs:",t),t;return s||[]}),enabled:!!(a!=null&&a.id)}),Ye=()=>{const s=A.filter(o=>o.status==="completed"),t=20,n=s.map(o=>{const b=o.actual_duration?o.actual_duration/60:8,G=b*t;return{job_id:o.id,job_title:o.title,hours_worked:b,hourly_rate:t,total_payment:G,status:"pending",job_date:o.start_date||o.created_at}}),N=n.reduce((o,b)=>o+b.hours_worked,0),f=n.reduce((o,b)=>o+b.total_payment,0),$=n.filter(o=>{const b=new Date(o.job_date),G=new Date;return b.getMonth()===G.getMonth()&&b.getFullYear()===G.getFullYear()}).reduce((o,b)=>o+b.total_payment,0),W={total_hours:N,total_earnings:f,jobs_count:n.length,average_hourly_rate:t,monthly_earnings:$,pending_payments:n.filter(o=>o.status==="pending").length};return{payments:n,summary:W}},{payments:p,summary:_}=Ye(),Y=Je({mutationFn:s=>X(void 0,null,function*(){if(!(a!=null&&a.id))throw new Error("No driver ID found");const{data:t,error:n}=yield ie.from("driver_invoices").insert(R(L({},s),{driver_id:a.id,organization_id:a.organization_id,status:"sent",created_at:new Date().toISOString(),due_date:new Date(Date.now()+30*24*60*60*1e3).toISOString()})).select().single();if(n)throw n;return t}),onSuccess:()=>{F.invalidateQueries({queryKey:["driver-invoices"]}),D({title:"Invoice Sent Successfully!",description:"Your invoice has been sent to management for review. You will be notified when payment is processed."}),Oe()},onError:s=>{console.error("Error creating invoice:",s),D({title:"Error",description:"Failed to send invoice. Please try again.",variant:"destructive"})}}),Ue=()=>{var n;const s=Date.now(),t=((n=a==null?void 0:a.id)==null?void 0:n.slice(0,8))||"DRIVER";return`INV-${s}-${t}`},he=()=>{if(w==="select"){if(i.length===0){D({title:"No Jobs Selected",description:"Please select at least one job to include in the invoice.",variant:"destructive"});return}const t=p.filter(n=>i.includes(n.job_id)).reduce((n,N)=>n+N.total_payment,0);V(R(L({},r),{invoiceNumber:Ue(),totalAmount:t,jobsIncluded:i,notes:me,dueDate:new Date(Date.now()+30*24*60*60*1e3).toISOString().split("T")[0]})),q("review")}else w==="review"&&q("confirm")},ue=()=>{w==="review"?q("select"):w==="confirm"&&q("review")},je=()=>{Y.mutate({invoice_number:r.invoiceNumber,total_amount:r.totalAmount,jobs_included:r.jobsIncluded,notes:r.notes,due_date:r.dueDate})},Oe=()=>{q("select"),H([]),xe(""),V({invoiceNumber:"",totalAmount:0,jobsIncluded:[],notes:"",dueDate:"",specialRequests:"",paymentTerms:"30 days",contactInfo:""})},v=Je({mutationFn:n=>X(void 0,[n],function*({jobId:s,status:t}){const{data:N,error:f}=yield ie.from("jobs").update({status:t}).eq("id",s).select().single();if(f)throw f;return N}),onSuccess:()=>{F.invalidateQueries({queryKey:["driver-jobs"]}),D({title:"Job Updated",description:"Job status updated successfully"})},onError:s=>{console.error("Error updating job:",s),D({title:"Error",description:"Failed to update job status",variant:"destructive"})}});if(x)return e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsxs("div",{className:"text-center",children:[e.jsx(k,{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-primary mb-4"}),e.jsx("p",{className:"text-lg",children:"Loading jobs..."})]})});if(!g||!a)return e.jsx(Ee,{to:"/auth",replace:!0});if(a.role!=="driver")return e.jsx(Ee,{to:"/dashboard",replace:!0});const B=s=>{switch(s){case"completed":return e.jsx(j,{className:"bg-green-100 text-green-800 hover:bg-green-100",children:"Completed"});case"in_progress":return e.jsx(j,{className:"bg-blue-100 text-blue-800 hover:bg-blue-100",children:"In Progress"});case"assigned":return e.jsx(j,{className:"bg-purple-100 text-purple-800 hover:bg-purple-100",children:"Assigned"});case"pending":return e.jsx(j,{className:"bg-yellow-100 text-yellow-800 hover:bg-yellow-100",children:"Pending"});case"cancelled":return e.jsx(j,{className:"bg-red-100 text-red-800 hover:bg-red-100",children:"Cancelled"});default:return e.jsx(j,{variant:"secondary",children:s})}},Q=s=>{switch(s){case"urgent":return e.jsx(j,{className:"bg-red-100 text-red-800 hover:bg-red-100",children:"Urgent"});case"high":return e.jsx(j,{className:"bg-orange-100 text-orange-800 hover:bg-orange-100",children:"High"});case"medium":return e.jsx(j,{className:"bg-yellow-100 text-yellow-800 hover:bg-yellow-100",children:"Medium"});case"low":return e.jsx(j,{className:"bg-green-100 text-green-800 hover:bg-green-100",children:"Low"});default:return e.jsx(j,{variant:"secondary",children:s})}},ze=s=>{var N,f;const t=((N=s.title)==null?void 0:N.toLowerCase())||"",n=((f=s.description)==null?void 0:f.toLowerCase())||"";return t.includes("school")||n.includes("school")?e.jsx(Ae,{className:"w-4 h-4"}):t.includes("medical")||n.includes("medical")?e.jsx(Te,{className:"w-4 h-4"}):t.includes("charter")||n.includes("charter")?e.jsx(rs,{className:"w-4 h-4"}):e.jsx(T,{className:"w-4 h-4"})},C=s=>{if(!s)return"No date set";const t=oe(s);return de(t)?"Today":cs(t)?"Tomorrow":ds(t)?"Yesterday":os(t,"MMM dd, yyyy")},le=s=>s||"No time set",ne=A.filter(s=>{var N,f,$,W;const t=((N=s.title)==null?void 0:N.toLowerCase().includes(P.toLowerCase()))||((f=s.pickup_location)==null?void 0:f.toLowerCase().includes(P.toLowerCase()))||(($=s.delivery_location)==null?void 0:$.toLowerCase().includes(P.toLowerCase()))||((W=s.customer_name)==null?void 0:W.toLowerCase().includes(P.toLowerCase())),n=J==="all"||s.status===J;return t&&n}),ge=ne.filter(s=>s.status==="assigned"||s.status==="in_progress"),pe=ne.filter(s=>s.status==="pending"),Ne=ne.filter(s=>s.status==="completed"),K={totalJobs:A.filter(s=>s.start_date&&de(oe(s.start_date))).length,completedJobs:A.filter(s=>s.status==="completed"&&s.start_date&&de(oe(s.start_date))).length,upcomingJobs:A.filter(s=>s.status==="pending"||s.status==="assigned").length,inProgressJobs:A.filter(s=>s.status==="in_progress").length},be=s=>{v.mutate({jobId:s,status:"in_progress"})},ve=s=>{v.mutate({jobId:s,status:"completed"})};return qe?e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsxs("div",{className:"text-center",children:[e.jsx(k,{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-primary mb-4"}),e.jsx("p",{className:"text-lg",children:"Loading your jobs..."})]})}):Ve?e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Te,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Error Loading Jobs"}),e.jsx("p",{className:"text-gray-600",children:"Unable to load your jobs. Please try again later."}),e.jsx(m,{className:"mt-4",onClick:()=>F.invalidateQueries({queryKey:["driver-jobs"]}),children:"Retry"})]})}):e.jsxs("div",{className:"space-y-4 p-4",children:[e.jsx("div",{className:"flex justify-between items-center",children:e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center gap-2 sm:gap-3 sm:text-3xl",children:[e.jsx(T,{className:"w-6 h-6 sm:w-8 sm:h-8 text-blue-600"}),"My Jobs"]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1 sm:text-base",children:"View and manage your assigned transport jobs"})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 sm:gap-6 sm:grid-cols-4",children:[e.jsx(c,{className:"mobile-card",children:e.jsx(d,{className:"p-4 sm:p-6",children:e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[e.jsx(T,{className:"w-6 h-6 sm:w-8 sm:h-8 text-blue-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs sm:text-sm text-gray-600",children:"Today's Jobs"}),e.jsx("p",{className:"text-xl sm:text-2xl font-bold",children:K.totalJobs})]})]})})}),e.jsx(c,{className:"mobile-card",children:e.jsx(d,{className:"p-4 sm:p-6",children:e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[e.jsx(U,{className:"w-6 h-6 sm:w-8 sm:h-8 text-green-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs sm:text-sm text-gray-600",children:"Completed"}),e.jsx("p",{className:"text-xl sm:text-2xl font-bold text-green-600",children:K.completedJobs})]})]})})}),e.jsx(c,{className:"mobile-card",children:e.jsx(d,{className:"p-4 sm:p-6",children:e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[e.jsx(ce,{className:"w-6 h-6 sm:w-8 sm:h-8 text-yellow-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs sm:text-sm text-gray-600",children:"Upcoming"}),e.jsx("p",{className:"text-xl sm:text-2xl font-bold text-yellow-600",children:K.upcomingJobs})]})]})})}),e.jsx(c,{className:"mobile-card",children:e.jsx(d,{className:"p-4 sm:p-6",children:e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[e.jsx(O,{className:"w-6 h-6 sm:w-8 sm:h-8 text-purple-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs sm:text-sm text-gray-600",children:"In Progress"}),e.jsx("p",{className:"text-xl sm:text-2xl font-bold text-purple-600",children:K.inProgressJobs})]})]})})})]}),e.jsxs(Ze,{defaultValue:"current",className:"space-y-4",children:[e.jsxs(es,{className:"grid w-full grid-cols-3 sm:grid-cols-6",children:[e.jsx(E,{value:"current",className:"text-xs sm:text-sm",children:"Current"}),e.jsx(E,{value:"upcoming",className:"text-xs sm:text-sm",children:"Upcoming"}),e.jsx(E,{value:"completed",className:"text-xs sm:text-sm",children:"Completed"}),e.jsx(E,{value:"payment",className:"text-xs sm:text-sm hidden sm:block",children:"Payment"}),e.jsx(E,{value:"invoice",className:"text-xs sm:text-sm hidden sm:block",children:"Invoice"}),e.jsx(E,{value:"history",className:"text-xs sm:text-sm hidden sm:block",children:"History"})]}),e.jsx(M,{value:"current",className:"space-y-4",children:e.jsxs(c,{children:[e.jsxs(h,{children:[e.jsxs(u,{className:"flex items-center gap-2",children:[e.jsx(O,{className:"w-5 h-5"}),"Active & Today's Jobs"]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(ls,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx(re,{placeholder:"Search jobs...",value:P,onChange:s=>te(s.target.value),className:"pl-10"})]}),e.jsxs(we,{value:J,onValueChange:y,children:[e.jsx(_e,{className:"w-48",children:e.jsx(Ce,{})}),e.jsxs(Ie,{children:[e.jsx(S,{value:"all",children:"All Status"}),e.jsx(S,{value:"assigned",children:"Assigned"}),e.jsx(S,{value:"in_progress",children:"In Progress"}),e.jsx(S,{value:"completed",children:"Completed"})]})]})]})]}),e.jsx(d,{children:ge.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(O,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Current Jobs"}),e.jsx("p",{className:"text-gray-600",children:"You don't have any active jobs at the moment."})]}):e.jsx("div",{className:"space-y-4",children:ge.map(s=>e.jsxs("div",{className:"border rounded-lg p-4 hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[ze(s),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg",children:s.title}),e.jsxs("p",{className:"text-sm text-gray-600",children:[s.start_date&&C(s.start_date)," • ",s.start_time&&le(s.start_time)]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[B(s.status),Q(s.priority),e.jsxs(Se,{children:[e.jsx(ss,{asChild:!0,children:e.jsx(m,{variant:"outline",size:"sm",onClick:()=>Me(s),children:e.jsx(ns,{className:"w-4 h-4"})})}),e.jsxs(ke,{className:"max-w-2xl",children:[e.jsx(De,{children:e.jsx(Pe,{children:s.title})}),l&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"Job Details"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Status:"}),e.jsx("span",{children:B(l.status)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Priority:"}),e.jsx("span",{children:Q(l.priority)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Date:"}),e.jsx("span",{children:C(l.start_date)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Time:"}),e.jsx("span",{children:le(l.start_time)})]}),l.estimated_duration&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Duration:"}),e.jsxs("span",{children:[l.estimated_duration," minutes"]})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"Customer Information"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[l.customer_name&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Customer:"}),e.jsx("p",{children:l.customer_name})]}),l.customer_contact&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Contact:"}),e.jsx("p",{children:l.customer_contact})]})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"Route Information"}),e.jsxs("div",{className:"bg-gray-50 p-3 rounded",children:[l.pickup_location&&e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(T,{className:"w-4 h-4 text-green-600"}),e.jsx("span",{className:"font-medium",children:"Pickup:"}),e.jsx("span",{children:l.pickup_location})]}),l.delivery_location&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(T,{className:"w-4 h-4 text-red-600"}),e.jsx("span",{className:"font-medium",children:"Destination:"}),e.jsx("span",{children:l.delivery_location})]})]})]}),l.description&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"Description"}),e.jsx("p",{className:"text-sm text-gray-600 bg-gray-50 p-3 rounded",children:l.description})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[l.status==="assigned"&&e.jsxs(m,{className:"bg-blue-600 hover:bg-blue-700",onClick:()=>be(l.id),disabled:v.isPending,children:[v.isPending?e.jsx(k,{className:"w-4 h-4 mr-2 animate-spin"}):e.jsx(O,{className:"w-4 h-4 mr-2"}),"Start Job"]}),l.status==="in_progress"&&e.jsxs(m,{className:"bg-green-600 hover:bg-green-700",onClick:()=>ve(l.id),disabled:v.isPending,children:[v.isPending?e.jsx(k,{className:"w-4 h-4 mr-2 animate-spin"}):e.jsx(U,{className:"w-4 h-4 mr-2"}),"Mark Complete"]}),l.customer_contact&&e.jsxs(m,{variant:"outline",children:[e.jsx(Fe,{className:"w-4 h-4 mr-2"}),"Contact Customer"]})]})]})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-3",children:[s.pickup_location&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx(T,{className:"w-4 h-4 text-green-600"}),e.jsxs("span",{children:["From: ",s.pickup_location]})]}),s.delivery_location&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx(T,{className:"w-4 h-4 text-red-600"}),e.jsxs("span",{children:["To: ",s.delivery_location]})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600",children:[s.estimated_duration&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(ce,{className:"w-4 h-4"}),s.estimated_duration," min"]}),s.customer_name&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Ae,{className:"w-4 h-4"}),s.customer_name]})]}),e.jsxs("div",{className:"flex gap-2",children:[s.status==="assigned"&&e.jsxs(m,{size:"sm",className:"bg-blue-600 hover:bg-blue-700",onClick:()=>be(s.id),disabled:v.isPending,children:[v.isPending?e.jsx(k,{className:"w-4 h-4 animate-spin"}):e.jsx(O,{className:"w-4 h-4 mr-1"}),"Start"]}),s.status==="in_progress"&&e.jsxs(m,{size:"sm",className:"bg-green-600 hover:bg-green-700",onClick:()=>ve(s.id),disabled:v.isPending,children:[v.isPending?e.jsx(k,{className:"w-4 h-4 animate-spin"}):e.jsx(U,{className:"w-4 h-4 mr-1"}),"Complete"]}),s.customer_contact&&e.jsx(m,{variant:"outline",size:"sm",children:e.jsx(Fe,{className:"w-4 h-4"})})]})]})]},s.id))})})]})}),e.jsx(M,{value:"upcoming",className:"space-y-4",children:e.jsxs(c,{children:[e.jsx(h,{children:e.jsxs(u,{className:"flex items-center gap-2",children:[e.jsx(Le,{className:"w-5 h-5"}),"Upcoming Jobs"]})}),e.jsx(d,{children:pe.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Le,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Upcoming Jobs"}),e.jsx("p",{className:"text-gray-600",children:"You don't have any upcoming jobs scheduled."})]}):e.jsx("div",{className:"space-y-4",children:pe.map(s=>e.jsxs("div",{className:"border rounded-lg p-4 hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"font-semibold",children:s.title}),e.jsxs("div",{className:"flex gap-2",children:[B(s.status),Q(s.priority)]})]}),e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsxs("p",{children:["Date: ",C(s.start_date)," • Time: ",le(s.start_time)]}),s.pickup_location&&e.jsxs("p",{children:["Pickup: ",s.pickup_location]}),s.delivery_location&&e.jsxs("p",{children:["Destination: ",s.delivery_location]})]})]},s.id))})})]})}),e.jsx(M,{value:"completed",className:"space-y-4",children:e.jsxs(c,{children:[e.jsx(h,{children:e.jsxs(u,{className:"flex items-center gap-2",children:[e.jsx(U,{className:"w-5 h-5"}),"Completed Jobs"]})}),e.jsx(d,{children:Ne.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(U,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Completed Jobs"}),e.jsx("p",{className:"text-gray-600",children:"You haven't completed any jobs yet."})]}):e.jsx("div",{className:"space-y-4",children:Ne.map(s=>e.jsxs("div",{className:"border rounded-lg p-4 bg-green-50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"font-semibold",children:s.title}),e.jsxs("div",{className:"flex gap-2",children:[B(s.status),Q(s.priority)]})]}),e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsxs("p",{children:["Completed: ",C(s.updated_at)]}),s.actual_duration&&e.jsxs("p",{children:["Duration: ",s.actual_duration," minutes"]}),s.pickup_location&&e.jsxs("p",{children:["Pickup: ",s.pickup_location]}),s.delivery_location&&e.jsxs("p",{children:["Destination: ",s.delivery_location]})]})]},s.id))})})]})}),e.jsxs(M,{value:"payment",className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[e.jsxs(c,{children:[e.jsxs(h,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(u,{className:"text-sm font-medium",children:"Total Hours"}),e.jsx(ce,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(d,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[_.total_hours.toFixed(1),"h"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"All completed jobs"})]})]}),e.jsxs(c,{children:[e.jsxs(h,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(u,{className:"text-sm font-medium",children:"Total Earnings"}),e.jsx(Z,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(d,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:["£",_.total_earnings.toFixed(2)]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Lifetime earnings"})]})]}),e.jsxs(c,{children:[e.jsxs(h,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(u,{className:"text-sm font-medium",children:"Monthly Earnings"}),e.jsx(Re,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(d,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:["£",_.monthly_earnings.toFixed(2)]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"This month"})]})]}),e.jsxs(c,{children:[e.jsxs(h,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(u,{className:"text-sm font-medium",children:"Hourly Rate"}),e.jsx(is,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(d,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:["£",_.average_hourly_rate,"/h"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Average rate"})]})]})]}),e.jsxs(c,{children:[e.jsx(h,{children:e.jsxs(u,{className:"flex items-center gap-2",children:[e.jsx(Z,{className:"w-5 h-5"}),"Payment Details"]})}),e.jsxs(d,{children:[p.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Z,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Payment Records"}),e.jsx("p",{className:"text-gray-600",children:"Complete some jobs to see your payment details."})]}):e.jsx("div",{className:"space-y-4",children:p.map(s=>e.jsxs("div",{className:"border rounded-lg p-4 hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("input",{type:"checkbox",checked:i.includes(s.job_id),onChange:t=>{t.target.checked?H([...i,s.job_id]):H(i.filter(n=>n!==s.job_id))},className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),e.jsx("span",{className:"text-sm text-gray-600",children:"Include in invoice"})]}),e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg",children:s.job_title}),e.jsxs("p",{className:"text-sm text-gray-600",children:[C(s.job_date)," • ",s.hours_worked.toFixed(1)," hours"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-2xl font-bold text-green-600",children:["£",s.total_payment.toFixed(2)]}),e.jsxs("div",{className:"text-sm text-gray-600",children:["@ £",s.hourly_rate,"/hour"]})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(j,{variant:"outline",children:[s.hours_worked.toFixed(1),"h worked"]}),e.jsx(j,{variant:s.status==="paid"?"default":s.status==="overdue"?"destructive":"secondary",children:s.status.charAt(0).toUpperCase()+s.status.slice(1)})]}),s.payment_date&&e.jsxs("div",{className:"text-sm text-gray-600",children:["Paid: ",C(s.payment_date)]})]})]},s.job_id))}),p.length>0&&e.jsx("div",{className:"mt-6 pt-6 border-t",children:e.jsxs(m,{onClick:()=>ae(!0),disabled:i.length===0,className:"w-full",children:[e.jsx(z,{className:"w-4 h-4 mr-2"}),"Send Invoice to Management",i.length>0&&e.jsxs(j,{variant:"secondary",className:"ml-2",children:[i.length," selected"]})]})})]})]}),e.jsxs(c,{children:[e.jsx(h,{children:e.jsxs(u,{className:"flex items-center gap-2",children:[e.jsx(Re,{className:"w-5 h-5"}),"Payment Summary"]})}),e.jsxs(d,{children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsxs("div",{className:"text-center p-4 border rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:_.jobs_count}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Jobs Completed"})]}),e.jsxs("div",{className:"text-center p-4 border rounded-lg",children:[e.jsxs("div",{className:"text-2xl font-bold text-green-600",children:["£",_.total_earnings.toFixed(2)]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Earnings"})]}),e.jsxs("div",{className:"text-center p-4 border rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-orange-600",children:_.pending_payments}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Pending Payments"})]})]}),e.jsxs("div",{className:"mt-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-blue-900 mb-2",children:"Payment Information"}),e.jsxs("ul",{className:"text-sm text-blue-800 space-y-1",children:[e.jsx("li",{children:"• Payments are calculated based on actual hours worked"}),e.jsxs("li",{children:["• Hourly rate: £",_.average_hourly_rate,"/hour"]}),e.jsxs("li",{children:["• Monthly earnings: £",_.monthly_earnings.toFixed(2)]}),e.jsx("li",{children:"• Contact HR for payment status updates"})]})]})]})]})]}),e.jsxs(M,{value:"invoice",className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsxs(c,{children:[e.jsxs(h,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(u,{className:"text-sm font-medium",children:"Pending Invoices"}),e.jsx(ee,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(d,{children:[e.jsx("div",{className:"text-2xl font-bold text-orange-600",children:p.filter(s=>s.status==="pending").length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Awaiting payment"})]})]}),e.jsxs(c,{children:[e.jsxs(h,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(u,{className:"text-sm font-medium",children:"Total Invoiced"}),e.jsx(Z,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(d,{children:[e.jsxs("div",{className:"text-2xl font-bold text-blue-600",children:["£",p.reduce((s,t)=>s+t.total_payment,0).toFixed(2)]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"All completed jobs"})]})]}),e.jsxs(c,{children:[e.jsxs(h,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(u,{className:"text-sm font-medium",children:"Ready to Invoice"}),e.jsx(z,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(d,{children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:p.length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Available jobs"})]})]})]}),e.jsxs(c,{children:[e.jsx(h,{children:e.jsxs(u,{className:"flex items-center gap-2",children:[e.jsx(ee,{className:"w-5 h-5"}),"Create New Invoice",w!=="select"&&e.jsxs(j,{variant:"outline",className:"ml-2",children:["Step ",w==="review"?"2":"3"," of 3"]})]})}),e.jsx(d,{children:p.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(ee,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Jobs Available for Invoice"}),e.jsx("p",{className:"text-gray-600",children:"Complete some jobs first to create invoices."})]}):e.jsxs("div",{className:"space-y-6",children:[w==="select"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-blue-900 mb-2",children:"Step 1: Select Jobs for Invoice"}),e.jsx("p",{className:"text-sm text-blue-800",children:"Choose the completed jobs you want to include in your invoice. You can select multiple jobs to create a single invoice."})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-3",children:"Available Jobs"}),e.jsx("div",{className:"space-y-3 max-h-60 overflow-y-auto",children:p.map(s=>e.jsxs("div",{className:"flex items-center gap-3 p-3 border rounded-lg hover:bg-gray-50",children:[e.jsx("input",{type:"checkbox",checked:i.includes(s.job_id),onChange:t=>{t.target.checked?H([...i,s.job_id]):H(i.filter(n=>n!==s.job_id))},className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-medium",children:s.job_title}),e.jsxs("span",{className:"font-bold text-green-600",children:["£",s.total_payment.toFixed(2)]})]}),e.jsxs("div",{className:"text-sm text-gray-600",children:[C(s.job_date)," • ",s.hours_worked.toFixed(1)," hours @ £",s.hourly_rate,"/hour"]})]})]},s.job_id))})]}),i.length>0&&e.jsxs("div",{className:"p-4 bg-green-50 border border-green-200 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-green-900 mb-2",children:"Invoice Summary"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Selected Jobs:"}),e.jsx("span",{className:"font-medium",children:i.length})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Total Amount:"}),e.jsxs("span",{className:"font-bold text-lg text-green-600",children:["£",p.filter(s=>i.includes(s.job_id)).reduce((s,t)=>s+t.total_payment,0).toFixed(2)]})]})]})]}),e.jsxs(m,{onClick:he,disabled:i.length===0,className:"w-full",size:"lg",children:["Next: Review Invoice",e.jsx(z,{className:"w-4 h-4 ml-2"})]})]}),w==="review"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-yellow-900 mb-2",children:"Step 2: Review Invoice Details"}),e.jsx("p",{className:"text-sm text-yellow-800",children:"Review your invoice details and add any additional information before sending to management."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Invoice Number"}),e.jsx(re,{value:r.invoiceNumber,readOnly:!0,className:"bg-gray-50"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Due Date"}),e.jsx(re,{type:"date",value:r.dueDate,onChange:s=>V(R(L({},r),{dueDate:s.target.value}))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Additional Notes"}),e.jsx("textarea",{value:r.notes,onChange:s=>V(R(L({},r),{notes:s.target.value})),placeholder:"Add any special requests, notes, or additional information...",className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:3})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Payment Terms"}),e.jsxs(we,{value:r.paymentTerms,onValueChange:s=>V(R(L({},r),{paymentTerms:s})),children:[e.jsx(_e,{children:e.jsx(Ce,{})}),e.jsxs(Ie,{children:[e.jsx(S,{value:"7 days",children:"7 days"}),e.jsx(S,{value:"14 days",children:"14 days"}),e.jsx(S,{value:"30 days",children:"30 days"}),e.jsx(S,{value:"60 days",children:"60 days"})]})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-3",children:"Selected Jobs"}),e.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto",children:p.filter(s=>i.includes(s.job_id)).map(s=>e.jsxs("div",{className:"p-3 border rounded-lg bg-gray-50",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-medium",children:s.job_title}),e.jsxs("span",{className:"font-bold text-green-600",children:["£",s.total_payment.toFixed(2)]})]}),e.jsxs("div",{className:"text-sm text-gray-600",children:[C(s.job_date)," • ",s.hours_worked.toFixed(1)," hours"]})]},s.job_id))})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(m,{onClick:ue,variant:"outline",className:"flex-1",children:"Back"}),e.jsx(m,{onClick:he,className:"flex-1",children:"Next: Confirm & Send"})]})]}),w==="confirm"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"p-4 bg-green-50 border border-green-200 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-green-900 mb-2",children:"Step 3: Confirm & Send Invoice"}),e.jsx("p",{className:"text-sm text-green-800",children:"Review your final invoice details and send to management for processing."})]}),e.jsxs("div",{className:"p-4 border rounded-lg bg-gray-50",children:[e.jsx("h4",{className:"font-medium mb-3",children:"Invoice Summary"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Invoice Number:"}),e.jsx("span",{className:"font-medium",children:r.invoiceNumber})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Total Amount:"}),e.jsxs("span",{className:"font-bold text-lg text-green-600",children:["£",r.totalAmount.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Jobs Included:"}),e.jsx("span",{className:"font-medium",children:r.jobsIncluded.length})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Due Date:"}),e.jsx("span",{className:"font-medium",children:new Date(r.dueDate).toLocaleDateString()})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Payment Terms:"}),e.jsx("span",{className:"font-medium",children:r.paymentTerms})]})]})]}),r.notes&&e.jsxs("div",{className:"p-4 border rounded-lg bg-blue-50",children:[e.jsx("h4",{className:"font-medium mb-2",children:"Additional Notes"}),e.jsx("p",{className:"text-sm text-gray-700",children:r.notes})]}),e.jsxs("div",{className:"p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-yellow-900 mb-2",children:"Important Information"}),e.jsxs("ul",{className:"text-sm text-yellow-800 space-y-1",children:[e.jsx("li",{children:"• Invoice will be sent to management for review"}),e.jsx("li",{children:"• Payment processing typically takes 3-5 business days"}),e.jsx("li",{children:"• You will be notified when payment is processed"}),e.jsx("li",{children:"• Contact HR for any payment inquiries"})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(m,{onClick:ue,variant:"outline",className:"flex-1",children:"Back to Review"}),e.jsx(m,{onClick:je,disabled:Y.isPending,className:"flex-1",size:"lg",children:Y.isPending?e.jsxs(e.Fragment,{children:[e.jsx(k,{className:"w-4 h-4 mr-2 animate-spin"}),"Sending Invoice..."]}):e.jsxs(e.Fragment,{children:[e.jsx(z,{className:"w-4 h-4 mr-2"}),"Send Invoice to Management"]})})]})]})]})})]}),e.jsxs(c,{children:[e.jsx(h,{children:e.jsxs(u,{className:"flex items-center gap-2",children:[e.jsx(se,{className:"w-5 h-5"}),"Invoice History"]})}),e.jsx(d,{children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx(se,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Invoice History"}),e.jsx("p",{className:"text-gray-600",children:"View your sent invoices and payment status."}),e.jsx(m,{className:"mt-4",variant:"outline",children:"View All Invoices"})]})})]})]}),e.jsx(M,{value:"history",className:"space-y-4",children:e.jsxs(c,{children:[e.jsx(h,{children:e.jsxs(u,{className:"flex items-center gap-2",children:[e.jsx(se,{className:"w-5 h-5"}),"Job History"]})}),e.jsx(d,{children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx(se,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Complete Job History"}),e.jsx("p",{className:"text-gray-600",children:"View your complete job history, ratings, and performance metrics."}),e.jsx(m,{className:"mt-4",variant:"outline",children:"View Full History"})]})})]})})]}),e.jsx(Se,{open:He,onOpenChange:ae,children:e.jsxs(ke,{className:"max-w-2xl",children:[e.jsx(De,{children:e.jsxs(Pe,{className:"flex items-center gap-2",children:[e.jsx(ee,{className:"w-5 h-5"}),"Send Invoice to Management"]})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-3",children:"Selected Payments"}),e.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto",children:p.filter(s=>i.includes(s.job_id)).map(s=>e.jsxs("div",{className:"flex justify-between items-center p-2 bg-gray-50 rounded",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:s.job_title}),e.jsxs("span",{className:"text-sm text-gray-600 ml-2",children:[s.hours_worked.toFixed(1),"h @ £",s.hourly_rate,"/h"]})]}),e.jsxs("span",{className:"font-bold",children:["£",s.total_payment.toFixed(2)]})]},s.job_id))}),e.jsx("div",{className:"mt-4 p-3 bg-blue-50 border border-blue-200 rounded",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-medium",children:"Total Invoice Amount:"}),e.jsxs("span",{className:"text-xl font-bold text-blue-600",children:["£",p.filter(s=>i.includes(s.job_id)).reduce((s,t)=>s+t.total_payment,0).toFixed(2)]})]})})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"invoice-notes",className:"block text-sm font-medium mb-2",children:"Additional Notes (Optional)"}),e.jsx("textarea",{id:"invoice-notes",value:me,onChange:s=>xe(s.target.value),placeholder:"Add any additional notes or special requests...",className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:3})]}),e.jsxs("div",{className:"p-4 bg-yellow-50 border border-yellow-200 rounded",children:[e.jsx("h4",{className:"font-medium text-yellow-900 mb-2",children:"Invoice Information"}),e.jsxs("ul",{className:"text-sm text-yellow-800 space-y-1",children:[e.jsx("li",{children:"• Invoice will be sent to management for review"}),e.jsx("li",{children:"• Payment terms: 30 days from invoice date"}),e.jsx("li",{children:"• You will be notified when payment is processed"}),e.jsx("li",{children:"• Contact HR for any payment inquiries"})]})]})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx(m,{variant:"outline",onClick:()=>ae(!1),className:"flex-1",children:"Cancel"}),e.jsx(m,{onClick:je,disabled:Y.isPending||i.length===0,className:"flex-1",children:Y.isPending?e.jsxs(e.Fragment,{children:[e.jsx(k,{className:"w-4 h-4 mr-2 animate-spin"}),"Sending..."]}):e.jsxs(e.Fragment,{children:[e.jsx(z,{className:"w-4 h-4 mr-2"}),"Send Invoice"]})})]})]})})]})};export{fs as default};
