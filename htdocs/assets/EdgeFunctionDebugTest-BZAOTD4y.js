var u=(d,t,s)=>new Promise((i,l)=>{var r=o=>{try{c(s.next(o))}catch(a){l(a)}},n=o=>{try{c(s.throw(o))}catch(a){l(a)}},c=o=>o.done?i(o.value):Promise.resolve(o.value).then(r,n);c((s=s.apply(d,t)).next())});import{j as e}from"./ui-vendor-DMUr7mTx.js";import{r as x}from"./react-vendor-BvqlMsL5.js";import{s as p}from"./index-ZwIgorfy.js";import"./supabase-vendor-B984m0TI.js";import"./utils-vendor-B2FlkASS.js";import"./icons-vendor-b0I7fGSL.js";import"./query-vendor-B2F_wWlc.js";import"./router-vendor-CEyBJ8vK.js";import"./ui-components-7w1-MJre.js";const S=()=>{const[d,t]=x.useState(!1),[s,i]=x.useState(null),l=()=>u(void 0,null,function*(){t(!0),i(null);try{console.log("Testing edge function with minimal data...");const{data:r,error:n}=yield p.functions.invoke("send-general-email",{body:{emailData:{to:"test@example.com",subject:"Debug Test",html:"<p>Test</p>"}}});console.log("Raw response:",{data:r,error:n}),i(n?{success:!1,message:`Edge function error: ${n.message}`,details:n,type:"error"}:{success:!0,message:"Edge function responded successfully!",details:r,type:"success"})}catch(r){console.error("Test error:",r),i({success:!1,message:`Test error: ${r.message}`,details:r,type:"exception"})}finally{t(!1)}});return e.jsxs("div",{style:{padding:"20px",fontFamily:"Arial, sans-serif",maxWidth:"800px"},children:[e.jsx("h1",{children:"üîç Edge Function Debug Test"}),e.jsxs("div",{style:{marginBottom:"20px",padding:"15px",backgroundColor:"#fff3cd",border:"1px solid #ffeaa7",borderRadius:"5px"},children:[e.jsx("h3",{children:"üîß Debugging Edge Function Error"}),e.jsx("p",{children:"The edge function is connecting (no CORS errors!) but returning a non-2xx status code. This test will help us see the exact error message."})]}),e.jsxs("div",{style:{marginBottom:"20px",padding:"15px",backgroundColor:"#f8f9fa",border:"1px solid #dee2e6",borderRadius:"5px"},children:[e.jsx("h3",{children:"üß™ Test Edge Function Response"}),e.jsx("p",{children:"This will show us the exact error from the edge function:"}),e.jsx("button",{onClick:l,disabled:d,style:{backgroundColor:"#007bff",color:"white",border:"none",padding:"12px 24px",borderRadius:"5px",cursor:d?"not-allowed":"pointer",fontSize:"16px",width:"100%"},children:d?"Testing...":"Debug Edge Function"})]}),s&&e.jsxs("div",{style:{marginTop:"20px",padding:"15px",backgroundColor:s.success?"#d4edda":"#f8d7da",border:`1px solid ${s.success?"#c3e6cb":"#f5c6cb"}`,borderRadius:"5px"},children:[e.jsx("h3",{children:s.success?"‚úÖ Success!":"‚ùå Error"}),e.jsx("p",{style:{fontWeight:"bold"},children:s.message}),e.jsxs("details",{style:{marginTop:"10px"},children:[e.jsx("summary",{style:{cursor:"pointer",fontWeight:"bold"},children:"View Full Details"}),e.jsx("pre",{style:{backgroundColor:"#f8f9fa",padding:"10px",borderRadius:"3px",overflow:"auto",marginTop:"10px",fontSize:"12px"},children:JSON.stringify(s.details,null,2)})]})]}),e.jsxs("div",{style:{marginTop:"30px",padding:"15px",backgroundColor:"#d1ecf1",border:"1px solid #bee5eb",borderRadius:"5px"},children:[e.jsx("h3",{children:"üîç Common Issues & Solutions"}),e.jsxs("ul",{children:[e.jsxs("li",{children:[e.jsx("strong",{children:"API Key Not Set:"})," Run ",e.jsx("code",{children:"supabase secrets set RESEND_API_KEY=re_YOUR_ACTUAL_KEY"})]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Invalid API Key:"})," Make sure your Resend API key is valid and active"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"API Key Format:"})," Should start with ",e.jsx("code",{children:"re_"})]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Resend Account:"})," Ensure your Resend account is active and has credits"]})]})]}),e.jsxs("div",{style:{marginTop:"20px",padding:"15px",backgroundColor:"#e8f5e8",border:"1px solid #4caf50",borderRadius:"5px"},children:[e.jsx("h3",{children:"‚úÖ Progress Made"}),e.jsxs("ul",{children:[e.jsxs("li",{children:["‚úÖ ",e.jsx("strong",{children:"CORS Fixed:"})," No more CORS header errors"]}),e.jsxs("li",{children:["‚úÖ ",e.jsx("strong",{children:"Edge Function Connecting:"})," Function is reachable"]}),e.jsxs("li",{children:["‚úÖ ",e.jsx("strong",{children:"API Key Secret Set:"})," Secret is configured"]}),e.jsxs("li",{children:["‚è≥ ",e.jsx("strong",{children:"Debugging Error:"})," Working on the specific error"]})]})]})]})};export{S as default};
