var Oe=Object.defineProperty,Ie=Object.defineProperties;var Be=Object.getOwnPropertyDescriptors;var Ne=Object.getOwnPropertySymbols;var $e=Object.prototype.hasOwnProperty,ze=Object.prototype.propertyIsEnumerable;var ye=(r,a,n)=>a in r?Oe(r,a,{enumerable:!0,configurable:!0,writable:!0,value:n}):r[a]=n,z=(r,a)=>{for(var n in a||(a={}))$e.call(a,n)&&ye(r,n,a[n]);if(Ne)for(var n of Ne(a))ze.call(a,n)&&ye(r,n,a[n]);return r},K=(r,a)=>Ie(r,Be(a));var T=(r,a,n)=>new Promise((o,m)=>{var h=u=>{try{v(n.next(u))}catch(p){m(p)}},g=u=>{try{v(n.throw(u))}catch(p){m(p)}},v=u=>u.done?o(u.value):Promise.resolve(u.value).then(h,g);v((n=n.apply(r,a)).next())});import{j as e}from"./ui-vendor-DMUr7mTx.js";import{r as y}from"./react-vendor-BvqlMsL5.js";import{u as I,C as w,a as C,b as S,c as fe,d as A,l as Z,f as Ue,ag as We,al as Ge,am as He,an as Ve,ao as Ye,D as se,F as de,B as x,m as te,n as ae,o as ne,p as re,L as d,I as k,T as E,G as le,ap as Ke,e as M,S as oe,q as me,r as he,t as xe,v as L,s as ve,ak as Ce,aq as Qe,h as Je,i as Xe,j as U,k as W}from"./index-ZwIgorfy.js";import{aA as Se,k as ue,j as G,f as Q,U as ce,E as X,T as be,ak as Ze,aD as es,bt as ss,g as O,V as je,J as ge,ao as we,Y as J,M as ie,a0 as Ae,bm as ts,b as as,_ as pe,Z as ns,S as rs,d as _e,$ as is}from"./icons-vendor-b0I7fGSL.js";import ls from"./ParentRouteTracker-CKSj-S23.js";import cs from"./ParentCommunicationCenter-CrvAYapn.js";import ds from"./NotificationCenter-Dz3J9WDC.js";import{u as De,a as qe,b as Fe}from"./query-vendor-B2F_wWlc.js";import{s as os,e as ms,g as hs,f as ee,L as ke,x as xs,O as us}from"./utils-vendor-B2FlkASS.js";import{E as js}from"./EmergencyContacts-CGH7bCEy.js";import"./supabase-vendor-B984m0TI.js";import"./router-vendor-CEyBJ8vK.js";import"./ui-components-7w1-MJre.js";const gs=()=>{const{profile:r}=I(),a=new Date().getHours(),n=()=>a<12?"Good morning":a<17?"Good afternoon":"Good evening",o=()=>{const m=["Your child's safety is our top priority.","Every journey matters when it comes to your family.","We're here to make transportation worry-free for you.","Your trust in us drives everything we do.","Safe travels start with caring parents like you."],h=Math.floor((new Date().getTime()-new Date(new Date().getFullYear(),0,0).getTime())/864e5);return m[h%m.length]};return e.jsxs(w,{className:"bg-gradient-to-r from-teal-600 to-cyan-600 text-white border-0 shadow-xl",children:[e.jsx(C,{className:"pb-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(S,{className:"text-2xl font-bold mb-2",children:[n(),", ",(r==null?void 0:r.first_name)||"Parent","! ðŸ‘‹"]}),e.jsx(fe,{className:"text-teal-100 text-lg",children:o()})]}),e.jsx("div",{className:"hidden md:block",children:e.jsx("div",{className:"w-20 h-20 bg-white/10 rounded-full flex items-center justify-center",children:e.jsx(Se,{className:"w-10 h-10 text-white"})})})]})}),e.jsx(A,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-3 bg-white/10 rounded-lg p-3",children:[e.jsx(ue,{className:"w-8 h-8 text-white"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:"Safe Transport"}),e.jsx("p",{className:"text-sm text-teal-100",children:"Trusted drivers & vehicles"})]})]}),e.jsxs("div",{className:"flex items-center space-x-3 bg-white/10 rounded-lg p-3",children:[e.jsx(G,{className:"w-8 h-8 text-white"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:"Real-time Updates"}),e.jsx("p",{className:"text-sm text-teal-100",children:"Live tracking & notifications"})]})]}),e.jsxs("div",{className:"flex items-center space-x-3 bg-white/10 rounded-lg p-3",children:[e.jsx(Q,{className:"w-8 h-8 text-white"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:"Family Care"}),e.jsx("p",{className:"text-sm text-teal-100",children:"Personalized attention"})]})]})]})})]})},ps=()=>{I();const{toast:r}=Z(),a=Ue(),[n,o]=y.useState(null),[m,h]=y.useState(!1),[g,v]=y.useState(!1),[u,p]=y.useState(null),[F,_]=y.useState(!1),[l,q]=y.useState({first_name:"",last_name:"",date_of_birth:"",grade:"",school:"",pickup_location:"",dropoff_location:"",emergency_contact_name:"",emergency_contact_phone:"",medical_conditions:"",allergies:"",special_instructions:""}),[N,P]=y.useState({assessment_type:"",risk_level:"low",description:"",required_equipment:""}),{data:i=[],isLoading:t,refetch:j}=We(),{data:b=[],isLoading:R,refetch:D}=Ge(n==null?void 0:n.id),B=He(),H=Ve(),c=Ye(),f=(s,V)=>{q(Y=>K(z({},Y),{[s]:V}))},$=(s,V)=>{P(Y=>K(z({},Y),{[s]:V}))},Pe=()=>T(void 0,null,function*(){try{yield B.mutateAsync(K(z({},l),{is_active:!0})),r({title:"Child added successfully",description:`${l.first_name} ${l.last_name} has been added to your family.`}),q({first_name:"",last_name:"",date_of_birth:"",grade:"",school:"",pickup_location:"",dropoff_location:"",emergency_contact_name:"",emergency_contact_phone:"",medical_conditions:"",allergies:"",special_instructions:""}),h(!1),j()}catch(s){r({title:"Failed to add child",description:"There was an error adding your child. Please try again.",variant:"destructive"})}}),Re=()=>T(void 0,null,function*(){if(u)try{yield H.mutateAsync(z({id:u.id},l)),r({title:"Child updated successfully",description:`${l.first_name} ${l.last_name}'s information has been updated.`}),_(!1),p(null),j()}catch(s){r({title:"Failed to update child",description:"There was an error updating your child's information. Please try again.",variant:"destructive"})}}),Te=()=>T(void 0,null,function*(){if(n)try{yield c.mutateAsync({child_id:n.id,assessment_type:N.assessment_type,risk_level:N.risk_level,description:N.description,required_equipment:N.required_equipment,is_active:!0,assessment_date:new Date().toISOString().split("T")[0]}),r({title:"Risk assessment added successfully",description:"The risk assessment has been added to your child's profile."}),P({assessment_type:"",risk_level:"low",description:"",required_equipment:""}),v(!1),D()}catch(s){r({title:"Failed to add risk assessment",description:"There was an error adding the risk assessment. Please try again.",variant:"destructive"})}}),Le=s=>{p(s),q({first_name:s.first_name,last_name:s.last_name,date_of_birth:s.date_of_birth,grade:s.grade||"",school:s.school||"",pickup_location:s.pickup_location||"",dropoff_location:s.dropoff_location||"",emergency_contact_name:s.emergency_contact_name||"",emergency_contact_phone:s.emergency_contact_phone||"",medical_conditions:s.medical_conditions||"",allergies:s.allergies||"",special_instructions:s.special_instructions||""}),_(!0)},Ee=s=>{switch(s){case"low":return"bg-green-100 text-green-800";case"medium":return"bg-yellow-100 text-yellow-800";case"high":return"bg-orange-100 text-orange-800";case"critical":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},Me=s=>{switch(s){case"medical":return e.jsx(Se,{className:"w-4 h-4"});case"behavioral":return e.jsx(ss,{className:"w-4 h-4"});case"physical":return e.jsx(ce,{className:"w-4 h-4"});case"environmental":return e.jsx(es,{className:"w-4 h-4"});default:return e.jsx(be,{className:"w-4 h-4"})}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(w,{children:[e.jsx(C,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(S,{className:"flex items-center space-x-2",children:[e.jsx(ce,{className:"w-5 h-5"}),e.jsx("span",{children:"My Children"})]}),e.jsxs(se,{open:m,onOpenChange:h,children:[e.jsx(de,{asChild:!0,children:e.jsxs(x,{size:"sm",children:[e.jsx(X,{className:"w-4 h-4 mr-2"}),"Add Child"]})}),e.jsxs(te,{className:a?"w-[95vw] max-w-none mx-2":"",children:[e.jsxs(ae,{children:[e.jsx(ne,{children:"Add New Child"}),e.jsx(re,{children:"Add a new child to your family profile"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(d,{htmlFor:"firstName",children:"First Name"}),e.jsx(k,{id:"firstName",value:l.first_name,onChange:s=>f("first_name",s.target.value),placeholder:"Enter first name"})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"lastName",children:"Last Name"}),e.jsx(k,{id:"lastName",value:l.last_name,onChange:s=>f("last_name",s.target.value),placeholder:"Enter last name"})]})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"dateOfBirth",children:"Date of Birth"}),e.jsx(k,{id:"dateOfBirth",type:"date",value:l.date_of_birth,onChange:s=>f("date_of_birth",s.target.value)})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(d,{htmlFor:"grade",children:"Grade"}),e.jsx(k,{id:"grade",value:l.grade,onChange:s=>f("grade",s.target.value),placeholder:"e.g., 3rd Grade"})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"school",children:"School"}),e.jsx(k,{id:"school",value:l.school,onChange:s=>f("school",s.target.value),placeholder:"Enter school name"})]})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"pickupLocation",children:"Pickup Location"}),e.jsx(k,{id:"pickupLocation",value:l.pickup_location,onChange:s=>f("pickup_location",s.target.value),placeholder:"Enter pickup address"})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"dropoffLocation",children:"Dropoff Location"}),e.jsx(k,{id:"dropoffLocation",value:l.dropoff_location,onChange:s=>f("dropoff_location",s.target.value),placeholder:"Enter dropoff address"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(d,{htmlFor:"emergencyContactName",children:"Emergency Contact Name"}),e.jsx(k,{id:"emergencyContactName",value:l.emergency_contact_name,onChange:s=>f("emergency_contact_name",s.target.value),placeholder:"Emergency contact name"})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"emergencyContactPhone",children:"Emergency Contact Phone"}),e.jsx(k,{id:"emergencyContactPhone",value:l.emergency_contact_phone,onChange:s=>f("emergency_contact_phone",s.target.value),placeholder:"Emergency contact phone"})]})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"medicalConditions",children:"Medical Conditions"}),e.jsx(E,{id:"medicalConditions",value:l.medical_conditions,onChange:s=>f("medical_conditions",s.target.value),placeholder:"Any medical conditions or special needs"})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"allergies",children:"Allergies"}),e.jsx(E,{id:"allergies",value:l.allergies,onChange:s=>f("allergies",s.target.value),placeholder:"Any allergies or dietary restrictions"})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"specialInstructions",children:"Special Instructions"}),e.jsx(E,{id:"specialInstructions",value:l.special_instructions,onChange:s=>f("special_instructions",s.target.value),placeholder:"Any special instructions for transport"})]})]}),e.jsxs(le,{children:[e.jsx(x,{variant:"outline",onClick:()=>h(!1),children:"Cancel"}),e.jsx(x,{onClick:Pe,disabled:!l.first_name||!l.last_name||!l.date_of_birth||B.isPending,children:B.isPending?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Adding..."]}):"Add Child"})]})]})]})]})}),e.jsx(A,{children:t?e.jsx("div",{className:"flex items-center justify-center h-32",children:e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-primary"})}):i.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(ce,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"No children added yet"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Add your children to manage their transport information"})]}):e.jsx("div",{className:"space-y-4",children:i.map(s=>{const V=Ke(s.date_of_birth);return e.jsx("div",{className:`border rounded-lg p-4 cursor-pointer transition-all hover:shadow-md ${(n==null?void 0:n.id)===s.id?"ring-2 ring-blue-500 bg-blue-50":""}`,onClick:()=>o(s),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsxs("h3",{className:"font-semibold",children:[s.first_name," ",s.last_name]}),e.jsxs(M,{variant:"outline",children:[V," years old"]}),s.grade&&e.jsx(M,{variant:"secondary",children:s.grade})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.school||"School not set"}),s.medical_conditions&&s.medical_conditions!=="None"||s.allergies&&s.allergies!=="None"?e.jsxs("div",{className:"flex items-center space-x-2 mt-2",children:[e.jsx(be,{className:"w-4 h-4 text-orange-500"}),e.jsx("span",{className:"text-sm text-orange-600",children:"Medical alerts"})]}):null]}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsx(x,{variant:"outline",size:"sm",onClick:Y=>{Y.stopPropagation(),Le(s)},children:e.jsx(Ze,{className:"w-4 h-4"})})})]})},s.id)})})})]}),n&&e.jsxs(w,{children:[e.jsx(C,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(S,{className:"flex items-center space-x-2",children:[e.jsx(ue,{className:"w-5 h-5"}),e.jsxs("span",{children:["Risk Assessments - ",n.first_name]})]}),e.jsxs(se,{open:g,onOpenChange:v,children:[e.jsx(de,{asChild:!0,children:e.jsxs(x,{size:"sm",children:[e.jsx(X,{className:"w-4 h-4 mr-2"}),"Add Assessment"]})}),e.jsxs(te,{className:a?"w-[95vw] max-w-none mx-2":"",children:[e.jsxs(ae,{children:[e.jsx(ne,{children:"Add Risk Assessment"}),e.jsxs(re,{children:["Add a new risk assessment for ",n.first_name]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(d,{htmlFor:"assessmentType",children:"Assessment Type"}),e.jsxs(oe,{value:N.assessment_type,onValueChange:s=>$("assessment_type",s),children:[e.jsx(me,{children:e.jsx(he,{placeholder:"Select assessment type"})}),e.jsxs(xe,{children:[e.jsx(L,{value:"medical",children:"Medical"}),e.jsx(L,{value:"behavioral",children:"Behavioral"}),e.jsx(L,{value:"physical",children:"Physical"}),e.jsx(L,{value:"environmental",children:"Environmental"})]})]})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"riskLevel",children:"Risk Level"}),e.jsxs(oe,{value:N.risk_level,onValueChange:s=>$("risk_level",s),children:[e.jsx(me,{children:e.jsx(he,{})}),e.jsxs(xe,{children:[e.jsx(L,{value:"low",children:"Low"}),e.jsx(L,{value:"medium",children:"Medium"}),e.jsx(L,{value:"high",children:"High"}),e.jsx(L,{value:"critical",children:"Critical"})]})]})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"description",children:"Description"}),e.jsx(E,{id:"description",value:N.description,onChange:s=>$("description",s.target.value),placeholder:"Describe the risk assessment"})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"requiredEquipment",children:"Required Equipment"}),e.jsx(E,{id:"requiredEquipment",value:N.required_equipment,onChange:s=>$("required_equipment",s.target.value),placeholder:"Any required equipment or accommodations"})]})]}),e.jsxs(le,{children:[e.jsx(x,{variant:"outline",onClick:()=>v(!1),children:"Cancel"}),e.jsx(x,{onClick:Te,disabled:!N.assessment_type||!N.description||c.isPending,children:c.isPending?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Adding..."]}):"Add Assessment"})]})]})]})]})}),e.jsx(A,{children:R?e.jsx("div",{className:"flex items-center justify-center h-32",children:e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-primary"})}):b.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(ue,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"No risk assessments yet"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Add risk assessments to ensure safe transport"})]}):e.jsx("div",{className:"space-y-4",children:b.map(s=>e.jsx("div",{className:"border rounded-lg p-4",children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[Me(s.assessment_type),e.jsx("span",{className:"font-medium capitalize",children:s.assessment_type}),e.jsx(M,{className:Ee(s.risk_level),children:s.risk_level})]}),e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:s.description}),s.required_equipment&&e.jsxs("p",{className:"text-sm text-muted-foreground",children:[e.jsx("strong",{children:"Required:"})," ",s.required_equipment]})]})})},s.id))})})]}),e.jsx(se,{open:F,onOpenChange:_,children:e.jsxs(te,{className:a?"w-[95vw] max-w-none mx-2":"",children:[e.jsxs(ae,{children:[e.jsx(ne,{children:"Edit Child Information"}),e.jsxs(re,{children:["Update ",u==null?void 0:u.first_name,"'s information"]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(d,{htmlFor:"editFirstName",children:"First Name"}),e.jsx(k,{id:"editFirstName",value:l.first_name,onChange:s=>f("first_name",s.target.value)})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"editLastName",children:"Last Name"}),e.jsx(k,{id:"editLastName",value:l.last_name,onChange:s=>f("last_name",s.target.value)})]})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"editDateOfBirth",children:"Date of Birth"}),e.jsx(k,{id:"editDateOfBirth",type:"date",value:l.date_of_birth,onChange:s=>f("date_of_birth",s.target.value)})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(d,{htmlFor:"editGrade",children:"Grade"}),e.jsx(k,{id:"editGrade",value:l.grade,onChange:s=>f("grade",s.target.value)})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"editSchool",children:"School"}),e.jsx(k,{id:"editSchool",value:l.school,onChange:s=>f("school",s.target.value)})]})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"editMedicalConditions",children:"Medical Conditions"}),e.jsx(E,{id:"editMedicalConditions",value:l.medical_conditions,onChange:s=>f("medical_conditions",s.target.value)})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"editAllergies",children:"Allergies"}),e.jsx(E,{id:"editAllergies",value:l.allergies,onChange:s=>f("allergies",s.target.value)})]})]}),e.jsxs(le,{children:[e.jsx(x,{variant:"outline",onClick:()=>_(!1),children:"Cancel"}),e.jsx(x,{onClick:Re,disabled:!l.first_name||!l.last_name||H.isPending,children:H.isPending?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Updating..."]}):"Update Child"})]})]})})]})},fs=r=>{const{user:a}=I(),o=new Date().toISOString().split("T")[0];return De({queryKey:["attendance",a==null?void 0:a.id,o],queryFn:()=>T(void 0,null,function*(){if(!(a!=null&&a.id))return[];console.log("Fetching attendance for date:",o);try{const{data:m,error:h}=yield ve.from("daily_attendance").select(`
            *,
            child_profiles:child_profiles(
              id,
              first_name,
              last_name,
              pickup_location,
              dropoff_location
            ),
            routes:routes(
              id,
              name,
              start_location,
              end_location
            )
          `).eq("attendance_date",o).order("created_at",{ascending:!1});if(h)throw console.error("Error fetching attendance:",h),h;return console.log("Fetched attendance records:",m),m||[]}catch(m){return console.error("Error in useAttendance:",m),[]}}),enabled:!!(a!=null&&a.id)})},vs=()=>{const{toast:r}=Z(),a=qe();return Fe({mutationFn:u=>T(void 0,[u],function*({id:n,status:o,pickup_status:m,dropoff_status:h,parent_notes:g,driver_notes:v}){const p={};o&&(p.status=o),m&&(p.pickup_status=m),h&&(p.dropoff_status=h),g!==void 0&&(p.parent_notes=g),v!==void 0&&(p.driver_notes=v);const{data:F,error:_}=yield ve.from("daily_attendance").update(p).eq("id",n).select().single();if(_)throw _;return F}),onSuccess:n=>{a.invalidateQueries({queryKey:["attendance"]}),r({title:"Attendance Updated",description:"The attendance record has been updated successfully."})},onError:n=>{console.error("Error updating attendance:",n),r({title:"Error",description:"Failed to update attendance. Please try again.",variant:"destructive"})}})},Ns=()=>{I(),Z();const[r,a]=y.useState(!1),[n,o]=y.useState(null),[m,h]=y.useState(""),{data:g=[],isLoading:v}=fs(),u=vs(),p=i=>{switch(i){case"attending":return e.jsx(ge,{className:"w-5 h-5 text-green-500"});case"absent":return e.jsx(we,{className:"w-5 h-5 text-red-500"});case"late_pickup":return e.jsx(G,{className:"w-5 h-5 text-yellow-500"});case"sick":return e.jsx(J,{className:"w-5 h-5 text-orange-500"});case"holiday":return e.jsx(O,{className:"w-5 h-5 text-blue-500"});default:return e.jsx(J,{className:"w-5 h-5 text-gray-500"})}},F=i=>{switch(i){case"attending":return"bg-green-100 text-green-800 border-green-200";case"absent":return"bg-red-100 text-red-800 border-red-200";case"late_pickup":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"sick":return"bg-orange-100 text-orange-800 border-orange-200";case"holiday":return"bg-blue-100 text-blue-800 border-blue-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},_=i=>{switch(i){case"attending":return"Attending";case"absent":return"Absent";case"late_pickup":return"Late Pickup";case"sick":return"Sick";case"holiday":return"Holiday";default:return"Unknown"}},l=i=>{switch(i){case"picked_up":return"bg-green-100 text-green-800 border-green-200";case"pending":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"missed":return"bg-red-100 text-red-800 border-red-200";case"cancelled":return"bg-gray-100 text-gray-800 border-gray-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},q=i=>{switch(i){case"picked_up":return"Picked Up";case"pending":return"Pending";case"missed":return"Missed";case"cancelled":return"Cancelled";default:return"Unknown"}},N=(i,t)=>T(void 0,null,function*(){try{yield u.mutateAsync({id:i,status:t,parent_notes:m}),h(""),o(null)}catch(j){console.error("Failed to update attendance:",j)}}),P=i=>{a(i),i||(o(null),h(""))};return e.jsxs(se,{open:r,onOpenChange:P,children:[e.jsx(de,{asChild:!0,children:e.jsxs(x,{variant:"outline",size:"sm",children:[e.jsx(O,{className:"w-4 h-4 mr-2"}),"View Attendance"]})}),e.jsxs(te,{className:"max-w-4xl max-h-[80vh] overflow-y-auto",children:[e.jsxs(ae,{children:[e.jsx(ne,{children:"Daily Attendance"}),e.jsx(re,{children:"View and update attendance records for today"})]}),v?e.jsxs("div",{className:"flex items-center justify-center py-8",children:[e.jsx(je,{className:"w-8 h-8 animate-spin text-blue-600"}),e.jsx("span",{className:"ml-2",children:"Loading attendance data..."})]}):g.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(O,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Attendance Records"}),e.jsx("p",{className:"text-gray-600",children:"No attendance records found for today. Attendance records are created automatically when children are assigned to routes."})]}):e.jsx("div",{className:"space-y-6",children:g.map(i=>{var t,j,b;return e.jsxs(w,{children:[e.jsx(C,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(S,{className:"text-lg",children:[(t=i.child_profiles)==null?void 0:t.first_name," ",(j=i.child_profiles)==null?void 0:j.last_name]}),e.jsxs(fe,{children:["Route: ",((b=i.routes)==null?void 0:b.name)||"No route assigned"]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[p(i.status),e.jsx(M,{variant:"outline",className:F(i.status),children:_(i.status)})]})]})}),e.jsxs(A,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx(d,{className:"text-sm font-medium",children:"Pickup Status"}),e.jsx(M,{variant:"outline",className:l(i.pickup_status),children:q(i.pickup_status)})]}),e.jsxs("div",{children:[e.jsx(d,{className:"text-sm font-medium",children:"Dropoff Status"}),e.jsx(M,{variant:"outline",className:l(i.dropoff_status),children:q(i.dropoff_status)})]})]}),i.parent_notes&&e.jsxs("div",{className:"mb-4",children:[e.jsx(d,{className:"text-sm font-medium",children:"Parent Notes"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:i.parent_notes})]}),i.driver_notes&&e.jsxs("div",{className:"mb-4",children:[e.jsx(d,{className:"text-sm font-medium",children:"Driver Notes"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:i.driver_notes})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(d,{htmlFor:`notes-${i.id}`,className:"text-sm font-medium",children:"Add/Update Notes"}),e.jsx(E,{id:`notes-${i.id}`,placeholder:"Add any notes about today's attendance...",value:(n==null?void 0:n.id)===i.id?m:"",onChange:R=>{(n==null?void 0:n.id)===i.id||o(i),h(R.target.value)},className:"mt-1"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(x,{variant:"outline",size:"sm",onClick:()=>N(i.id,"attending"),disabled:u.isPending,children:[e.jsx(ge,{className:"w-4 h-4 mr-1"}),"Mark Attending"]}),e.jsxs(x,{variant:"outline",size:"sm",onClick:()=>N(i.id,"absent"),disabled:u.isPending,children:[e.jsx(we,{className:"w-4 h-4 mr-1"}),"Mark Absent"]}),e.jsxs(x,{variant:"outline",size:"sm",onClick:()=>N(i.id,"sick"),disabled:u.isPending,children:[e.jsx(J,{className:"w-4 h-4 mr-1"}),"Mark Sick"]}),u.isPending&&e.jsx(je,{className:"w-4 h-4 animate-spin"})]})]})]})]},i.id)})})]})]})},ys=()=>{const r=qe(),{profile:a}=I();return Fe({mutationFn:n=>T(void 0,null,function*(){if(!(a!=null&&a.organization_id))throw new Error("Organization ID is required");const{data:o,error:m}=yield ve.from("customer_bookings").insert([K(z({},n),{organization_id:a.organization_id,created_by:a.id})]).select().single();if(m)throw m;return o}),onSuccess:()=>{r.invalidateQueries({queryKey:["customer-bookings"]})}})},bs=()=>{const{profile:r}=I(),{toast:a}=Z(),n=ys(),[o,m]=y.useState(""),[h,g]=y.useState(""),[v,u]=y.useState(""),[p,F]=y.useState(""),[_,l]=y.useState(""),[q,N]=y.useState(!1),{data:P}=De({queryKey:["available-routes"],queryFn:()=>T(void 0,null,function*(){return console.log("Fetching available routes"),[{id:"route-1",name:"City Center Route",transport_company:"Logistics Solution Resources",route_number:"R001",is_active:!0},{id:"route-2",name:"Suburban Express",transport_company:"Logistics Solution Resources",route_number:"R002",is_active:!0},{id:"route-3",name:"School Run Special",transport_company:"Logistics Solution Resources",route_number:"R003",is_active:!0}]})}),i=t=>T(void 0,null,function*(){t.preventDefault(),N(!0);try{const j=`BK-${Date.now()}-${Math.random().toString(36).substr(2,5).toUpperCase()}`,b={booking_number:j,customer_name:`${(r==null?void 0:r.first_name)||""} ${(r==null?void 0:r.last_name)||""}`.trim(),customer_email:r==null?void 0:r.email,customer_phone:r==null?void 0:r.phone,customer_id:r==null?void 0:r.id,pickup_location:v,dropoff_location:p,service_type:"school_transport",passengers:1,special_requirements:_,booking_date:h,estimated_price:25};yield n.mutateAsync(b),a({title:"Booking Request Submitted",description:`Your transport booking request (${j}) has been submitted for review.`}),m(""),g(""),u(""),F(""),l("")}catch(j){console.error("Booking submission error:",j),a({title:"Submission Failed",description:"Failed to submit booking request. Please try again.",variant:"destructive"})}finally{N(!1)}});return e.jsxs(w,{children:[e.jsxs(C,{children:[e.jsxs(S,{className:"flex items-center space-x-2",children:[e.jsx(O,{className:"w-5 h-5 text-blue-500"}),e.jsx("span",{children:"Request Transport Booking"})]}),e.jsx(fe,{children:"Submit a request for transport services"})]}),e.jsx(A,{children:e.jsxs("form",{onSubmit:i,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"route",children:"Preferred Route"}),e.jsxs(oe,{value:o,onValueChange:m,children:[e.jsx(me,{children:e.jsx(he,{placeholder:"Select a route"})}),e.jsx(xe,{children:P==null?void 0:P.map(t=>e.jsx(L,{value:t.id,children:t.name},t.id))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"date",children:"Request Date"}),e.jsx(k,{id:"date",type:"date",value:h,onChange:t=>g(t.target.value),min:new Date().toISOString().split("T")[0],required:!0})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"pickup",children:"Pickup Location"}),e.jsxs("div",{className:"relative",children:[e.jsx(ie,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx(k,{id:"pickup",value:v,onChange:t=>u(t.target.value),placeholder:"Enter pickup address",className:"pl-10",required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"dropoff",children:"Drop-off Location"}),e.jsxs("div",{className:"relative",children:[e.jsx(ie,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx(k,{id:"dropoff",value:p,onChange:t=>F(t.target.value),placeholder:"Enter drop-off address",className:"pl-10",required:!0})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"requests",children:"Special Requests or Notes"}),e.jsxs("div",{className:"relative",children:[e.jsx(Ae,{className:"absolute left-3 top-3 text-gray-400 w-4 h-4"}),e.jsx(E,{id:"requests",value:_,onChange:t=>l(t.target.value),placeholder:"Any special requirements, accessibility needs, or additional information...",className:"pl-10",rows:3})]})]}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsx("h4",{className:"font-medium text-blue-900 mb-2",children:"Important Information"}),e.jsxs("ul",{className:"text-sm text-blue-800 space-y-1",children:[e.jsx("li",{children:"â€¢ Booking requests are subject to availability and approval"}),e.jsx("li",{children:"â€¢ You will receive confirmation within 24 hours"}),e.jsx("li",{children:"â€¢ Special requirements may affect pricing"}),e.jsx("li",{children:"â€¢ Cancellations must be made at least 24 hours in advance"})]})]}),e.jsx(x,{type:"submit",className:"w-full",disabled:q||!h||!v||!p,children:q?"Submitting...":"Submit Booking Request"})]})})]})},ws=({className:r})=>{const[a,n]=y.useState(new Date);Ce();const o=os(a,{weekStartsOn:1}),m=ms(a,{weekStartsOn:1}),h=hs({start:o,end:m}),g=[];for(let t=0;t<7;t++){const j=new Date(o);j.setDate(o.getDate()+t);const{data:b=[]}=Qe(j);g.push(b)}const v=t=>{n(t==="next"?xs(a,1):us(a,1))},u=t=>{try{const[j,b]=t.split(":"),R=parseInt(j),D=R>=12?"PM":"AM";return`${R%12||12}:${b} ${D}`}catch(j){return t}},p=t=>t==="pickup"?e.jsx(pe,{className:"w-3 h-3"}):e.jsx(Q,{className:"w-3 h-3"}),F=t=>t==="pickup"?"text-blue-600 bg-blue-50":"text-green-600 bg-green-50",_=t=>{switch(t){case"completed":return"bg-green-100 text-green-800 border-green-200";case"in_progress":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"delayed":return"bg-red-100 text-red-800 border-red-200";default:return"bg-blue-100 text-blue-800 border-blue-200"}},l=t=>{switch(t){case"completed":return"Completed";case"in_progress":return"In Progress";case"delayed":return"Delayed";default:return"Scheduled"}},q=t=>g[t]||[],N=()=>{const t=g.flat();return[...new Set(t.map(b=>b.childName))]},P=(t,j)=>q(t).filter(b=>b.childName===j),i=N();return e.jsxs("div",{className:`space-y-6 ${r}`,children:[e.jsx(w,{children:e.jsx(C,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(S,{className:"flex items-center space-x-2",children:[e.jsx(O,{className:"w-5 h-5"}),e.jsx("span",{children:"Weekly Schedule"})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(x,{variant:"outline",size:"sm",onClick:()=>v("prev"),children:e.jsx(ts,{className:"w-4 h-4"})}),e.jsxs("span",{className:"text-sm font-medium",children:[ee(o,"MMM d")," - ",ee(m,"MMM d, yyyy")]}),e.jsx(x,{variant:"outline",size:"sm",onClick:()=>v("next"),children:e.jsx(as,{className:"w-4 h-4"})})]}),e.jsx(x,{variant:"outline",size:"sm",onClick:()=>n(new Date),children:"Today"})]})]})})}),e.jsx(w,{children:e.jsx(A,{className:"p-6",children:i.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(O,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Schedule Data"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"No children are assigned to routes for this week."}),e.jsxs(x,{variant:"outline",children:[e.jsx(X,{className:"w-4 h-4 mr-2"}),"Add Children to Routes"]})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"grid grid-cols-7 gap-4 border-b pb-4",children:h.map((t,j)=>e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:`text-sm font-medium ${ke(t)?"text-blue-600":"text-gray-600"}`,children:ee(t,"EEE")}),e.jsx("div",{className:`text-lg font-bold ${ke(t)?"text-blue-600":"text-gray-900"}`,children:ee(t,"d")})]},j))}),i.map(t=>e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsx("h3",{className:"font-semibold text-lg mb-4 text-gray-900",children:t}),e.jsx("div",{className:"grid grid-cols-7 gap-4",children:h.map((j,b)=>{const R=P(b,t);return e.jsx("div",{className:"min-h-[120px]",children:R.length===0?e.jsx("div",{className:"text-center text-gray-400 text-xs py-8",children:"No schedule"}):e.jsx("div",{className:"space-y-2",children:R.map(D=>e.jsxs("div",{className:`p-2 rounded-lg border text-xs ${F(D.type)}`,children:[e.jsxs("div",{className:"flex items-center space-x-1 mb-1",children:[p(D.type),e.jsx("span",{className:"font-medium",children:D.type==="pickup"?"Pickup":"Dropoff"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(G,{className:"w-3 h-3"}),e.jsx("span",{children:u(D.time)})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(ie,{className:"w-3 h-3"}),e.jsx("span",{className:"truncate",title:D.location,children:D.location})]}),e.jsx("div",{className:"text-xs text-gray-600",children:D.driverName}),e.jsx(M,{variant:"outline",className:`text-xs ${_(D.status)}`,children:l(D.status)})]})]},D.id))})},b)})})]},t))]})})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs(w,{children:[e.jsx(C,{children:e.jsx(S,{className:"text-sm font-medium",children:"Total Trips This Week"})}),e.jsxs(A,{children:[e.jsx("div",{className:"text-2xl font-bold",children:g.flat().length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Pickups and dropoffs combined"})]})]}),e.jsxs(w,{children:[e.jsx(C,{children:e.jsx(S,{className:"text-sm font-medium",children:"Children with Schedules"})}),e.jsxs(A,{children:[e.jsx("div",{className:"text-2xl font-bold",children:i.length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Active this week"})]})]}),e.jsxs(w,{children:[e.jsx(C,{children:e.jsx(S,{className:"text-sm font-medium",children:"Completed Trips"})}),e.jsxs(A,{children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:g.flat().filter(t=>t.status==="completed").length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Successfully completed"})]})]})]})]})},Os=()=>{const{user:r,profile:a}=I();Z();const[n,o]=y.useState("overview");if((a==null?void 0:a.role)!=="parent")return e.jsx(Navigate,{to:"/dashboard",replace:!0});const{children:m,notifications:h,stats:g,isLoading:v,childrenError:u,notificationsError:p,markNotificationRead:F,refreshAllData:_,getChildStatus:l}=Ce(),q=m,[N,P]=y.useState(!1),[i,t]=y.useState(!1),[j,b]=y.useState(!1);if(v)return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-indigo-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(je,{className:"h-8 w-8 animate-spin text-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading your dashboard..."})]})});if(u||p)return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-indigo-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(J,{className:"h-8 w-8 text-red-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Failed to load dashboard data. Please try again."}),e.jsx(x,{onClick:_,className:"mt-4",children:"Retry"})]})});const R=c=>{switch(c){case"on_route":return"text-blue-600 bg-blue-50 border-blue-200";case"at_school":return"text-green-600 bg-green-50 border-green-200";case"at_home":return"text-gray-600 bg-gray-50 border-gray-200";case"pickup_scheduled":return"text-orange-600 bg-orange-50 border-orange-200";default:return"text-gray-600 bg-gray-50 border-gray-200"}},D=c=>{switch(c){case"on_route":return"On Route";case"at_school":return"At School";case"at_home":return"At Home";case"pickup_scheduled":return"Pickup Scheduled";default:return"Unknown"}},B=c=>{switch(c){case"on_route":return e.jsx(pe,{className:"w-4 h-4"});case"at_school":return e.jsx(ge,{className:"w-4 h-4"});case"at_home":return e.jsx(Q,{className:"w-4 h-4"});case"pickup_scheduled":return e.jsx(G,{className:"w-4 h-4"});default:return e.jsx(J,{className:"w-4 h-4"})}},H=c=>{F.mutate(c)};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-indigo-50",children:e.jsxs("div",{className:"container mx-auto p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Parent Dashboard"}),e.jsxs("p",{className:"text-gray-600 mt-1",children:["Welcome back, ",(a==null?void 0:a.first_name)||"Parent","! Here's what's happening with your children today."]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs(x,{variant:"outline",size:"sm",onClick:_,children:[e.jsx(ns,{className:"w-4 h-4 mr-2"}),"Refresh"]}),e.jsxs(x,{variant:"outline",size:"sm",children:[e.jsx(rs,{className:"w-4 h-4 mr-2"}),"Settings"]})]})]}),e.jsx(gs,{}),e.jsxs(Je,{value:n,onValueChange:o,className:"space-y-6",children:[e.jsxs(Xe,{className:"grid w-full grid-cols-6",children:[e.jsx(U,{value:"overview",children:"Overview"}),e.jsx(U,{value:"tracking",children:"Live Tracking"}),e.jsx(U,{value:"schedule",children:"Schedule"}),e.jsx(U,{value:"emergency",children:"Emergency Contacts"}),e.jsx(U,{value:"communication",children:"Communication"}),e.jsxs(U,{value:"notifications",children:["Notifications (",g.unreadNotifications,")"]})]}),e.jsxs(W,{value:"overview",className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsxs(w,{children:[e.jsxs(C,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(S,{className:"text-sm font-medium",children:"My Children"}),e.jsx(Q,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(A,{children:[e.jsx("div",{className:"text-2xl font-bold",children:g.totalChildren}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Active registrations"})]})]}),e.jsxs(w,{children:[e.jsxs(C,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(S,{className:"text-sm font-medium",children:"On Route"}),e.jsx(pe,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(A,{children:[e.jsx("div",{className:"text-2xl font-bold",children:g.childrenOnRoute}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Currently traveling"})]})]}),e.jsxs(w,{children:[e.jsxs(C,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(S,{className:"text-sm font-medium",children:"Notifications"}),e.jsx(_e,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(A,{children:[e.jsx("div",{className:"text-2xl font-bold",children:g.unreadNotifications}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Unread messages"})]})]}),e.jsxs(w,{children:[e.jsxs(C,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(S,{className:"text-sm font-medium",children:"Today's Pickups"}),e.jsx(G,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(A,{children:[e.jsx("div",{className:"text-2xl font-bold",children:g.todaysPickups}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Scheduled today"})]})]})]}),e.jsxs(w,{children:[e.jsx(C,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(S,{children:"Children Status"}),e.jsxs(x,{variant:"outline",size:"sm",onClick:()=>P(!0),children:[e.jsx(X,{className:"w-4 h-4 mr-2"}),"Manage Children"]})]})}),e.jsx(A,{children:e.jsx("div",{className:"space-y-4",children:q.map(c=>{const f=l(c.id),$=c.date_of_birth?new Date().getFullYear()-new Date(c.date_of_birth).getFullYear():"N/A";return e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx(Q,{className:"w-6 h-6 text-blue-600"})}),e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold",children:[c.first_name," ",c.last_name]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[c.grade_level||"N/A"," â€¢ Age ",$]}),c.pickup_location&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Pickup: ",c.pickup_location]})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(M,{variant:"outline",className:R(f),children:e.jsxs("div",{className:"flex items-center space-x-1",children:[B(f),e.jsx("span",{children:D(f)})]})}),e.jsx(x,{variant:"ghost",size:"sm",children:e.jsx(is,{className:"w-4 h-4"})})]})]},c.id)})})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs(w,{children:[e.jsx(C,{children:e.jsxs(S,{className:"flex items-center space-x-2",children:[e.jsx(O,{className:"w-5 h-5"}),e.jsx("span",{children:"Quick Actions"})]})}),e.jsxs(A,{className:"space-y-3",children:[e.jsxs(x,{variant:"outline",className:"w-full justify-start",onClick:()=>t(!0),children:[e.jsx(G,{className:"w-4 h-4 mr-2"}),"View Attendance"]}),e.jsxs(x,{variant:"outline",className:"w-full justify-start",onClick:()=>b(!0),children:[e.jsx(X,{className:"w-4 h-4 mr-2"}),"Request Booking"]}),e.jsxs(x,{variant:"outline",className:"w-full justify-start",onClick:()=>o("communication"),children:[e.jsx(Ae,{className:"w-4 h-4 mr-2"}),"Contact Transport"]})]})]}),e.jsxs(w,{children:[e.jsx(C,{children:e.jsxs(S,{className:"flex items-center space-x-2",children:[e.jsx(_e,{className:"w-5 h-5"}),e.jsx("span",{children:"Recent Notifications"})]})}),e.jsxs(A,{children:[e.jsx("div",{className:"space-y-3",children:h.slice(0,3).map(c=>e.jsx("div",{className:`p-3 rounded-lg border cursor-pointer transition-colors ${c.is_read?"bg-gray-50":"bg-blue-50 border-blue-200"}`,onClick:()=>H(c.id),children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:c.title}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:new Date(c.created_at).toLocaleTimeString()})]}),!c.is_read&&e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"})]})},c.id))}),e.jsx(x,{variant:"ghost",size:"sm",className:"w-full mt-3",onClick:()=>o("notifications"),children:"View All Notifications"})]})]}),e.jsxs(w,{children:[e.jsx(C,{children:e.jsxs(S,{className:"flex items-center space-x-2",children:[e.jsx(ie,{className:"w-5 h-5"}),e.jsx("span",{children:"Today's Schedule"})]})}),e.jsx(A,{children:e.jsx("div",{className:"space-y-3",children:q.map(c=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h4",{className:"font-medium text-sm",children:[c.first_name," ",c.last_name]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsx("span",{children:"Pickup:"}),e.jsx("span",{className:"font-medium",children:c.pickup_time||"N/A"})]}),e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsx("span",{children:"Dropoff:"}),e.jsx("span",{className:"font-medium",children:c.dropoff_time||"N/A"})]})]})]},c.id))})})]})]})]}),e.jsx(W,{value:"tracking",className:"space-y-6",children:e.jsx(ls,{})}),e.jsx(W,{value:"schedule",className:"space-y-6",children:e.jsx(ws,{})}),e.jsx(W,{value:"emergency",className:"space-y-6",children:e.jsx(js,{})}),e.jsx(W,{value:"communication",className:"space-y-6",children:e.jsx(cs,{})}),e.jsx(W,{value:"notifications",className:"space-y-6",children:e.jsx(ds,{})})]}),N&&e.jsx(ps,{}),i&&e.jsx(Ns,{}),j&&e.jsx(bs,{})]})})};export{Os as default};
