import{j as e}from"./ui-vendor-DMUr7mTx.js";import{r as E}from"./react-vendor-BvqlMsL5.js";import{u as I,aq as A,as as B,B as x,C as t,a as r,b as a,d as l,e as N}from"./index-ZwIgorfy.js";import{N as g}from"./router-vendor-CEyBJ8vK.js";import{g as o,_ as m,f as y,j as b,M as H,$ as L}from"./icons-vendor-b0I7fGSL.js";import"./supabase-vendor-B984m0TI.js";import"./utils-vendor-B2FlkASS.js";import"./query-vendor-B2F_wWlc.js";import"./ui-components-7w1-MJre.js";const G=()=>{const{user:v,profile:h,loading:w}=I(),[d,u]=E.useState(new Date),{data:i=[],isLoading:S,error:T}=A(d),n=B(d);if(w||S)return e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-primary mb-4"}),e.jsx("p",{className:"text-lg",children:"Loading schedule..."})]})});if(!v||!h)return e.jsx(g,{to:"/auth",replace:!0});if(h.role!=="parent")return e.jsx(g,{to:"/dashboard",replace:!0});const C=s=>{switch(s){case"scheduled":return"bg-blue-100 text-blue-800 border-blue-200";case"in_progress":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"completed":return"bg-green-100 text-green-800 border-green-200";case"delayed":return"bg-red-100 text-red-800 border-red-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},k=s=>{switch(s){case"scheduled":return"Scheduled";case"in_progress":return"In Progress";case"completed":return"Completed";case"delayed":return"Delayed";default:return"Unknown"}},D=s=>s==="pickup"?e.jsx(m,{className:"w-4 h-4"}):e.jsx(y,{className:"w-4 h-4"}),p=s=>s==="pickup"?"text-blue-600":"text-green-600",P=s=>s==="pickup"?"Pickup":"Dropoff",j=s=>{try{const[c,$]=s.split(":"),f=parseInt(c),M=f>=12?"PM":"AM";return`${f%12||12}:${$} ${M}`}catch(c){return s}};return e.jsxs("div",{className:"container mx-auto p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Schedule"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"View and manage your children's transport schedule"})]}),e.jsx("div",{className:"flex items-center space-x-3",children:e.jsxs(x,{variant:"outline",children:[e.jsx(o,{className:"w-4 h-4 mr-2"}),"Export Schedule"]})})]}),e.jsxs(t,{children:[e.jsx(r,{children:e.jsxs(a,{className:"flex items-center space-x-2",children:[e.jsx(o,{className:"w-5 h-5"}),e.jsx("span",{children:"Select Date"})]})}),e.jsx(l,{children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("input",{type:"date",value:d.toISOString().split("T")[0],onChange:s=>u(new Date(s.target.value)),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"}),e.jsx(x,{variant:"outline",onClick:()=>u(new Date),children:"Today"})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsxs(t,{children:[e.jsxs(r,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(a,{className:"text-sm font-medium",children:"Total Trips"}),e.jsx(m,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(l,{children:[e.jsx("div",{className:"text-2xl font-bold",children:n.totalTrips}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Scheduled for today"})]})]}),e.jsxs(t,{children:[e.jsxs(r,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(a,{className:"text-sm font-medium",children:"Pickups"}),e.jsx(m,{className:"h-4 w-4 text-blue-600"})]}),e.jsxs(l,{children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:n.pickups}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Morning pickups"})]})]}),e.jsxs(t,{children:[e.jsxs(r,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(a,{className:"text-sm font-medium",children:"Dropoffs"}),e.jsx(y,{className:"h-4 w-4 text-green-600"})]}),e.jsxs(l,{children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:n.dropoffs}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Afternoon dropoffs"})]})]}),e.jsxs(t,{children:[e.jsxs(r,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(a,{className:"text-sm font-medium",children:"Completed"}),e.jsx(b,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(l,{children:[e.jsx("div",{className:"text-2xl font-bold",children:n.completed}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Trips completed"})]})]})]}),e.jsxs(t,{children:[e.jsx(r,{children:e.jsx(a,{children:"Today's Schedule"})}),e.jsx(l,{children:i.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(o,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"No schedule items for today"}),e.jsx("p",{className:"text-sm text-gray-500 mt-2",children:T?"Error loading schedule data":"Your children may not be assigned to any routes today"})]}):e.jsx("div",{className:"space-y-4",children:i.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:`w-12 h-12 rounded-full flex items-center justify-center ${p(s.type)} bg-opacity-10`,children:D(s.type)}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("h3",{className:"font-semibold",children:s.childName}),e.jsx(N,{variant:"outline",className:p(s.type),children:P(s.type)})]}),e.jsxs("div",{className:"flex items-center space-x-4 mt-1 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(b,{className:"w-4 h-4"}),e.jsx("span",{children:j(s.time)})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(H,{className:"w-4 h-4"}),e.jsx("span",{children:s.location})]})]}),e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Driver: ",s.driverName," • Vehicle: ",s.vehicleNumber,s.routeName&&` • Route: ${s.routeName}`]})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(N,{variant:"outline",className:C(s.status),children:k(s.status)}),e.jsx(x,{variant:"ghost",size:"sm",children:e.jsx(L,{className:"w-4 h-4"})})]})]},s.id))})})]}),e.jsxs(t,{children:[e.jsx(r,{children:e.jsx(a,{children:"Weekly Schedule"})}),e.jsx(l,{children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-7 gap-4",children:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"].map(s=>e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-medium text-sm mb-2",children:s}),e.jsx("div",{className:"space-y-1",children:i.slice(0,2).map(c=>e.jsxs("div",{className:"text-xs p-2 bg-gray-100 rounded",children:[e.jsx("div",{className:"font-medium",children:c.childName}),e.jsx("div",{className:"text-gray-600",children:j(c.time)})]},`${s}-${c.id}`))})]},s))})})]})]})};export{G as default};
