var Xe=Object.defineProperty,Ye=Object.defineProperties;var es=Object.getOwnPropertyDescriptors;var we=Object.getOwnPropertySymbols;var ss=Object.prototype.hasOwnProperty,ts=Object.prototype.propertyIsEnumerable;var Ce=(g,l,p)=>l in g?Xe(g,l,{enumerable:!0,configurable:!0,writable:!0,value:p}):g[l]=p,a=(g,l)=>{for(var p in l||(l={}))ss.call(l,p)&&Ce(g,p,l[p]);if(we)for(var p of we(l))ts.call(l,p)&&Ce(g,p,l[p]);return g},i=(g,l)=>Ye(g,es(l));var _=(g,l,p)=>new Promise((f,k)=>{var oe=v=>{try{J(p.next(v))}catch($){k($)}},T=v=>{try{J(p.throw(v))}catch($){k($)}},J=v=>v.done?f(v.value):Promise.resolve(v.value).then(oe,T);J((p=p.apply(g,l)).next())});import{j as e}from"./ui-vendor-DMUr7mTx.js";import{r as j}from"./react-vendor-BvqlMsL5.js";import{u as rs,B as c,C as Q,a as R,b as ne,d as G,I as o,S as V,q as U,r as B,t as K,v as d,h as ns,i as as,j as ae,e as W,D as S,m as F,n as D,o as P,p as O,L as n,T as Z,G as E,s as I,y as N}from"./index-ZwIgorfy.js";import{a as is,u as pe,b as ie}from"./query-vendor-B2F_wWlc.js";import{N as qe}from"./router-vendor-CEyBJ8vK.js";import{s as X,t as Se,ab as ls,af as cs,E as le,T as Fe,bg as ce,D as De,a2 as os,Z as ds,aa as us,ak as Pe,bk as Oe,F as xs,M as Ee,$ as ms,S as hs,j as ps,J as js}from"./icons-vendor-b0I7fGSL.js";import"./supabase-vendor-B984m0TI.js";import"./utils-vendor-B2FlkASS.js";import"./ui-components-7w1-MJre.js";const qs=()=>{const{user:g,profile:l,loading:p}=rs(),f=is(),[k,oe]=j.useState("inventory"),[T,J]=j.useState(""),[v,$]=j.useState("all"),[de,Ie]=j.useState("all"),[Te,H]=j.useState(!1),[Ae,Y]=j.useState(!1),[Me,w]=j.useState(!1),[ze,ee]=j.useState(!1),[Le,se]=j.useState(!1),[Qe,te]=j.useState(!1),[Re,ue]=j.useState(!1),[r,A]=j.useState(null),[t,u]=j.useState({part_number:"",name:"",description:"",category:"engine",quantity:0,min_quantity:0,unit_price:0,supplier:"",supplier_contact:"",location:"",notes:""}),[h,C]=j.useState({quantity:0,unit_price:0,reference_type:"manual",reference_number:"",notes:""}),[y,M]=j.useState({quantity:0,reference_type:"job",reference_number:"",notes:""}),[m,b]=j.useState({quantity:0,unit_price:0,supplier:"",supplier_contact:"",expected_delivery:"",notes:""});if(p)return e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-primary mb-4"}),e.jsx("p",{className:"text-lg",children:"Loading parts inventory..."})]})});if(!g||!l)return e.jsx(qe,{to:"/auth",replace:!0});if(l.role!=="mechanic")return e.jsx(qe,{to:"/dashboard",replace:!0});const{data:z=[],isLoading:Ve,refetch:Ue}=pe({queryKey:["parts-inventory"],queryFn:()=>_(void 0,null,function*(){console.log("🔍 Fetching parts from backend..."),console.log("👤 Current user profile:",l),console.log("🏢 User organization:",l==null?void 0:l.organization_id);const{data:s,error:x}=yield I.from("parts_inventory").select("*").eq("organization_id",l==null?void 0:l.organization_id).order("name");return x?(console.error("Error fetching parts inventory:",x),[]):(console.log("📊 Backend returned parts:",s),console.log("📊 Parts count:",(s==null?void 0:s.length)||0),s||[])}),staleTime:0,gcTime:0,refetchOnWindowFocus:!0,refetchOnMount:!0}),je=()=>_(void 0,null,function*(){console.log("🔄 Force refreshing data..."),f.clear(),localStorage.clear(),sessionStorage.clear(),yield f.invalidateQueries({queryKey:["parts-inventory"]}),yield f.invalidateQueries({queryKey:["stock-movements"]}),yield f.invalidateQueries({queryKey:["stock-orders"]}),yield Ue(),console.log("✅ Force refresh completed")});j.useEffect(()=>{je()},[]);const{data:Be=[]}=pe({queryKey:["stock-movements"],queryFn:()=>_(void 0,null,function*(){const{data:s,error:x}=yield I.from("stock_movements").select(`
          *,
          part:parts_inventory(part_number, name)
        `).order("movement_date",{ascending:!1}).limit(50);return x?(console.error("Error fetching stock movements:",x),[]):s||[]})});pe({queryKey:["stock-orders"],queryFn:()=>_(void 0,null,function*(){const{data:s,error:x}=yield I.from("stock_orders").select(`
          *,
          part:parts_inventory(part_number, name)
        `).order("order_date",{ascending:!1});return x?(console.error("Error fetching stock orders:",x),[]):s||[]})});const xe=ie({mutationFn:s=>_(void 0,null,function*(){const x=i(a({},s),{organization_id:l==null?void 0:l.organization_id,created_by:g==null?void 0:g.id,status:"in_stock"}),{data:q,error:re}=yield I.from("parts_inventory").insert([x]).select().single();if(re)throw re;return q}),onSuccess:()=>{f.invalidateQueries({queryKey:["parts-inventory"]}),N({title:"Success",description:"Part added successfully"}),H(!1),u({part_number:"",name:"",description:"",category:"engine",quantity:0,min_quantity:0,unit_price:0,supplier:"",supplier_contact:"",location:"",notes:""})},onError:s=>{N({title:"Error",description:"Failed to add part",variant:"destructive"})}}),me=ie({mutationFn:q=>_(void 0,[q],function*({id:s,data:x}){const{data:re,error:ke}=yield I.from("parts_inventory").update(x).eq("id",s).select().single();if(ke)throw ke;return re}),onSuccess:()=>{f.invalidateQueries({queryKey:["parts-inventory"]}),N({title:"Success",description:"Part updated successfully"}),Y(!1),A(null)},onError:s=>{N({title:"Error",description:"Failed to update part",variant:"destructive"})}}),L=ie({mutationFn:s=>_(void 0,null,function*(){const{data:x,error:q}=yield I.from("stock_movements").insert([s]).select().single();if(q)throw q;return x}),onSuccess:()=>{f.invalidateQueries({queryKey:["parts-inventory","stock-movements"]}),N({title:"Success",description:"Stock movement recorded successfully"}),ee(!1),se(!1),C({quantity:0,unit_price:0,reference_type:"manual",reference_number:"",notes:""}),M({quantity:0,reference_type:"job",reference_number:"",notes:""})},onError:s=>{N({title:"Error",description:"Failed to record stock movement",variant:"destructive"})}}),he=ie({mutationFn:s=>_(void 0,null,function*(){const{data:x,error:q}=yield I.from("stock_orders").insert([s]).select().single();if(q)throw q;return x}),onSuccess:()=>{f.invalidateQueries({queryKey:["stock-orders"]}),N({title:"Success",description:"Stock order created successfully"}),te(!1),b({quantity:0,unit_price:0,supplier:"",supplier_contact:"",expected_delivery:"",notes:""})},onError:s=>{N({title:"Error",description:"Failed to create stock order",variant:"destructive"})}}),ge=z.filter(s=>!(k==="low_stock"&&s.quantity>s.min_quantity||k==="out_of_stock"&&s.quantity>0||k==="on_order"&&s.status!=="on_order"||T&&!s.name.toLowerCase().includes(T.toLowerCase())&&!s.part_number.toLowerCase().includes(T.toLowerCase())||v!=="all"&&s.category!==v||de!=="all"&&s.status!==de)),ye=s=>{switch(s){case"in_stock":return"bg-green-100 text-green-800 border-green-200";case"low_stock":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"out_of_stock":return"bg-red-100 text-red-800 border-red-200";case"on_order":return"bg-blue-100 text-blue-800 border-blue-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},ve=s=>{switch(s){case"in_stock":return e.jsx(js,{className:"w-4 h-4"});case"low_stock":return e.jsx(Fe,{className:"w-4 h-4"});case"out_of_stock":return e.jsx(ce,{className:"w-4 h-4"});case"on_order":return e.jsx(ps,{className:"w-4 h-4"});default:return e.jsx(X,{className:"w-4 h-4"})}},Ke=()=>{xe.mutate({part_number:t.part_number,name:t.name,description:t.description,category:t.category,quantity:t.quantity,min_quantity:t.min_quantity,unit_price:t.unit_price,supplier:t.supplier,supplier_contact:t.supplier_contact,location:t.location,status:t.quantity>t.min_quantity?"in_stock":"low_stock"})},Je=()=>{r&&me.mutate({id:r.id,data:{part_number:t.part_number,name:t.name,description:t.description,category:t.category,quantity:t.quantity,min_quantity:t.min_quantity,unit_price:t.unit_price,supplier:t.supplier,supplier_contact:t.supplier_contact,location:t.location,status:t.quantity>t.min_quantity?"in_stock":"low_stock"}})},fe=s=>{A(s),u({part_number:s.part_number,name:s.name,description:s.description,category:s.category,quantity:s.quantity,min_quantity:s.min_quantity,unit_price:s.unit_price,supplier:s.supplier,supplier_contact:s.supplier_contact,location:s.location,notes:""}),Y(!0)},$e=s=>{A(s),w(!0)},_e=s=>{A(s),C({quantity:0,unit_price:s.unit_price,reference_type:"manual",reference_number:"",notes:""}),ee(!0)},Ne=s=>{A(s),M({quantity:0,reference_type:"job",reference_number:"",notes:""}),se(!0)},be=s=>{A(s),b({quantity:s.min_quantity*2,unit_price:s.unit_price,supplier:s.supplier,supplier_contact:s.supplier_contact,expected_delivery:"",notes:""}),te(!0)},He=()=>{ue(!0)},Ge=()=>{r&&L.mutate({part_id:r.id,movement_type:"stock_in",quantity:h.quantity,previous_quantity:r.quantity,new_quantity:r.quantity+h.quantity,unit_price:h.unit_price,total_value:h.quantity*h.unit_price,reference_type:h.reference_type,reference_number:h.reference_number,notes:h.notes,moved_by:l.id})},We=()=>{if(r){if(y.quantity>r.quantity){N({title:"Error",description:"Insufficient stock available",variant:"destructive"});return}L.mutate({part_id:r.id,movement_type:"stock_out",quantity:y.quantity,previous_quantity:r.quantity,new_quantity:r.quantity-y.quantity,unit_price:r.unit_price,total_value:y.quantity*r.unit_price,reference_type:y.reference_type,reference_number:y.reference_number,notes:y.notes,moved_by:l.id})}},Ze=()=>{r&&he.mutate({part_id:r.id,supplier:m.supplier,supplier_contact:m.supplier_contact,quantity_ordered:m.quantity,unit_price:m.unit_price,total_cost:m.quantity*m.unit_price,expected_delivery:m.expected_delivery,notes:m.notes,ordered_by:l.id})};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-3",children:[e.jsx(X,{className:"w-8 h-8 text-blue-600"}),"Parts & Supplies"]}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Manage inventory, track supplies, and handle orders"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(c,{variant:"outline",size:"sm",onClick:He,children:[e.jsx(Se,{className:"w-4 h-4 mr-2"}),"Stock Movements"]}),e.jsxs(c,{variant:"outline",size:"sm",children:[e.jsx(ls,{className:"w-4 h-4 mr-2"}),"Export"]}),e.jsxs(c,{variant:"outline",size:"sm",children:[e.jsx(cs,{className:"w-4 h-4 mr-2"}),"Import"]}),e.jsxs(c,{size:"sm",onClick:()=>H(!0),children:[e.jsx(le,{className:"w-4 h-4 mr-2"}),"Add Part"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsxs(Q,{children:[e.jsxs(R,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(ne,{className:"text-sm font-medium",children:"Total Parts"}),e.jsx(X,{className:"h-4 w-4 text-blue-600"})]}),e.jsxs(G,{children:[e.jsx("div",{className:"text-2xl font-bold",children:z.length}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[z.filter(s=>s.status==="in_stock").length," in stock"]})]})]}),e.jsxs(Q,{children:[e.jsxs(R,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(ne,{className:"text-sm font-medium",children:"Low Stock"}),e.jsx(Fe,{className:"h-4 w-4 text-yellow-600"})]}),e.jsxs(G,{children:[e.jsx("div",{className:"text-2xl font-bold",children:z.filter(s=>s.status==="low_stock").length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Need reordering"})]})]}),e.jsxs(Q,{children:[e.jsxs(R,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(ne,{className:"text-sm font-medium",children:"Out of Stock"}),e.jsx(ce,{className:"h-4 w-4 text-red-600"})]}),e.jsxs(G,{children:[e.jsx("div",{className:"text-2xl font-bold",children:z.filter(s=>s.status==="out_of_stock").length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Urgent orders needed"})]})]}),e.jsxs(Q,{children:[e.jsxs(R,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(ne,{className:"text-sm font-medium",children:"Total Value"}),e.jsx(De,{className:"h-4 w-4 text-green-600"})]}),e.jsxs(G,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:["£",z.reduce((s,x)=>s+x.quantity*x.unit_price,0).toLocaleString()]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Inventory value"})]})]})]}),e.jsx(Q,{children:e.jsx(R,{children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 items-start md:items-center justify-between",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 flex-1",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(os,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx(o,{placeholder:"Search parts...",value:T,onChange:s=>J(s.target.value),className:"pl-10"})]}),e.jsxs(V,{value:v,onValueChange:$,children:[e.jsx(U,{className:"w-[150px]",children:e.jsx(B,{placeholder:"Category"})}),e.jsxs(K,{children:[e.jsx(d,{value:"all",children:"All Categories"}),e.jsx(d,{value:"engine",children:"Engine"}),e.jsx(d,{value:"brakes",children:"Brakes"}),e.jsx(d,{value:"electrical",children:"Electrical"}),e.jsx(d,{value:"tires",children:"Tires"}),e.jsx(d,{value:"fluids",children:"Fluids"})]})]}),e.jsxs(V,{value:de,onValueChange:Ie,children:[e.jsx(U,{className:"w-[150px]",children:e.jsx(B,{placeholder:"Status"})}),e.jsxs(K,{children:[e.jsx(d,{value:"all",children:"All Status"}),e.jsx(d,{value:"in_stock",children:"In Stock"}),e.jsx(d,{value:"low_stock",children:"Low Stock"}),e.jsx(d,{value:"out_of_stock",children:"Out of Stock"}),e.jsx(d,{value:"on_order",children:"On Order"})]})]})]}),e.jsxs(c,{variant:"outline",size:"sm",onClick:je,children:[e.jsx(ds,{className:"w-4 h-4 mr-2"}),"Refresh"]})]})})}),e.jsxs(Q,{children:[e.jsx(R,{children:e.jsx(ns,{value:k,onValueChange:oe,children:e.jsxs(as,{children:[e.jsx(ae,{value:"inventory",children:"All Inventory"}),e.jsx(ae,{value:"low_stock",children:"Low Stock"}),e.jsx(ae,{value:"out_of_stock",children:"Out of Stock"}),e.jsx(ae,{value:"on_order",children:"On Order"})]})})}),e.jsx(G,{children:Ve?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx("div",{className:"inline-block animate-spin rounded-full h-6 w-6 border-b-2 border-primary"})}):ge.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(X,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No parts found"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"Add your first part to get started"}),e.jsxs(c,{onClick:()=>H(!0),children:[e.jsx(le,{className:"w-4 h-4 mr-2"}),"Add Part"]})]}):e.jsx("div",{className:"space-y-4",children:ge.map(s=>e.jsx("div",{className:"border rounded-lg p-4 hover:bg-gray-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h4",{className:"font-semibold",children:s.part_number}),e.jsxs(W,{className:ye(s.status),children:[ve(s.status),s.status.replace("_"," ")]}),e.jsx(W,{variant:"outline",children:s.category})]}),e.jsx("h5",{className:"font-medium text-lg mb-1",children:s.name}),e.jsx("p",{className:"text-gray-600 text-sm mb-2",children:s.description}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Quantity:"}),e.jsxs("p",{className:"font-medium",children:[s.quantity," / ",s.min_quantity]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Unit Price:"}),e.jsxs("p",{className:"font-medium",children:["£",s.unit_price]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Supplier:"}),e.jsx("p",{className:"font-medium",children:s.supplier})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Location:"}),e.jsx("p",{className:"font-medium",children:s.location})]})]})]}),e.jsxs("div",{className:"flex gap-2 ml-4",children:[e.jsx(c,{variant:"outline",size:"sm",onClick:()=>$e(s),children:e.jsx(us,{className:"w-4 h-4"})}),e.jsx(c,{variant:"outline",size:"sm",onClick:()=>fe(s),children:e.jsx(Pe,{className:"w-4 h-4"})}),e.jsx(c,{variant:"outline",size:"sm",onClick:()=>_e(s),children:e.jsx(le,{className:"w-4 h-4"})}),e.jsx(c,{variant:"outline",size:"sm",onClick:()=>Ne(s),children:e.jsx(ce,{className:"w-4 h-4"})}),(s.status==="low_stock"||s.status==="out_of_stock")&&e.jsxs(c,{size:"sm",onClick:()=>be(s),children:[e.jsx(Oe,{className:"w-4 h-4 mr-2"}),"Order"]})]})]})},s.id))})})]}),e.jsx(S,{open:Te,onOpenChange:H,children:e.jsxs(F,{className:"max-w-2xl",children:[e.jsxs(D,{children:[e.jsx(P,{children:"Add New Part"}),e.jsx(O,{children:"Add a new part to the inventory"})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(n,{htmlFor:"part_number",children:"Part Number"}),e.jsx(o,{id:"part_number",value:t.part_number,onChange:s=>u(i(a({},t),{part_number:s.target.value})),placeholder:"e.g., BRK-001"})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"category",children:"Category"}),e.jsxs(V,{value:t.category,onValueChange:s=>u(i(a({},t),{category:s})),children:[e.jsx(U,{children:e.jsx(B,{})}),e.jsxs(K,{children:[e.jsx(d,{value:"engine",children:"Engine"}),e.jsx(d,{value:"brakes",children:"Brakes"}),e.jsx(d,{value:"electrical",children:"Electrical"}),e.jsx(d,{value:"tires",children:"Tires"}),e.jsx(d,{value:"fluids",children:"Fluids"})]})]})]})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"name",children:"Part Name"}),e.jsx(o,{id:"name",value:t.name,onChange:s=>u(i(a({},t),{name:s.target.value})),placeholder:"e.g., Brake Pad Set"})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"description",children:"Description"}),e.jsx(Z,{id:"description",value:t.description,onChange:s=>u(i(a({},t),{description:s.target.value})),placeholder:"Describe the part...",rows:3})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(n,{htmlFor:"quantity",children:"Current Quantity"}),e.jsx(o,{id:"quantity",type:"number",value:t.quantity,onChange:s=>u(i(a({},t),{quantity:parseInt(s.target.value)||0})),placeholder:"0"})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"min_quantity",children:"Min Quantity"}),e.jsx(o,{id:"min_quantity",type:"number",value:t.min_quantity,onChange:s=>u(i(a({},t),{min_quantity:parseInt(s.target.value)||0})),placeholder:"0"})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"unit_price",children:"Unit Price (£)"}),e.jsx(o,{id:"unit_price",type:"number",step:"0.01",value:t.unit_price,onChange:s=>u(i(a({},t),{unit_price:parseFloat(s.target.value)||0})),placeholder:"0.00"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(n,{htmlFor:"supplier",children:"Supplier"}),e.jsx(o,{id:"supplier",value:t.supplier,onChange:s=>u(i(a({},t),{supplier:s.target.value})),placeholder:"Supplier name"})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"supplier_contact",children:"Supplier Contact"}),e.jsx(o,{id:"supplier_contact",value:t.supplier_contact,onChange:s=>u(i(a({},t),{supplier_contact:s.target.value})),placeholder:"Phone or email"})]})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"location",children:"Storage Location"}),e.jsx(o,{id:"location",value:t.location,onChange:s=>u(i(a({},t),{location:s.target.value})),placeholder:"e.g., Shelf A1, Bin 3"})]})]}),e.jsxs(E,{children:[e.jsx(c,{variant:"outline",onClick:()=>H(!1),children:"Cancel"}),e.jsx(c,{onClick:Ke,disabled:xe.isPending,children:xe.isPending?"Adding...":"Add Part"})]})]})}),e.jsx(S,{open:Ae,onOpenChange:Y,children:e.jsxs(F,{className:"max-w-2xl",children:[e.jsxs(D,{children:[e.jsx(P,{children:"Edit Part"}),e.jsx(O,{children:"Update part information"})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(n,{htmlFor:"edit-part_number",children:"Part Number"}),e.jsx(o,{id:"edit-part_number",value:t.part_number,onChange:s=>u(i(a({},t),{part_number:s.target.value}))})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"edit-category",children:"Category"}),e.jsxs(V,{value:t.category,onValueChange:s=>u(i(a({},t),{category:s})),children:[e.jsx(U,{children:e.jsx(B,{})}),e.jsxs(K,{children:[e.jsx(d,{value:"engine",children:"Engine"}),e.jsx(d,{value:"brakes",children:"Brakes"}),e.jsx(d,{value:"electrical",children:"Electrical"}),e.jsx(d,{value:"tires",children:"Tires"}),e.jsx(d,{value:"fluids",children:"Fluids"})]})]})]})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"edit-name",children:"Part Name"}),e.jsx(o,{id:"edit-name",value:t.name,onChange:s=>u(i(a({},t),{name:s.target.value}))})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"edit-description",children:"Description"}),e.jsx(Z,{id:"edit-description",value:t.description,onChange:s=>u(i(a({},t),{description:s.target.value})),rows:3})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(n,{htmlFor:"edit-quantity",children:"Current Quantity"}),e.jsx(o,{id:"edit-quantity",type:"number",value:t.quantity,onChange:s=>u(i(a({},t),{quantity:parseInt(s.target.value)||0}))})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"edit-min_quantity",children:"Min Quantity"}),e.jsx(o,{id:"edit-min_quantity",type:"number",value:t.min_quantity,onChange:s=>u(i(a({},t),{min_quantity:parseInt(s.target.value)||0}))})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"edit-unit_price",children:"Unit Price (£)"}),e.jsx(o,{id:"edit-unit_price",type:"number",step:"0.01",value:t.unit_price,onChange:s=>u(i(a({},t),{unit_price:parseFloat(s.target.value)||0}))})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(n,{htmlFor:"edit-supplier",children:"Supplier"}),e.jsx(o,{id:"edit-supplier",value:t.supplier,onChange:s=>u(i(a({},t),{supplier:s.target.value}))})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"edit-supplier_contact",children:"Supplier Contact"}),e.jsx(o,{id:"edit-supplier_contact",value:t.supplier_contact,onChange:s=>u(i(a({},t),{supplier_contact:s.target.value}))})]})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"edit-location",children:"Storage Location"}),e.jsx(o,{id:"edit-location",value:t.location,onChange:s=>u(i(a({},t),{location:s.target.value}))})]})]}),e.jsxs(E,{children:[e.jsx(c,{variant:"outline",onClick:()=>Y(!1),children:"Cancel"}),e.jsx(c,{onClick:Je,disabled:me.isPending,children:me.isPending?"Updating...":"Update Part"})]})]})}),e.jsx(S,{open:Me,onOpenChange:w,children:e.jsxs(F,{className:"max-w-3xl max-h-[85vh] overflow-y-auto",children:[e.jsx(D,{className:"border-b pb-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(P,{className:"text-xl font-bold flex items-center gap-2",children:[e.jsx(X,{className:"w-5 h-5 text-primary"}),r==null?void 0:r.name]}),e.jsxs(O,{className:"text-sm text-muted-foreground mt-1",children:["Part Number: ",r==null?void 0:r.part_number]})]}),r&&e.jsxs(W,{className:ye(r.status),children:[ve(r.status),r.status.replace("_"," ")]})]})}),r&&e.jsxs("div",{className:"space-y-6 py-4",children:[e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsxs("h3",{className:"font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[e.jsx(xs,{className:"w-4 h-4"}),"Basic Information"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(n,{className:"text-sm font-medium text-gray-600",children:"Description"}),e.jsx("p",{className:"text-gray-900 mt-1",children:r.description||"No description available"})]}),e.jsxs("div",{children:[e.jsx(n,{className:"text-sm font-medium text-gray-600",children:"Category"}),e.jsx(W,{variant:"outline",className:"mt-1",children:r.category})]})]})]}),e.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[e.jsxs("h3",{className:"font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[e.jsx(Se,{className:"w-4 h-4"}),"Stock Information"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx(n,{className:"text-sm font-medium text-gray-600",children:"Current Stock"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600 mt-1",children:r.quantity}),e.jsx("p",{className:"text-xs text-gray-500",children:"units available"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx(n,{className:"text-sm font-medium text-gray-600",children:"Minimum Stock"}),e.jsx("p",{className:"text-lg font-semibold text-gray-900 mt-1",children:r.min_quantity}),e.jsx("p",{className:"text-xs text-gray-500",children:"reorder level"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx(n,{className:"text-sm font-medium text-gray-600",children:"Stock Level"}),e.jsxs("div",{className:"mt-2",children:[e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full transition-all ${r.quantity>r.min_quantity?"bg-green-500":r.quantity>0?"bg-yellow-500":"bg-red-500"}`,style:{width:`${Math.min(r.quantity/r.min_quantity*50,100)}%`}})}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[(r.quantity/r.min_quantity).toFixed(1),"x minimum"]})]})]})]})]}),e.jsxs("div",{className:"bg-green-50 rounded-lg p-4",children:[e.jsxs("h3",{className:"font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[e.jsx(De,{className:"w-4 h-4"}),"Financial Information"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx(n,{className:"text-sm font-medium text-gray-600",children:"Unit Price"}),e.jsxs("p",{className:"text-xl font-bold text-green-600 mt-1",children:["£",r.unit_price.toFixed(2)]}),e.jsx("p",{className:"text-xs text-gray-500",children:"per unit"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx(n,{className:"text-sm font-medium text-gray-600",children:"Total Value"}),e.jsxs("p",{className:"text-xl font-bold text-blue-600 mt-1",children:["£",(r.quantity*r.unit_price).toFixed(2)]}),e.jsx("p",{className:"text-xs text-gray-500",children:"current inventory"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx(n,{className:"text-sm font-medium text-gray-600",children:"Reorder Value"}),e.jsxs("p",{className:"text-lg font-semibold text-gray-900 mt-1",children:["£",(r.min_quantity*r.unit_price).toFixed(2)]}),e.jsx("p",{className:"text-xs text-gray-500",children:"minimum order"})]})]})]}),e.jsxs("div",{className:"bg-purple-50 rounded-lg p-4",children:[e.jsxs("h3",{className:"font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[e.jsx(Ee,{className:"w-4 h-4"}),"Location & Supplier"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx(n,{className:"text-sm font-medium text-gray-600",children:"Storage Location"}),e.jsxs("p",{className:"text-gray-900 mt-1 flex items-center gap-1",children:[e.jsx(Ee,{className:"w-4 h-4 text-gray-500"}),r.location||"Not specified"]})]}),e.jsxs("div",{children:[e.jsx(n,{className:"text-sm font-medium text-gray-600",children:"Supplier"}),e.jsx("p",{className:"text-gray-900 mt-1 font-medium",children:r.supplier||"Not specified"}),r.supplier_contact&&e.jsxs("p",{className:"text-sm text-gray-600 mt-1 flex items-center gap-1",children:[e.jsx(ms,{className:"w-4 h-4"}),r.supplier_contact]})]})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsxs("h3",{className:"font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[e.jsx(hs,{className:"w-4 h-4"}),"Quick Actions"]}),e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsxs(c,{onClick:()=>{w(!1),fe(r)},variant:"outline",size:"sm",children:[e.jsx(Pe,{className:"w-4 h-4 mr-2"}),"Edit Part"]}),e.jsxs(c,{onClick:()=>{w(!1),_e(r)},variant:"outline",size:"sm",children:[e.jsx(le,{className:"w-4 h-4 mr-2"}),"Stock In"]}),e.jsxs(c,{onClick:()=>{w(!1),Ne(r)},variant:"outline",size:"sm",children:[e.jsx(ce,{className:"w-4 h-4 mr-2"}),"Stock Out"]}),(r.status==="low_stock"||r.status==="out_of_stock")&&e.jsxs(c,{onClick:()=>{w(!1),be(r)},size:"sm",children:[e.jsx(Oe,{className:"w-4 h-4 mr-2"}),"Order More"]})]})]})]}),e.jsx(E,{className:"border-t pt-4",children:e.jsx(c,{variant:"outline",onClick:()=>w(!1),children:"Close"})})]})}),e.jsx(S,{open:ze,onOpenChange:ee,children:e.jsxs(F,{className:"max-w-md",children:[e.jsxs(D,{children:[e.jsx(P,{children:"Stock In"}),e.jsxs(O,{children:["Add stock for ",r==null?void 0:r.name]})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{children:[e.jsx(n,{htmlFor:"stock-in-quantity",children:"Quantity"}),e.jsx(o,{id:"stock-in-quantity",type:"number",value:h.quantity,onChange:s=>C(i(a({},h),{quantity:parseInt(s.target.value)||0})),placeholder:"0"})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"stock-in-price",children:"Unit Price (£)"}),e.jsx(o,{id:"stock-in-price",type:"number",step:"0.01",value:h.unit_price,onChange:s=>C(i(a({},h),{unit_price:parseFloat(s.target.value)||0})),placeholder:"0.00"})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"stock-in-reference",children:"Reference Type"}),e.jsxs(V,{value:h.reference_type,onValueChange:s=>C(i(a({},h),{reference_type:s})),children:[e.jsx(U,{children:e.jsx(B,{})}),e.jsxs(K,{children:[e.jsx(d,{value:"manual",children:"Manual Entry"}),e.jsx(d,{value:"order",children:"Order"}),e.jsx(d,{value:"return",children:"Return"})]})]})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"stock-in-reference-number",children:"Reference Number"}),e.jsx(o,{id:"stock-in-reference-number",value:h.reference_number,onChange:s=>C(i(a({},h),{reference_number:s.target.value})),placeholder:"e.g., ORD-001, Return-001"})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"stock-in-notes",children:"Notes"}),e.jsx(Z,{id:"stock-in-notes",value:h.notes,onChange:s=>C(i(a({},h),{notes:s.target.value})),placeholder:"Additional notes...",rows:3})]})]}),e.jsxs(E,{children:[e.jsx(c,{variant:"outline",onClick:()=>ee(!1),children:"Cancel"}),e.jsx(c,{onClick:Ge,disabled:L.isPending,children:L.isPending?"Adding...":"Add Stock"})]})]})}),e.jsx(S,{open:Le,onOpenChange:se,children:e.jsxs(F,{className:"max-w-md",children:[e.jsxs(D,{children:[e.jsx(P,{children:"Stock Out"}),e.jsxs(O,{children:["Remove stock for ",r==null?void 0:r.name]})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{children:[e.jsx(n,{htmlFor:"stock-out-quantity",children:"Quantity"}),e.jsx(o,{id:"stock-out-quantity",type:"number",value:y.quantity,onChange:s=>M(i(a({},y),{quantity:parseInt(s.target.value)||0})),placeholder:"0"})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"stock-out-reference",children:"Reference Type"}),e.jsxs(V,{value:y.reference_type,onValueChange:s=>M(i(a({},y),{reference_type:s})),children:[e.jsx(U,{children:e.jsx(B,{})}),e.jsxs(K,{children:[e.jsx(d,{value:"job",children:"Job"}),e.jsx(d,{value:"manual",children:"Manual Entry"}),e.jsx(d,{value:"adjustment",children:"Adjustment"})]})]})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"stock-out-reference-number",children:"Reference Number"}),e.jsx(o,{id:"stock-out-reference-number",value:y.reference_number,onChange:s=>M(i(a({},y),{reference_number:s.target.value})),placeholder:"e.g., JOB-001, ADJ-001"})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"stock-out-notes",children:"Notes"}),e.jsx(Z,{id:"stock-out-notes",value:y.notes,onChange:s=>M(i(a({},y),{notes:s.target.value})),placeholder:"Additional notes...",rows:3})]})]}),e.jsxs(E,{children:[e.jsx(c,{variant:"outline",onClick:()=>se(!1),children:"Cancel"}),e.jsx(c,{onClick:We,disabled:L.isPending,children:L.isPending?"Removing...":"Remove Stock"})]})]})}),e.jsx(S,{open:Qe,onOpenChange:te,children:e.jsxs(F,{className:"max-w-md",children:[e.jsxs(D,{children:[e.jsx(P,{children:"Create Order"}),e.jsxs(O,{children:["Order ",r==null?void 0:r.name]})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{children:[e.jsx(n,{htmlFor:"order-quantity",children:"Quantity"}),e.jsx(o,{id:"order-quantity",type:"number",value:m.quantity,onChange:s=>b(i(a({},m),{quantity:parseInt(s.target.value)||0})),placeholder:"0"})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"order-price",children:"Unit Price (£)"}),e.jsx(o,{id:"order-price",type:"number",step:"0.01",value:m.unit_price,onChange:s=>b(i(a({},m),{unit_price:parseFloat(s.target.value)||0})),placeholder:"0.00"})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"order-supplier",children:"Supplier"}),e.jsx(o,{id:"order-supplier",value:m.supplier,onChange:s=>b(i(a({},m),{supplier:s.target.value})),placeholder:"Supplier name"})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"order-contact",children:"Supplier Contact"}),e.jsx(o,{id:"order-contact",value:m.supplier_contact,onChange:s=>b(i(a({},m),{supplier_contact:s.target.value})),placeholder:"Phone or email"})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"order-delivery",children:"Expected Delivery"}),e.jsx(o,{id:"order-delivery",type:"date",value:m.expected_delivery,onChange:s=>b(i(a({},m),{expected_delivery:s.target.value}))})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"order-notes",children:"Notes"}),e.jsx(Z,{id:"order-notes",value:m.notes,onChange:s=>b(i(a({},m),{notes:s.target.value})),placeholder:"Additional notes...",rows:3})]})]}),e.jsxs(E,{children:[e.jsx(c,{variant:"outline",onClick:()=>te(!1),children:"Cancel"}),e.jsx(c,{onClick:Ze,disabled:he.isPending,children:he.isPending?"Creating...":"Create Order"})]})]})}),e.jsx(S,{open:Re,onOpenChange:ue,children:e.jsxs(F,{className:"max-w-4xl",children:[e.jsxs(D,{children:[e.jsx(P,{children:"Stock Movements"}),e.jsx(O,{children:"Recent stock movements and audit trail"})]}),e.jsx("div",{className:"max-h-96 overflow-y-auto",children:e.jsx("div",{className:"space-y-4",children:Be.map(s=>{var x;return e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h4",{className:"font-semibold",children:s.movement_number}),e.jsx(W,{className:s.movement_type==="stock_in"?"bg-green-100 text-green-800":"bg-red-100 text-red-800",children:s.movement_type.replace("_"," ").toUpperCase()})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Part:"}),e.jsx("p",{className:"font-medium",children:((x=s.part)==null?void 0:x.name)||"N/A"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Quantity:"}),e.jsx("p",{className:"font-medium",children:s.quantity})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Reference:"}),e.jsx("p",{className:"font-medium",children:s.reference_number||"N/A"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Date:"}),e.jsx("p",{className:"font-medium",children:new Date(s.movement_date).toLocaleDateString()})]})]}),s.notes&&e.jsxs("div",{className:"mt-2",children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Notes:"}),e.jsx("p",{className:"text-sm",children:s.notes})]})]},s.id)})})}),e.jsx(E,{children:e.jsx(c,{variant:"outline",onClick:()=>ue(!1),children:"Close"})})]})})]})};export{qs as default};
