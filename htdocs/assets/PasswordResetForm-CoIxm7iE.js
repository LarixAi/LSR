var g=(u,p,a)=>new Promise((x,n)=>{var f=r=>{try{c(a.next(r))}catch(m){n(m)}},d=r=>{try{c(a.throw(r))}catch(m){n(m)}},c=r=>r.done?x(r.value):Promise.resolve(r.value).then(f,d);c((a=a.apply(u,p)).next())});import{j as e}from"./ui-vendor-DMUr7mTx.js";import{r as i}from"./react-vendor-BvqlMsL5.js";import{l as I,B as o,C as z,a as B,b as D,d as q,L as j,I as v,A as T,g as W}from"./index-ZwIgorfy.js";import{L as H}from"./router-vendor-CEyBJ8vK.js";import{P as C}from"./passwordResetService-iJGmCZNu.js";import{aH as M,h as V,J as Z,am as k,an as E,aa as R}from"./icons-vendor-b0I7fGSL.js";import"./supabase-vendor-B984m0TI.js";import"./utils-vendor-B2FlkASS.js";import"./query-vendor-B2F_wWlc.js";import"./ui-components-7w1-MJre.js";import"./emailService-CYvLt_Xb.js";const re=()=>{const[u,p]=i.useState(""),[a,x]=i.useState(""),[n,f]=i.useState(""),[d,c]=i.useState(!1),[r,m]=i.useState(!1),[N,y]=i.useState(!1),[P,b]=i.useState(!1),[S,h]=i.useState(!1),{toast:l}=I(),L=s=>g(void 0,null,function*(){s.preventDefault(),y(!0);try{const t=yield C.sendPasswordResetEmail(u);t.success?(b(!0),l({title:"Reset Email Sent",description:t.message})):l({title:"Failed to Send Reset Email",description:t.message,variant:"destructive"})}catch(t){l({title:"Error",description:t.message||"Failed to send reset email",variant:"destructive"})}finally{y(!1)}}),F=s=>g(void 0,null,function*(){if(s.preventDefault(),h(!0),a!==n){l({title:"Passwords Do Not Match",description:"Please make sure your passwords match.",variant:"destructive"}),h(!1);return}if(a.length<8){l({title:"Password Too Short",description:"Password must be at least 8 characters long.",variant:"destructive"}),h(!1);return}try{const t=yield C.updatePassword(a);t.success?(l({title:"Password Updated",description:"Your password has been updated successfully."}),window.location.href="/auth"):l({title:"Failed to Update Password",description:t.message,variant:"destructive"})}catch(t){l({title:"Error",description:t.message||"Failed to update password",variant:"destructive"})}finally{h(!1)}}),w=(s=>{let t=0;return s.length>=8&&t++,/[A-Z]/.test(s)&&t++,/[a-z]/.test(s)&&t++,/[0-9]/.test(s)&&t++,/[^A-Za-z0-9]/.test(s)&&t++,t})(a),A=["bg-red-500","bg-red-400","bg-yellow-500","bg-green-400","bg-green-500"],U=["Very Weak","Weak","Fair","Good","Strong"];return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-gray-100 to-gray-200 flex items-center justify-center p-6",children:e.jsxs("div",{className:"w-full max-w-md",children:[e.jsx("div",{className:"mb-6",children:e.jsx(H,{to:"/auth",children:e.jsxs(o,{variant:"outline",className:"flex items-center gap-2",children:[e.jsx(M,{className:"h-4 w-4"}),"Back to Login"]})})}),e.jsxs(z,{className:"shadow-xl",children:[e.jsxs(B,{className:"text-center",children:[e.jsx(D,{className:"text-2xl font-bold",children:"Password Reset"}),e.jsx("p",{className:"text-muted-foreground",children:P?"Check your email for reset instructions":"Enter your email to receive a reset link"})]}),e.jsx(q,{className:"space-y-6",children:P?e.jsxs("form",{onSubmit:F,className:"space-y-4",children:[e.jsxs(T,{children:[e.jsx(Z,{className:"h-4 w-4"}),e.jsx(W,{children:"Reset email sent! Please check your email and click the reset link to continue."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(j,{htmlFor:"newPassword",children:"New Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(k,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(v,{id:"newPassword",type:d?"text":"password",value:a,onChange:s=>x(s.target.value),placeholder:"Enter new password",className:"pl-10 pr-10",required:!0}),e.jsx(o,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>c(!d),children:d?e.jsx(E,{className:"h-4 w-4"}):e.jsx(R,{className:"h-4 w-4"})})]}),a&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"flex gap-1",children:[0,1,2,3,4].map(s=>e.jsx("div",{className:`h-2 flex-1 rounded-full transition-colors ${s<w?A[w-1]:"bg-gray-200"}`},s))}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Password strength: ",U[w-1]||"Very Weak"]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(j,{htmlFor:"confirmPassword",children:"Confirm New Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(k,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(v,{id:"confirmPassword",type:r?"text":"password",value:n,onChange:s=>f(s.target.value),placeholder:"Confirm new password",className:"pl-10 pr-10",required:!0}),e.jsx(o,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>m(!r),children:r?e.jsx(E,{className:"h-4 w-4"}):e.jsx(R,{className:"h-4 w-4"})})]})]}),e.jsx(o,{type:"submit",className:"w-full",disabled:S,children:S?"Updating...":"Update Password"}),e.jsx("div",{className:"text-center",children:e.jsx(o,{type:"button",variant:"link",onClick:()=>b(!1),className:"text-sm",children:"Send another reset email"})})]}):e.jsxs("form",{onSubmit:L,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(j,{htmlFor:"email",children:"Email Address"}),e.jsxs("div",{className:"relative",children:[e.jsx(V,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(v,{id:"email",type:"email",value:u,onChange:s=>p(s.target.value),placeholder:"Enter your email address",className:"pl-10",required:!0})]})]}),e.jsx(o,{type:"submit",className:"w-full",disabled:N,children:N?"Sending...":"Send Reset Email"})]})})]})]})})};export{re as default};
