var ne=Object.defineProperty,re=Object.defineProperties;var ie=Object.getOwnPropertyDescriptors;var L=Object.getOwnPropertySymbols;var de=Object.prototype.hasOwnProperty,oe=Object.prototype.propertyIsEnumerable;var k=(x,l,d)=>l in x?ne(x,l,{enumerable:!0,configurable:!0,writable:!0,value:d}):x[l]=d,c=(x,l)=>{for(var d in l||(l={}))de.call(l,d)&&k(x,d,l[d]);if(L)for(var d of L(l))oe.call(l,d)&&k(x,d,l[d]);return x},n=(x,l)=>re(x,ie(l));import{j as e}from"./ui-vendor-DMUr7mTx.js";import{r as u}from"./react-vendor-BvqlMsL5.js";import{u as xe,l as me,D as E,F as he,B as N,m as M,n as R,o as q,I as o,T as je,C as m,d as h,S as ue,q as pe,r as fe,t as ge,v,a as ve,b as Ne,e as I}from"./index-ZwIgorfy.js";import{T as ye,a as be,b as F,c as p,d as Ce,e as f}from"./table-6WL4qh3Z.js";import{N as H}from"./router-vendor-CEyBJ8vK.js";import{q as S,E as Se,J as w,j as P,aj as V,f as D,D as B,aa as we,$ as Pe,h as De,M as O,ao as Ae}from"./icons-vendor-b0I7fGSL.js";import{f as g}from"./utils-vendor-B2FlkASS.js";import"./supabase-vendor-B984m0TI.js";import"./query-vendor-B2F_wWlc.js";import"./ui-components-7w1-MJre.js";const Te=[{id:"1",routeName:"Northern Line Replacement",affectedLine:"Northern Line (King's Cross to Finchley Central)",startDate:"2024-01-15",endDate:"2024-02-28",status:"active",vehiclesAssigned:12,passengersAffected:850,pickupPoints:["King's Cross Station","Camden Town","Kentish Town","Tufnell Park"],dropoffPoints:["Archway","Highgate","East Finchley","Finchley Central"],frequency:"Every 10 minutes",estimatedCost:125e3,contactPerson:"Sarah Mitchell",contactPhone:"+44 20 7946 0958",contactEmail:"sarah.mitchell@lsr.co.uk",notes:"Major track upgrade works requiring full line closure",createdAt:"2024-01-10T09:00:00Z",updatedAt:"2024-01-15T14:30:00Z"},{id:"2",routeName:"Victoria Line Weekend Service",affectedLine:"Victoria Line (Tottenham Hale to Brixton)",startDate:"2024-02-03",endDate:"2024-02-04",status:"planned",vehiclesAssigned:8,passengersAffected:420,pickupPoints:["Tottenham Hale","Seven Sisters","Finsbury Park","Highbury & Islington"],dropoffPoints:["King's Cross","Oxford Circus","Victoria","Brixton"],frequency:"Every 15 minutes",estimatedCost:45e3,contactPerson:"James Rodriguez",contactPhone:"+44 20 7946 0723",contactEmail:"james.rodriguez@lsr.co.uk",notes:"Weekend engineering works - signalling system upgrade",createdAt:"2024-01-20T11:15:00Z",updatedAt:"2024-01-25T16:45:00Z"},{id:"3",routeName:"Central Line Emergency Replacement",affectedLine:"Central Line (Liverpool Street to Stratford)",startDate:"2024-01-28",endDate:"2024-01-28",status:"completed",vehiclesAssigned:6,passengersAffected:320,pickupPoints:["Liverpool Street","Bethnal Green","Mile End"],dropoffPoints:["Stratford","West Ham","Plaistow"],frequency:"Every 8 minutes",estimatedCost:18500,contactPerson:"Emma Thompson",contactPhone:"+44 20 7946 0634",contactEmail:"emma.thompson@lsr.co.uk",notes:"Emergency service due to signal failure - resolved same day",createdAt:"2024-01-28T06:30:00Z",updatedAt:"2024-01-28T20:15:00Z"}],Oe=()=>{const{user:x,profile:l,loading:d}=xe(),{toast:Z}=me(),[j,z]=u.useState(Te),[y,K]=u.useState(""),[b,W]=u.useState("all");u.useState("overview");const[J,C]=u.useState(!1),[U,A]=u.useState(!1),[t,$]=u.useState(null),[r,i]=u.useState({routeName:"",affectedLine:"",startDate:"",endDate:"",status:"planned",vehiclesAssigned:0,passengersAffected:0,pickupPoints:[],dropoffPoints:[],frequency:"",estimatedCost:0,contactPerson:"",contactPhone:"",contactEmail:"",notes:""});if(d)return e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-primary mb-4"}),e.jsx("p",{className:"text-lg",children:"Loading rail replacement services..."})]})});if(!x||!l)return e.jsx(H,{to:"/auth",replace:!0});if(!["admin","council"].includes(l.role))return e.jsx(H,{to:"/unauthorized",replace:!0});const G=j.filter(s=>{const a=s.routeName.toLowerCase().includes(y.toLowerCase())||s.affectedLine.toLowerCase().includes(y.toLowerCase()),ce=b==="all"||s.status===b;return a&&ce}),X=j.length,Q=j.filter(s=>s.status==="active").length,Y=j.filter(s=>s.status==="planned").length,_=j.reduce((s,a)=>s+a.vehiclesAssigned,0),ee=j.reduce((s,a)=>s+a.passengersAffected,0),se=j.reduce((s,a)=>s+a.estimatedCost,0),T=s=>{switch(s){case"active":return"bg-green-100 text-green-800";case"planned":return"bg-blue-100 text-blue-800";case"completed":return"bg-gray-100 text-gray-800";case"cancelled":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},ae=s=>{switch(s){case"active":return e.jsx(w,{className:"w-4 h-4"});case"planned":return e.jsx(P,{className:"w-4 h-4"});case"completed":return e.jsx(w,{className:"w-4 h-4"});case"cancelled":return e.jsx(Ae,{className:"w-4 h-4"});default:return e.jsx(P,{className:"w-4 h-4"})}},te=()=>{const s=n(c({},r),{id:Date.now().toString(),createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()});z([...j,s]),C(!1),i({routeName:"",affectedLine:"",startDate:"",endDate:"",status:"planned",vehiclesAssigned:0,passengersAffected:0,pickupPoints:[],dropoffPoints:[],frequency:"",estimatedCost:0,contactPerson:"",contactPhone:"",contactEmail:"",notes:""}),Z({title:"Success",description:"Rail replacement service created successfully."})},le=s=>{$(s),A(!0)};return e.jsxs("div",{className:"container mx-auto p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center space-x-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(S,{className:"h-8 w-8 text-primary"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Rail Replacement Services"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage bus replacement services for rail disruptions"})]})]})}),e.jsxs(E,{open:J,onOpenChange:C,children:[e.jsx(he,{asChild:!0,children:e.jsxs(N,{className:"flex items-center space-x-2",children:[e.jsx(Se,{className:"w-4 h-4"}),e.jsx("span",{children:"New Service"})]})}),e.jsxs(M,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsx(R,{children:e.jsx(q,{children:"Create Rail Replacement Service"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Route Name"}),e.jsx(o,{value:r.routeName||"",onChange:s=>i(a=>n(c({},a),{routeName:s.target.value})),placeholder:"Enter route name"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Affected Line"}),e.jsx(o,{value:r.affectedLine||"",onChange:s=>i(a=>n(c({},a),{affectedLine:s.target.value})),placeholder:"Enter affected rail line"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Start Date"}),e.jsx(o,{type:"date",value:r.startDate||"",onChange:s=>i(a=>n(c({},a),{startDate:s.target.value}))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"End Date"}),e.jsx(o,{type:"date",value:r.endDate||"",onChange:s=>i(a=>n(c({},a),{endDate:s.target.value}))})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Vehicles Required"}),e.jsx(o,{type:"number",value:r.vehiclesAssigned||0,onChange:s=>i(a=>n(c({},a),{vehiclesAssigned:parseInt(s.target.value)||0})),placeholder:"0"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Passengers Affected"}),e.jsx(o,{type:"number",value:r.passengersAffected||0,onChange:s=>i(a=>n(c({},a),{passengersAffected:parseInt(s.target.value)||0})),placeholder:"0"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Estimated Cost (Â£)"}),e.jsx(o,{type:"number",value:r.estimatedCost||0,onChange:s=>i(a=>n(c({},a),{estimatedCost:parseInt(s.target.value)||0})),placeholder:"0"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Service Frequency"}),e.jsx(o,{value:r.frequency||"",onChange:s=>i(a=>n(c({},a),{frequency:s.target.value})),placeholder:"e.g., Every 10 minutes"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Contact Person"}),e.jsx(o,{value:r.contactPerson||"",onChange:s=>i(a=>n(c({},a),{contactPerson:s.target.value})),placeholder:"Full name"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Contact Phone"}),e.jsx(o,{value:r.contactPhone||"",onChange:s=>i(a=>n(c({},a),{contactPhone:s.target.value})),placeholder:"+44 20 ..."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Contact Email"}),e.jsx(o,{type:"email",value:r.contactEmail||"",onChange:s=>i(a=>n(c({},a),{contactEmail:s.target.value})),placeholder:"email@lsr.co.uk"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Notes"}),e.jsx(je,{value:r.notes||"",onChange:s=>i(a=>n(c({},a),{notes:s.target.value})),placeholder:"Additional notes about the replacement service",rows:3})]}),e.jsxs("div",{className:"flex space-x-2 pt-4",children:[e.jsx(N,{variant:"outline",onClick:()=>C(!1),className:"flex-1",children:"Cancel"}),e.jsx(N,{onClick:te,className:"flex-1",children:"Create Service"})]})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-6 gap-4",children:[e.jsx(m,{children:e.jsx(h,{className:"p-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(S,{className:"h-8 w-8 text-blue-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:X}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Total Services"})]})]})})}),e.jsx(m,{children:e.jsx(h,{className:"p-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(w,{className:"h-8 w-8 text-green-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:Q}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Active Services"})]})]})})}),e.jsx(m,{children:e.jsx(h,{className:"p-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(P,{className:"h-8 w-8 text-blue-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:Y}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Planned Services"})]})]})})}),e.jsx(m,{children:e.jsx(h,{className:"p-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(V,{className:"h-8 w-8 text-orange-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:_}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Vehicles Deployed"})]})]})})}),e.jsx(m,{children:e.jsx(h,{className:"p-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(D,{className:"h-8 w-8 text-purple-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:ee.toLocaleString()}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Passengers Served"})]})]})})}),e.jsx(m,{children:e.jsx(h,{className:"p-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(B,{className:"h-8 w-8 text-green-600"}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-2xl font-bold",children:["Â£",(se/1e3).toFixed(0),"k"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Total Cost"})]})]})})})]}),e.jsx(m,{children:e.jsx(h,{className:"p-4",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(o,{placeholder:"Search by route name or affected line...",value:y,onChange:s=>K(s.target.value),className:"flex-1"}),e.jsxs(ue,{value:b,onValueChange:W,children:[e.jsx(pe,{className:"w-40",children:e.jsx(fe,{placeholder:"Status"})}),e.jsxs(ge,{children:[e.jsx(v,{value:"all",children:"All Status"}),e.jsx(v,{value:"active",children:"Active"}),e.jsx(v,{value:"planned",children:"Planned"}),e.jsx(v,{value:"completed",children:"Completed"}),e.jsx(v,{value:"cancelled",children:"Cancelled"})]})]})]})})}),e.jsxs(m,{children:[e.jsx(ve,{children:e.jsx(Ne,{children:"Rail Replacement Services"})}),e.jsx(h,{children:e.jsxs(ye,{children:[e.jsx(be,{children:e.jsxs(F,{children:[e.jsx(p,{children:"Route Name"}),e.jsx(p,{children:"Affected Line"}),e.jsx(p,{children:"Period"}),e.jsx(p,{children:"Status"}),e.jsx(p,{children:"Vehicles"}),e.jsx(p,{children:"Passengers"}),e.jsx(p,{children:"Cost"}),e.jsx(p,{children:"Actions"})]})}),e.jsx(Ce,{children:G.map(s=>e.jsxs(F,{children:[e.jsx(f,{className:"font-medium",children:s.routeName}),e.jsx(f,{className:"text-sm text-muted-foreground",children:s.affectedLine}),e.jsx(f,{children:e.jsxs("div",{className:"text-sm",children:[g(new Date(s.startDate),"MMM dd")," - ",g(new Date(s.endDate),"MMM dd, yyyy")]})}),e.jsx(f,{children:e.jsx(I,{className:T(s.status),children:e.jsxs("div",{className:"flex items-center space-x-1",children:[ae(s.status),e.jsx("span",{className:"capitalize",children:s.status})]})})}),e.jsx(f,{children:s.vehiclesAssigned}),e.jsx(f,{children:s.passengersAffected.toLocaleString()}),e.jsxs(f,{children:["Â£",(s.estimatedCost/1e3).toFixed(0),"k"]}),e.jsx(f,{children:e.jsx(N,{variant:"ghost",size:"sm",onClick:()=>le(s),children:e.jsx(we,{className:"w-4 h-4"})})})]},s.id))})]})})]}),e.jsx(E,{open:U,onOpenChange:A,children:e.jsxs(M,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsx(R,{children:e.jsxs(q,{className:"flex items-center space-x-2",children:[e.jsx(S,{className:"w-5 h-5"}),e.jsx("span",{children:t==null?void 0:t.routeName})]})}),t&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Service Information"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Affected Line:"})," ",t.affectedLine]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Period:"})," ",g(new Date(t.startDate),"MMM dd, yyyy")," - ",g(new Date(t.endDate),"MMM dd, yyyy")]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Frequency:"})," ",t.frequency]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Status:"}),e.jsx(I,{className:`ml-2 ${T(t.status)}`,children:t.status})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Contact Information"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(D,{className:"w-4 h-4"}),e.jsx("span",{children:t.contactPerson})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Pe,{className:"w-4 h-4"}),e.jsx("span",{children:t.contactPhone})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(De,{className:"w-4 h-4"}),e.jsx("span",{children:t.contactEmail})]})]})]})]}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Service Metrics"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(m,{children:e.jsx(h,{className:"p-3",children:e.jsxs("div",{className:"text-center",children:[e.jsx(V,{className:"w-6 h-6 mx-auto mb-1 text-orange-600"}),e.jsx("div",{className:"text-lg font-bold",children:t.vehiclesAssigned}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Vehicles"})]})})}),e.jsx(m,{children:e.jsx(h,{className:"p-3",children:e.jsxs("div",{className:"text-center",children:[e.jsx(D,{className:"w-6 h-6 mx-auto mb-1 text-purple-600"}),e.jsx("div",{className:"text-lg font-bold",children:t.passengersAffected.toLocaleString()}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Passengers"})]})})}),e.jsx(m,{className:"col-span-2",children:e.jsx(h,{className:"p-3",children:e.jsxs("div",{className:"text-center",children:[e.jsx(B,{className:"w-6 h-6 mx-auto mb-1 text-green-600"}),e.jsxs("div",{className:"text-lg font-bold",children:["Â£",t.estimatedCost.toLocaleString()]}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Estimated Cost"})]})})})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold mb-2 flex items-center space-x-2",children:[e.jsx(O,{className:"w-4 h-4 text-green-600"}),e.jsx("span",{children:"Pickup Points"})]}),e.jsx("div",{className:"space-y-1",children:t.pickupPoints.map((s,a)=>e.jsx("div",{className:"text-sm p-2 bg-green-50 rounded border-l-4 border-green-200",children:s},a))})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold mb-2 flex items-center space-x-2",children:[e.jsx(O,{className:"w-4 h-4 text-red-600"}),e.jsx("span",{children:"Dropoff Points"})]}),e.jsx("div",{className:"space-y-1",children:t.dropoffPoints.map((s,a)=>e.jsx("div",{className:"text-sm p-2 bg-red-50 rounded border-l-4 border-red-200",children:s},a))})]})]}),t.notes&&e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Notes"}),e.jsx("div",{className:"p-3 bg-gray-50 rounded border text-sm",children:t.notes})]}),e.jsxs("div",{className:"text-xs text-muted-foreground border-t pt-4",children:[e.jsxs("div",{children:["Created: ",g(new Date(t.createdAt),"MMM dd, yyyy HH:mm")]}),e.jsxs("div",{children:["Updated: ",g(new Date(t.updatedAt),"MMM dd, yyyy HH:mm")]})]})]})]})})]})};export{Oe as default};
