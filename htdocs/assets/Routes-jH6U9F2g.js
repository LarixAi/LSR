import{j as e}from"./ui-vendor-DMUr7mTx.js";import{r as n}from"./react-vendor-BvqlMsL5.js";import{u as O,D as P,F as U,B as r,m as q,n as $,o as G,L as g,I as h,C as c,d,a as J,b as K,S as v,q as N,r as b,t as f,v as a,e as y}from"./index-ZwIgorfy.js";import{T as Q,a as W,b as w,c as t,d as X,e as l}from"./table-6WL4qh3Z.js";import{u as Y,a as Z,b as ee}from"./useRoutes-CuFbmWya.js";import{N as se}from"./router-vendor-CEyBJ8vK.js";import{p as u,E as ae,A as te,D as le,a1 as S,a2 as ie,M as ne,a as re,f as ce,aa as de,ak as oe,aR as xe}from"./icons-vendor-b0I7fGSL.js";import"./supabase-vendor-B984m0TI.js";import"./utils-vendor-B2FlkASS.js";import"./query-vendor-B2F_wWlc.js";import"./ui-components-7w1-MJre.js";const Ce=()=>{const{user:C,profile:R,loading:T}=O(),[o,D]=n.useState(""),[m,L]=n.useState("all"),[j,F]=n.useState("all"),[A,_]=n.useState(!1);n.useState({name:"",start_location:"",end_location:"",distance:0,estimated_time:0,status:"active"});const{data:k=[],isLoading:E,error:he}=Y(),p=Z();if(ee(),T||E)return e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-primary mb-4"}),e.jsx("p",{className:"text-lg",children:"Loading route management..."})]})});if(!C||!R)return e.jsx(se,{to:"/auth",replace:!0});const B=k.map(s=>({id:s.id,name:s.name||`${s.start_location} → ${s.end_location}`,type:"school",origin:s.start_location||"Unknown",destination:s.end_location||"Unknown",distance:s.distance||0,stops:0,assignedVehicle:void 0,assignedDriver:void 0,status:s.status==="active"?"active":"inactive",students:void 0,revenue:0})),M=s=>{const i={active:"bg-green-100 text-green-800",inactive:"bg-gray-100 text-gray-800",planned:"bg-blue-100 text-blue-800",completed:"bg-purple-100 text-purple-800"};return e.jsx(y,{className:i[s]||"bg-gray-100 text-gray-800",children:s})},V=s=>{const i={school:"bg-yellow-100 text-yellow-800",medical:"bg-red-100 text-red-800",charter:"bg-purple-100 text-purple-800",corporate:"bg-blue-100 text-blue-800"};return e.jsx(y,{className:i[s]||"bg-gray-100 text-gray-800",children:s})},I=B.filter(s=>{const i=s.name.toLowerCase().includes(o.toLowerCase())||s.origin.toLowerCase().includes(o.toLowerCase())||s.destination.toLowerCase().includes(o.toLowerCase()),z=m==="all"||s.status===m,H=j==="all"||s.type===j;return i&&z&&H}),x={totalRoutes:p.total,activeRoutes:p.active,totalRevenue:0,totalDistance:p.total_distance||0};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-3",children:[e.jsx(u,{className:"w-8 h-8 text-blue-600"}),"School Routes Management"]}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Manage and optimize school transportation routes"})]}),e.jsxs(P,{open:A,onOpenChange:_,children:[e.jsx(U,{asChild:!0,children:e.jsxs(r,{className:"bg-blue-600 hover:bg-blue-700",children:[e.jsx(ae,{className:"w-4 h-4 mr-2"}),"Create Route"]})}),e.jsxs(q,{className:"max-w-2xl",children:[e.jsx($,{children:e.jsx(G,{children:"Create New Route"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(g,{htmlFor:"route-name",children:"Route Name"}),e.jsx(h,{id:"route-name",placeholder:"Enter route name"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(g,{htmlFor:"origin",children:"Origin"}),e.jsx(h,{id:"origin",placeholder:"Starting location"})]}),e.jsxs("div",{children:[e.jsx(g,{htmlFor:"destination",children:"Destination"}),e.jsx(h,{id:"destination",placeholder:"End location"})]})]}),e.jsx(r,{className:"w-full bg-blue-600 hover:bg-blue-700",children:"Create Route"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsx(c,{children:e.jsx(d,{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(u,{className:"w-8 h-8 text-blue-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Routes"}),e.jsx("p",{className:"text-2xl font-bold",children:x.totalRoutes})]})]})})}),e.jsx(c,{children:e.jsx(d,{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(te,{className:"w-8 h-8 text-green-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Active Routes"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:x.activeRoutes})]})]})})}),e.jsx(c,{children:e.jsx(d,{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(le,{className:"w-8 h-8 text-emerald-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Revenue"}),e.jsxs("p",{className:"text-2xl font-bold text-emerald-600",children:["£",x.totalRevenue.toLocaleString()]})]})]})})}),e.jsx(c,{children:e.jsx(d,{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(S,{className:"w-8 h-8 text-purple-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Distance"}),e.jsxs("p",{className:"text-2xl font-bold text-purple-600",children:[x.totalDistance.toFixed(1)," km"]})]})]})})})]}),e.jsxs(c,{children:[e.jsxs(J,{children:[e.jsxs(K,{className:"flex items-center gap-2",children:[e.jsx(u,{className:"w-5 h-5"}),"School Routes Management"]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(ie,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx(h,{placeholder:"Search routes...",value:o,onChange:s=>D(s.target.value),className:"pl-10"})]}),e.jsxs(v,{value:m,onValueChange:L,children:[e.jsx(N,{className:"w-48",children:e.jsx(b,{})}),e.jsxs(f,{children:[e.jsx(a,{value:"all",children:"All Status"}),e.jsx(a,{value:"active",children:"Active"}),e.jsx(a,{value:"inactive",children:"Inactive"}),e.jsx(a,{value:"planned",children:"Planned"})]})]}),e.jsxs(v,{value:j,onValueChange:F,children:[e.jsx(N,{className:"w-48",children:e.jsx(b,{})}),e.jsxs(f,{children:[e.jsx(a,{value:"all",children:"All Types"}),e.jsx(a,{value:"school",children:"School Transport"}),e.jsx(a,{value:"medical",children:"Medical Transport"}),e.jsx(a,{value:"charter",children:"Charter Service"}),e.jsx(a,{value:"corporate",children:"Corporate Shuttle"})]})]})]})]}),e.jsx(d,{children:e.jsxs(Q,{children:[e.jsx(W,{children:e.jsxs(w,{children:[e.jsx(t,{children:"Route Name"}),e.jsx(t,{children:"Type"}),e.jsx(t,{children:"Route"}),e.jsx(t,{children:"Distance"}),e.jsx(t,{children:"Stops"}),e.jsx(t,{children:"Assigned"}),e.jsx(t,{children:"Status"}),e.jsx(t,{children:"Revenue"}),e.jsx(t,{children:"Actions"})]})}),e.jsx(X,{children:I.map(s=>e.jsxs(w,{children:[e.jsx(l,{children:e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s.name}),e.jsx("p",{className:"text-sm text-gray-500",children:s.id})]})}),e.jsx(l,{children:V(s.type)}),e.jsx(l,{children:e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(ne,{className:"w-4 h-4 text-gray-400"}),e.jsxs("span",{className:"truncate",children:[s.origin," → ",s.destination]})]})}),e.jsx(l,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(S,{className:"w-4 h-4 text-gray-400"}),e.jsxs("span",{children:[s.distance," km"]})]})}),e.jsx(l,{children:s.stops}),e.jsx(l,{children:e.jsxs("div",{className:"text-sm",children:[s.assignedVehicle&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(re,{className:"w-3 h-3 text-gray-400"}),e.jsx("span",{children:s.assignedVehicle})]}),s.assignedDriver&&e.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[e.jsx(ce,{className:"w-3 h-3 text-gray-400"}),e.jsx("span",{children:s.assignedDriver})]})]})}),e.jsx(l,{children:M(s.status)}),e.jsx(l,{children:e.jsxs("span",{className:"font-medium",children:["£",s.revenue]})}),e.jsx(l,{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(r,{variant:"outline",size:"sm",children:e.jsx(de,{className:"w-4 h-4"})}),e.jsx(r,{variant:"outline",size:"sm",children:e.jsx(oe,{className:"w-4 h-4"})}),e.jsx(r,{variant:"outline",size:"sm",children:e.jsx(xe,{className:"w-4 h-4"})})]})})]},s.id))})]})})]})]})};export{Ce as default};
