var xs=Object.defineProperty,vs=Object.defineProperties;var ms=Object.getOwnPropertyDescriptors;var ot=Object.getOwnPropertySymbols;var cn=Object.prototype.hasOwnProperty,ln=Object.prototype.propertyIsEnumerable;var Rt=Math.pow,an=(e,t,n)=>t in e?xs(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,v=(e,t)=>{for(var n in t||(t={}))cn.call(t,n)&&an(e,n,t[n]);if(ot)for(var n of ot(t))ln.call(t,n)&&an(e,n,t[n]);return e},w=(e,t)=>vs(e,ms(t));var Ye=(e,t)=>{var n={};for(var s in e)cn.call(e,s)&&t.indexOf(s)<0&&(n[s]=e[s]);if(e!=null&&ot)for(var s of ot(e))t.indexOf(s)<0&&ln.call(e,s)&&(n[s]=e[s]);return n};var oe=(e,t,n)=>new Promise((s,i)=>{var o=u=>{try{l(n.next(u))}catch(f){i(f)}},c=u=>{try{l(n.throw(u))}catch(f){i(f)}},l=u=>u.done?s(u.value):Promise.resolve(u.value).then(o,c);l((n=n.apply(e,t)).next())});import{j as r}from"./ui-vendor-DMUr7mTx.js";import{r as d,a as Z,b as Ve}from"./react-vendor-BvqlMsL5.js";import{u as Tn,s as ue,z as bs,e as z,B as Q,C as dn,a as un,b as fn,d as hn,x as ys,D as at,m as ct,n as lt,o as dt,p as ut,L as $,I as gn,T as ft,E as pe,S as pn,q as xn,r as vn,t as mn,v as F,J as U}from"./index-ZwIgorfy.js";import{u as _n,a as ws,b as Me}from"./query-vendor-B2F_wWlc.js";import{E as Et,_ as bn,T as yn,S as It,aa as js,ak as Tt,aF as _t,aI as Cs,X as Ss,F as Mt,b6 as Fn,J as Ns,l as Ds,k as Rs,b7 as Es,n as Is,a3 as Ms}from"./icons-vendor-b0I7fGSL.js";import"./supabase-vendor-B984m0TI.js";import"./utils-vendor-B2FlkASS.js";import"./router-vendor-CEyBJ8vK.js";import"./ui-components-7w1-MJre.js";const Ln=()=>{const{profile:e}=Tn(),{data:t}=_n({queryKey:["subscription-access",e==null?void 0:e.organization_id],queryFn:()=>oe(void 0,null,function*(){var m;if(!(e!=null&&e.organization_id))return{planName:null,planId:null};const{data:h}=yield ue.from("subscriptions").select(`
          *,
          plan:subscription_plans(name)
        `).eq("organization_id",e.organization_id).eq("status","active").maybeSingle();if(h)return{planName:((m=h.plan)==null?void 0:m.name)||"Unknown",planId:h.plan_id};const{data:x}=yield ue.from("organization_trials").select("*").eq("organization_id",e.organization_id).eq("trial_status","active").maybeSingle();return x?{planName:"Trial",planId:"trial"}:{planName:"Starter",planId:"starter"}}),enabled:!!(e!=null&&e.organization_id),staleTime:5*60*1e3}),n=(t==null?void 0:t.planName)||"Starter",s=["Professional","Enterprise","Trial"].includes(n),i=n==="Enterprise",o=s,c=s,l=s,u=s,f=!s;return{canEditQuestions:o,canCreateQuestionSets:c,canReorderQuestions:l,canAccessAdvancedFeatures:u,currentPlan:n,isProfessionalOrHigher:s,isEnterprise:i,upgradeRequired:f,upgradeMessage:f?"Upgrade to Professional or Enterprise plan to edit and create custom question sets":""}};function As(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return d.useMemo(()=>s=>{t.forEach(i=>i(s))},t)}const yt=typeof window!="undefined"&&typeof window.document!="undefined"&&typeof window.document.createElement!="undefined";function Qe(e){const t=Object.prototype.toString.call(e);return t==="[object Window]"||t==="[object global]"}function Bt(e){return"nodeType"in e}function ee(e){var t,n;return e?Qe(e)?e:Bt(e)&&(t=(n=e.ownerDocument)==null?void 0:n.defaultView)!=null?t:window:window}function $t(e){const{Document:t}=ee(e);return e instanceof t}function tt(e){return Qe(e)?!1:e instanceof ee(e).HTMLElement}function Qn(e){return e instanceof ee(e).SVGElement}function ze(e){return e?Qe(e)?e.document:Bt(e)?$t(e)?e:tt(e)||Qn(e)?e.ownerDocument:document:document:document}const xe=yt?d.useLayoutEffect:d.useEffect;function Ut(e){const t=d.useRef(e);return xe(()=>{t.current=e}),d.useCallback(function(){for(var n=arguments.length,s=new Array(n),i=0;i<n;i++)s[i]=arguments[i];return t.current==null?void 0:t.current(...s)},[])}function ks(){const e=d.useRef(null),t=d.useCallback((s,i)=>{e.current=setInterval(s,i)},[]),n=d.useCallback(()=>{e.current!==null&&(clearInterval(e.current),e.current=null)},[]);return[t,n]}function Ge(e,t){t===void 0&&(t=[e]);const n=d.useRef(e);return xe(()=>{n.current!==e&&(n.current=e)},t),n}function nt(e,t){const n=d.useRef();return d.useMemo(()=>{const s=e(n.current);return n.current=s,s},[...t])}function xt(e){const t=Ut(e),n=d.useRef(null),s=d.useCallback(i=>{i!==n.current&&(t==null||t(i,n.current)),n.current=i},[]);return[n,s]}function Ft(e){const t=d.useRef();return d.useEffect(()=>{t.current=e},[e]),t.current}let At={};function st(e,t){return d.useMemo(()=>{if(t)return t;const n=At[e]==null?0:At[e]+1;return At[e]=n,e+"-"+n},[e,t])}function zn(e){return function(t){for(var n=arguments.length,s=new Array(n>1?n-1:0),i=1;i<n;i++)s[i-1]=arguments[i];return s.reduce((o,c)=>{const l=Object.entries(c);for(const[u,f]of l){const g=o[u];g!=null&&(o[u]=g+e*f)}return o},v({},t))}}const Le=zn(1),Je=zn(-1);function qs(e){return"clientX"in e&&"clientY"in e}function Xt(e){if(!e)return!1;const{KeyboardEvent:t}=ee(e.target);return t&&e instanceof t}function Os(e){if(!e)return!1;const{TouchEvent:t}=ee(e.target);return t&&e instanceof t}function Lt(e){if(Os(e)){if(e.touches&&e.touches.length){const{clientX:t,clientY:n}=e.touches[0];return{x:t,y:n}}else if(e.changedTouches&&e.changedTouches.length){const{clientX:t,clientY:n}=e.changedTouches[0];return{x:t,y:n}}}return qs(e)?{x:e.clientX,y:e.clientY}:null}const Ze=Object.freeze({Translate:{toString(e){if(!e)return;const{x:t,y:n}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(n?Math.round(n):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;const{scaleX:t,scaleY:n}=e;return"scaleX("+t+") scaleY("+n+")"}},Transform:{toString(e){if(e)return[Ze.Translate.toString(e),Ze.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:n,easing:s}=e;return t+" "+n+"ms "+s}}}),wn="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function Ts(e){return e.matches(wn)?e:e.querySelector(wn)}const _s={display:"none"};function Fs(e){let{id:t,value:n}=e;return Z.createElement("div",{id:t,style:_s},n)}function Ls(e){let{id:t,announcement:n,ariaLiveType:s="assertive"}=e;const i={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return Z.createElement("div",{id:t,style:i,role:"status","aria-live":s,"aria-atomic":!0},n)}function Qs(){const[e,t]=d.useState("");return{announce:d.useCallback(s=>{s!=null&&t(s)},[]),announcement:e}}const Pn=d.createContext(null);function zs(e){const t=d.useContext(Pn);d.useEffect(()=>{if(!t)throw new Error("useDndMonitor must be used within a children of <DndContext>");return t(e)},[e,t])}function Ps(){const[e]=d.useState(()=>new Set),t=d.useCallback(s=>(e.add(s),()=>e.delete(s)),[e]);return[d.useCallback(s=>{let{type:i,event:o}=s;e.forEach(c=>{var l;return(l=c[i])==null?void 0:l.call(c,o)})},[e]),t]}const Bs={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},$s={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was moved over droppable area "+n.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was dropped over droppable area "+n.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function Us(e){let{announcements:t=$s,container:n,hiddenTextDescribedById:s,screenReaderInstructions:i=Bs}=e;const{announce:o,announcement:c}=Qs(),l=st("DndLiveRegion"),[u,f]=d.useState(!1);if(d.useEffect(()=>{f(!0)},[]),zs(d.useMemo(()=>({onDragStart(h){let{active:x}=h;o(t.onDragStart({active:x}))},onDragMove(h){let{active:x,over:m}=h;t.onDragMove&&o(t.onDragMove({active:x,over:m}))},onDragOver(h){let{active:x,over:m}=h;o(t.onDragOver({active:x,over:m}))},onDragEnd(h){let{active:x,over:m}=h;o(t.onDragEnd({active:x,over:m}))},onDragCancel(h){let{active:x,over:m}=h;o(t.onDragCancel({active:x,over:m}))}}),[o,t])),!u)return null;const g=Z.createElement(Z.Fragment,null,Z.createElement(Fs,{id:s,value:i.draggable}),Z.createElement(Ls,{id:l,announcement:c}));return n?Ve.createPortal(g,n):g}var P;(function(e){e.DragStart="dragStart",e.DragMove="dragMove",e.DragEnd="dragEnd",e.DragCancel="dragCancel",e.DragOver="dragOver",e.RegisterDroppable="registerDroppable",e.SetDroppableDisabled="setDroppableDisabled",e.UnregisterDroppable="unregisterDroppable"})(P||(P={}));function vt(){}function jn(e,t){return d.useMemo(()=>({sensor:e,options:t!=null?t:{}}),[e,t])}function Xs(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return d.useMemo(()=>[...t].filter(s=>s!=null),[...t])}const fe=Object.freeze({x:0,y:0});function Bn(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function $n(e,t){let{data:{value:n}}=e,{data:{value:s}}=t;return n-s}function Ys(e,t){let{data:{value:n}}=e,{data:{value:s}}=t;return s-n}function Cn(e){let{left:t,top:n,height:s,width:i}=e;return[{x:t,y:n},{x:t+i,y:n},{x:t,y:n+s},{x:t+i,y:n+s}]}function Un(e,t){if(!e||e.length===0)return null;const[n]=e;return n[t]}function Sn(e,t,n){return t===void 0&&(t=e.left),n===void 0&&(n=e.top),{x:t+e.width*.5,y:n+e.height*.5}}const Vs=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:s}=e;const i=Sn(t,t.left,t.top),o=[];for(const c of s){const{id:l}=c,u=n.get(l);if(u){const f=Bn(Sn(u),i);o.push({id:l,data:{droppableContainer:c,value:f}})}}return o.sort($n)},Hs=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:s}=e;const i=Cn(t),o=[];for(const c of s){const{id:l}=c,u=n.get(l);if(u){const f=Cn(u),g=i.reduce((x,m,R)=>x+Bn(f[R],m),0),h=Number((g/4).toFixed(4));o.push({id:l,data:{droppableContainer:c,value:h}})}}return o.sort($n)};function Ws(e,t){const n=Math.max(t.top,e.top),s=Math.max(t.left,e.left),i=Math.min(t.left+t.width,e.left+e.width),o=Math.min(t.top+t.height,e.top+e.height),c=i-s,l=o-n;if(s<i&&n<o){const u=t.width*t.height,f=e.width*e.height,g=c*l,h=g/(u+f-g);return Number(h.toFixed(4))}return 0}const Ks=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:s}=e;const i=[];for(const o of s){const{id:c}=o,l=n.get(c);if(l){const u=Ws(l,t);u>0&&i.push({id:c,data:{droppableContainer:o,value:u}})}}return i.sort(Ys)};function Gs(e,t,n){return w(v({},e),{scaleX:t&&n?t.width/n.width:1,scaleY:t&&n?t.height/n.height:1})}function Xn(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:fe}function Js(e){return function(n){for(var s=arguments.length,i=new Array(s>1?s-1:0),o=1;o<s;o++)i[o-1]=arguments[o];return i.reduce((c,l)=>w(v({},c),{top:c.top+e*l.y,bottom:c.bottom+e*l.y,left:c.left+e*l.x,right:c.right+e*l.x}),v({},n))}}const Zs=Js(1);function er(e){if(e.startsWith("matrix3d(")){const t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}else if(e.startsWith("matrix(")){const t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}function tr(e,t,n){const s=er(t);if(!s)return e;const{scaleX:i,scaleY:o,x:c,y:l}=s,u=e.left-c-(1-i)*parseFloat(n),f=e.top-l-(1-o)*parseFloat(n.slice(n.indexOf(" ")+1)),g=i?e.width/i:e.width,h=o?e.height/o:e.height;return{width:g,height:h,top:f,right:u+g,bottom:f+h,left:u}}const nr={ignoreTransform:!1};function Pe(e,t){t===void 0&&(t=nr);let n=e.getBoundingClientRect();if(t.ignoreTransform){const{transform:f,transformOrigin:g}=ee(e).getComputedStyle(e);f&&(n=tr(n,f,g))}const{top:s,left:i,width:o,height:c,bottom:l,right:u}=n;return{top:s,left:i,width:o,height:c,bottom:l,right:u}}function Nn(e){return Pe(e,{ignoreTransform:!0})}function sr(e){const t=e.innerWidth,n=e.innerHeight;return{top:0,left:0,right:t,bottom:n,width:t,height:n}}function rr(e,t){return t===void 0&&(t=ee(e).getComputedStyle(e)),t.position==="fixed"}function ir(e,t){t===void 0&&(t=ee(e).getComputedStyle(e));const n=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(i=>{const o=t[i];return typeof o=="string"?n.test(o):!1})}function wt(e,t){const n=[];function s(i){if(t!=null&&n.length>=t||!i)return n;if($t(i)&&i.scrollingElement!=null&&!n.includes(i.scrollingElement))return n.push(i.scrollingElement),n;if(!tt(i)||Qn(i)||n.includes(i))return n;const o=ee(e).getComputedStyle(i);return i!==e&&ir(i,o)&&n.push(i),rr(i,o)?n:s(i.parentNode)}return e?s(e):n}function Yn(e){const[t]=wt(e,1);return t!=null?t:null}function kt(e){return!yt||!e?null:Qe(e)?e:Bt(e)?$t(e)||e===ze(e).scrollingElement?window:tt(e)?e:null:null}function Vn(e){return Qe(e)?e.scrollX:e.scrollLeft}function Hn(e){return Qe(e)?e.scrollY:e.scrollTop}function Qt(e){return{x:Vn(e),y:Hn(e)}}var X;(function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"})(X||(X={}));function Wn(e){return!yt||!e?!1:e===document.scrollingElement}function Kn(e){const t={x:0,y:0},n=Wn(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},s={x:e.scrollWidth-n.width,y:e.scrollHeight-n.height},i=e.scrollTop<=t.y,o=e.scrollLeft<=t.x,c=e.scrollTop>=s.y,l=e.scrollLeft>=s.x;return{isTop:i,isLeft:o,isBottom:c,isRight:l,maxScroll:s,minScroll:t}}const or={x:.2,y:.2};function ar(e,t,n,s,i){let{top:o,left:c,right:l,bottom:u}=n;s===void 0&&(s=10),i===void 0&&(i=or);const{isTop:f,isBottom:g,isLeft:h,isRight:x}=Kn(e),m={x:0,y:0},R={x:0,y:0},b={height:t.height*i.y,width:t.width*i.x};return!f&&o<=t.top+b.height?(m.y=X.Backward,R.y=s*Math.abs((t.top+b.height-o)/b.height)):!g&&u>=t.bottom-b.height&&(m.y=X.Forward,R.y=s*Math.abs((t.bottom-b.height-u)/b.height)),!x&&l>=t.right-b.width?(m.x=X.Forward,R.x=s*Math.abs((t.right-b.width-l)/b.width)):!h&&c<=t.left+b.width&&(m.x=X.Backward,R.x=s*Math.abs((t.left+b.width-c)/b.width)),{direction:m,speed:R}}function cr(e){if(e===document.scrollingElement){const{innerWidth:o,innerHeight:c}=window;return{top:0,left:0,right:o,bottom:c,width:o,height:c}}const{top:t,left:n,right:s,bottom:i}=e.getBoundingClientRect();return{top:t,left:n,right:s,bottom:i,width:e.clientWidth,height:e.clientHeight}}function Gn(e){return e.reduce((t,n)=>Le(t,Qt(n)),fe)}function lr(e){return e.reduce((t,n)=>t+Vn(n),0)}function dr(e){return e.reduce((t,n)=>t+Hn(n),0)}function ur(e,t){if(t===void 0&&(t=Pe),!e)return;const{top:n,left:s,bottom:i,right:o}=t(e);Yn(e)&&(i<=0||o<=0||n>=window.innerHeight||s>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}const fr=[["x",["left","right"],lr],["y",["top","bottom"],dr]];class Yt{constructor(t,n){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const s=wt(n),i=Gn(s);this.rect=v({},t),this.width=t.width,this.height=t.height;for(const[o,c,l]of fr)for(const u of c)Object.defineProperty(this,u,{get:()=>{const f=l(s),g=i[o]-f;return this.rect[u]+g},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class He{constructor(t){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(n=>{var s;return(s=this.target)==null?void 0:s.removeEventListener(...n)})},this.target=t}add(t,n,s){var i;(i=this.target)==null||i.addEventListener(t,n,s),this.listeners.push([t,n,s])}}function hr(e){const{EventTarget:t}=ee(e);return e instanceof t?e:ze(e)}function qt(e,t){const n=Math.abs(e.x),s=Math.abs(e.y);return typeof t=="number"?Math.sqrt(Rt(n,2)+Rt(s,2))>t:"x"in t&&"y"in t?n>t.x&&s>t.y:"x"in t?n>t.x:"y"in t?s>t.y:!1}var ae;(function(e){e.Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange"})(ae||(ae={}));function Dn(e){e.preventDefault()}function gr(e){e.stopPropagation()}var k;(function(e){e.Space="Space",e.Down="ArrowDown",e.Right="ArrowRight",e.Left="ArrowLeft",e.Up="ArrowUp",e.Esc="Escape",e.Enter="Enter",e.Tab="Tab"})(k||(k={}));const Jn={start:[k.Space,k.Enter],cancel:[k.Esc],end:[k.Space,k.Enter,k.Tab]},pr=(e,t)=>{let{currentCoordinates:n}=t;switch(e.code){case k.Right:return w(v({},n),{x:n.x+25});case k.Left:return w(v({},n),{x:n.x-25});case k.Down:return w(v({},n),{y:n.y+25});case k.Up:return w(v({},n),{y:n.y-25})}};class Vt{constructor(t){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=t;const{event:{target:n}}=t;this.props=t,this.listeners=new He(ze(n)),this.windowListeners=new He(ee(n)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(ae.Resize,this.handleCancel),this.windowListeners.add(ae.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(ae.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:t,onStart:n}=this.props,s=t.node.current;s&&ur(s),n(fe)}handleKeyDown(t){if(Xt(t)){const{active:n,context:s,options:i}=this.props,{keyboardCodes:o=Jn,coordinateGetter:c=pr,scrollBehavior:l="smooth"}=i,{code:u}=t;if(o.end.includes(u)){this.handleEnd(t);return}if(o.cancel.includes(u)){this.handleCancel(t);return}const{collisionRect:f}=s.current,g=f?{x:f.left,y:f.top}:fe;this.referenceCoordinates||(this.referenceCoordinates=g);const h=c(t,{active:n,context:s.current,currentCoordinates:g});if(h){const x=Je(h,g),m={x:0,y:0},{scrollableAncestors:R}=s.current;for(const b of R){const j=t.code,{isTop:I,isRight:E,isLeft:y,isBottom:S,maxScroll:C,minScroll:N}=Kn(b),D=cr(b),M={x:Math.min(j===k.Right?D.right-D.width/2:D.right,Math.max(j===k.Right?D.left:D.left+D.width/2,h.x)),y:Math.min(j===k.Down?D.bottom-D.height/2:D.bottom,Math.max(j===k.Down?D.top:D.top+D.height/2,h.y))},O=j===k.Right&&!E||j===k.Left&&!y,_=j===k.Down&&!S||j===k.Up&&!I;if(O&&M.x!==h.x){const q=b.scrollLeft+x.x,W=j===k.Right&&q<=C.x||j===k.Left&&q>=N.x;if(W&&!x.y){b.scrollTo({left:q,behavior:l});return}W?m.x=b.scrollLeft-q:m.x=j===k.Right?b.scrollLeft-C.x:b.scrollLeft-N.x,m.x&&b.scrollBy({left:-m.x,behavior:l});break}else if(_&&M.y!==h.y){const q=b.scrollTop+x.y,W=j===k.Down&&q<=C.y||j===k.Up&&q>=N.y;if(W&&!x.x){b.scrollTo({top:q,behavior:l});return}W?m.y=b.scrollTop-q:m.y=j===k.Down?b.scrollTop-C.y:b.scrollTop-N.y,m.y&&b.scrollBy({top:-m.y,behavior:l});break}}this.handleMove(t,Le(Je(h,this.referenceCoordinates),m))}}}handleMove(t,n){const{onMove:s}=this.props;t.preventDefault(),s(n)}handleEnd(t){const{onEnd:n}=this.props;t.preventDefault(),this.detach(),n()}handleCancel(t){const{onCancel:n}=this.props;t.preventDefault(),this.detach(),n()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}Vt.activators=[{eventName:"onKeyDown",handler:(e,t,n)=>{let{keyboardCodes:s=Jn,onActivation:i}=t,{active:o}=n;const{code:c}=e.nativeEvent;if(s.start.includes(c)){const l=o.activatorNode.current;return l&&e.target!==l?!1:(e.preventDefault(),i==null||i({event:e.nativeEvent}),!0)}return!1}}];function Rn(e){return!!(e&&"distance"in e)}function En(e){return!!(e&&"delay"in e)}class Ht{constructor(t,n,s){var i;s===void 0&&(s=hr(t.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=t,this.events=n;const{event:o}=t,{target:c}=o;this.props=t,this.events=n,this.document=ze(c),this.documentListeners=new He(this.document),this.listeners=new He(s),this.windowListeners=new He(ee(c)),this.initialCoordinates=(i=Lt(o))!=null?i:fe,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:t,props:{options:{activationConstraint:n,bypassActivationConstraint:s}}}=this;if(this.listeners.add(t.move.name,this.handleMove,{passive:!1}),this.listeners.add(t.end.name,this.handleEnd),t.cancel&&this.listeners.add(t.cancel.name,this.handleCancel),this.windowListeners.add(ae.Resize,this.handleCancel),this.windowListeners.add(ae.DragStart,Dn),this.windowListeners.add(ae.VisibilityChange,this.handleCancel),this.windowListeners.add(ae.ContextMenu,Dn),this.documentListeners.add(ae.Keydown,this.handleKeydown),n){if(s!=null&&s({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(En(n)){this.timeoutId=setTimeout(this.handleStart,n.delay),this.handlePending(n);return}if(Rn(n)){this.handlePending(n);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(t,n){const{active:s,onPending:i}=this.props;i(s,t,this.initialCoordinates,n)}handleStart(){const{initialCoordinates:t}=this,{onStart:n}=this.props;t&&(this.activated=!0,this.documentListeners.add(ae.Click,gr,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(ae.SelectionChange,this.removeTextSelection),n(t))}handleMove(t){var n;const{activated:s,initialCoordinates:i,props:o}=this,{onMove:c,options:{activationConstraint:l}}=o;if(!i)return;const u=(n=Lt(t))!=null?n:fe,f=Je(i,u);if(!s&&l){if(Rn(l)){if(l.tolerance!=null&&qt(f,l.tolerance))return this.handleCancel();if(qt(f,l.distance))return this.handleStart()}if(En(l)&&qt(f,l.tolerance))return this.handleCancel();this.handlePending(l,f);return}t.cancelable&&t.preventDefault(),c(u)}handleEnd(){const{onAbort:t,onEnd:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleCancel(){const{onAbort:t,onCancel:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleKeydown(t){t.code===k.Esc&&this.handleCancel()}removeTextSelection(){var t;(t=this.document.getSelection())==null||t.removeAllRanges()}}const xr={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class Wt extends Ht{constructor(t){const{event:n}=t,s=ze(n.target);super(t,xr,s)}}Wt.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:s}=t;return!n.isPrimary||n.button!==0?!1:(s==null||s({event:n}),!0)}}];const vr={move:{name:"mousemove"},end:{name:"mouseup"}};var zt;(function(e){e[e.RightClick=2]="RightClick"})(zt||(zt={}));class mr extends Ht{constructor(t){super(t,vr,ze(t.event.target))}}mr.activators=[{eventName:"onMouseDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:s}=t;return n.button===zt.RightClick?!1:(s==null||s({event:n}),!0)}}];const Ot={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class br extends Ht{constructor(t){super(t,Ot)}static setup(){return window.addEventListener(Ot.move.name,t,{capture:!1,passive:!1}),function(){window.removeEventListener(Ot.move.name,t)};function t(){}}}br.activators=[{eventName:"onTouchStart",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:s}=t;const{touches:i}=n;return i.length>1?!1:(s==null||s({event:n}),!0)}}];var We;(function(e){e[e.Pointer=0]="Pointer",e[e.DraggableRect=1]="DraggableRect"})(We||(We={}));var mt;(function(e){e[e.TreeOrder=0]="TreeOrder",e[e.ReversedTreeOrder=1]="ReversedTreeOrder"})(mt||(mt={}));function yr(e){let{acceleration:t,activator:n=We.Pointer,canScroll:s,draggingRect:i,enabled:o,interval:c=5,order:l=mt.TreeOrder,pointerCoordinates:u,scrollableAncestors:f,scrollableAncestorRects:g,delta:h,threshold:x}=e;const m=jr({delta:h,disabled:!o}),[R,b]=ks(),j=d.useRef({x:0,y:0}),I=d.useRef({x:0,y:0}),E=d.useMemo(()=>{switch(n){case We.Pointer:return u?{top:u.y,bottom:u.y,left:u.x,right:u.x}:null;case We.DraggableRect:return i}},[n,i,u]),y=d.useRef(null),S=d.useCallback(()=>{const N=y.current;if(!N)return;const D=j.current.x*I.current.x,M=j.current.y*I.current.y;N.scrollBy(D,M)},[]),C=d.useMemo(()=>l===mt.TreeOrder?[...f].reverse():f,[l,f]);d.useEffect(()=>{if(!o||!f.length||!E){b();return}for(const N of C){if((s==null?void 0:s(N))===!1)continue;const D=f.indexOf(N),M=g[D];if(!M)continue;const{direction:O,speed:_}=ar(N,M,E,t,x);for(const q of["x","y"])m[q][O[q]]||(_[q]=0,O[q]=0);if(_.x>0||_.y>0){b(),y.current=N,R(S,c),j.current=_,I.current=O;return}}j.current={x:0,y:0},I.current={x:0,y:0},b()},[t,S,s,b,o,c,JSON.stringify(E),JSON.stringify(m),R,f,C,g,JSON.stringify(x)])}const wr={x:{[X.Backward]:!1,[X.Forward]:!1},y:{[X.Backward]:!1,[X.Forward]:!1}};function jr(e){let{delta:t,disabled:n}=e;const s=Ft(t);return nt(i=>{if(n||!s||!i)return wr;const o={x:Math.sign(t.x-s.x),y:Math.sign(t.y-s.y)};return{x:{[X.Backward]:i.x[X.Backward]||o.x===-1,[X.Forward]:i.x[X.Forward]||o.x===1},y:{[X.Backward]:i.y[X.Backward]||o.y===-1,[X.Forward]:i.y[X.Forward]||o.y===1}}},[n,t,s])}function Cr(e,t){const n=t!=null?e.get(t):void 0,s=n?n.node.current:null;return nt(i=>{var o;return t==null?null:(o=s!=null?s:i)!=null?o:null},[s,t])}function Sr(e,t){return d.useMemo(()=>e.reduce((n,s)=>{const{sensor:i}=s,o=i.activators.map(c=>({eventName:c.eventName,handler:t(c.handler,s)}));return[...n,...o]},[]),[e,t])}var et;(function(e){e[e.Always=0]="Always",e[e.BeforeDragging=1]="BeforeDragging",e[e.WhileDragging=2]="WhileDragging"})(et||(et={}));var Pt;(function(e){e.Optimized="optimized"})(Pt||(Pt={}));const In=new Map;function Nr(e,t){let{dragging:n,dependencies:s,config:i}=t;const[o,c]=d.useState(null),{frequency:l,measure:u,strategy:f}=i,g=d.useRef(e),h=j(),x=Ge(h),m=d.useCallback(function(I){I===void 0&&(I=[]),!x.current&&c(E=>E===null?I:E.concat(I.filter(y=>!E.includes(y))))},[x]),R=d.useRef(null),b=nt(I=>{if(h&&!n)return In;if(!I||I===In||g.current!==e||o!=null){const E=new Map;for(let y of e){if(!y)continue;if(o&&o.length>0&&!o.includes(y.id)&&y.rect.current){E.set(y.id,y.rect.current);continue}const S=y.node.current,C=S?new Yt(u(S),S):null;y.rect.current=C,C&&E.set(y.id,C)}return E}return I},[e,o,n,h,u]);return d.useEffect(()=>{g.current=e},[e]),d.useEffect(()=>{h||m()},[n,h]),d.useEffect(()=>{o&&o.length>0&&c(null)},[JSON.stringify(o)]),d.useEffect(()=>{h||typeof l!="number"||R.current!==null||(R.current=setTimeout(()=>{m(),R.current=null},l))},[l,h,m,...s]),{droppableRects:b,measureDroppableContainers:m,measuringScheduled:o!=null};function j(){switch(f){case et.Always:return!1;case et.BeforeDragging:return n;default:return!n}}}function Zn(e,t){return nt(n=>e?n||(typeof t=="function"?t(e):e):null,[t,e])}function Dr(e,t){return Zn(e,t)}function Rr(e){let{callback:t,disabled:n}=e;const s=Ut(t),i=d.useMemo(()=>{if(n||typeof window=="undefined"||typeof window.MutationObserver=="undefined")return;const{MutationObserver:o}=window;return new o(s)},[s,n]);return d.useEffect(()=>()=>i==null?void 0:i.disconnect(),[i]),i}function jt(e){let{callback:t,disabled:n}=e;const s=Ut(t),i=d.useMemo(()=>{if(n||typeof window=="undefined"||typeof window.ResizeObserver=="undefined")return;const{ResizeObserver:o}=window;return new o(s)},[n]);return d.useEffect(()=>()=>i==null?void 0:i.disconnect(),[i]),i}function Er(e){return new Yt(Pe(e),e)}function Mn(e,t,n){t===void 0&&(t=Er);const[s,i]=d.useState(null);function o(){i(u=>{if(!e)return null;if(e.isConnected===!1){var f;return(f=u!=null?u:n)!=null?f:null}const g=t(e);return JSON.stringify(u)===JSON.stringify(g)?u:g})}const c=Rr({callback(u){if(e)for(const f of u){const{type:g,target:h}=f;if(g==="childList"&&h instanceof HTMLElement&&h.contains(e)){o();break}}}}),l=jt({callback:o});return xe(()=>{o(),e?(l==null||l.observe(e),c==null||c.observe(document.body,{childList:!0,subtree:!0})):(l==null||l.disconnect(),c==null||c.disconnect())},[e]),s}function Ir(e){const t=Zn(e);return Xn(e,t)}const An=[];function Mr(e){const t=d.useRef(e),n=nt(s=>e?s&&s!==An&&e&&t.current&&e.parentNode===t.current.parentNode?s:wt(e):An,[e]);return d.useEffect(()=>{t.current=e},[e]),n}function Ar(e){const[t,n]=d.useState(null),s=d.useRef(e),i=d.useCallback(o=>{const c=kt(o.target);c&&n(l=>l?(l.set(c,Qt(c)),new Map(l)):null)},[]);return d.useEffect(()=>{const o=s.current;if(e!==o){c(o);const l=e.map(u=>{const f=kt(u);return f?(f.addEventListener("scroll",i,{passive:!0}),[f,Qt(f)]):null}).filter(u=>u!=null);n(l.length?new Map(l):null),s.current=e}return()=>{c(e),c(o)};function c(l){l.forEach(u=>{const f=kt(u);f==null||f.removeEventListener("scroll",i)})}},[i,e]),d.useMemo(()=>e.length?t?Array.from(t.values()).reduce((o,c)=>Le(o,c),fe):Gn(e):fe,[e,t])}function kn(e,t){t===void 0&&(t=[]);const n=d.useRef(null);return d.useEffect(()=>{n.current=null},t),d.useEffect(()=>{const s=e!==fe;s&&!n.current&&(n.current=e),!s&&n.current&&(n.current=null)},[e]),n.current?Je(e,n.current):fe}function kr(e){d.useEffect(()=>{if(!yt)return;const t=e.map(n=>{let{sensor:s}=n;return s.setup==null?void 0:s.setup()});return()=>{for(const n of t)n==null||n()}},e.map(t=>{let{sensor:n}=t;return n}))}function qr(e,t){return d.useMemo(()=>e.reduce((n,s)=>{let{eventName:i,handler:o}=s;return n[i]=c=>{o(c,t)},n},{}),[e,t])}function es(e){return d.useMemo(()=>e?sr(e):null,[e])}const qn=[];function Or(e,t){t===void 0&&(t=Pe);const[n]=e,s=es(n?ee(n):null),[i,o]=d.useState(qn);function c(){o(()=>e.length?e.map(u=>Wn(u)?s:new Yt(t(u),u)):qn)}const l=jt({callback:c});return xe(()=>{l==null||l.disconnect(),c(),e.forEach(u=>l==null?void 0:l.observe(u))},[e]),i}function Tr(e){if(!e)return null;if(e.children.length>1)return e;const t=e.children[0];return tt(t)?t:e}function _r(e){let{measure:t}=e;const[n,s]=d.useState(null),i=d.useCallback(f=>{for(const{target:g}of f)if(tt(g)){s(h=>{const x=t(g);return h?w(v({},h),{width:x.width,height:x.height}):x});break}},[t]),o=jt({callback:i}),c=d.useCallback(f=>{const g=Tr(f);o==null||o.disconnect(),g&&(o==null||o.observe(g)),s(g?t(g):null)},[t,o]),[l,u]=xt(c);return d.useMemo(()=>({nodeRef:l,rect:n,setRef:u}),[n,l,u])}const Fr=[{sensor:Wt,options:{}},{sensor:Vt,options:{}}],Lr={current:{}},pt={draggable:{measure:Nn},droppable:{measure:Nn,strategy:et.WhileDragging,frequency:Pt.Optimized},dragOverlay:{measure:Pe}};class Ke extends Map{get(t){var n;return t!=null&&(n=super.get(t))!=null?n:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(t=>{let{disabled:n}=t;return!n})}getNodeFor(t){var n,s;return(n=(s=this.get(t))==null?void 0:s.node.current)!=null?n:void 0}}const Qr={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new Ke,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:vt},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:pt,measureDroppableContainers:vt,windowRect:null,measuringScheduled:!1},zr={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:vt,draggableNodes:new Map,over:null,measureDroppableContainers:vt},Ct=d.createContext(zr),ts=d.createContext(Qr);function Pr(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new Ke}}}function Br(e,t){switch(t.type){case P.DragStart:return w(v({},e),{draggable:w(v({},e.draggable),{initialCoordinates:t.initialCoordinates,active:t.active})});case P.DragMove:return e.draggable.active==null?e:w(v({},e),{draggable:w(v({},e.draggable),{translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}})});case P.DragEnd:case P.DragCancel:return w(v({},e),{draggable:w(v({},e.draggable),{active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}})});case P.RegisterDroppable:{const{element:n}=t,{id:s}=n,i=new Ke(e.droppable.containers);return i.set(s,n),w(v({},e),{droppable:w(v({},e.droppable),{containers:i})})}case P.SetDroppableDisabled:{const{id:n,key:s,disabled:i}=t,o=e.droppable.containers.get(n);if(!o||s!==o.key)return e;const c=new Ke(e.droppable.containers);return c.set(n,w(v({},o),{disabled:i})),w(v({},e),{droppable:w(v({},e.droppable),{containers:c})})}case P.UnregisterDroppable:{const{id:n,key:s}=t,i=e.droppable.containers.get(n);if(!i||s!==i.key)return e;const o=new Ke(e.droppable.containers);return o.delete(n),w(v({},e),{droppable:w(v({},e.droppable),{containers:o})})}default:return e}}function $r(e){let{disabled:t}=e;const{active:n,activatorEvent:s,draggableNodes:i}=d.useContext(Ct),o=Ft(s),c=Ft(n==null?void 0:n.id);return d.useEffect(()=>{if(!t&&!s&&o&&c!=null){if(!Xt(o)||document.activeElement===o.target)return;const l=i.get(c);if(!l)return;const{activatorNode:u,node:f}=l;if(!u.current&&!f.current)return;requestAnimationFrame(()=>{for(const g of[u.current,f.current]){if(!g)continue;const h=Ts(g);if(h){h.focus();break}}})}},[s,t,i,c,o]),null}function Ur(e,t){let i=t,{transform:n}=i,s=Ye(i,["transform"]);return e!=null&&e.length?e.reduce((o,c)=>c(v({transform:o},s)),n):n}function Xr(e){return d.useMemo(()=>({draggable:v(v({},pt.draggable),e==null?void 0:e.draggable),droppable:v(v({},pt.droppable),e==null?void 0:e.droppable),dragOverlay:v(v({},pt.dragOverlay),e==null?void 0:e.dragOverlay)}),[e==null?void 0:e.draggable,e==null?void 0:e.droppable,e==null?void 0:e.dragOverlay])}function Yr(e){let{activeNode:t,measure:n,initialRect:s,config:i=!0}=e;const o=d.useRef(!1),{x:c,y:l}=typeof i=="boolean"?{x:i,y:i}:i;xe(()=>{if(!c&&!l||!t){o.current=!1;return}if(o.current||!s)return;const f=t==null?void 0:t.node.current;if(!f||f.isConnected===!1)return;const g=n(f),h=Xn(g,s);if(c||(h.x=0),l||(h.y=0),o.current=!0,Math.abs(h.x)>0||Math.abs(h.y)>0){const x=Yn(f);x&&x.scrollBy({top:h.y,left:h.x})}},[t,c,l,s,n])}const ns=d.createContext(w(v({},fe),{scaleX:1,scaleY:1}));var De;(function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"})(De||(De={}));const Vr=d.memo(function(t){var n,s,i,o;let on=t,{id:c,accessibility:l,autoScroll:u=!0,children:f,sensors:g=Fr,collisionDetection:h=Ks,measuring:x,modifiers:m}=on,R=Ye(on,["id","accessibility","autoScroll","children","sensors","collisionDetection","measuring","modifiers"]);const b=d.useReducer(Br,void 0,Pr),[j,I]=b,[E,y]=Ps(),[S,C]=d.useState(De.Uninitialized),N=S===De.Initialized,{draggable:{active:D,nodes:M,translate:O},droppable:{containers:_}}=j,q=D!=null?M.get(D):null,W=d.useRef({initial:null,translated:null}),J=d.useMemo(()=>{var H;return D!=null?{id:D,data:(H=q==null?void 0:q.data)!=null?H:Lr,rect:W}:null},[D,q]),re=d.useRef(null),[Re,Ae]=d.useState(null),[K,ke]=d.useState(null),ce=Ge(R,Object.values(R)),Ee=st("DndDescribedBy",c),Ie=d.useMemo(()=>_.getEnabled(),[_]),V=Xr(x),{droppableRects:le,measureDroppableContainers:de,measuringScheduled:ve}=Nr(Ie,{dragging:N,dependencies:[O.x,O.y],config:V.droppable}),a=Cr(M,D),p=d.useMemo(()=>K?Lt(K):null,[K]),T=ps(),L=Dr(a,V.draggable.measure);Yr({activeNode:D!=null?M.get(D):null,config:T.layoutShiftCompensation,initialRect:L,measure:V.draggable.measure});const A=Mn(a,V.draggable.measure,L),B=Mn(a?a.parentElement:null),G=d.useRef({activatorEvent:null,active:null,activeNode:a,collisionRect:null,collisions:null,droppableRects:le,draggableNodes:M,draggingNode:null,draggingNodeRect:null,droppableContainers:_,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),ye=_.getNodeFor((n=G.current.over)==null?void 0:n.id),me=_r({measure:V.dragOverlay.measure}),qe=(s=me.nodeRef.current)!=null?s:a,Oe=N?(i=me.rect)!=null?i:A:null,Gt=!!(me.nodeRef.current&&me.rect),Jt=Ir(Gt?null:A),St=es(qe?ee(qe):null),we=Mr(N?ye!=null?ye:a:null),rt=Or(we),it=Ur(m,{transform:{x:O.x-Jt.x,y:O.y-Jt.y,scaleX:1,scaleY:1},activatorEvent:K,active:J,activeNodeRect:A,containerNodeRect:B,draggingNodeRect:Oe,over:G.current.over,overlayNodeRect:me.rect,scrollableAncestors:we,scrollableAncestorRects:rt,windowRect:St}),Zt=p?Le(p,O):null,en=Ar(we),cs=kn(en),ls=kn(en,[A]),Te=Le(it,cs),_e=Oe?Zs(Oe,it):null,Be=J&&_e?h({active:J,collisionRect:_e,droppableRects:le,droppableContainers:Ie,pointerCoordinates:Zt}):null,tn=Un(Be,"id"),[je,nn]=d.useState(null),ds=Gt?it:Le(it,ls),us=Gs(ds,(o=je==null?void 0:je.rect)!=null?o:null,A),Nt=d.useRef(null),sn=d.useCallback((H,te)=>{let{sensor:ne,options:Ce}=te;if(re.current==null)return;const ie=M.get(re.current);if(!ie)return;const se=H.nativeEvent,he=new ne({active:re.current,activeNode:ie,event:se,options:Ce,context:G,onAbort(Y){if(!M.get(Y))return;const{onDragAbort:ge}=ce.current,be={id:Y};ge==null||ge(be),E({type:"onDragAbort",event:be})},onPending(Y,Se,ge,be){if(!M.get(Y))return;const{onDragPending:Ue}=ce.current,Ne={id:Y,constraint:Se,initialCoordinates:ge,offset:be};Ue==null||Ue(Ne),E({type:"onDragPending",event:Ne})},onStart(Y){const Se=re.current;if(Se==null)return;const ge=M.get(Se);if(!ge)return;const{onDragStart:be}=ce.current,$e={activatorEvent:se,active:{id:Se,data:ge.data,rect:W}};Ve.unstable_batchedUpdates(()=>{be==null||be($e),C(De.Initializing),I({type:P.DragStart,initialCoordinates:Y,active:Se}),E({type:"onDragStart",event:$e}),Ae(Nt.current),ke(se)})},onMove(Y){I({type:P.DragMove,coordinates:Y})},onEnd:Fe(P.DragEnd),onCancel:Fe(P.DragCancel)});Nt.current=he;function Fe(Y){return function(){return oe(this,null,function*(){const{active:ge,collisions:be,over:$e,scrollAdjustedTranslate:Ue}=G.current;let Ne=null;if(ge&&Ue){const{cancelDrop:Xe}=ce.current;Ne={activatorEvent:se,active:ge,collisions:be,delta:Ue,over:$e},Y===P.DragEnd&&typeof Xe=="function"&&(yield Promise.resolve(Xe(Ne)))&&(Y=P.DragCancel)}re.current=null,Ve.unstable_batchedUpdates(()=>{I({type:Y}),C(De.Uninitialized),nn(null),Ae(null),ke(null),Nt.current=null;const Xe=Y===P.DragEnd?"onDragEnd":"onDragCancel";if(Ne){const Dt=ce.current[Xe];Dt==null||Dt(Ne),E({type:Xe,event:Ne})}})})}}},[M]),fs=d.useCallback((H,te)=>(ne,Ce)=>{const ie=ne.nativeEvent,se=M.get(Ce);if(re.current!==null||!se||ie.dndKit||ie.defaultPrevented)return;const he={active:se};H(ne,te.options,he)===!0&&(ie.dndKit={capturedBy:te.sensor},re.current=Ce,sn(ne,te))},[M,sn]),rn=Sr(g,fs);kr(g),xe(()=>{A&&S===De.Initializing&&C(De.Initialized)},[A,S]),d.useEffect(()=>{const{onDragMove:H}=ce.current,{active:te,activatorEvent:ne,collisions:Ce,over:ie}=G.current;if(!te||!ne)return;const se={active:te,activatorEvent:ne,collisions:Ce,delta:{x:Te.x,y:Te.y},over:ie};Ve.unstable_batchedUpdates(()=>{H==null||H(se),E({type:"onDragMove",event:se})})},[Te.x,Te.y]),d.useEffect(()=>{const{active:H,activatorEvent:te,collisions:ne,droppableContainers:Ce,scrollAdjustedTranslate:ie}=G.current;if(!H||re.current==null||!te||!ie)return;const{onDragOver:se}=ce.current,he=Ce.get(tn),Fe=he&&he.rect.current?{id:he.id,rect:he.rect.current,data:he.data,disabled:he.disabled}:null,Y={active:H,activatorEvent:te,collisions:ne,delta:{x:ie.x,y:ie.y},over:Fe};Ve.unstable_batchedUpdates(()=>{nn(Fe),se==null||se(Y),E({type:"onDragOver",event:Y})})},[tn]),xe(()=>{G.current={activatorEvent:K,active:J,activeNode:a,collisionRect:_e,collisions:Be,droppableRects:le,draggableNodes:M,draggingNode:qe,draggingNodeRect:Oe,droppableContainers:_,over:je,scrollableAncestors:we,scrollAdjustedTranslate:Te},W.current={initial:Oe,translated:_e}},[J,a,Be,_e,M,qe,Oe,le,_,je,we,Te]),yr(w(v({},T),{delta:O,draggingRect:_e,pointerCoordinates:Zt,scrollableAncestors:we,scrollableAncestorRects:rt}));const hs=d.useMemo(()=>({active:J,activeNode:a,activeNodeRect:A,activatorEvent:K,collisions:Be,containerNodeRect:B,dragOverlay:me,draggableNodes:M,droppableContainers:_,droppableRects:le,over:je,measureDroppableContainers:de,scrollableAncestors:we,scrollableAncestorRects:rt,measuringConfiguration:V,measuringScheduled:ve,windowRect:St}),[J,a,A,K,Be,B,me,M,_,le,je,de,we,rt,V,ve,St]),gs=d.useMemo(()=>({activatorEvent:K,activators:rn,active:J,activeNodeRect:A,ariaDescribedById:{draggable:Ee},dispatch:I,draggableNodes:M,over:je,measureDroppableContainers:de}),[K,rn,J,A,I,Ee,M,je,de]);return Z.createElement(Pn.Provider,{value:y},Z.createElement(Ct.Provider,{value:gs},Z.createElement(ts.Provider,{value:hs},Z.createElement(ns.Provider,{value:us},f)),Z.createElement($r,{disabled:(l==null?void 0:l.restoreFocus)===!1})),Z.createElement(Us,w(v({},l),{hiddenTextDescribedById:Ee})));function ps(){const H=(Re==null?void 0:Re.autoScrollEnabled)===!1,te=typeof u=="object"?u.enabled===!1:u===!1,ne=N&&!H&&!te;return typeof u=="object"?w(v({},u),{enabled:ne}):{enabled:ne}}}),Hr=d.createContext(null),On="button",Wr="Draggable";function Kr(e){let{id:t,data:n,disabled:s=!1,attributes:i}=e;const o=st(Wr),{activators:c,activatorEvent:l,active:u,activeNodeRect:f,ariaDescribedById:g,draggableNodes:h,over:x}=d.useContext(Ct),{role:m=On,roleDescription:R="draggable",tabIndex:b=0}=i!=null?i:{},j=(u==null?void 0:u.id)===t,I=d.useContext(j?ns:Hr),[E,y]=xt(),[S,C]=xt(),N=qr(c,t),D=Ge(n);xe(()=>(h.set(t,{id:t,key:o,node:E,activatorNode:S,data:D}),()=>{const O=h.get(t);O&&O.key===o&&h.delete(t)}),[h,t]);const M=d.useMemo(()=>({role:m,tabIndex:b,"aria-disabled":s,"aria-pressed":j&&m===On?!0:void 0,"aria-roledescription":R,"aria-describedby":g.draggable}),[s,m,b,j,R,g.draggable]);return{active:u,activatorEvent:l,activeNodeRect:f,attributes:M,isDragging:j,listeners:s?void 0:N,node:E,over:x,setNodeRef:y,setActivatorNodeRef:C,transform:I}}function Gr(){return d.useContext(ts)}const Jr="Droppable",Zr={timeout:25};function ei(e){let{data:t,disabled:n=!1,id:s,resizeObserverConfig:i}=e;const o=st(Jr),{active:c,dispatch:l,over:u,measureDroppableContainers:f}=d.useContext(Ct),g=d.useRef({disabled:n}),h=d.useRef(!1),x=d.useRef(null),m=d.useRef(null),{disabled:R,updateMeasurementsFor:b,timeout:j}=v(v({},Zr),i),I=Ge(b!=null?b:s),E=d.useCallback(()=>{if(!h.current){h.current=!0;return}m.current!=null&&clearTimeout(m.current),m.current=setTimeout(()=>{f(Array.isArray(I.current)?I.current:[I.current]),m.current=null},j)},[j]),y=jt({callback:E,disabled:R||!c}),S=d.useCallback((M,O)=>{y&&(O&&(y.unobserve(O),h.current=!1),M&&y.observe(M))},[y]),[C,N]=xt(S),D=Ge(t);return d.useEffect(()=>{!y||!C.current||(y.disconnect(),h.current=!1,y.observe(C.current))},[C,y]),d.useEffect(()=>(l({type:P.RegisterDroppable,element:{id:s,key:o,disabled:n,node:C,rect:x,data:D}}),()=>l({type:P.UnregisterDroppable,key:o,id:s})),[s]),d.useEffect(()=>{n!==g.current.disabled&&(l({type:P.SetDroppableDisabled,id:s,key:o,disabled:n}),g.current.disabled=n)},[s,o,n,l]),{active:c,rect:x,isOver:(u==null?void 0:u.id)===s,node:C,over:u,setNodeRef:N}}function Kt(e,t,n){const s=e.slice();return s.splice(n<0?s.length+n:n,0,s.splice(t,1)[0]),s}function ti(e,t){return e.reduce((n,s,i)=>{const o=t.get(s);return o&&(n[i]=o),n},Array(e.length))}function ht(e){return e!==null&&e>=0}function ni(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function si(e){return typeof e=="boolean"?{draggable:e,droppable:e}:e}const ss=e=>{let{rects:t,activeIndex:n,overIndex:s,index:i}=e;const o=Kt(t,s,n),c=t[i],l=o[i];return!l||!c?null:{x:l.left-c.left,y:l.top-c.top,scaleX:l.width/c.width,scaleY:l.height/c.height}},gt={scaleX:1,scaleY:1},ri=e=>{var t;let{activeIndex:n,activeNodeRect:s,index:i,rects:o,overIndex:c}=e;const l=(t=o[n])!=null?t:s;if(!l)return null;if(i===n){const f=o[c];return f?v({x:0,y:n<c?f.top+f.height-(l.top+l.height):f.top-l.top},gt):null}const u=ii(o,i,n);return i>n&&i<=c?v({x:0,y:-l.height-u},gt):i<n&&i>=c?v({x:0,y:l.height+u},gt):v({x:0,y:0},gt)};function ii(e,t,n){const s=e[t],i=e[t-1],o=e[t+1];return s?n<t?i?s.top-(i.top+i.height):o?o.top-(s.top+s.height):0:o?o.top-(s.top+s.height):i?s.top-(i.top+i.height):0:0}const rs="Sortable",is=Z.createContext({activeIndex:-1,containerId:rs,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:ss,disabled:{draggable:!1,droppable:!1}});function oi(e){let{children:t,id:n,items:s,strategy:i=ss,disabled:o=!1}=e;const{active:c,dragOverlay:l,droppableRects:u,over:f,measureDroppableContainers:g}=Gr(),h=st(rs,n),x=l.rect!==null,m=d.useMemo(()=>s.map(N=>typeof N=="object"&&"id"in N?N.id:N),[s]),R=c!=null,b=c?m.indexOf(c.id):-1,j=f?m.indexOf(f.id):-1,I=d.useRef(m),E=!ni(m,I.current),y=j!==-1&&b===-1||E,S=si(o);xe(()=>{E&&R&&g(m)},[E,m,R,g]),d.useEffect(()=>{I.current=m},[m]);const C=d.useMemo(()=>({activeIndex:b,containerId:h,disabled:S,disableTransforms:y,items:m,overIndex:j,useDragOverlay:x,sortedRects:ti(m,u),strategy:i}),[b,h,S.draggable,S.droppable,y,m,j,u,x,i]);return Z.createElement(is.Provider,{value:C},t)}const ai=e=>{let{id:t,items:n,activeIndex:s,overIndex:i}=e;return Kt(n,s,i).indexOf(t)},ci=e=>{let{containerId:t,isSorting:n,wasDragging:s,index:i,items:o,newIndex:c,previousItems:l,previousContainerId:u,transition:f}=e;return!f||!s||l!==o&&i===c?!1:n?!0:c!==i&&t===u},li={duration:200,easing:"ease"},os="transform",di=Ze.Transition.toString({property:os,duration:0,easing:"linear"}),ui={roleDescription:"sortable"};function fi(e){let{disabled:t,index:n,node:s,rect:i}=e;const[o,c]=d.useState(null),l=d.useRef(n);return xe(()=>{if(!t&&n!==l.current&&s.current){const u=i.current;if(u){const f=Pe(s.current,{ignoreTransform:!0}),g={x:u.left-f.left,y:u.top-f.top,scaleX:u.width/f.width,scaleY:u.height/f.height};(g.x||g.y)&&c(g)}}n!==l.current&&(l.current=n)},[t,n,s,i]),d.useEffect(()=>{o&&c(null)},[o]),o}function hi(e){let{animateLayoutChanges:t=ci,attributes:n,disabled:s,data:i,getNewIndex:o=ai,id:c,strategy:l,resizeObserverConfig:u,transition:f=li}=e;const{items:g,containerId:h,activeIndex:x,disabled:m,disableTransforms:R,sortedRects:b,overIndex:j,useDragOverlay:I,strategy:E}=d.useContext(is),y=gi(s,m),S=g.indexOf(c),C=d.useMemo(()=>v({sortable:{containerId:h,index:S,items:g}},i),[h,i,S,g]),N=d.useMemo(()=>g.slice(g.indexOf(c)),[g,c]),{rect:D,node:M,isOver:O,setNodeRef:_}=ei({id:c,data:C,disabled:y.droppable,resizeObserverConfig:v({updateMeasurementsFor:N},u)}),{active:q,activatorEvent:W,activeNodeRect:J,attributes:re,setNodeRef:Re,listeners:Ae,isDragging:K,over:ke,setActivatorNodeRef:ce,transform:Ee}=Kr({id:c,data:C,attributes:v(v({},ui),n),disabled:y.draggable}),Ie=As(_,Re),V=!!q,le=V&&!R&&ht(x)&&ht(j),de=!I&&K,ve=de&&le?Ee:null,a=l!=null?l:E,p=le?ve!=null?ve:a({rects:b,activeNodeRect:J,activeIndex:x,overIndex:j,index:S}):null,T=ht(x)&&ht(j)?o({id:c,items:g,activeIndex:x,overIndex:j}):S,L=q==null?void 0:q.id,A=d.useRef({activeId:L,items:g,newIndex:T,containerId:h}),B=g!==A.current.items,G=t({active:q,containerId:h,isDragging:K,isSorting:V,id:c,index:S,items:g,newIndex:A.current.newIndex,previousItems:A.current.items,previousContainerId:A.current.containerId,transition:f,wasDragging:A.current.activeId!=null}),ye=fi({disabled:!G,index:S,node:M,rect:D});return d.useEffect(()=>{V&&A.current.newIndex!==T&&(A.current.newIndex=T),h!==A.current.containerId&&(A.current.containerId=h),g!==A.current.items&&(A.current.items=g)},[V,T,h,g]),d.useEffect(()=>{if(L===A.current.activeId)return;if(L!=null&&A.current.activeId==null){A.current.activeId=L;return}const qe=setTimeout(()=>{A.current.activeId=L},50);return()=>clearTimeout(qe)},[L]),{active:q,activeIndex:x,attributes:re,data:C,rect:D,index:S,newIndex:T,items:g,isOver:O,isSorting:V,isDragging:K,listeners:Ae,node:M,overIndex:j,over:ke,setNodeRef:Ie,setActivatorNodeRef:ce,setDroppableNodeRef:_,setDraggableNodeRef:Re,transform:ye!=null?ye:p,transition:me()};function me(){if(ye||B&&A.current.newIndex===S)return di;if(!(de&&!Xt(W)||!f)&&(V||G))return Ze.Transition.toString(w(v({},f),{property:os}))}}function gi(e,t){var n,s;return typeof e=="boolean"?{draggable:e,droppable:!1}:{draggable:(n=e==null?void 0:e.draggable)!=null?n:t.draggable,droppable:(s=e==null?void 0:e.droppable)!=null?s:t.droppable}}function bt(e){if(!e)return!1;const t=e.data.current;return!!(t&&"sortable"in t&&typeof t.sortable=="object"&&"containerId"in t.sortable&&"items"in t.sortable&&"index"in t.sortable)}const pi=[k.Down,k.Right,k.Up,k.Left],xi=(e,t)=>{let{context:{active:n,collisionRect:s,droppableRects:i,droppableContainers:o,over:c,scrollableAncestors:l}}=t;if(pi.includes(e.code)){if(e.preventDefault(),!n||!s)return;const u=[];o.getEnabled().forEach(h=>{if(!h||h!=null&&h.disabled)return;const x=i.get(h.id);if(x)switch(e.code){case k.Down:s.top<x.top&&u.push(h);break;case k.Up:s.top>x.top&&u.push(h);break;case k.Left:s.left>x.left&&u.push(h);break;case k.Right:s.left<x.left&&u.push(h);break}});const f=Hs({active:n,collisionRect:s,droppableRects:i,droppableContainers:u,pointerCoordinates:null});let g=Un(f,"id");if(g===(c==null?void 0:c.id)&&f.length>1&&(g=f[1].id),g!=null){const h=o.get(n.id),x=o.get(g),m=x?i.get(x.id):null,R=x==null?void 0:x.node.current;if(R&&m&&h&&x){const j=wt(R).some((N,D)=>l[D]!==N),I=as(h,x),E=vi(h,x),y=j||!I?{x:0,y:0}:{x:E?s.width-m.width:0,y:E?s.height-m.height:0},S={x:m.left,y:m.top};return y.x&&y.y?S:Je(S,y)}}}};function as(e,t){return!bt(e)||!bt(t)?!1:e.data.current.sortable.containerId===t.data.current.sortable.containerId}function vi(e,t){return!bt(e)||!bt(t)||!as(e,t)?!1:e.data.current.sortable.index<t.data.current.sortable.index}const mi=({question:e,onEdit:t,onDelete:n,getCategoryColor:s,getCategoryIcon:i})=>{const{attributes:o,listeners:c,setNodeRef:l,transform:u,transition:f,isDragging:g}=hi({id:e.id}),h={transform:Ze.Transform.toString(u),transition:f,opacity:g?.5:1},x=Ln();return r.jsxs("div",{ref:l,style:h,className:`flex items-center space-x-3 p-3 border rounded-lg ${g?"shadow-lg bg-blue-50":"bg-white"}`,children:[r.jsx("div",w(v(v({},o),c),{className:"cursor-grab active:cursor-grabbing p-1 hover:bg-gray-100 rounded",title:"Drag to reorder",children:r.jsx(Fn,{className:"w-4 h-4 text-gray-400"})})),r.jsx("div",{className:"flex items-center space-x-2 flex-1",children:r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx("div",{className:`p-2 rounded ${s(e.category)}`,children:i(e.category)}),r.jsxs("div",{className:"flex-1",children:[r.jsx("p",{className:"font-medium",children:e.question}),r.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[r.jsxs(z,{variant:"outline",className:"text-xs",children:["#",e.order_index+1]}),r.jsx(z,{variant:"outline",className:"text-xs",children:e.category}),e.is_required&&r.jsx(z,{className:"bg-red-100 text-red-800 text-xs",children:"Required"}),e.has_photo&&r.jsx(z,{className:"bg-blue-100 text-blue-800 text-xs",children:"Photo"}),e.has_notes&&r.jsx(z,{className:"bg-green-100 text-green-800 text-xs",children:"Notes"})]})]})]})}),r.jsxs("div",{className:"flex items-center space-x-1",children:[r.jsx(Q,{variant:"outline",size:"sm",onClick:()=>t(e),disabled:!x.canEditQuestions,title:x.canEditQuestions?"":x.upgradeMessage,children:r.jsx(Tt,{className:"w-4 h-4"})}),r.jsx(Q,{variant:"outline",size:"sm",onClick:()=>n(e.id),disabled:!x.canEditQuestions,title:x.canEditQuestions?"":x.upgradeMessage,children:r.jsx(_t,{className:"w-4 h-4"})})]})]})},Ii=()=>{const e=Xs(jn(Wt,{activationConstraint:{distance:8}}),jn(Vt,{coordinateGetter:xi})),{profile:t}=Tn(),{selectedOrganizationId:n}=bs(),s=ws(),i=Ln(),[o,c]=d.useState(null),[l,u]=d.useState(!1),[f,g]=d.useState(!1),[h,x]=d.useState(!1),[m,R]=d.useState(!1),[b,j]=d.useState(null),[I,E]=d.useState(!1),[y,S]=d.useState({name:"",description:"",is_active:!0,is_default:!1}),[C,N]=d.useState({question:"",category:"general",is_required:!0,has_photo:!1,has_notes:!0}),{data:D=[],isLoading:M}=_n({queryKey:["inspection-question-sets",n],queryFn:()=>oe(void 0,null,function*(){if(!n)return[];const{data:a,error:p}=yield ue.from("inspection_question_sets").select(`
          *,
          questions:inspection_questions(*)
        `).eq("organization_id",n).order("created_at",{ascending:!1});if(p)throw p;return a}),enabled:!!n}),O=Me({mutationFn:a=>oe(void 0,null,function*(){const{data:p,error:T}=yield ue.from("inspection_question_sets").insert(a).select().single();if(T)throw T;return p}),onSuccess:()=>{s.invalidateQueries(["inspection-question-sets"]),u(!1),S({name:"",description:"",is_active:!0,is_default:!1}),U.success("Question set created successfully")},onError:a=>{U.error(`Failed to create question set: ${a.message}`)}}),_=Me({mutationFn:T=>oe(void 0,null,function*(){var L=T,{id:a}=L,p=Ye(L,["id"]);const{data:A,error:B}=yield ue.from("inspection_question_sets").update(p).eq("id",a).select().single();if(B)throw B;return A}),onSuccess:()=>{s.invalidateQueries(["inspection-question-sets"]),g(!1),c(null),U.success("Question set updated successfully")},onError:a=>{U.error(`Failed to update question set: ${a.message}`)}}),q=Me({mutationFn:a=>oe(void 0,null,function*(){const{data:p,error:T}=yield ue.from("inspection_questions").insert(a).select().single();if(T)throw T;return p}),onSuccess:()=>{s.invalidateQueries(["inspection-question-sets"]),x(!1),N({question:"",category:"general",is_required:!0,has_photo:!1,has_notes:!0}),U.success("Question added successfully")},onError:a=>{U.error(`Failed to add question: ${a.message}`)}}),W=Me({mutationFn:T=>oe(void 0,null,function*(){var L=T,{id:a}=L,p=Ye(L,["id"]);const{data:A,error:B}=yield ue.from("inspection_questions").update(p).eq("id",a).select().single();if(B)throw B;return A}),onSuccess:()=>{s.invalidateQueries(["inspection-question-sets"]),R(!1),j(null),U.success("Question updated successfully")},onError:a=>{U.error(`Failed to update question: ${a.message}`)}}),J=Me({mutationFn:a=>oe(void 0,null,function*(){const{error:p}=yield ue.from("inspection_questions").delete().eq("id",a);if(p)throw p}),onSuccess:()=>{s.invalidateQueries(["inspection-question-sets"]),U.success("Question deleted successfully")},onError:a=>{U.error(`Failed to delete question: ${a.message}`)}}),re=Me({mutationFn:T=>oe(void 0,[T],function*({questionId:a,newOrderIndex:p}){const{error:L}=yield ue.from("inspection_questions").update({order_index:p}).eq("id",a);if(L)throw L;return{questionId:a,newOrderIndex:p}}),onSuccess:()=>{s.invalidateQueries({queryKey:["question-sets"]}),E(!1),U.success("Question order updated successfully")},onError:a=>{U.error(`Failed to update question order: ${a.message}`)}}),Re=a=>{const{active:p,over:T}=a;if(p.id!==(T==null?void 0:T.id)&&o){const L=o.questions.findIndex(B=>B.id===p.id),A=o.questions.findIndex(B=>B.id===(T==null?void 0:T.id));if(L!==-1&&A!==-1){const B=Kt(o.questions,L,A);c(G=>G?w(v({},G),{questions:B}):null),E(!0),B.forEach((G,ye)=>{re.mutate({questionId:G.id,newOrderIndex:ye})})}}},Ae=Me({mutationFn:a=>oe(void 0,null,function*(){const{error:p}=yield ue.from("inspection_question_sets").delete().eq("id",a);if(p)throw p}),onSuccess:()=>{s.invalidateQueries(["inspection-question-sets"]),c(null),U.success("Question set deleted successfully")},onError:a=>{U.error(`Failed to delete question set: ${a.message}`)}}),K=()=>{!n||!(t!=null&&t.id)||O.mutate(w(v({},y),{organization_id:n,created_by:t.id}))},ke=()=>{o&&_.mutate(v({id:o.id},y))},ce=()=>{if(!o)return;const a=Math.max(0,...o.questions.map(p=>p.order_index));q.mutate(w(v({},C),{question_set_id:o.id,order_index:a+1}))},Ee=()=>{b&&W.mutate(v({id:b.id},C))},Ie=a=>{j(a),N({question:a.question,category:a.category,is_required:a.is_required,has_photo:a.has_photo,has_notes:a.has_notes}),R(!0)},V=a=>{c(a),S({name:a.name,description:a.description,is_active:a.is_active,is_default:a.is_default}),g(!0)},le=()=>oe(void 0,null,function*(){if(!n||!(t!=null&&t.id)){U.error("Authentication required");return}try{const{data:a,error:p}=yield ue.rpc("create_default_daily_pretrip_questions",{org_id:n,creator_id:t.id});if(p){console.error("Error creating default questions:",p),U.error(`Failed to create default questions: ${p.message}`);return}s.invalidateQueries(["inspection-question-sets"]),U.success('Default "Daily Pre-Trip Inspection" question set created with 56 comprehensive questions!')}catch(a){console.error("Error:",a),U.error("Failed to create default question set")}}),de=a=>{switch(a.toLowerCase()){case"exterior":return r.jsx(bn,{className:"w-4 h-4"});case"interior":return r.jsx(It,{className:"w-4 h-4"});case"engine":return r.jsx(Ms,{className:"w-4 h-4"});case"tires":return r.jsx(Is,{className:"w-4 h-4"});case"lights":return r.jsx(Es,{className:"w-4 h-4"});case"brakes":return r.jsx(Rs,{className:"w-4 h-4"});case"fuel":return r.jsx(Ds,{className:"w-4 h-4"});case"safety":return r.jsx(yn,{className:"w-4 h-4"});case"documentation":return r.jsx(Mt,{className:"w-4 h-4"});case"driver":return r.jsx(Ns,{className:"w-4 h-4"});default:return r.jsx(Mt,{className:"w-4 h-4"})}},ve=a=>{switch(a.toLowerCase()){case"exterior":return"bg-blue-100 text-blue-800";case"interior":return"bg-purple-100 text-purple-800";case"engine":return"bg-orange-100 text-orange-800";case"tires":return"bg-slate-100 text-slate-800";case"lights":return"bg-yellow-100 text-yellow-800";case"brakes":return"bg-red-100 text-red-800";case"fuel":return"bg-green-100 text-green-800";case"safety":return"bg-amber-100 text-amber-800";case"documentation":return"bg-indigo-100 text-indigo-800";case"driver":return"bg-emerald-100 text-emerald-800";default:return"bg-gray-100 text-gray-800"}};return M?r.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:r.jsxs("div",{className:"text-center space-y-4",children:[r.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto"}),r.jsx("p",{className:"text-muted-foreground",children:"Loading vehicle check questions..."})]})}):r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:" Vehicle Check Questions Management"}),r.jsx("p",{className:"text-gray-600 mt-2",children:"Manage vehicle inspection question sets and customize checklists"}),i.currentPlan&&r.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[r.jsxs(z,{variant:"outline",className:"text-xs",children:["Current Plan: ",i.currentPlan]}),i.upgradeRequired&&r.jsx(z,{variant:"destructive",className:"text-xs",children:"Upgrade Required"})]})]}),r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsxs(z,{variant:"outline",className:"text-sm",children:[D.length,"/5 Question Sets"]}),r.jsxs(Q,{onClick:()=>u(!0),disabled:D.length>=5||!i.canCreateQuestionSets,title:i.canCreateQuestionSets?"":i.upgradeMessage,children:[r.jsx(Et,{className:"w-4 h-4 mr-2"}),"Create Question Set"]}),r.jsxs(Q,{variant:"outline",onClick:le,disabled:D.some(a=>a.name==="Daily Pre-Trip Inspection"),children:[r.jsx(bn,{className:"w-4 h-4 mr-2"}),"Import Default Questions"]})]})]}),i.upgradeRequired&&r.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:r.jsxs("div",{className:"flex items-start space-x-3",children:[r.jsx("div",{className:"flex-shrink-0",children:r.jsx(yn,{className:"w-5 h-5 text-blue-600"})}),r.jsxs("div",{className:"flex-1",children:[r.jsx("h3",{className:"text-sm font-medium text-blue-800",children:"Upgrade Required for Advanced Features"}),r.jsx("p",{className:"text-sm text-blue-700 mt-1",children:i.upgradeMessage}),r.jsx("div",{className:"mt-3",children:r.jsx(Q,{variant:"outline",size:"sm",onClick:()=>window.location.href="/subscriptions",children:"View Plans"})})]})]})}),r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:D.map(a=>r.jsxs(dn,{className:`${a.is_active?"border-blue-200":"border-gray-200"}`,children:[r.jsx(un,{className:"pb-3",children:r.jsx("div",{className:"flex items-start justify-between",children:r.jsxs("div",{className:"flex-1",children:[r.jsxs(fn,{className:"flex items-center space-x-2",children:[r.jsx(It,{className:"w-5 h-5 text-blue-600"}),r.jsx("span",{children:a.name}),a.is_default&&r.jsx(z,{className:"bg-green-100 text-green-800 text-xs",children:"Default"}),!a.is_active&&r.jsx(z,{variant:"secondary",className:"text-xs",children:"Inactive"})]}),r.jsx("p",{className:"text-sm text-gray-600 mt-1",children:a.description})]})})}),r.jsxs(hn,{className:"space-y-4",children:[r.jsxs("div",{className:"flex items-center justify-between text-sm",children:[r.jsx("span",{className:"text-gray-600",children:"Questions:"}),r.jsx(z,{variant:"outline",children:a.questions.length})]}),r.jsxs("div",{className:"space-y-2",children:[a.questions.slice(0,3).map(p=>r.jsxs("div",{className:"flex items-center space-x-2 text-sm",children:[r.jsx("div",{className:`p-1 rounded ${ve(p.category)}`,children:de(p.category)}),r.jsx("span",{className:"text-gray-700 truncate",children:p.question})]},p.id)),a.questions.length>3&&r.jsxs("p",{className:"text-xs text-gray-500",children:["+",a.questions.length-3," more questions"]})]}),r.jsx(ys,{}),r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsxs(Q,{variant:"outline",size:"sm",onClick:()=>c(a),children:[r.jsx(js,{className:"w-4 h-4 mr-1"}),"View"]}),r.jsxs(Q,{variant:"outline",size:"sm",onClick:()=>V(a),disabled:!i.canEditQuestions,title:i.canEditQuestions?"":i.upgradeMessage,children:[r.jsx(Tt,{className:"w-4 h-4 mr-1"}),"Edit"]})]}),r.jsx(Q,{variant:"outline",size:"sm",onClick:()=>Ae.mutate(a.id),disabled:a.is_default||!i.canEditQuestions,title:i.canEditQuestions?"":i.upgradeMessage,children:r.jsx(_t,{className:"w-4 h-4"})})]})]})]},a.id))}),o&&r.jsxs(dn,{children:[r.jsxs(un,{children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs(fn,{className:"flex items-center space-x-2",children:[r.jsx(It,{className:"w-5 h-5 text-blue-600"}),r.jsx("span",{children:o.name}),o.is_default&&r.jsx(z,{className:"bg-green-100 text-green-800",children:"Default"}),I&&r.jsxs(z,{className:"bg-blue-100 text-blue-800 animate-pulse",children:[r.jsx(Cs,{className:"w-3 h-3 mr-1"}),"Saving..."]})]}),r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsxs(Q,{variant:"outline",onClick:()=>x(!0),disabled:!i.canEditQuestions,title:i.canEditQuestions?"":i.upgradeMessage,children:[r.jsx(Et,{className:"w-4 h-4 mr-2"}),"Add Question"]}),r.jsx(Q,{variant:"outline",onClick:()=>c(null),children:r.jsx(Ss,{className:"w-4 h-4"})})]})]}),r.jsx("p",{className:"text-gray-600",children:o.description})]}),r.jsx(hn,{children:r.jsx("div",{className:"space-y-4",children:o.questions.length===0?r.jsxs("div",{className:"text-center py-8",children:[r.jsx(Mt,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),r.jsx("p",{className:"text-gray-600",children:"No questions in this set yet."}),r.jsxs(Q,{variant:"outline",className:"mt-4",onClick:()=>x(!0),children:[r.jsx(Et,{className:"w-4 h-4 mr-2"}),"Add First Question"]})]}):r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx(Fn,{className:"w-4 h-4 text-gray-400"}),r.jsx("span",{className:"text-sm font-medium text-gray-600",children:i.canReorderQuestions?"Drag to reorder questions":"Question reordering requires Professional plan"})]}),r.jsxs(z,{variant:"outline",className:"text-xs",children:[o.questions.length," questions"]})]}),i.canReorderQuestions?r.jsx(Vr,{sensors:e,collisionDetection:Vs,onDragEnd:Re,children:r.jsx(oi,{items:o.questions.sort((a,p)=>a.order_index-p.order_index).map(a=>a.id),strategy:ri,children:o.questions.sort((a,p)=>a.order_index-p.order_index).map(a=>r.jsx(mi,{question:a,onEdit:Ie,onDelete:p=>J.mutate(p),getCategoryColor:ve,getCategoryIcon:de},a.id))})}):r.jsx("div",{className:"space-y-3",children:o.questions.sort((a,p)=>a.order_index-p.order_index).map(a=>r.jsxs("div",{className:"flex items-center space-x-3 p-3 border rounded-lg bg-white",children:[r.jsxs("div",{className:"flex items-center space-x-2 flex-1",children:[r.jsx("div",{className:`p-2 rounded ${ve(a.category)}`,children:de(a.category)}),r.jsxs("div",{className:"flex-1",children:[r.jsx("p",{className:"font-medium",children:a.question}),r.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[r.jsxs(z,{variant:"outline",className:"text-xs",children:["#",a.order_index+1]}),r.jsx(z,{variant:"outline",className:"text-xs",children:a.category}),a.is_required&&r.jsx(z,{className:"bg-red-100 text-red-800 text-xs",children:"Required"}),a.has_photo&&r.jsx(z,{className:"bg-blue-100 text-blue-800 text-xs",children:"Photo"}),a.has_notes&&r.jsx(z,{className:"bg-green-100 text-green-800 text-xs",children:"Notes"})]})]})]}),r.jsxs("div",{className:"flex items-center space-x-1",children:[r.jsx(Q,{variant:"outline",size:"sm",onClick:()=>Ie(a),disabled:!i.canEditQuestions,title:i.canEditQuestions?"":i.upgradeMessage,children:r.jsx(Tt,{className:"w-4 h-4"})}),r.jsx(Q,{variant:"outline",size:"sm",onClick:()=>J.mutate(a.id),disabled:!i.canEditQuestions,title:i.canEditQuestions?"":i.upgradeMessage,children:r.jsx(_t,{className:"w-4 h-4"})})]})]},a.id))})]})})})]}),r.jsx(at,{open:l,onOpenChange:u,children:r.jsxs(ct,{className:"max-w-md","aria-describedby":"create-set-description",children:[r.jsxs(lt,{children:[r.jsx(dt,{children:"Create Question Set"}),r.jsx(ut,{id:"create-set-description",children:"Create a new set of inspection questions for your vehicles."})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx($,{htmlFor:"set-name",children:"Set Name"}),r.jsx(gn,{id:"set-name",value:y.name,onChange:a=>S(p=>w(v({},p),{name:a.target.value})),placeholder:"e.g., Daily Pre-Trip Inspection"})]}),r.jsxs("div",{children:[r.jsx($,{htmlFor:"set-description",children:"Description"}),r.jsx(ft,{id:"set-description",value:y.description,onChange:a=>S(p=>w(v({},p),{description:a.target.value})),placeholder:"Brief description of this question set"})]}),r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx(pe,{id:"is-active",checked:y.is_active,onCheckedChange:a=>S(p=>w(v({},p),{is_active:a}))}),r.jsx($,{htmlFor:"is-active",children:"Active"})]}),r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx(pe,{id:"is-default",checked:y.is_default,onCheckedChange:a=>S(p=>w(v({},p),{is_default:a}))}),r.jsx($,{htmlFor:"is-default",children:"Set as Default"})]}),r.jsxs("div",{className:"flex justify-end space-x-2",children:[r.jsx(Q,{variant:"outline",onClick:()=>u(!1),children:"Cancel"}),r.jsx(Q,{onClick:K,disabled:!y.name||O.isPending,children:O.isPending?"Creating...":"Create Set"})]})]})]})}),r.jsx(at,{open:f,onOpenChange:g,children:r.jsxs(ct,{className:"max-w-md","aria-describedby":"edit-set-description",children:[r.jsxs(lt,{children:[r.jsx(dt,{children:"Edit Question Set"}),r.jsx(ut,{id:"edit-set-description",children:"Modify the question set details and settings."})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx($,{htmlFor:"edit-set-name",children:"Set Name"}),r.jsx(gn,{id:"edit-set-name",value:y.name,onChange:a=>S(p=>w(v({},p),{name:a.target.value})),placeholder:"e.g., Daily Pre-Trip Inspection"})]}),r.jsxs("div",{children:[r.jsx($,{htmlFor:"edit-set-description",children:"Description"}),r.jsx(ft,{id:"edit-set-description",value:y.description,onChange:a=>S(p=>w(v({},p),{description:a.target.value})),placeholder:"Brief description of this question set"})]}),r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx(pe,{id:"edit-is-active",checked:y.is_active,onCheckedChange:a=>S(p=>w(v({},p),{is_active:a}))}),r.jsx($,{htmlFor:"edit-is-active",children:"Active"})]}),r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx(pe,{id:"edit-is-default",checked:y.is_default,onCheckedChange:a=>S(p=>w(v({},p),{is_default:a}))}),r.jsx($,{htmlFor:"edit-is-default",children:"Set as Default"})]}),r.jsxs("div",{className:"flex justify-end space-x-2",children:[r.jsx(Q,{variant:"outline",onClick:()=>g(!1),children:"Cancel"}),r.jsx(Q,{onClick:ke,disabled:!y.name||_.isPending,children:_.isPending?"Updating...":"Update Set"})]})]})]})}),r.jsx(at,{open:h,onOpenChange:x,children:r.jsxs(ct,{className:"max-w-md","aria-describedby":"add-question-description",children:[r.jsxs(lt,{children:[r.jsx(dt,{children:"Add Question"}),r.jsx(ut,{id:"add-question-description",children:"Add a new question to the inspection checklist."})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx($,{htmlFor:"question-text",children:"Question"}),r.jsx(ft,{id:"question-text",value:C.question,onChange:a=>N(p=>w(v({},p),{question:a.target.value})),placeholder:"e.g., Are all lights working properly?"})]}),r.jsxs("div",{children:[r.jsx($,{htmlFor:"question-category",children:"Category"}),r.jsxs(pn,{value:C.category,onValueChange:a=>N(p=>w(v({},p),{category:a})),children:[r.jsx(xn,{children:r.jsx(vn,{})}),r.jsxs(mn,{children:[r.jsx(F,{value:"general",children:"General"}),r.jsx(F,{value:"exterior",children:"Exterior"}),r.jsx(F,{value:"interior",children:"Interior"}),r.jsx(F,{value:"engine",children:"Engine"}),r.jsx(F,{value:"tires",children:"Tires"}),r.jsx(F,{value:"lights",children:"Lights"}),r.jsx(F,{value:"brakes",children:"Brakes"}),r.jsx(F,{value:"fuel",children:"Fuel"}),r.jsx(F,{value:"safety",children:"Safety"}),r.jsx(F,{value:"documentation",children:"Documentation"}),r.jsx(F,{value:"driver",children:"Driver"})]})]})]}),r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx(pe,{id:"is-required",checked:C.is_required,onCheckedChange:a=>N(p=>w(v({},p),{is_required:a}))}),r.jsx($,{htmlFor:"is-required",children:"Required Question"})]}),r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx(pe,{id:"has-photo",checked:C.has_photo,onCheckedChange:a=>N(p=>w(v({},p),{has_photo:a}))}),r.jsx($,{htmlFor:"has-photo",children:"Require Photo"})]}),r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx(pe,{id:"has-notes",checked:C.has_notes,onCheckedChange:a=>N(p=>w(v({},p),{has_notes:a}))}),r.jsx($,{htmlFor:"has-notes",children:"Allow Notes"})]}),r.jsxs("div",{className:"flex justify-end space-x-2",children:[r.jsx(Q,{variant:"outline",onClick:()=>x(!1),children:"Cancel"}),r.jsx(Q,{onClick:ce,disabled:!C.question||q.isPending,children:q.isPending?"Adding...":"Add Question"})]})]})]})}),r.jsx(at,{open:m,onOpenChange:R,children:r.jsxs(ct,{className:"max-w-md","aria-describedby":"edit-question-description",children:[r.jsxs(lt,{children:[r.jsx(dt,{children:"Edit Question"}),r.jsx(ut,{id:"edit-question-description",children:"Modify the question details and settings."})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx($,{htmlFor:"edit-question-text",children:"Question"}),r.jsx(ft,{id:"edit-question-text",value:C.question,onChange:a=>N(p=>w(v({},p),{question:a.target.value})),placeholder:"e.g., Are all lights working properly?"})]}),r.jsxs("div",{children:[r.jsx($,{htmlFor:"edit-question-category",children:"Category"}),r.jsxs(pn,{value:C.category,onValueChange:a=>N(p=>w(v({},p),{category:a})),children:[r.jsx(xn,{children:r.jsx(vn,{})}),r.jsxs(mn,{children:[r.jsx(F,{value:"general",children:"General"}),r.jsx(F,{value:"exterior",children:"Exterior"}),r.jsx(F,{value:"interior",children:"Interior"}),r.jsx(F,{value:"engine",children:"Engine"}),r.jsx(F,{value:"tires",children:"Tires"}),r.jsx(F,{value:"lights",children:"Lights"}),r.jsx(F,{value:"brakes",children:"Brakes"}),r.jsx(F,{value:"fuel",children:"Fuel"}),r.jsx(F,{value:"safety",children:"Safety"}),r.jsx(F,{value:"documentation",children:"Documentation"}),r.jsx(F,{value:"driver",children:"Driver"})]})]})]}),r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx(pe,{id:"edit-is-required",checked:C.is_required,onCheckedChange:a=>N(p=>w(v({},p),{is_required:a}))}),r.jsx($,{htmlFor:"edit-is-required",children:"Required Question"})]}),r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx(pe,{id:"edit-has-photo",checked:C.has_photo,onCheckedChange:a=>N(p=>w(v({},p),{has_photo:a}))}),r.jsx($,{htmlFor:"edit-has-photo",children:"Require Photo"})]}),r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx(pe,{id:"edit-has-notes",checked:C.has_notes,onCheckedChange:a=>N(p=>w(v({},p),{has_notes:a}))}),r.jsx($,{htmlFor:"edit-has-notes",children:"Allow Notes"})]}),r.jsxs("div",{className:"flex justify-end space-x-2",children:[r.jsx(Q,{variant:"outline",onClick:()=>R(!1),children:"Cancel"}),r.jsx(Q,{onClick:Ee,disabled:!C.question||W.isPending,children:W.isPending?"Updating...":"Update Question"})]})]})]})})]})};export{Ii as default};
