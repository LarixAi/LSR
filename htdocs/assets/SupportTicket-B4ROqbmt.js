var K=Object.defineProperty,Q=Object.defineProperties;var D=Object.getOwnPropertyDescriptors;var $=Object.getOwnPropertySymbols;var J=Object.prototype.hasOwnProperty,X=Object.prototype.propertyIsEnumerable;var H=(s,i,n)=>i in s?K(s,i,{enumerable:!0,configurable:!0,writable:!0,value:n}):s[i]=n,C=(s,i)=>{for(var n in i||(i={}))J.call(i,n)&&H(s,n,i[n]);if($)for(var n of $(i))X.call(i,n)&&H(s,n,i[n]);return s},T=(s,i)=>Q(s,D(i));var I=(s,i,n)=>new Promise((u,c)=>{var N=a=>{try{h(n.next(a))}catch(o){c(o)}},x=a=>{try{h(n.throw(a))}catch(o){c(o)}},h=a=>a.done?u(a.value):Promise.resolve(a.value).then(N,x);h((n=n.apply(s,i)).next())});import{j as e}from"./ui-vendor-DMUr7mTx.js";import{r as f}from"./react-vendor-BvqlMsL5.js";import{u as _,s as Z,l as ee,C as v,d as b,e as E,B as y,a as w,b as S,L as p,S as se,q as te,r as ie,t as ae,v as q,I as j,T as re,f as ne,h as oe,i as ce,j as V,k as M}from"./index-ZwIgorfy.js";import{A as le,a as de,b as ue,c as me}from"./accordion-D0yQVAlM.js";import{b as pe,a as he}from"./router-vendor-CEyBJ8vK.js";import{a as xe,b as ge}from"./query-vendor-B2F_wWlc.js";import{J as je,T as F,b7 as W,U as Y,S as P,G as fe,v as B,u as ye,aB as R,F as ve,E as be,av as Ne,b8 as we}from"./icons-vendor-b0I7fGSL.js";import"./supabase-vendor-B984m0TI.js";import"./utils-vendor-B2FlkASS.js";import"./ui-components-7w1-MJre.js";const Se=()=>{const s=xe(),{profile:i}=_();return ge({mutationFn:n=>I(void 0,null,function*(){if(!(i!=null&&i.organization_id))throw new Error("Organization ID is required");const{data:u,error:c}=yield Z.from("support_tickets").insert([T(C({},n),{organization_id:i.organization_id,created_by:i.id})]).select().single();if(c)throw c;return u}),onSuccess:()=>{s.invalidateQueries({queryKey:["support-tickets"]})}})};var ke={};function Ce(){const{profile:s}=_(),{toast:i}=ee(),[n]=pe(),[u,c]=f.useState(!1),[N,x]=f.useState(!1),[h,a]=f.useState(""),o=Se(),[r,g]=f.useState({type:"support",priority:"medium",subject:"",description:"",userEmail:(s==null?void 0:s.email)||"",userName:`${(s==null?void 0:s.first_name)||""} ${(s==null?void 0:s.last_name)||""}`.trim(),userPhone:"",appVersion:"v1.0.0",deviceInfo:`${navigator.userAgent} - ${window.innerWidth}x${window.innerHeight}`,attachments:[]});f.useEffect(()=>{n.get("type")==="suggestion"&&g(l=>T(C({},l),{type:"suggestion"}))},[n]);const G=()=>{const t=Date.now().toString(36),l=Math.random().toString(36).substr(2,5);return`TKT-${t}-${l}`.toUpperCase()},d=(t,l)=>{g(m=>T(C({},m),{[t]:l}))},L=()=>r.subject.trim()?r.description.trim()?r.userEmail.trim()?!0:(i({title:"Missing Email",description:"Please enter your email address.",variant:"destructive"}),!1):(i({title:"Missing Description",description:"Please provide a detailed description of your issue or suggestion.",variant:"destructive"}),!1):(i({title:"Missing Subject",description:"Please enter a subject for your ticket.",variant:"destructive"}),!1),O=(t,l)=>I(this,null,function*(){try{const m={ticket_id:l,type:t.type==="support"?"technical":"feature_request",priority:t.priority==="urgent"?"critical":t.priority,subject:t.subject,description:t.description,user_email:t.userEmail,user_name:t.userName,user_phone:t.userPhone,app_version:t.appVersion,device_info:t.deviceInfo,tags:[t.type]};yield o.mutateAsync(m);try{const k=yield fetch("/functions/v1/send-support-ticket",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${ke.REACT_APP_SUPABASE_ANON_KEY}`},body:JSON.stringify({ticketData:t,ticketId:l})}),z=yield k.json();k.ok||console.warn("Email notification failed:",z.error)}catch(k){console.warn("Email notification failed:",k)}return!0}catch(m){throw console.error("Error creating support ticket:",m),m}}),U=t=>I(this,null,function*(){if(t.preventDefault(),!L())return;c(!0);const l=G();a(l);try{if(yield O(r,l))x(!0),i({title:"Ticket Submitted Successfully",description:`Your ticket (${l}) has been sent to our support team.`});else throw new Error("Failed to send email")}catch(m){console.error("Error submitting ticket:",m),i({title:"Submission Failed",description:"There was an error submitting your ticket. Please try again.",variant:"destructive"})}finally{c(!1)}}),A=()=>{g({type:"support",priority:"medium",subject:"",description:"",userEmail:(s==null?void 0:s.email)||"",userName:`${(s==null?void 0:s.first_name)||""} ${(s==null?void 0:s.last_name)||""}`.trim(),userPhone:"",appVersion:"v1.0.0",deviceInfo:`${navigator.userAgent} - ${window.innerWidth}x${window.innerHeight}`,attachments:[]}),x(!1),a("")};return N?e.jsx("div",{className:"max-w-2xl mx-auto p-6",children:e.jsx(v,{className:"border-green-200 bg-green-50",children:e.jsxs(b,{className:"p-6 text-center",children:[e.jsx(je,{className:"w-16 h-16 text-green-600 mx-auto mb-4"}),e.jsx("h2",{className:"text-2xl font-bold text-green-800 mb-2",children:"Ticket Submitted Successfully!"}),e.jsx("p",{className:"text-green-700 mb-4",children:"Your ticket has been sent to our support team. We'll get back to you soon."}),e.jsxs("div",{className:"bg-white p-4 rounded-lg border mb-4",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Ticket ID:"}),e.jsx(E,{variant:"outline",className:"text-lg font-mono",children:h})]}),e.jsxs("div",{className:"space-y-2 text-sm text-green-700",children:[e.jsx("p",{children:"â€¢ You'll receive a confirmation email shortly"}),e.jsx("p",{children:"â€¢ Our team will respond within the expected timeframe"}),e.jsx("p",{children:"â€¢ Keep this ticket ID for reference"})]}),e.jsx("div",{className:"mt-6 space-x-3",children:e.jsx(y,{onClick:A,variant:"outline",children:"Submit Another Ticket"})})]})})}):e.jsx("div",{className:"max-w-2xl mx-auto p-6",children:e.jsxs(v,{children:[e.jsx(w,{children:e.jsxs(S,{className:"flex items-center space-x-2",children:[r.type==="support"?e.jsx(F,{className:"w-6 h-6 text-red-600"}):e.jsx(W,{className:"w-6 h-6 text-blue-600"}),e.jsx("span",{children:r.type==="support"?"IT Support Request":"Feature Suggestion"})]})}),e.jsx(b,{children:e.jsxs("form",{onSubmit:U,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs(y,{type:"button",variant:r.type==="support"?"default":"outline",className:"h-auto p-4 flex flex-col items-center space-y-2",onClick:()=>d("type","support"),children:[e.jsx(F,{className:"w-6 h-6"}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-medium",children:"IT Support"}),e.jsx("div",{className:"text-xs opacity-70",children:"Report issues or get help"})]})]}),e.jsxs(y,{type:"button",variant:r.type==="suggestion"?"default":"outline",className:"h-auto p-4 flex flex-col items-center space-y-2",onClick:()=>d("type","suggestion"),children:[e.jsx(W,{className:"w-6 h-6"}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-medium",children:"Feature Suggestion"}),e.jsx("div",{className:"text-xs opacity-70",children:"Suggest improvements"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"priority",children:"Priority Level"}),e.jsxs(se,{value:r.priority,onValueChange:t=>d("priority",t),children:[e.jsx(te,{children:e.jsx(ie,{})}),e.jsxs(ae,{children:[e.jsx(q,{value:"low",children:"ðŸŸ¢ Low - General inquiry"}),e.jsx(q,{value:"medium",children:"ðŸŸ¡ Medium - Minor issue"}),e.jsx(q,{value:"high",children:"ðŸŸ  High - Important issue"}),e.jsx(q,{value:"urgent",children:"ðŸ”´ Urgent - Critical issue"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"subject",children:"Subject *"}),e.jsx(j,{id:"subject",value:r.subject,onChange:t=>d("subject",t.target.value),placeholder:r.type==="support"?"Brief description of your issue":"Brief description of your suggestion",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"description",children:"Description *"}),e.jsx(re,{id:"description",value:r.description,onChange:t=>d("description",t.target.value),placeholder:r.type==="support"?"Please provide detailed information about your issue, including steps to reproduce, error messages, and what you were trying to do when the problem occurred.":"Please describe your feature suggestion in detail, including why it would be helpful and how it could improve the app.",rows:6,required:!0})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"font-semibold flex items-center space-x-2",children:[e.jsx(Y,{className:"w-4 h-4"}),e.jsx("span",{children:"Contact Information"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"userName",children:"Name *"}),e.jsx(j,{id:"userName",value:r.userName,onChange:t=>d("userName",t.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"userEmail",children:"Email *"}),e.jsx(j,{id:"userEmail",type:"email",value:r.userEmail,onChange:t=>d("userEmail",t.target.value),required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"userPhone",children:"Phone (Optional)"}),e.jsx(j,{id:"userPhone",type:"tel",value:r.userPhone,onChange:t=>d("userPhone",t.target.value),placeholder:"For urgent issues"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"font-semibold flex items-center space-x-2",children:[e.jsx(P,{className:"w-4 h-4"}),e.jsx("span",{children:"System Information"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"appVersion",children:"App Version"}),e.jsx(j,{id:"appVersion",value:r.appVersion,onChange:t=>d("appVersion",t.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"deviceInfo",children:"Device Info"}),e.jsx(j,{id:"deviceInfo",value:r.deviceInfo,onChange:t=>d("deviceInfo",t.target.value)})]})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx(y,{type:"button",variant:"outline",onClick:A,disabled:u,children:"Reset"}),e.jsx(y,{type:"submit",disabled:u,className:"min-w-[120px]",children:u?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Sending..."]}):e.jsxs(e.Fragment,{children:[e.jsx(fe,{className:"w-4 h-4 mr-2"}),"Submit Ticket"]})})]})]})})]})})}function Me(){const{profile:s}=_(),i=ne(),n=he(),[u,c]=f.useState("help"),N=[{category:"General",items:[{question:"How do I update my profile information?",answer:"Go to Settings > Profile to update your personal information, contact details, and preferences."},{question:"How do I change my password?",answer:"Navigate to Settings > Security to change your password. You'll need to enter your current password for verification."},{question:"What should I do if I forget my password?",answer:"Use the 'Forgot Password' option on the login screen. You'll receive a reset link via email."}]},{category:"Vehicle Checks",items:[{question:"How do I complete a vehicle check?",answer:"Tap the Vehicle Check icon in the navigation bar, then follow the step-by-step checklist. Make sure to complete all required items."},{question:"What if I find a defect during my vehicle check?",answer:"Report any defects immediately through the app. The system will automatically notify the maintenance team."},{question:"Can I save a vehicle check for later?",answer:"Yes, you can save your progress and complete the check later. Your data will be stored locally."}]},{category:"Fuel System",items:[{question:"How do I record a fuel purchase?",answer:"Go to Fuel System > Record Purchase. Enter the fuel amount, cost, and upload a photo of the receipt."},{question:"What if I lose my fuel receipt?",answer:"Contact your supervisor immediately. You may need to provide alternative documentation."},{question:"How do I view my fuel history?",answer:"Navigate to Fuel System > History to view all your recorded fuel purchases and expenses."}]},{category:"Time Management",items:[{question:"How do I clock in and out?",answer:"Use the Time Management feature to clock in when you start work and clock out when you finish."},{question:"What if I forget to clock out?",answer:"Contact your supervisor to manually adjust your time records. Always try to clock out at the end of your shift."},{question:"How do I view my timesheet?",answer:"Go to Time Management > Timesheet to view your work hours, breaks, and total time worked."}]},{category:"Compliance",items:[{question:"How do I check my license status?",answer:"Go to Compliance to view your current license status, expiry dates, and any required renewals."},{question:"What training do I need to complete?",answer:"Check the Training section in Compliance to see required courses and your completion status."},{question:"How do I upload documents?",answer:"Navigate to Documents to upload and manage your licenses, certificates, and other required documents."}]}],x=[{title:"Emergency Support",description:"For urgent issues affecting safety or operations",icon:F,contact:"+1 (555) 123-4567",response:"Immediate response",color:"text-red-600",bgColor:"bg-red-50"},{title:"IT Support",description:"For app issues and technical problems",icon:P,contact:"transport@logisticssolutionresources.com",response:"Within 2 hours",color:"text-blue-600",bgColor:"bg-blue-50"},{title:"General Inquiries",description:"For general questions and information",icon:R,contact:"support@lsr.com",response:"Within 24 hours",color:"text-green-600",bgColor:"bg-green-50"}],h=[{title:"Submit Support Ticket",description:"Report an issue or get help",icon:F,action:()=>c("ticket"),color:"bg-red-500 hover:bg-red-600"},{title:"Feature Suggestion",description:"Suggest improvements",icon:be,action:()=>{c("ticket"),n("/support?type=suggestion")},color:"bg-blue-500 hover:bg-blue-600"},{title:"View Manual",description:"Download user guide",icon:Ne,action:()=>window.open("/manual.pdf","_blank"),color:"bg-purple-500 hover:bg-purple-600"},{title:"Training Videos",description:"Watch tutorial videos",icon:we,action:()=>n("/training-videos"),color:"bg-green-500 hover:bg-green-600"}];return e.jsxs("div",{className:`space-y-6 ${i?"p-4":"p-6"}`,children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"flex items-center justify-center space-x-2 mb-2",children:[e.jsx(B,{className:"w-8 h-8 text-red-600"}),e.jsx("h1",{className:"text-2xl font-bold",children:"Help & Support"})]}),e.jsx("p",{className:"text-muted-foreground",children:"Get assistance with the LSR mobile app"})]}),e.jsxs(oe,{value:u,onValueChange:c,className:"w-full",children:[e.jsxs(ce,{className:"grid w-full grid-cols-2",children:[e.jsxs(V,{value:"help",className:"flex items-center space-x-2",children:[e.jsx(B,{className:"w-4 h-4"}),e.jsx("span",{children:"Help Center"})]}),e.jsxs(V,{value:"ticket",className:"flex items-center space-x-2",children:[e.jsx(ye,{className:"w-4 h-4"}),e.jsx("span",{children:"Submit Ticket"})]})]}),e.jsxs(M,{value:"help",className:"space-y-6",children:[e.jsxs(v,{children:[e.jsx(w,{children:e.jsxs(S,{className:"flex items-center space-x-2",children:[e.jsx(P,{className:"w-5 h-5"}),e.jsx("span",{children:"Quick Actions"})]})}),e.jsx(b,{children:e.jsx("div",{className:"grid grid-cols-2 gap-3",children:h.map((a,o)=>{const r=a.icon;return e.jsxs(y,{variant:"outline",className:"h-auto p-4 flex flex-col items-center space-y-2",onClick:a.action,children:[e.jsx(r,{className:"w-6 h-6"}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-medium text-sm",children:a.title}),e.jsx("div",{className:"text-xs text-muted-foreground",children:a.description})]})]},o)})})})]}),e.jsxs(v,{children:[e.jsx(w,{children:e.jsxs(S,{className:"flex items-center space-x-2",children:[e.jsx(R,{className:"w-5 h-5"}),e.jsx("span",{children:"Contact Support"})]})}),e.jsx(b,{children:e.jsx("div",{className:"space-y-4",children:x.map((a,o)=>{const r=a.icon;return e.jsx("div",{className:`p-4 rounded-lg border ${a.bgColor}`,children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(r,{className:`w-5 h-5 mt-0.5 ${a.color}`}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-sm",children:a.title}),e.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:a.description}),e.jsxs("div",{className:"flex items-center space-x-4 text-sm",children:[e.jsx("span",{className:"font-medium",children:a.contact}),e.jsx(E,{variant:"outline",className:"text-xs",children:a.response})]})]})]})},o)})})})]}),e.jsxs(v,{children:[e.jsx(w,{children:e.jsxs(S,{className:"flex items-center space-x-2",children:[e.jsx(ve,{className:"w-5 h-5"}),e.jsx("span",{children:"Frequently Asked Questions"})]})}),e.jsx(b,{children:e.jsx(le,{type:"single",collapsible:!0,className:"w-full",children:N.map((a,o)=>e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"font-semibold text-lg mb-3 text-gray-800",children:a.category}),a.items.map((r,g)=>e.jsxs(de,{value:`${o}-${g}`,children:[e.jsx(ue,{className:"text-left",children:r.question}),e.jsx(me,{className:"text-muted-foreground",children:r.answer})]},`${o}-${g}`))]},o))})})]}),e.jsxs(v,{className:"bg-gradient-to-r from-blue-50 to-indigo-50",children:[e.jsx(w,{children:e.jsxs(S,{className:"flex items-center space-x-2",children:[e.jsx(Y,{className:"w-5 h-5"}),e.jsx("span",{children:"Your Information"})]})}),e.jsx(b,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Name:"}),e.jsxs("span",{className:"text-sm font-medium",children:[s==null?void 0:s.first_name," ",s==null?void 0:s.last_name]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Role:"}),e.jsx(E,{variant:"secondary",className:"capitalize",children:s==null?void 0:s.role})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"App Version:"}),e.jsx("span",{className:"text-sm font-medium",children:"v1.0.0"})]})]})})]})]}),e.jsx(M,{value:"ticket",children:e.jsx(Ce,{})})]})]})}export{Me as default};
