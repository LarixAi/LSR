var p=(s,d,n)=>new Promise((r,i)=>{var o=a=>{try{c(n.next(a))}catch(t){i(t)}},m=a=>{try{c(n.throw(a))}catch(t){i(t)}},c=a=>a.done?r(a.value):Promise.resolve(a.value).then(o,m);c((n=n.apply(s,d)).next())});import{j as e}from"./ui-vendor-DMUr7mTx.js";import{r as u}from"./react-vendor-BvqlMsL5.js";import{u as f,B as b,A as w,g as y,C as x,a as h,b as g,d as j,e as l}from"./index-ZwIgorfy.js";import{Z as N,I as v,S as C,aG as D,T as S,ao as k,J as I}from"./icons-vendor-b0I7fGSL.js";import"./supabase-vendor-B984m0TI.js";import"./utils-vendor-B2FlkASS.js";import"./query-vendor-B2F_wWlc.js";import"./router-vendor-CEyBJ8vK.js";import"./ui-components-7w1-MJre.js";function $(){const{profile:s}=f(),[d,n]=u.useState([]),[r,i]=u.useState(!1),o=()=>p(this,null,function*(){i(!0);const a=[];a.push({name:"Authentication",status:s?"success":"error",message:s?"User is authenticated":"User is not authenticated",details:s?`User ID: ${s.id}`:"No profile found"}),a.push({name:"Organization ID",status:s!=null&&s.organization_id?"success":"warning",message:s!=null&&s.organization_id?"Organization ID is set":"Organization ID is not set",details:(s==null?void 0:s.organization_id)||"No organization ID found"}),a.push({name:"User Role",status:s!=null&&s.role?"success":"warning",message:s!=null&&s.role?"User role is set":"User role is not set",details:(s==null?void 0:s.role)||"No role found"});try{const t=yield fetch("/");a.push({name:"Development Server",status:t.ok?"success":"error",message:t.ok?"Development server is running":"Development server is not responding",details:`Status: ${t.status}`})}catch(t){a.push({name:"Development Server",status:"error",message:"Cannot connect to development server",details:t instanceof Error?t.message:"Unknown error"})}a.push({name:"Supabase Connection",status:"warning",message:"Supabase connection check disabled in diagnostic mode",details:"This would check if Supabase client is properly configured"}),a.push({name:"Trial Management Hooks",status:"warning",message:"Trial management hooks are disabled in test mode",details:"Hooks are available but not loaded to prevent errors"}),n(a),i(!1)});u.useEffect(()=>{o()},[]);const m=a=>{switch(a){case"success":return e.jsx(I,{className:"h-4 w-4 text-green-500"});case"error":return e.jsx(k,{className:"h-4 w-4 text-red-500"});case"warning":return e.jsx(S,{className:"h-4 w-4 text-yellow-500"});case"loading":return e.jsx(N,{className:"h-4 w-4 text-blue-500 animate-spin"});default:return e.jsx(v,{className:"h-4 w-4 text-gray-500"})}},c=a=>{switch(a){case"success":return e.jsx(l,{variant:"default",className:"bg-green-100 text-green-800",children:"Success"});case"error":return e.jsx(l,{variant:"destructive",children:"Error"});case"warning":return e.jsx(l,{variant:"secondary",className:"bg-yellow-100 text-yellow-800",children:"Warning"});case"loading":return e.jsx(l,{variant:"outline",children:"Loading"});default:return e.jsx(l,{variant:"outline",children:"Unknown"})}};return e.jsxs("div",{className:"container mx-auto p-6 space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"System Diagnostic"}),e.jsx("p",{className:"text-muted-foreground",children:"Check system status and identify issues"})]}),e.jsxs(b,{onClick:o,disabled:r,children:[e.jsx(N,{className:`w-4 h-4 mr-2 ${r?"animate-spin":""}`}),r?"Running...":"Run Diagnostics"]})]}),e.jsxs(w,{children:[e.jsx(v,{className:"h-4 w-4"}),e.jsx("div",{className:"font-medium",children:"Diagnostic Mode"}),e.jsx(y,{children:'This page helps identify what might be causing the "something unexpected happened" error. Run diagnostics to check system components.'})]}),e.jsx("div",{className:"grid gap-4",children:d.map((a,t)=>e.jsxs(x,{children:[e.jsx(h,{children:e.jsxs(g,{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[m(a.status),e.jsx("span",{children:a.name})]}),c(a.status)]})}),e.jsxs(j,{children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:a.message}),a.details&&e.jsx("div",{className:"bg-gray-50 p-3 rounded text-xs font-mono",children:a.details})]})]},t))}),e.jsxs(x,{children:[e.jsx(h,{children:e.jsxs(g,{className:"flex items-center gap-2",children:[e.jsx(C,{className:"h-5 w-5"}),"Profile Information"]})}),e.jsx(j,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"User ID"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:(s==null?void 0:s.id)||"Not available"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Organization ID"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:(s==null?void 0:s.organization_id)||"Not set"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"User Role"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:(s==null?void 0:s.role)||"Not set"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Email"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:(s==null?void 0:s.email)||"Not available"})]})]})})]}),e.jsxs(x,{children:[e.jsx(h,{children:e.jsxs(g,{className:"flex items-center gap-2",children:[e.jsx(D,{className:"h-5 w-5"}),"Next Steps"]})}),e.jsx(j,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"If you see errors:"}),e.jsxs("ul",{className:"text-sm text-muted-foreground space-y-1",children:[e.jsx("li",{children:"• Check if you're logged in properly"}),e.jsx("li",{children:"• Verify your user has an organization_id set"}),e.jsx("li",{children:"• Ensure the development server is running"}),e.jsx("li",{children:"• Check browser console for JavaScript errors"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"If everything looks good:"}),e.jsxs("ul",{className:"text-sm text-muted-foreground space-y-1",children:[e.jsx("li",{children:"• Try accessing the trial test page again"}),e.jsx("li",{children:"• Run the database migration in Supabase"}),e.jsx("li",{children:"• Check if the error persists"})]})]})]})})]})]})}export{$ as default};
