var Ie=Object.defineProperty,Le=Object.defineProperties;var Be=Object.getOwnPropertyDescriptors;var we=Object.getOwnPropertySymbols;var Ue=Object.prototype.hasOwnProperty,$e=Object.prototype.propertyIsEnumerable;var Ce=(a,c,h)=>c in a?Ie(a,c,{enumerable:!0,configurable:!0,writable:!0,value:h}):a[c]=h,m=(a,c)=>{for(var h in c||(c={}))Ue.call(c,h)&&Ce(a,h,c[h]);if(we)for(var h of we(c))$e.call(c,h)&&Ce(a,h,c[h]);return a},T=(a,c)=>Le(a,Be(c));var I=(a,c,h)=>new Promise((f,x)=>{var j=v=>{try{u(h.next(v))}catch(r){x(r)}},F=v=>{try{u(h.throw(v))}catch(r){x(r)}},u=v=>v.done?f(v.value):Promise.resolve(v.value).then(j,F);u((h=h.apply(a,c)).next())});import{j as e}from"./ui-vendor-DMUr7mTx.js";import{r as Q,a as re}from"./react-vendor-BvqlMsL5.js";import{u as oe,s as X,J as U,D as pe,m as ve,n as ge,o as fe,p as Se,L as s,B as y,P as ue,S,q as k,r as D,t as R,v as n,I as g,T as ae,w as A,e as Y,h as He,i as Qe,j as ie,k as te,x as ke,C as V,d as q,a as L,b as B,y as z,c as me,z as Ye}from"./index-ZwIgorfy.js";import{u as ye,a as Ge,b as We,c as De,d as Ke}from"./useVehicles-uD3YILF5.js";import{T as Re,a as Oe,b as ne,c as $,d as qe,e as H}from"./table-6WL4qh3Z.js";import{u as Ae}from"./form-vendor-C09QGZOn.js";import{u as je,a as _e,b as Ne}from"./query-vendor-B2F_wWlc.js";import{u as Je}from"./fileUpload-CIFnm8aI.js";import{F as ee,J as Z,X as Xe,af as Ee,_ as G,k as se,o as Me,j as Te,V as be,aq as Ze,am as Ve,ab as es,aa as ss,aF as Pe,T as le,W as ce,E as de,ak as as,Y as is,S as Fe,aG as ts,m as rs}from"./icons-vendor-b0I7fGSL.js";import{a as ls}from"./router-vendor-CEyBJ8vK.js";import"./supabase-vendor-B984m0TI.js";import"./utils-vendor-B2FlkASS.js";import"./ui-components-7w1-MJre.js";const ns=a=>{const{profile:c}=oe();return je({queryKey:["vehicle-documents",a,c==null?void 0:c.organization_id],queryFn:()=>I(void 0,null,function*(){if(!(c!=null&&c.organization_id)||!a)return[];console.log("Fetching vehicle documents for vehicle:",a);const{data:h,error:f}=yield X.from("documents").select("*").eq("organization_id",c.organization_id).eq("vehicle_id",a).order("created_at",{ascending:!1});return f?(console.error("Error fetching vehicle documents:",f),[]):(console.log("Fetched vehicle documents:",h),h||[])}),enabled:!!(c!=null&&c.organization_id)&&!!a})},cs=()=>{const{profile:a}=oe(),c=_e();return Ne({mutationFn:h=>I(void 0,null,function*(){if(!(a!=null&&a.organization_id)||!(a!=null&&a.id))throw new Error("Organization and user information required");const{data:f,error:x}=yield X.from("documents").insert(T(m({},h),{organization_id:a.organization_id,uploaded_by:a.id})).select().single();if(x)throw x;return f}),onSuccess:(h,f)=>{c.invalidateQueries({queryKey:["vehicle-documents",f.vehicle_id]}),c.invalidateQueries({queryKey:["documents"]}),U.success("Vehicle document uploaded successfully")},onError:h=>{console.error("Error creating vehicle document:",h),U.error("Failed to upload vehicle document: "+h.message)}})},ds=()=>{const a=_e();return Ne({mutationFn:f=>I(void 0,[f],function*({id:c,vehicleId:h}){const{error:x}=yield X.from("documents").delete().eq("id",c);if(x)throw x}),onSuccess:(c,{vehicleId:h})=>{a.invalidateQueries({queryKey:["vehicle-documents",h]}),a.invalidateQueries({queryKey:["documents"]}),U.success("Vehicle document deleted successfully")},onError:c=>{console.error("Error deleting vehicle document:",c),U.error("Failed to delete vehicle document: "+c.message)}})},os=({open:a,onOpenChange:c,vehicleId:h,vehicleNumber:f,allowVehicleSelection:x=!1})=>{const{profile:j}=oe(),F=cs(),{data:u=[]}=ye(),[v,r]=Q.useState(h||""),[_,b]=Q.useState(f||""),[p,d]=Q.useState(null),[P,w]=Q.useState(0),[N,E]=Q.useState(!1),[t,C]=Q.useState({name:"",category:"",description:"",expiryDate:"",tags:"",isConfidential:!1,priority:"medium",department:"",version:"1.0",isFavorite:!1}),W=["Vehicle Registration","Vehicle Insurance","MOT Certificate","Service History","Maintenance Records","Safety Certificate","Compliance Documents","Inspection Reports","Repair Records","Warranty Documents","Other"],K=["Fleet Management","Maintenance","Compliance","Operations","Safety","Administration","Other"],he=l=>{var O;const o=(O=l.target.files)==null?void 0:O[0];if(o){if(o.size>50*1024*1024){U.error("File size must be less than 50MB");return}d(o),t.name||C(M=>T(m({},M),{name:o.name.split(".")[0]}))}},xe=l=>I(void 0,null,function*(){if(l.preventDefault(),!p||!(j!=null&&j.organization_id)){U.error("Please select a file to upload");return}if(!t.name||!t.category){U.error("Please fill in all required fields");return}if(x&&!v){U.error("Please select a vehicle for this document");return}E(!0),w(0);try{w(25);const o=yield Je(p,"documents","vehicle-documents",j.organization_id,j.id);if(!o.success)throw new Error(o.error||"File upload failed");w(75);const O={name:t.name,category:t.category,description:t.description,expiry_date:t.expiryDate||void 0,tags:t.tags?t.tags.split(",").map(M=>M.trim()):[],is_public:!t.isConfidential,file_name:p.name,file_path:o.storagePath,file_type:p.type,file_size:p.size,status:"active",priority:t.priority,department:t.department,version:t.version,is_favorite:t.isFavorite,vehicle_id:v||h,organization_id:j.organization_id,uploaded_by:j.id};yield F.mutateAsync(O),w(100),d(null),C({name:"",category:"",description:"",expiryDate:"",tags:"",isConfidential:!1,priority:"medium",department:"",version:"1.0",isFavorite:!1}),x&&(r(""),b("")),w(0),c(!1)}catch(o){console.error("Error uploading document:",o),U.error("Failed to upload document")}finally{E(!1)}}),i=()=>{N||(d(null),C({name:"",category:"",description:"",expiryDate:"",tags:"",isConfidential:!1,priority:"medium",department:"",version:"1.0",isFavorite:!1}),x&&(r(""),b("")),w(0),c(!1))};return e.jsx(pe,{open:a,onOpenChange:i,children:e.jsxs(ve,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(ge,{children:[e.jsxs(fe,{className:"flex items-center gap-2",children:[e.jsx(ee,{className:"h-5 w-5"}),x?"Upload Vehicle Document":`Upload Document for ${f}`]}),e.jsx(Se,{children:x?"Upload a document and select which vehicle it belongs to":`Upload a document for vehicle ${f}`})]}),e.jsxs("form",{onSubmit:xe,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx(s,{htmlFor:"file",children:"Document File *"}),e.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:border-gray-400 transition-colors",children:[e.jsx("input",{id:"file",type:"file",onChange:he,accept:".pdf,.doc,.docx,.xls,.xlsx,.jpg,.jpeg,.png,.txt",className:"hidden",disabled:N}),e.jsx("label",{htmlFor:"file",className:"cursor-pointer",children:p?e.jsxs("div",{className:"space-y-2",children:[e.jsx(Z,{className:"h-8 w-8 text-green-500 mx-auto"}),e.jsx("p",{className:"font-medium",children:p.name}),e.jsxs("p",{className:"text-sm text-gray-500",children:[(p.size/1024/1024).toFixed(2)," MB"]}),e.jsxs(y,{type:"button",variant:"outline",size:"sm",onClick:()=>d(null),disabled:N,children:[e.jsx(Xe,{className:"h-4 w-4 mr-1"}),"Remove File"]})]}):e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ee,{className:"h-8 w-8 text-gray-400 mx-auto"}),e.jsx("p",{className:"font-medium",children:"Click to select file"}),e.jsx("p",{className:"text-sm text-gray-500",children:"PDF, DOC, XLS, Images, or Text files up to 50MB"})]})})]})]}),N&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Uploading..."}),e.jsxs("span",{children:[P,"%"]})]}),e.jsx(ue,{value:P,className:"w-full"})]}),x&&e.jsxs("div",{className:"col-span-full",children:[e.jsx(s,{htmlFor:"vehicle",children:"Select Vehicle *"}),e.jsxs(S,{value:v,onValueChange:l=>{r(l);const o=u.find(O=>O.id===l);b((o==null?void 0:o.vehicle_number)||"")},disabled:N,children:[e.jsx(k,{children:e.jsx(D,{placeholder:"Choose a vehicle"})}),e.jsx(R,{children:u.map(l=>e.jsxs(n,{value:l.id,children:[l.vehicle_number," - ",l.make," ",l.model," (",l.license_plate,")"]},l.id))})]}),_&&e.jsxs("p",{className:"text-sm text-muted-foreground mt-1",children:["Selected: ",_]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(s,{htmlFor:"name",children:"Document Name *"}),e.jsx(g,{id:"name",value:t.name,onChange:l=>C(o=>T(m({},o),{name:l.target.value})),placeholder:"Enter document name",disabled:N})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"category",children:"Category *"}),e.jsxs(S,{value:t.category,onValueChange:l=>C(o=>T(m({},o),{category:l})),disabled:N,children:[e.jsx(k,{children:e.jsx(D,{placeholder:"Select category"})}),e.jsx(R,{children:W.map(l=>e.jsx(n,{value:l,children:l},l))})]})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"priority",children:"Priority"}),e.jsxs(S,{value:t.priority,onValueChange:l=>C(o=>T(m({},o),{priority:l})),disabled:N,children:[e.jsx(k,{children:e.jsx(D,{})}),e.jsxs(R,{children:[e.jsx(n,{value:"low",children:"Low"}),e.jsx(n,{value:"medium",children:"Medium"}),e.jsx(n,{value:"high",children:"High"}),e.jsx(n,{value:"critical",children:"Critical"})]})]})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"department",children:"Department"}),e.jsxs(S,{value:t.department,onValueChange:l=>C(o=>T(m({},o),{department:l})),disabled:N,children:[e.jsx(k,{children:e.jsx(D,{placeholder:"Select department"})}),e.jsx(R,{children:K.map(l=>e.jsx(n,{value:l,children:l},l))})]})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"expiryDate",children:"Expiry Date"}),e.jsx(g,{id:"expiryDate",type:"date",value:t.expiryDate,onChange:l=>C(o=>T(m({},o),{expiryDate:l.target.value})),disabled:N})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"version",children:"Version"}),e.jsx(g,{id:"version",value:t.version,onChange:l=>C(o=>T(m({},o),{version:l.target.value})),placeholder:"1.0",disabled:N})]})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"tags",children:"Tags"}),e.jsx(g,{id:"tags",value:t.tags,onChange:l=>C(o=>T(m({},o),{tags:l.target.value})),placeholder:"Enter tags separated by commas",disabled:N})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"description",children:"Description"}),e.jsx(ae,{id:"description",value:t.description,onChange:l=>C(o=>T(m({},o),{description:l.target.value})),placeholder:"Enter document description",rows:3,disabled:N})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(A,{id:"isConfidential",checked:t.isConfidential,onCheckedChange:l=>C(o=>T(m({},o),{isConfidential:l})),disabled:N}),e.jsx(s,{htmlFor:"isConfidential",children:"Mark as confidential"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(A,{id:"isFavorite",checked:t.isFavorite,onCheckedChange:l=>C(o=>T(m({},o),{isFavorite:l})),disabled:N}),e.jsx(s,{htmlFor:"isFavorite",children:"Mark as favorite"})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[e.jsx(y,{type:"button",variant:"outline",onClick:i,disabled:N,children:"Cancel"}),e.jsx(y,{type:"submit",disabled:!p||!t.name||!t.category||N,children:N?"Uploading...":"Upload Document"})]})]})]})})},ze=({vehicle:a,open:c,onOpenChange:h,onSuccess:f})=>{const x=Ge(),[j,F]=re.useState(!1),{register:u,handleSubmit:v,reset:r,setValue:_,watch:b,formState:{errors:p,isSubmitting:d}}=Ae({defaultValues:{make:"",model:"",year:new Date().getFullYear(),license_plate:"",vehicle_number:"",vehicle_type:"bus",status:"active",vin:"",capacity:0,fuel_type:"Diesel",mileage:0,orv_off_road_reason:"",orv_expected_return_date:"",orv_location:"",orv_responsible_person:"",orv_insurance_status:"covered",orv_maintenance_type:"planned",bor_return_ready:!1,bor_safety_inspection_complete:!1,bor_documentation_verified:!1,bor_driver_assigned:!1,bor_quality_assurance_complete:!1,bor_return_authorization:"pending"}});re.useEffect(()=>{a&&r({make:a.make||"",model:a.model||"",year:a.year||new Date().getFullYear(),license_plate:a.license_plate||"",vehicle_number:a.vehicle_number||"",vehicle_type:a.type||"bus",status:a.status||"active",vin:a.vin||"",capacity:a.capacity||0,fuel_type:a.fuel_type||"Diesel",mileage:a.mileage||0,orv_off_road_reason:"",orv_expected_return_date:"",orv_location:"",orv_responsible_person:"",orv_insurance_status:"covered",orv_maintenance_type:"planned",bor_return_ready:!1,bor_safety_inspection_complete:!1,bor_documentation_verified:!1,bor_driver_assigned:!1,bor_quality_assurance_complete:!1,bor_return_authorization:"pending"})},[a,r]);const P=t=>I(void 0,null,function*(){if(a){if(!t.make.trim()){z({title:"Validation Error",description:"Make is required",variant:"destructive"});return}if(!t.model.trim()){z({title:"Validation Error",description:"Model is required",variant:"destructive"});return}if(!t.license_plate.trim()){z({title:"Validation Error",description:"License plate is required",variant:"destructive"});return}if(!t.vehicle_number.trim()){z({title:"Validation Error",description:"Vehicle number is required",variant:"destructive"});return}try{yield x.mutateAsync({id:a.id,updates:{make:t.make,model:t.model,year:t.year,license_plate:t.license_plate,vehicle_number:t.vehicle_number,type:t.vehicle_type,status:t.status,capacity:t.capacity,fuel_type:t.fuel_type,mileage:t.mileage}}),z({title:"Success",description:"Vehicle updated successfully!"}),h(!1),f==null||f()}catch(C){console.error("Error updating vehicle:",C),z({title:"Error",description:"Failed to update vehicle. Please try again.",variant:"destructive"})}}}),w=()=>{r(),h(!1)},E=(()=>{if(!a)return{status:"unknown",icon:e.jsx(G,{className:"w-4 h-4 text-gray-400"}),color:"gray"};switch(a.status){case"active":return{status:"Compliant",icon:e.jsx(Z,{className:"w-4 h-4 text-green-600"}),color:"green"};case"maintenance":return{status:"ORV: Maintenance",icon:e.jsx(ce,{className:"w-4 h-4 text-yellow-600"}),color:"yellow"};case"out_of_service":return{status:"ORV: Off Road",icon:e.jsx(le,{className:"w-4 h-4 text-red-600"}),color:"red"};default:return{status:"Unknown",icon:e.jsx(G,{className:"w-4 h-4 text-gray-400"}),color:"gray"}}})();return a?e.jsx(pe,{open:c,onOpenChange:w,children:e.jsxs(ve,{className:"sm:max-w-[900px] max-h-[90vh] overflow-y-auto",children:[e.jsxs(ge,{children:[e.jsxs(fe,{className:"flex items-center gap-2",children:[e.jsx(G,{className:"h-5 w-5"}),"Edit Vehicle - ",a.vehicle_number]}),e.jsxs("div",{className:"text-sm text-muted-foreground flex items-center gap-2",children:["Update vehicle details and ORV & BOR compliance settings",e.jsxs(Y,{variant:"outline",className:`text-${E.color}-600 border-${E.color}-200`,children:[E.icon,E.status]})]})]}),e.jsxs("form",{onSubmit:v(P),className:"space-y-6",children:[e.jsxs(He,{defaultValue:"basic",className:"w-full",children:[e.jsxs(Qe,{className:"grid w-full grid-cols-5",children:[e.jsx(ie,{value:"basic",children:"Basic Info"}),e.jsx(ie,{value:"orv",children:"ORV Status"}),e.jsx(ie,{value:"bor",children:"BOR Status"}),e.jsx(ie,{value:"compliance",children:"Compliance"}),e.jsx(ie,{value:"documents",children:"Documents"})]}),e.jsx(te,{value:"basic",className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(s,{htmlFor:"vehicle_number",children:"Vehicle Number"}),e.jsx(g,m({id:"vehicle_number",placeholder:"e.g., BUS001"},u("vehicle_number",{required:!0}))),p.vehicle_number&&e.jsx("p",{className:"text-sm text-destructive mt-1",children:"Vehicle number is required"})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"license_plate",children:"License Plate"}),e.jsx(g,m({id:"license_plate",placeholder:"e.g., LDN 001A"},u("license_plate",{required:!0}))),p.license_plate&&e.jsx("p",{className:"text-sm text-destructive mt-1",children:"License plate is required"})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"make",children:"Make"}),e.jsx(g,m({id:"make",placeholder:"e.g., Mercedes"},u("make",{required:!0}))),p.make&&e.jsx("p",{className:"text-sm text-destructive mt-1",children:"Make is required"})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"model",children:"Model"}),e.jsx(g,m({id:"model",placeholder:"e.g., Citaro"},u("model",{required:!0}))),p.model&&e.jsx("p",{className:"text-sm text-destructive mt-1",children:"Model is required"})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"year",children:"Year"}),e.jsx(g,m({id:"year",type:"number",placeholder:"e.g., 2023"},u("year",{required:!0,valueAsNumber:!0,min:1900,max:new Date().getFullYear()+1}))),p.year&&e.jsx("p",{className:"text-sm text-destructive mt-1",children:"Valid year is required"})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"capacity",children:"Capacity"}),e.jsx(g,m({id:"capacity",type:"number",placeholder:"e.g., 50"},u("capacity",{valueAsNumber:!0,min:1})))]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"vehicle_type",children:"Vehicle Type"}),e.jsxs(S,{onValueChange:t=>_("vehicle_type",t),defaultValue:b("vehicle_type"),children:[e.jsx(k,{children:e.jsx(D,{placeholder:"Select vehicle type"})}),e.jsxs(R,{children:[e.jsx(n,{value:"bus",children:"Bus"}),e.jsx(n,{value:"coach",children:"Coach"}),e.jsx(n,{value:"hgv",children:"HGV"}),e.jsx(n,{value:"minibus",children:"Minibus"}),e.jsx(n,{value:"double_decker_bus",children:"Double Decker Bus"})]})]})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"status",children:"Status"}),e.jsxs(S,{onValueChange:t=>_("status",t),defaultValue:b("status"),children:[e.jsx(k,{children:e.jsx(D,{placeholder:"Select status"})}),e.jsxs(R,{children:[e.jsx(n,{value:"active",children:"Active"}),e.jsx(n,{value:"maintenance",children:"Maintenance"}),e.jsx(n,{value:"out_of_service",children:"Out of Service"})]})]})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"fuel_type",children:"Fuel Type"}),e.jsxs(S,{onValueChange:t=>_("fuel_type",t),defaultValue:b("fuel_type"),children:[e.jsx(k,{children:e.jsx(D,{placeholder:"Select fuel type"})}),e.jsxs(R,{children:[e.jsx(n,{value:"Diesel",children:"Diesel"}),e.jsx(n,{value:"Petrol",children:"Petrol"}),e.jsx(n,{value:"Electric",children:"Electric"}),e.jsx(n,{value:"Hybrid",children:"Hybrid"}),e.jsx(n,{value:"LPG",children:"LPG"})]})]})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"mileage",children:"Mileage"}),e.jsx(g,m({id:"mileage",type:"number",placeholder:"e.g., 50000"},u("mileage",{valueAsNumber:!0,min:0})))]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx(s,{htmlFor:"vin",children:"VIN (Optional)"}),e.jsx(g,m({id:"vin",placeholder:"Vehicle Identification Number"},u("vin")))]})]})}),e.jsxs(te,{value:"orv",className:"space-y-4",children:[e.jsxs("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(se,{className:"h-4 w-4 text-orange-600"}),e.jsx("span",{className:"font-semibold text-orange-800",children:"ORV (Off-Road Vehicle) Management"})]}),e.jsx("p",{className:"text-sm text-orange-700",children:"Manage off-road vehicle status, documentation, and compliance requirements."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(s,{htmlFor:"orv_off_road_reason",children:"Reason for Off-Road Usage"}),e.jsx(ae,m({id:"orv_off_road_reason",placeholder:"e.g., Scheduled maintenance, Emergency repairs, Operational requirements"},u("orv_off_road_reason")))]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"orv_expected_return_date",children:"Expected Return Date"}),e.jsx(g,m({id:"orv_expected_return_date",type:"date"},u("orv_expected_return_date")))]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"orv_location",children:"Location of Off-Road Usage"}),e.jsx(g,m({id:"orv_location",placeholder:"e.g., Maintenance facility, Storage location"},u("orv_location")))]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"orv_responsible_person",children:"Responsible Person"}),e.jsx(g,m({id:"orv_responsible_person",placeholder:"e.g., Fleet Manager, Maintenance Supervisor"},u("orv_responsible_person")))]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"orv_insurance_status",children:"Insurance Status"}),e.jsxs(S,{onValueChange:t=>_("orv_insurance_status",t),defaultValue:b("orv_insurance_status"),children:[e.jsx(k,{children:e.jsx(D,{placeholder:"Select insurance status"})}),e.jsxs(R,{children:[e.jsx(n,{value:"covered",children:"Covered"}),e.jsx(n,{value:"suspended",children:"Suspended"}),e.jsx(n,{value:"expired",children:"Expired"})]})]})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"orv_maintenance_type",children:"Maintenance Type"}),e.jsxs(S,{onValueChange:t=>_("orv_maintenance_type",t),defaultValue:b("orv_maintenance_type"),children:[e.jsx(k,{children:e.jsx(D,{placeholder:"Select maintenance type"})}),e.jsxs(R,{children:[e.jsx(n,{value:"planned",children:"Planned"}),e.jsx(n,{value:"unplanned",children:"Unplanned"}),e.jsx(n,{value:"operational",children:"Operational"}),e.jsx(n,{value:"regulatory",children:"Regulatory"})]})]})]})]})]}),e.jsxs(te,{value:"bor",className:"space-y-4",children:[e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Me,{className:"h-4 w-4 text-blue-600"}),e.jsx("span",{className:"font-semibold text-blue-800",children:"BOR (Back On Road) Management"})]}),e.jsx("p",{className:"text-sm text-blue-700",children:"Manage vehicle return to service process and compliance verification."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx("div",{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(A,{id:"bor_return_ready",checked:b("bor_return_ready"),onCheckedChange:t=>_("bor_return_ready",t)}),e.jsx(s,{htmlFor:"bor_return_ready",children:"Return Ready"})]})}),e.jsx("div",{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(A,{id:"bor_safety_inspection_complete",checked:b("bor_safety_inspection_complete"),onCheckedChange:t=>_("bor_safety_inspection_complete",t)}),e.jsx(s,{htmlFor:"bor_safety_inspection_complete",children:"Safety Inspection Complete"})]})}),e.jsx("div",{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(A,{id:"bor_documentation_verified",checked:b("bor_documentation_verified"),onCheckedChange:t=>_("bor_documentation_verified",t)}),e.jsx(s,{htmlFor:"bor_documentation_verified",children:"Documentation Verified"})]})}),e.jsx("div",{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(A,{id:"bor_driver_assigned",checked:b("bor_driver_assigned"),onCheckedChange:t=>_("bor_driver_assigned",t)}),e.jsx(s,{htmlFor:"bor_driver_assigned",children:"Driver Assigned"})]})}),e.jsx("div",{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(A,{id:"bor_quality_assurance_complete",checked:b("bor_quality_assurance_complete"),onCheckedChange:t=>_("bor_quality_assurance_complete",t)}),e.jsx(s,{htmlFor:"bor_quality_assurance_complete",children:"Quality Assurance Complete"})]})}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"bor_return_authorization",children:"Return Authorization"}),e.jsxs(S,{onValueChange:t=>_("bor_return_authorization",t),defaultValue:b("bor_return_authorization"),children:[e.jsx(k,{children:e.jsx(D,{placeholder:"Select return authorization status"})}),e.jsxs(R,{children:[e.jsx(n,{value:"pending",children:"Pending"}),e.jsx(n,{value:"approved",children:"Approved"}),e.jsx(n,{value:"rejected",children:"Rejected"})]})]})]})]})]}),e.jsxs(te,{value:"compliance",className:"space-y-4",children:[e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Z,{className:"h-4 w-4 text-green-600"}),e.jsx("span",{className:"font-semibold text-green-800",children:"Compliance Overview"})]}),e.jsx("p",{className:"text-sm text-green-700",children:"View and manage overall compliance status and requirements."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center p-4 border rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:E.icon}),e.jsx("div",{className:"font-semibold mt-2",children:"Current Status"}),e.jsx("div",{className:"text-sm text-gray-600",children:E.status})]}),e.jsxs("div",{className:"text-center p-4 border rounded-lg",children:[e.jsx(Te,{className:"w-8 h-8 mx-auto text-orange-600"}),e.jsx("div",{className:"font-semibold mt-2",children:"ORV Duration"}),e.jsx("div",{className:"text-sm text-gray-600",children:a.status==="active"?"N/A":"Tracked"})]}),e.jsxs("div",{className:"text-center p-4 border rounded-lg",children:[e.jsx(ee,{className:"w-8 h-8 mx-auto text-green-600"}),e.jsx("div",{className:"font-semibold mt-2",children:"Documentation"}),e.jsx("div",{className:"text-sm text-gray-600",children:a.status==="active"?"Complete":"Required"})]})]}),e.jsx(ke,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-semibold",children:"Compliance Checklist"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(A,{id:"check1",checked:a.status==="active",disabled:!0}),e.jsx(s,{htmlFor:"check1",children:"Vehicle Roadworthy"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(A,{id:"check2",checked:a.status==="active",disabled:!0}),e.jsx(s,{htmlFor:"check2",children:"Documentation Current"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(A,{id:"check3",checked:a.status==="active",disabled:!0}),e.jsx(s,{htmlFor:"check3",children:"Insurance Valid"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(A,{id:"check4",checked:a.status==="active",disabled:!0}),e.jsx(s,{htmlFor:"check4",children:"Driver Assigned"})]})]})]})]}),e.jsxs(te,{value:"documents",className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Vehicle Documents"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Manage all documents related to this vehicle"})]}),e.jsxs(y,{onClick:()=>F(!0),children:[e.jsx(Ee,{className:"h-4 w-4 mr-2"}),"Upload Document"]})]}),e.jsx(hs,{vehicleId:a.id,vehicleNumber:a.vehicle_number})]})]}),e.jsxs("div",{className:"flex justify-end space-x-2 pt-4",children:[e.jsx(y,{type:"button",variant:"outline",onClick:w,disabled:d,children:"Cancel"}),e.jsxs(y,{type:"submit",disabled:d,children:[d&&e.jsx(be,{className:"mr-2 h-4 w-4 animate-spin"}),"Update Vehicle"]})]})]}),e.jsx(os,{open:j,onOpenChange:F,vehicleId:a.id,vehicleNumber:a.vehicle_number,allowVehicleSelection:!1})]})}):null},hs=({vehicleId:a,vehicleNumber:c})=>{const{data:h=[],isLoading:f}=ns(a),x=ds(),j=r=>I(void 0,null,function*(){if(confirm("Are you sure you want to delete this document?"))try{yield x.mutateAsync({id:r,vehicleId:a})}catch(_){console.error("Error deleting document:",_)}}),F=r=>{r.file_url?window.open(r.file_url,"_blank"):z.error("Download URL not available")},u=r=>{switch(r){case"active":return"bg-green-100 text-green-800";case"expired":return"bg-red-100 text-red-800";case"pending":return"bg-yellow-100 text-yellow-800";case"archived":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}},v=r=>{switch(r){case"critical":return"bg-red-100 text-red-800";case"high":return"bg-orange-100 text-orange-800";case"medium":return"bg-yellow-100 text-yellow-800";case"low":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}};return f?e.jsxs("div",{className:"flex items-center justify-center py-8",children:[e.jsx(be,{className:"h-6 w-6 animate-spin"}),e.jsx("span",{className:"ml-2",children:"Loading documents..."})]}):h.length===0?e.jsx(V,{children:e.jsxs(q,{className:"flex flex-col items-center justify-center py-8",children:[e.jsx(ee,{className:"h-12 w-12 text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No documents uploaded"}),e.jsx("p",{className:"text-gray-500 text-center mb-4",children:"Upload documents like registration, insurance, MOT certificates, and maintenance records."})]})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs(V,{children:[e.jsx(L,{children:e.jsxs(B,{className:"flex items-center gap-2",children:[e.jsx(ee,{className:"h-5 w-5"}),"Documents (",h.length,")"]})}),e.jsx(q,{children:e.jsxs(Re,{children:[e.jsx(Oe,{children:e.jsxs(ne,{children:[e.jsx($,{children:"Document"}),e.jsx($,{children:"Category"}),e.jsx($,{children:"Status"}),e.jsx($,{children:"Priority"}),e.jsx($,{children:"Uploaded"}),e.jsx($,{children:"Expiry"}),e.jsx($,{className:"text-right",children:"Actions"})]})}),e.jsx(qe,{children:h.map(r=>e.jsxs(ne,{children:[e.jsx(H,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[r.is_favorite&&e.jsx(Ze,{className:"h-4 w-4 text-yellow-500"}),!r.is_public&&e.jsx(Ve,{className:"h-4 w-4 text-red-500"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:r.name}),r.description&&e.jsx("div",{className:"text-sm text-gray-500",children:r.description})]})]})}),e.jsx(H,{children:e.jsx(Y,{variant:"outline",children:r.category})}),e.jsx(H,{children:e.jsx(Y,{className:u(r.status),children:r.status})}),e.jsx(H,{children:r.priority&&e.jsx(Y,{className:v(r.priority),children:r.priority})}),e.jsx(H,{children:e.jsx("div",{className:"text-sm",children:new Date(r.uploaded_at).toLocaleDateString()})}),e.jsx(H,{children:r.expiry_date?e.jsx("div",{className:"text-sm",children:new Date(r.expiry_date).toLocaleDateString()}):e.jsx("span",{className:"text-gray-400",children:"No expiry"})}),e.jsx(H,{className:"text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx(y,{variant:"ghost",size:"sm",onClick:()=>F(r),title:"Download",children:e.jsx(es,{className:"h-4 w-4"})}),e.jsx(y,{variant:"ghost",size:"sm",onClick:()=>window.open(r.file_url,"_blank"),title:"View",children:e.jsx(ss,{className:"h-4 w-4"})}),e.jsx(y,{variant:"ghost",size:"sm",onClick:()=>j(r.id),title:"Delete",className:"text-red-600 hover:text-red-700",children:e.jsx(Pe,{className:"h-4 w-4"})})]})})]},r.id))})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(V,{children:e.jsx(q,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ee,{className:"h-5 w-5 text-blue-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold",children:h.length}),e.jsx("div",{className:"text-sm text-gray-600",children:"Total Documents"})]})]})})}),e.jsx(V,{children:e.jsx(q,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Z,{className:"h-5 w-5 text-green-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold",children:h.filter(r=>r.status==="active").length}),e.jsx("div",{className:"text-sm text-gray-600",children:"Active"})]})]})})}),e.jsx(V,{children:e.jsx(q,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(le,{className:"h-5 w-5 text-red-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold",children:h.filter(r=>r.status==="expired").length}),e.jsx("div",{className:"text-sm text-gray-600",children:"Expired"})]})]})})}),e.jsx(V,{children:e.jsx(q,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ve,{className:"h-5 w-5 text-orange-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold",children:h.filter(r=>!r.is_public).length}),e.jsx("div",{className:"text-sm text-gray-600",children:"Confidential"})]})]})})})]})]})},xs=({open:a,onOpenChange:c,onSuccess:h})=>{const f=We(),{register:x,handleSubmit:j,reset:F,setValue:u,watch:v,formState:{errors:r,isSubmitting:_}}=Ae({defaultValues:{vehicle_number:"",license_plate:"",make:"",model:"",year:new Date().getFullYear(),vin:"",vehicle_type:"bus",fuel_type:"Diesel",color:"",capacity:1,status:"active",purchase_date:"",registration_expiry:"",insurance_expiry:"",service_interval_months:6,notes:"",orv_off_road_reason:"",orv_expected_return_date:"",orv_location:"",orv_responsible_person:"",orv_insurance_status:"covered",orv_maintenance_type:"planned",bor_return_ready:!1,bor_safety_inspection_complete:!1,bor_documentation_verified:!1,bor_driver_assigned:!1,bor_quality_assurance_complete:!1,bor_return_authorization:"pending"}}),b=d=>I(void 0,null,function*(){if(!d.vehicle_number.trim()){z({title:"Validation Error",description:"Vehicle number is required",variant:"destructive"});return}if(!d.license_plate.trim()){z({title:"Validation Error",description:"License plate is required",variant:"destructive"});return}if(d.capacity<1){z({title:"Validation Error",description:"Capacity must be at least 1",variant:"destructive"});return}try{yield f.mutateAsync({vehicle_number:d.vehicle_number,license_plate:d.license_plate,make:d.make||null,model:d.model||null,year:d.year||null,type:d.vehicle_type,fuel_type:d.fuel_type||null,capacity:d.capacity,status:d.status}),z({title:"Success",description:"Vehicle added successfully!"}),c(!1),h==null||h(),F()}catch(P){console.error("Error adding vehicle:",P),z({title:"Error",description:"Failed to add vehicle. Please try again.",variant:"destructive"})}}),p=()=>{F(),c(!1)};return e.jsx(pe,{open:a,onOpenChange:p,children:e.jsxs(ve,{className:"sm:max-w-[800px] max-h-[90vh] overflow-y-auto",children:[e.jsxs(ge,{children:[e.jsxs(fe,{className:"flex items-center gap-2",children:[e.jsx(G,{className:"h-5 w-5"}),"Add New Vehicle"]}),e.jsx(Se,{children:"Register a new vehicle in your fleet management system."})]}),e.jsxs("form",{onSubmit:j(b),className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Basic Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(s,{htmlFor:"vehicle_number",children:"Vehicle Number *"}),e.jsx(g,m({id:"vehicle_number",placeholder:"e.g., BUS001"},x("vehicle_number",{required:!0}))),r.vehicle_number&&e.jsx("p",{className:"text-sm text-destructive mt-1",children:"Vehicle number is required"})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"license_plate",children:"License Plate *"}),e.jsx(g,m({id:"license_plate",placeholder:"e.g., LDN 001A"},x("license_plate",{required:!0}))),r.license_plate&&e.jsx("p",{className:"text-sm text-destructive mt-1",children:"License plate is required"})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"capacity",children:"Passenger Capacity *"}),e.jsx(g,m({id:"capacity",type:"number",placeholder:"Number of seats"},x("capacity",{required:!0,valueAsNumber:!0,min:1}))),r.capacity&&e.jsx("p",{className:"text-sm text-destructive mt-1",children:"Valid capacity is required"})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"vehicle_type",children:"Vehicle Type *"}),e.jsxs(S,{onValueChange:d=>u("vehicle_type",d),defaultValue:v("vehicle_type"),children:[e.jsx(k,{children:e.jsx(D,{placeholder:"Select vehicle type"})}),e.jsxs(R,{children:[e.jsx(n,{value:"Bus",children:"Bus"}),e.jsx(n,{value:"Coach",children:"Coach"}),e.jsx(n,{value:"HGV",children:"HGV"}),e.jsx(n,{value:"Minibus",children:"Minibus"}),e.jsx(n,{value:"Van",children:"Van"})]})]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Vehicle Specifications"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(s,{htmlFor:"make",children:"Make"}),e.jsx(g,m({id:"make",placeholder:"e.g., Mercedes"},x("make")))]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"model",children:"Model"}),e.jsx(g,m({id:"model",placeholder:"e.g., Citaro"},x("model")))]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"year",children:"Year"}),e.jsx(g,m({id:"year",type:"number",placeholder:"e.g., 2023"},x("year",{valueAsNumber:!0,min:1900,max:new Date().getFullYear()+1})))]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"color",children:"Color"}),e.jsx(g,m({id:"color",placeholder:"e.g., White"},x("color")))]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"fuel_type",children:"Fuel Type"}),e.jsxs(S,{onValueChange:d=>u("fuel_type",d),defaultValue:v("fuel_type"),children:[e.jsx(k,{children:e.jsx(D,{placeholder:"Select fuel type"})}),e.jsxs(R,{children:[e.jsx(n,{value:"Diesel",children:"Diesel"}),e.jsx(n,{value:"Petrol",children:"Petrol"}),e.jsx(n,{value:"Electric",children:"Electric"}),e.jsx(n,{value:"Hybrid",children:"Hybrid"}),e.jsx(n,{value:"CNG",children:"CNG"})]})]})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"vin",children:"VIN (Vehicle Identification Number)"}),e.jsx(g,m({id:"vin",placeholder:"17-character VIN"},x("vin")))]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Compliance & Registration"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(s,{htmlFor:"purchase_date",children:"Purchase Date"}),e.jsx(g,m({id:"purchase_date",type:"date"},x("purchase_date")))]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"registration_expiry",children:"Registration Expiry"}),e.jsx(g,m({id:"registration_expiry",type:"date"},x("registration_expiry")))]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"insurance_expiry",children:"Insurance Expiry"}),e.jsx(g,m({id:"insurance_expiry",type:"date"},x("insurance_expiry")))]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"service_interval_months",children:"Service Interval (Months)"}),e.jsx(g,m({id:"service_interval_months",type:"number",placeholder:"e.g., 6"},x("service_interval_months",{valueAsNumber:!0,min:1})))]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"status",children:"Initial Status"}),e.jsxs(S,{onValueChange:d=>u("status",d),defaultValue:v("status"),children:[e.jsx(k,{children:e.jsx(D,{placeholder:"Select status"})}),e.jsxs(R,{children:[e.jsx(n,{value:"active",children:"Active"}),e.jsx(n,{value:"maintenance",children:"Maintenance"}),e.jsx(n,{value:"out_of_service",children:"Out of Service"})]})]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Off-Road Vehicle Compliance"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(s,{htmlFor:"orv_off_road_reason",children:"Reason for Off-Road Usage"}),e.jsx(ae,m({id:"orv_off_road_reason",placeholder:"e.g., Construction site access, Emergency response, Site survey"},x("orv_off_road_reason")))]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"orv_expected_return_date",children:"Expected Return Date"}),e.jsx(g,m({id:"orv_expected_return_date",type:"date"},x("orv_expected_return_date")))]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"orv_location",children:"Location of Off-Road Usage"}),e.jsx(g,m({id:"orv_location",placeholder:"e.g., 123 Main St, City, Country"},x("orv_location")))]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"orv_responsible_person",children:"Responsible Person"}),e.jsx(g,m({id:"orv_responsible_person",placeholder:"e.g., John Doe, Manager"},x("orv_responsible_person")))]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"orv_insurance_status",children:"Insurance Status"}),e.jsxs(S,{onValueChange:d=>u("orv_insurance_status",d),defaultValue:v("orv_insurance_status"),children:[e.jsx(k,{children:e.jsx(D,{placeholder:"Select insurance status"})}),e.jsxs(R,{children:[e.jsx(n,{value:"covered",children:"Covered"}),e.jsx(n,{value:"suspended",children:"Suspended"}),e.jsx(n,{value:"expired",children:"Expired"})]})]})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"orv_maintenance_type",children:"Maintenance Type"}),e.jsxs(S,{onValueChange:d=>u("orv_maintenance_type",d),defaultValue:v("orv_maintenance_type"),children:[e.jsx(k,{children:e.jsx(D,{placeholder:"Select maintenance type"})}),e.jsxs(R,{children:[e.jsx(n,{value:"planned",children:"Planned"}),e.jsx(n,{value:"unplanned",children:"Unplanned"}),e.jsx(n,{value:"operational",children:"Operational"}),e.jsx(n,{value:"regulatory",children:"Regulatory"})]})]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Back On Road Compliance"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(s,{htmlFor:"bor_return_ready",children:"Return Ready"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(A,{id:"bor_return_ready",checked:v("bor_return_ready"),onCheckedChange:d=>u("bor_return_ready",d)}),e.jsx(s,{htmlFor:"bor_return_ready",children:"Return Ready"})]})]}),e.jsx("div",{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(A,{id:"bor_safety_inspection_complete",checked:v("bor_safety_inspection_complete"),onCheckedChange:d=>u("bor_safety_inspection_complete",d)}),e.jsx(s,{htmlFor:"bor_safety_inspection_complete",children:"Safety Inspection Complete"})]})}),e.jsx("div",{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(A,{id:"bor_documentation_verified",checked:v("bor_documentation_verified"),onCheckedChange:d=>u("bor_documentation_verified",d)}),e.jsx(s,{htmlFor:"bor_documentation_verified",children:"Documentation Verified"})]})}),e.jsx("div",{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(A,{id:"bor_driver_assigned",checked:v("bor_driver_assigned"),onCheckedChange:d=>u("bor_driver_assigned",d)}),e.jsx(s,{htmlFor:"bor_driver_assigned",children:"Driver Assigned"})]})}),e.jsx("div",{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(A,{id:"bor_quality_assurance_complete",checked:v("bor_quality_assurance_complete"),onCheckedChange:d=>u("bor_quality_assurance_complete",d)}),e.jsx(s,{htmlFor:"bor_quality_assurance_complete",children:"Quality Assurance Complete"})]})}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"bor_return_authorization",children:"Return Authorization"}),e.jsxs(S,{onValueChange:d=>u("bor_return_authorization",d),defaultValue:v("bor_return_authorization"),children:[e.jsx(k,{children:e.jsx(D,{placeholder:"Select return authorization status"})}),e.jsxs(R,{children:[e.jsx(n,{value:"pending",children:"Pending"}),e.jsx(n,{value:"approved",children:"Approved"}),e.jsx(n,{value:"rejected",children:"Rejected"})]})]})]})]})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"notes",children:"Additional Notes"}),e.jsx(ae,m({id:"notes",placeholder:"Any additional information about the vehicle..."},x("notes")))]}),e.jsxs("div",{className:"flex justify-end space-x-2 pt-4 border-t",children:[e.jsx(y,{type:"button",variant:"outline",onClick:p,disabled:_,children:"Cancel"}),e.jsxs(y,{type:"submit",disabled:_,children:[_&&e.jsx(be,{className:"mr-2 h-4 w-4 animate-spin"}),"Add Vehicle"]})]})]})]})})},ms=()=>{const{data:a=[],isLoading:c,error:h}=ye(),f=De(),[x,j]=re.useState(null),[F,u]=re.useState(null),[v,r]=re.useState(!1),_=p=>I(void 0,null,function*(){try{yield f.mutateAsync(p.id),U.success("Vehicle deleted successfully"),u(null)}catch(d){console.error("Error deleting vehicle:",d),U.error("Failed to delete vehicle")}}),b=p=>{const d=p.status||"active";switch(d){case"active":return e.jsxs(Y,{variant:"default",className:"bg-green-100 text-green-800 border-green-200",children:[e.jsx(Z,{className:"w-3 h-3 mr-1"}),"Active"]});case"maintenance":return e.jsxs(Y,{variant:"outline",className:"text-yellow-600 border-yellow-200",children:[e.jsx(ce,{className:"w-3 h-3 mr-1"}),"ORV: Maintenance"]});case"out_of_service":return e.jsxs(Y,{variant:"destructive",className:"bg-red-100 text-red-800 border-red-200",children:[e.jsx(le,{className:"w-3 h-3 mr-1"}),"ORV: Off Road"]});default:return e.jsxs(Y,{variant:"secondary",children:[e.jsx(G,{className:"w-3 h-3 mr-1"}),d]})}};return c?e.jsx(V,{children:e.jsxs(L,{children:[e.jsx(B,{children:"Vehicles"}),e.jsx(me,{children:"Loading vehicles..."})]})}):h?e.jsx(V,{children:e.jsxs(L,{children:[e.jsx(B,{children:"Vehicles"}),e.jsxs(me,{children:["Error loading vehicles: ",h.message]})]})}):e.jsxs(e.Fragment,{children:[e.jsxs(V,{children:[e.jsxs(L,{children:[e.jsx(B,{children:"Vehicle Fleet"}),e.jsx(me,{children:"Manage your vehicle fleet with ORV & BOR roadworthiness compliance tracking"})]}),e.jsx(q,{children:a.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(G,{className:"mx-auto h-12 w-12 text-gray-400"}),e.jsx("h3",{className:"mt-2 text-sm font-semibold text-gray-900",children:"No vehicles"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Get started by adding your first vehicle to the fleet."}),e.jsx("div",{className:"mt-6",children:e.jsxs(y,{onClick:()=>r(!0),children:[e.jsx(de,{className:"mr-2 h-4 w-4"}),"Add Vehicle"]})})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(se,{className:"h-4 w-4 text-orange-600"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"ORV: Off-Road Vehicle | BOR: Back On Road"})]}),e.jsxs(y,{onClick:()=>r(!0),children:[e.jsx(de,{className:"mr-2 h-4 w-4"}),"Add Vehicle"]})]}),e.jsx("div",{className:"border rounded-lg",children:e.jsxs(Re,{children:[e.jsx(Oe,{children:e.jsxs(ne,{children:[e.jsx($,{children:"Vehicle"}),e.jsx($,{children:"Type"}),e.jsx($,{children:"Status"}),e.jsx($,{children:"Capacity"}),e.jsx($,{children:"Actions"})]})}),e.jsx(qe,{children:a.map(p=>e.jsxs(ne,{children:[e.jsx(H,{children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:p.vehicle_number}),e.jsx("div",{className:"text-sm text-gray-500",children:p.license_plate}),e.jsxs("div",{className:"text-xs text-gray-400",children:[p.make," ",p.model," (",p.year,")"]})]})}),e.jsx(H,{children:e.jsx(Y,{variant:"outline",className:"capitalize",children:p.type||"bus"})}),e.jsx(H,{children:b(p)}),e.jsx(H,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium",children:p.capacity||0}),e.jsx("span",{className:"text-xs text-gray-500",children:"seats"})]})}),e.jsx(H,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(y,{variant:"outline",size:"sm",onClick:()=>j(p),children:e.jsx(as,{className:"h-4 w-4"})}),e.jsx(y,{variant:"outline",size:"sm",onClick:()=>u(p),children:e.jsx(Pe,{className:"h-4 w-4"})})]})})]},p.id))})]})}),e.jsx("div",{className:"text-xs text-gray-500 text-center",children:e.jsxs("div",{className:"flex items-center justify-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Z,{className:"w-3 h-3 text-green-600"}),e.jsx("span",{children:"Active"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ce,{className:"w-3 h-3 text-yellow-600"}),e.jsx("span",{children:"ORV: Maintenance"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(le,{className:"w-3 h-3 text-red-600"}),e.jsx("span",{children:"ORV: Off Road"})]})]})})]})})]}),e.jsx(xs,{open:v,onOpenChange:r,onSuccess:()=>{r(!1)}}),e.jsx(ze,{vehicle:x,open:!!x,onOpenChange:p=>{p||j(null)},onSuccess:()=>{j(null)}}),F&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Delete Vehicle"}),e.jsxs("p",{className:"text-gray-600 mb-6",children:["Are you sure you want to delete ",F.vehicle_number,"? This action cannot be undone."]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx(y,{variant:"outline",onClick:()=>u(null),disabled:f.isPending,children:"Cancel"}),e.jsx(y,{variant:"destructive",onClick:()=>_(F),disabled:f.isPending,children:f.isPending?"Deleting...":"Delete"})]})]})})]})},us=()=>{const{profile:a}=oe(),{selectedOrganizationId:c}=Ye(),h=_e(),[f,x]=Q.useState(1),[j,F]=Q.useState({vehicle_number:"",make:"",model:"",year:"",license_plate:"",vin:"",fuel_type:"",transmission:"",color:"",mileage:"",notes:""}),[u,v]=Q.useState([]),[r,_]=Q.useState([]),{data:b=[],isLoading:p}=je({queryKey:["inspection-templates",c],queryFn:()=>I(void 0,null,function*(){if(!c)return[];const{data:i,error:l}=yield X.from("inspection_templates").select("*").eq("organization_id",c).eq("is_active",!0).order("frequency_days",{ascending:!0});return l?(console.error("Error fetching templates:",l),[]):i}),enabled:!!c}),{data:d=[]}=je({queryKey:["drivers",c],queryFn:()=>I(void 0,null,function*(){if(!c)return[];const{data:i,error:l}=yield X.from("profiles").select("id, first_name, last_name, email").eq("organization_id",c).eq("role","driver").order("first_name");return l?(console.error("Error fetching drivers:",l),[]):i}),enabled:!!c}),P=Ne({mutationFn:()=>I(void 0,null,function*(){if(!c||!(a!=null&&a.id))throw new Error("Missing organization or user data");const{data:i,error:l}=yield X.from("vehicles").insert(T(m({},j),{organization_id:c,created_by:a.id,status:"active"})).select().single();if(l)throw l;const o=u.map(J=>X.from("inspection_schedules").insert({vehicle_id:i.id,template_id:J.template_id,scheduled_date:J.next_inspection_date,assigned_driver_id:J.assigned_driver_id,notes:J.notes,organization_id:c,status:"scheduled"}));if((yield Promise.all(o)).filter(J=>J.error).length>0)throw yield X.from("vehicles").delete().eq("id",i.id),new Error("Failed to create inspection schedules");return i}),onSuccess:()=>{U.success("Vehicle created successfully with inspection schedules!"),h.invalidateQueries(["vehicles"]),h.invalidateQueries(["inspection-schedules"]),F({vehicle_number:"",make:"",model:"",year:"",license_plate:"",vin:"",fuel_type:"",transmission:"",color:"",mileage:"",notes:""}),v([]),_([]),x(1)},onError:i=>{U.error(`Failed to create vehicle: ${i.message}`)}}),w=(i,l)=>{F(o=>T(m({},o),{[i]:l}))},N=i=>{_(l=>{if(l.includes(i))return v(O=>O.filter(M=>M.template_id!==i)),l.filter(O=>O!==i);{const O=b.find(M=>M.id===i);if(O){const M=new Date;M.setDate(M.getDate()+O.frequency_days),v(J=>[...J,{template_id:i,frequency_days:O.frequency_days,next_inspection_date:M.toISOString().split("T")[0],notes:`Initial ${O.name} schedule`}])}return[...l,i]}})},E=(i,l,o)=>{v(O=>O.map(M=>M.template_id===i?T(m({},M),{[l]:o}):M))},t=i=>i===1?"Daily":i===7?"Weekly":i===28?"4-Weekly":i===42?"6-Weekly":`Every ${i} days`,C=()=>j.vehicle_number&&j.make&&j.model&&j.license_plate,W=()=>r.length>0&&u.every(i=>i.next_inspection_date),K=()=>{f===1&&C()&&x(2)},he=()=>{f===2&&x(1)},xe=()=>{W()&&P.mutate()};return p?e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto"}),e.jsx("p",{className:"text-muted-foreground",children:"Loading inspection templates..."})]})}):e.jsxs("div",{className:"container mx-auto px-4 py-8 max-w-4xl",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Add New Vehicle"}),e.jsx("p",{className:"text-gray-600",children:"Create a new vehicle and set up its inspection schedules"})]}),e.jsx("div",{className:"flex items-center justify-center mb-8",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:`flex items-center justify-center w-10 h-10 rounded-full border-2 ${f>=1?"bg-primary text-primary-foreground border-primary":"bg-gray-100 border-gray-300"}`,children:e.jsx(G,{className:"w-5 h-5"})}),e.jsx("div",{className:`h-1 w-16 ${f>=2?"bg-primary":"bg-gray-300"}`}),e.jsx("div",{className:`flex items-center justify-center w-10 h-10 rounded-full border-2 ${f>=2?"bg-primary text-primary-foreground border-primary":"bg-gray-100 border-gray-300"}`,children:e.jsx(se,{className:"w-5 h-5"})})]})}),f===1&&e.jsxs(V,{children:[e.jsx(L,{children:e.jsxs(B,{className:"flex items-center space-x-2",children:[e.jsx(G,{className:"w-5 h-5"}),e.jsx("span",{children:"Vehicle Information"})]})}),e.jsxs(q,{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(s,{htmlFor:"vehicle_number",children:"Vehicle Number *"}),e.jsx(g,{id:"vehicle_number",value:j.vehicle_number,onChange:i=>w("vehicle_number",i.target.value),placeholder:"e.g., V001"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(s,{htmlFor:"license_plate",children:"License Plate *"}),e.jsx(g,{id:"license_plate",value:j.license_plate,onChange:i=>w("license_plate",i.target.value),placeholder:"e.g., ABC123"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(s,{htmlFor:"make",children:"Make *"}),e.jsx(g,{id:"make",value:j.make,onChange:i=>w("make",i.target.value),placeholder:"e.g., Ford"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(s,{htmlFor:"model",children:"Model *"}),e.jsx(g,{id:"model",value:j.model,onChange:i=>w("model",i.target.value),placeholder:"e.g., Transit"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(s,{htmlFor:"year",children:"Year"}),e.jsx(g,{id:"year",value:j.year,onChange:i=>w("year",i.target.value),placeholder:"e.g., 2023"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(s,{htmlFor:"vin",children:"VIN"}),e.jsx(g,{id:"vin",value:j.vin,onChange:i=>w("vin",i.target.value),placeholder:"Vehicle Identification Number"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(s,{htmlFor:"fuel_type",children:"Fuel Type"}),e.jsxs(S,{value:j.fuel_type,onValueChange:i=>w("fuel_type",i),children:[e.jsx(k,{children:e.jsx(D,{placeholder:"Select fuel type"})}),e.jsxs(R,{children:[e.jsx(n,{value:"diesel",children:"Diesel"}),e.jsx(n,{value:"petrol",children:"Petrol"}),e.jsx(n,{value:"electric",children:"Electric"}),e.jsx(n,{value:"hybrid",children:"Hybrid"}),e.jsx(n,{value:"lpg",children:"LPG"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(s,{htmlFor:"transmission",children:"Transmission"}),e.jsxs(S,{value:j.transmission,onValueChange:i=>w("transmission",i),children:[e.jsx(k,{children:e.jsx(D,{placeholder:"Select transmission"})}),e.jsxs(R,{children:[e.jsx(n,{value:"manual",children:"Manual"}),e.jsx(n,{value:"automatic",children:"Automatic"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(s,{htmlFor:"color",children:"Color"}),e.jsx(g,{id:"color",value:j.color,onChange:i=>w("color",i.target.value),placeholder:"e.g., White"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(s,{htmlFor:"mileage",children:"Current Mileage"}),e.jsx(g,{id:"mileage",value:j.mileage,onChange:i=>w("mileage",i.target.value),placeholder:"e.g., 50000"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(s,{htmlFor:"notes",children:"Notes"}),e.jsx(ae,{id:"notes",value:j.notes,onChange:i=>w("notes",i.target.value),placeholder:"Additional notes about the vehicle...",rows:3})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(y,{onClick:K,disabled:!C(),className:"bg-primary hover:bg-primary/90",children:["Next: Setup Inspections",e.jsx(se,{className:"w-4 h-4 ml-2"})]})})]})]}),f===2&&e.jsxs(V,{children:[e.jsxs(L,{children:[e.jsxs(B,{className:"flex items-center space-x-2",children:[e.jsx(se,{className:"w-5 h-5"}),e.jsx("span",{children:"Inspection Schedule Setup"})]}),e.jsx("p",{className:"text-sm text-gray-600 mt-2",children:"Select the inspection types that apply to this vehicle and set up their schedules"})]}),e.jsxs(q,{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Available Inspection Types"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:b.map(i=>e.jsx("div",{className:"border rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(A,{checked:r.includes(i.id),onCheckedChange:()=>N(i.id)}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium",children:i.name}),e.jsx("p",{className:"text-sm text-gray-600",children:i.description}),e.jsx(Y,{variant:"outline",className:"mt-2",children:t(i.frequency_days)})]})]})},i.id))})]}),e.jsx(ke,{}),r.length>0&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Inspection Schedules"}),e.jsx("div",{className:"space-y-4",children:u.map(i=>{const l=b.find(o=>o.id===i.template_id);return e.jsxs(V,{className:"p-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(s,{className:"text-sm font-medium",children:"Inspection Type"}),e.jsx("p",{className:"text-sm text-gray-600",children:l==null?void 0:l.name})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:`date-${i.template_id}`,className:"text-sm font-medium",children:"Next Inspection Date *"}),e.jsx(g,{id:`date-${i.template_id}`,type:"date",value:i.next_inspection_date,onChange:o=>E(i.template_id,"next_inspection_date",o.target.value),min:new Date().toISOString().split("T")[0]})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:`driver-${i.template_id}`,className:"text-sm font-medium",children:"Assigned Driver"}),e.jsxs(S,{value:i.assigned_driver_id||"",onValueChange:o=>E(i.template_id,"assigned_driver_id",o||null),children:[e.jsx(k,{children:e.jsx(D,{placeholder:"Select driver"})}),e.jsxs(R,{children:[e.jsx(n,{value:"",children:"No driver assigned"}),d.map(o=>e.jsxs(n,{value:o.id,children:[o.first_name," ",o.last_name]},o.id))]})]})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx(s,{htmlFor:`notes-${i.template_id}`,className:"text-sm font-medium",children:"Notes"}),e.jsx(ae,{id:`notes-${i.template_id}`,value:i.notes||"",onChange:o=>E(i.template_id,"notes",o.target.value),placeholder:"Additional notes for this inspection schedule...",rows:2})]})]},i.template_id)})})]}),r.length===0&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx(is,{className:"h-12 w-12 text-yellow-500 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Inspection Types Selected"}),e.jsx("p",{className:"text-gray-600",children:"Please select at least one inspection type above to continue."})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(y,{variant:"outline",onClick:he,children:"Back to Vehicle Info"}),e.jsx(y,{onClick:xe,disabled:!W()||P.isPending,className:"bg-primary hover:bg-primary/90",children:P.isPending?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Creating Vehicle..."]}):e.jsxs(e.Fragment,{children:[e.jsx(de,{className:"w-4 h-4 mr-2"}),"Create Vehicle with Inspections"]})})]})]})]})]})};function ks(){const[a,c]=Q.useState(null),[h,f]=Q.useState(!1),x=ls(),{data:j=[],isLoading:F,error:u}=ye(),v=Ke(),r=De(),_=()=>{f(!0)},b=()=>I(this,null,function*(){if(confirm("Are you sure you want to delete ALL vehicles? This action cannot be undone."))try{for(const K of j)yield r.mutateAsync(K.id);z({title:"Success!",description:"All vehicles have been removed from your fleet."})}catch(K){console.error("Error clearing vehicles:",K),z({title:"Error",description:"Failed to clear all vehicles. Please try again.",variant:"destructive"})}}),p=()=>{x("/vehicle-settings")},d=v.total,P=v.active,w=v.maintenance,N=v.out_of_service,E=d>0?Math.round(P/d*100):0,t=d>0?Math.round((d-N)/d*100):0,C=w+N,W=Math.floor(C*.3);return u?e.jsxs("div",{className:"space-y-6",children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Vehicle Management"}),e.jsx(V,{children:e.jsx(q,{className:"p-8",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("p",{className:"text-destructive",children:["Error loading vehicles: ",u.message]}),e.jsx(y,{onClick:()=>window.location.reload(),className:"mt-4",children:"Try Again"})]})})})]}):h?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Vehicle Management"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Fleet management with ORV & BOR roadworthiness compliance"})]}),e.jsx(y,{variant:"outline",onClick:()=>f(!1),children:"Back to Vehicle List"})]}),e.jsx(us,{})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Vehicle Management"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Fleet management with ORV & BOR roadworthiness compliance"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(y,{onClick:p,variant:"outline",className:"inline-flex items-center",children:[e.jsx(Fe,{className:"mr-2 h-4 w-4"}),"Fleet Settings"]}),j.length>0&&e.jsxs(y,{onClick:b,variant:"destructive",className:"inline-flex items-center",disabled:r.isPending,children:[e.jsx(ts,{className:"mr-2 h-4 w-4"}),r.isPending?"Clearing...":"Clear All Vehicles"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs(V,{className:"border-orange-200 bg-orange-50 vehicle-card",children:[e.jsxs(L,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsxs(B,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(se,{className:"h-4 w-4 text-orange-600"}),"ORV (Off-Road Vehicle) Status"]}),e.jsxs(Y,{variant:C>0?"destructive":"default",className:"badge",children:[C," Off-Road"]})]}),e.jsx(q,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Compliance Rate"}),e.jsxs("span",{className:"font-semibold",children:[E,"%"]})]}),e.jsx(ue,{value:E,className:"h-2"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs text-gray-600",children:[e.jsxs("div",{children:["Maintenance: ",w]}),e.jsxs("div",{children:["Out of Service: ",N]})]})]})})]}),e.jsxs(V,{className:"border-blue-200 bg-blue-50 vehicle-card",children:[e.jsxs(L,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsxs(B,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(Me,{className:"h-4 w-4 text-blue-600"}),"BOR (Back On Road) Status"]}),e.jsxs(Y,{variant:W>0?"default":"secondary",className:"badge",children:[W," Returning Soon"]})]}),e.jsx(q,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Return Readiness"}),e.jsxs("span",{className:"font-semibold",children:[t,"%"]})]}),e.jsx(ue,{value:t,className:"h-2"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs text-gray-600",children:[e.jsxs("div",{children:["Ready to Return: ",W]}),e.jsxs("div",{children:["In Process: ",C-W]})]})]})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs(V,{className:"stats-card",children:[e.jsxs(L,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(B,{className:"text-sm font-medium stats-label",children:"Total Vehicles"}),e.jsx(G,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(q,{children:[e.jsx("div",{className:"text-2xl font-bold stats-number",children:d}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1 stats-label",children:"Fleet size"})]})]}),e.jsxs(V,{className:"stats-card",children:[e.jsxs(L,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(B,{className:"text-sm font-medium stats-label",children:"Active"}),e.jsx(Z,{className:"h-4 w-4 text-green-600"})]}),e.jsxs(q,{children:[e.jsx("div",{className:"text-2xl font-bold stats-number",children:P}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1 stats-label",children:[d>0?Math.round(P/d*100):0,"% of fleet"]})]})]}),e.jsxs(V,{className:"stats-card",children:[e.jsxs(L,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(B,{className:"text-sm font-medium stats-label",children:"In Maintenance"}),e.jsx(ce,{className:"h-4 w-4 text-yellow-600"})]}),e.jsxs(q,{children:[e.jsx("div",{className:"text-2xl font-bold stats-number",children:w}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1 stats-label",children:"ORV: Planned/Unplanned"})]})]}),e.jsxs(V,{children:[e.jsxs(L,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(B,{className:"text-sm font-medium",children:"Out of Service"}),e.jsx(le,{className:"h-4 w-4 text-red-600"})]}),e.jsxs(q,{children:[e.jsx("div",{className:"text-2xl font-bold",children:N}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"ORV: Regulatory/Operational"})]})]})]}),j.length>0&&e.jsxs(V,{children:[e.jsx(L,{children:e.jsx(B,{className:"text-lg",children:"Compliance Quick Actions"})}),e.jsx(q,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs(y,{variant:"outline",className:"h-auto p-4 flex flex-col items-center gap-2",children:[e.jsx(ee,{className:"h-6 w-6 text-blue-600"}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-semibold",children:"ORV Documentation"}),e.jsx("div",{className:"text-xs text-gray-600",children:"Manage off-road declarations"})]})]}),e.jsxs(y,{variant:"outline",className:"h-auto p-4 flex flex-col items-center gap-2",children:[e.jsx(Te,{className:"h-6 w-6 text-orange-600"}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-semibold",children:"BOR Return Process"}),e.jsx("div",{className:"text-xs text-gray-600",children:"Vehicle return to service"})]})]}),e.jsxs(y,{variant:"outline",className:"h-auto p-4 flex flex-col items-center gap-2",children:[e.jsx(rs,{className:"h-6 w-6 text-green-600"}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-semibold",children:"Compliance Reports"}),e.jsx("div",{className:"text-xs text-gray-600",children:"View compliance analytics"})]})]})]})})]}),!F&&j.length===0?e.jsx(V,{children:e.jsx(q,{className:"p-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx(G,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No Vehicles Found"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"You haven't added any vehicles to your fleet yet. Start by adding your first vehicle with mandatory inspection schedules to get started with vehicle management and ORV/BOR compliance tracking."}),e.jsxs("div",{className:"flex gap-2 justify-center",children:[e.jsxs(y,{onClick:_,className:"inline-flex items-center",children:[e.jsx(de,{className:"mr-2 h-4 w-4"}),"Add Your First Vehicle"]}),e.jsxs(y,{onClick:p,variant:"outline",className:"inline-flex items-center",children:[e.jsx(Fe,{className:"mr-2 h-4 w-4"}),"Configure Fleet Settings"]})]})]})})}):e.jsx(ms,{}),e.jsx(ze,{vehicle:a,open:!!a,onOpenChange:K=>!K&&c(null),onSuccess:()=>{c(null)}})]})}export{ks as default};
