var Me=Object.defineProperty,Pe=Object.defineProperties;var Ue=Object.getOwnPropertyDescriptors;var pe=Object.getOwnPropertySymbols;var Be=Object.prototype.hasOwnProperty,Ie=Object.prototype.propertyIsEnumerable;var ge=(u,c,o)=>c in u?Me(u,c,{enumerable:!0,configurable:!0,writable:!0,value:o}):u[c]=o,x=(u,c)=>{for(var o in c||(c={}))Be.call(c,o)&&ge(u,o,c[o]);if(pe)for(var o of pe(c))Ie.call(c,o)&&ge(u,o,c[o]);return u},m=(u,c)=>Pe(u,Ue(c));var G=(u,c,o)=>new Promise((v,b)=>{var V=a=>{try{F(o.next(a))}catch(C){b(C)}},S=a=>{try{F(o.throw(a))}catch(C){b(C)}},F=a=>a.done?v(a.value):Promise.resolve(a.value).then(V,S);F((o=o.apply(u,c)).next())});import{j as e}from"./ui-vendor-DMUr7mTx.js";import{r as p}from"./react-vendor-BvqlMsL5.js";import{u as _e,s as be,z as ze,B as _,C as T,a as I,b as z,d as E,L as l,I as w,S as g,q as f,r as y,t as N,v as t,h as Ke,i as Qe,j as W,k as Ge,e as L,D as J,m as X,n as Y,o as Z,p as $,T as K,G as O,y as k}from"./index-ZwIgorfy.js";import{a as Je,u as Ce}from"./query-vendor-B2F_wWlc.js";import{N as fe}from"./router-vendor-CEyBJ8vK.js";import{E as Xe,F as ye,W as Ye,T as Ne,D as Ze,a2 as $e,aa as Oe,ak as es,aF as ss}from"./icons-vendor-b0I7fGSL.js";import"./supabase-vendor-B984m0TI.js";import"./utils-vendor-B2FlkASS.js";import"./ui-components-7w1-MJre.js";const ts=(u,c,o)=>{_e(),Je();const{data:v=[],isLoading:b,error:V}=Ce({queryKey:["work-orders",u,c,o],queryFn:()=>G(void 0,null,function*(){if(!u)return[];try{let a=be.from("work_orders").select(`
            *,
            vehicle:vehicles!work_orders_vehicle_id_fkey(id, vehicle_number, make, model, license_plate),
            assigned_mechanic:profiles!work_orders_assigned_mechanic_id_fkey(id, first_name, last_name, email),
            created_by_profile:profiles!work_orders_created_by_fkey(id, first_name, last_name)
          `).eq("organization_id",u).order("created_at",{ascending:!1});const{data:C,error:n}=yield a;return n?(console.error("Error fetching work orders:",n),[]):C||[]}catch(a){return console.error("Error in work orders query:",a),[]}}),enabled:!!u}),F=(()=>{if(!v||v.length===0)return{total:0,byStatus:{open:0,assigned:0,in_progress:0,on_hold:0,completed:0,cancelled:0},byPriority:{low:0,medium:0,high:0,urgent:0,critical:0},byType:{preventive:0,corrective:0,emergency:0,inspection:0,modification:0,other:0},totalCost:0,totalHours:0,overdue:0};const a={total:v.length,byStatus:{open:0,assigned:0,in_progress:0,on_hold:0,completed:0,cancelled:0},byPriority:{low:0,medium:0,high:0,urgent:0,critical:0},byType:{preventive:0,corrective:0,emergency:0,inspection:0,modification:0,other:0},totalCost:0,totalHours:0,overdue:0},C=new Date;return v.forEach(n=>{n.status&&a.byStatus[n.status]++,n.priority&&a.byPriority[n.priority]++,n.work_type&&a.byType[n.work_type]++,n.total_cost&&(a.totalCost+=n.total_cost),n.actual_hours&&(a.totalHours+=n.actual_hours),n.due_date&&n.status!=="completed"&&n.status!=="cancelled"&&new Date(n.due_date)<C&&a.overdue++}),a})();return{workOrders:v,isLoading:b,error:V,stats:F,hasData:v.length>0}},us=()=>{var de,oe,he,xe,me,ue,je;const{user:u,profile:c,loading:o}=_e(),{selectedOrganizationId:v}=ze(),[b,V]=p.useState("all"),[S,F]=p.useState(""),[a,C]=p.useState("all"),[n,ee]=p.useState("all"),[H,we]=p.useState("all"),[Se,R]=p.useState(!1),[Fe,q]=p.useState(!1),[De,M]=p.useState(!1),[r,Q]=p.useState(null);p.useState(null);const[i,d]=p.useState({title:"",description:"",vehicle_id:"",defect_type:"mechanical",severity:"medium",priority:"medium",location:"",estimated_cost:0,estimated_hours:0,work_notes:""}),{workOrders:ke,isLoading:Te,error:Ee,createWorkOrder:We,updateWorkOrder:Le,deleteWorkOrder:Ve,isCreating:se,isUpdating:te,isDeleting:is,workOrderStats:h}=ts(v),{data:ie=[]}=Ce({queryKey:["vehicles",v],queryFn:()=>G(void 0,null,function*(){if(!v)return[];const{data:s,error:j}=yield be.from("vehicles").select("id, vehicle_number, make, model, license_plate").eq("organization_id",v).order("vehicle_number");return j?(console.error("Error fetching vehicles:",j),[]):s||[]}),enabled:!!v});if(o)return e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-primary mb-4"}),e.jsx("p",{className:"text-lg",children:"Loading work orders..."})]})});if(!u||!c)return e.jsx(fe,{to:"/auth",replace:!0});if(c.role!=="mechanic"&&c.role!=="admin")return e.jsx(fe,{to:"/dashboard",replace:!0});const D=ke.filter(s=>{var A,ve;const j=s.title.toLowerCase().includes(S.toLowerCase())||s.defect_number.toLowerCase().includes(S.toLowerCase())||((ve=(A=s.vehicle)==null?void 0:A.vehicle_number)==null?void 0:ve.toLowerCase().includes(S.toLowerCase())),P=a==="all"||s.severity===a,U=n==="all"||s.status===n,B=H==="all"||s.defect_type===H;return j&&P&&U&&B}),le=s=>{switch(s){case"reported":return D.filter(j=>j.status==="reported");case"investigating":return D.filter(j=>j.status==="investigating");case"repairing":return D.filter(j=>j.status==="repairing");case"resolved":return D.filter(j=>j.status==="resolved");case"closed":return D.filter(j=>j.status==="closed");default:return D}},re=s=>{switch(s){case"reported":return"bg-blue-100 text-blue-800";case"investigating":return"bg-yellow-100 text-yellow-800";case"repairing":return"bg-orange-100 text-orange-800";case"resolved":return"bg-green-100 text-green-800";case"closed":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}},ae=s=>{switch(s){case"critical":return"bg-red-100 text-red-800";case"high":return"bg-orange-100 text-orange-800";case"medium":return"bg-yellow-100 text-yellow-800";case"low":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}},ce=s=>{switch(s){case"safety":return"bg-red-100 text-red-800";case"mechanical":return"bg-blue-100 text-blue-800";case"electrical":return"bg-purple-100 text-purple-800";case"cosmetic":return"bg-gray-100 text-gray-800";case"other":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}},Ae=()=>{if(!i.title||!i.vehicle_id){k({title:"Error",description:"Please fill in all required fields",variant:"destructive"});return}We(i,{onSuccess:()=>{k({title:"Success",description:"Work order created successfully"}),R(!1),d({title:"",description:"",vehicle_id:"",defect_type:"mechanical",severity:"medium",priority:"medium",location:"",estimated_cost:0,estimated_hours:0,work_notes:""})},onError:s=>{k({title:"Error",description:"Failed to create work order",variant:"destructive"})}})},He=()=>{r&&Le({id:r.id,data:i},{onSuccess:()=>{k({title:"Success",description:"Work order updated successfully"}),q(!1),Q(null)},onError:s=>{k({title:"Error",description:"Failed to update work order",variant:"destructive"})}})},Re=s=>{confirm("Are you sure you want to delete this work order?")&&Ve(s,{onSuccess:()=>{k({title:"Success",description:"Work order deleted successfully"})},onError:j=>{k({title:"Error",description:"Failed to delete work order",variant:"destructive"})}})},ne=s=>{Q(s),d({title:s.title,description:s.description||"",vehicle_id:s.vehicle_id,defect_type:s.defect_type,severity:s.severity,priority:s.priority||"medium",location:s.location||"",estimated_cost:s.estimated_cost,estimated_hours:s.estimated_hours||0,work_notes:s.work_notes||""}),q(!0)},qe=s=>{Q(s),M(!0)};return e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Work Orders"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Manage vehicle defects and repairs"})]}),e.jsxs(_,{onClick:()=>R(!0),children:[e.jsx(Xe,{className:"h-4 w-4 mr-2"}),"New Work Order"]})]}),h&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[e.jsxs(T,{children:[e.jsxs(I,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(z,{className:"text-sm font-medium",children:"Total Work Orders"}),e.jsx(ye,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(E,{children:[e.jsx("div",{className:"text-2xl font-bold",children:h.total}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"All time"})]})]}),e.jsxs(T,{children:[e.jsxs(I,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(z,{className:"text-sm font-medium",children:"In Progress"}),e.jsx(Ye,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(E,{children:[e.jsx("div",{className:"text-2xl font-bold",children:h.byStatus.investigating+h.byStatus.repairing}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Investigating & Repairing"})]})]}),e.jsxs(T,{children:[e.jsxs(I,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(z,{className:"text-sm font-medium",children:"Critical Issues"}),e.jsx(Ne,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(E,{children:[e.jsx("div",{className:"text-2xl font-bold",children:h.bySeverity.critical}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Safety priority"})]})]}),e.jsxs(T,{children:[e.jsxs(I,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(z,{className:"text-sm font-medium",children:"Total Cost"}),e.jsx(Ze,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(E,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:["£",h.totalEstimatedCost.toFixed(2)]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Estimated total"})]})]})]}),e.jsx(T,{className:"mb-6",children:e.jsx(E,{className:"p-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"search",children:"Search"}),e.jsxs("div",{className:"relative",children:[e.jsx($e,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(w,{id:"search",placeholder:"Search work orders...",value:S,onChange:s=>F(s.target.value),className:"pl-10"})]})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"severity",children:"Severity"}),e.jsxs(g,{value:a,onValueChange:C,children:[e.jsx(f,{children:e.jsx(y,{placeholder:"All severities"})}),e.jsxs(N,{children:[e.jsx(t,{value:"all",children:"All Severities"}),e.jsx(t,{value:"low",children:"Low"}),e.jsx(t,{value:"medium",children:"Medium"}),e.jsx(t,{value:"high",children:"High"}),e.jsx(t,{value:"critical",children:"Critical"})]})]})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"status",children:"Status"}),e.jsxs(g,{value:n,onValueChange:ee,children:[e.jsx(f,{children:e.jsx(y,{placeholder:"All statuses"})}),e.jsxs(N,{children:[e.jsx(t,{value:"all",children:"All Statuses"}),e.jsx(t,{value:"reported",children:"Reported"}),e.jsx(t,{value:"investigating",children:"Investigating"}),e.jsx(t,{value:"repairing",children:"Repairing"}),e.jsx(t,{value:"resolved",children:"Resolved"}),e.jsx(t,{value:"closed",children:"Closed"})]})]})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"defectType",children:"Defect Type"}),e.jsxs(g,{value:H,onValueChange:we,children:[e.jsx(f,{children:e.jsx(y,{placeholder:"All types"})}),e.jsxs(N,{children:[e.jsx(t,{value:"all",children:"All Types"}),e.jsx(t,{value:"safety",children:"Safety"}),e.jsx(t,{value:"mechanical",children:"Mechanical"}),e.jsx(t,{value:"electrical",children:"Electrical"}),e.jsx(t,{value:"cosmetic",children:"Cosmetic"}),e.jsx(t,{value:"other",children:"Other"})]})]})]})]})})}),e.jsxs(Ke,{value:b,onValueChange:V,className:"space-y-6",children:[e.jsxs(Qe,{className:"grid w-full grid-cols-6",children:[e.jsxs(W,{value:"all",children:["All (",D.length,")"]}),e.jsxs(W,{value:"reported",children:["Reported (",(h==null?void 0:h.byStatus.reported)||0,")"]}),e.jsxs(W,{value:"investigating",children:["Investigating (",(h==null?void 0:h.byStatus.investigating)||0,")"]}),e.jsxs(W,{value:"repairing",children:["Repairing (",(h==null?void 0:h.byStatus.repairing)||0,")"]}),e.jsxs(W,{value:"resolved",children:["Resolved (",(h==null?void 0:h.byStatus.resolved)||0,")"]}),e.jsxs(W,{value:"closed",children:["Closed (",(h==null?void 0:h.byStatus.closed)||0,")"]})]}),e.jsx(Ge,{value:b,className:"space-y-6",children:Te?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-primary mb-4"}),e.jsx("p",{children:"Loading work orders..."})]}):Ee?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Ne,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),e.jsx("p",{className:"text-red-600",children:"Error loading work orders"})]}):le(b).length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(ye,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Work Orders"}),e.jsx("p",{className:"text-gray-600",children:S||a!=="all"||n!=="all"||H!=="all"?"No work orders match your current filters":"No work orders found. Create your first work order to get started."})]}):e.jsx("div",{className:"space-y-4",children:le(b).map(s=>{var j,P,U,B,A;return e.jsx(T,{className:"hover:shadow-md transition-shadow",children:e.jsx(E,{className:"p-6",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[e.jsx("h3",{className:"text-lg font-semibold",children:s.title}),e.jsx(L,{className:re(s.status),children:s.status}),e.jsx(L,{className:ae(s.severity),children:s.severity}),e.jsx(L,{className:ce(s.defect_type),children:s.defect_type})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm text-gray-600 mb-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Defect #:"})," ",s.defect_number]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Vehicle:"})," ",((j=s.vehicle)==null?void 0:j.vehicle_number)||"N/A"]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Reported:"})," ",new Date(s.reported_date).toLocaleDateString()]})]}),s.description&&e.jsx("p",{className:"text-gray-700 mb-4",children:s.description}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Estimated Cost:"})," £",s.estimated_cost.toFixed(2)]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Actual Cost:"})," £",s.actual_cost.toFixed(2)]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Reported By:"})," ",(P=s.reported_by_profile)==null?void 0:P.first_name," ",(U=s.reported_by_profile)==null?void 0:U.last_name]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Assigned To:"})," ",(B=s.assigned_mechanic)==null?void 0:B.first_name," ",(A=s.assigned_mechanic)==null?void 0:A.last_name," || 'Unassigned'"]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2 ml-4",children:[e.jsx(_,{variant:"outline",size:"sm",onClick:()=>qe(s),children:e.jsx(Oe,{className:"h-4 w-4"})}),e.jsx(_,{variant:"outline",size:"sm",onClick:()=>ne(s),children:e.jsx(es,{className:"h-4 w-4"})}),e.jsx(_,{variant:"outline",size:"sm",onClick:()=>Re(s.id),children:e.jsx(ss,{className:"h-4 w-4"})})]})]})})},s.id)})})})]}),e.jsx(J,{open:Se,onOpenChange:R,children:e.jsxs(X,{className:"max-w-2xl",children:[e.jsxs(Y,{children:[e.jsx(Z,{children:"Create New Work Order"}),e.jsx($,{children:"Report a new vehicle defect or maintenance issue"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx(l,{htmlFor:"title",children:"Title *"}),e.jsx(w,{id:"title",value:i.title,onChange:s=>d(m(x({},i),{title:s.target.value})),placeholder:"Brief description of the issue"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx(l,{htmlFor:"description",children:"Description"}),e.jsx(K,{id:"description",value:i.description,onChange:s=>d(m(x({},i),{description:s.target.value})),placeholder:"Detailed description of the problem",rows:3})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"vehicle",children:"Vehicle *"}),e.jsxs(g,{value:i.vehicle_id,onValueChange:s=>d(m(x({},i),{vehicle_id:s})),children:[e.jsx(f,{children:e.jsx(y,{placeholder:"Select vehicle"})}),e.jsx(N,{children:ie.map(s=>e.jsxs(t,{value:s.id,children:[s.vehicle_number," - ",s.make," ",s.model]},s.id))})]})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"defectType",children:"Defect Type"}),e.jsxs(g,{value:i.defect_type,onValueChange:s=>d(m(x({},i),{defect_type:s})),children:[e.jsx(f,{children:e.jsx(y,{})}),e.jsxs(N,{children:[e.jsx(t,{value:"safety",children:"Safety"}),e.jsx(t,{value:"mechanical",children:"Mechanical"}),e.jsx(t,{value:"electrical",children:"Electrical"}),e.jsx(t,{value:"cosmetic",children:"Cosmetic"}),e.jsx(t,{value:"other",children:"Other"})]})]})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"severity",children:"Severity"}),e.jsxs(g,{value:i.severity,onValueChange:s=>d(m(x({},i),{severity:s})),children:[e.jsx(f,{children:e.jsx(y,{})}),e.jsxs(N,{children:[e.jsx(t,{value:"low",children:"Low"}),e.jsx(t,{value:"medium",children:"Medium"}),e.jsx(t,{value:"high",children:"High"}),e.jsx(t,{value:"critical",children:"Critical"})]})]})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"priority",children:"Priority"}),e.jsxs(g,{value:i.priority,onValueChange:s=>d(m(x({},i),{priority:s})),children:[e.jsx(f,{children:e.jsx(y,{})}),e.jsxs(N,{children:[e.jsx(t,{value:"low",children:"Low"}),e.jsx(t,{value:"medium",children:"Medium"}),e.jsx(t,{value:"high",children:"High"}),e.jsx(t,{value:"urgent",children:"Urgent"})]})]})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"location",children:"Location"}),e.jsx(w,{id:"location",value:i.location,onChange:s=>d(m(x({},i),{location:s.target.value})),placeholder:"Where is the issue located?"})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"estimatedCost",children:"Estimated Cost (£)"}),e.jsx(w,{id:"estimatedCost",type:"number",value:i.estimated_cost,onChange:s=>d(m(x({},i),{estimated_cost:parseFloat(s.target.value)||0})),placeholder:"0.00"})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"estimatedHours",children:"Estimated Hours"}),e.jsx(w,{id:"estimatedHours",type:"number",value:i.estimated_hours,onChange:s=>d(m(x({},i),{estimated_hours:parseFloat(s.target.value)||0})),placeholder:"0.0"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx(l,{htmlFor:"workNotes",children:"Work Notes"}),e.jsx(K,{id:"workNotes",value:i.work_notes,onChange:s=>d(m(x({},i),{work_notes:s.target.value})),placeholder:"Additional notes for mechanics",rows:2})]})]}),e.jsxs(O,{children:[e.jsx(_,{variant:"outline",onClick:()=>R(!1),children:"Cancel"}),e.jsx(_,{onClick:Ae,disabled:se,children:se?"Creating...":"Create Work Order"})]})]})}),e.jsx(J,{open:Fe,onOpenChange:q,children:e.jsxs(X,{className:"max-w-2xl",children:[e.jsxs(Y,{children:[e.jsx(Z,{children:"Edit Work Order"}),e.jsx($,{children:"Update work order details"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx(l,{htmlFor:"edit-title",children:"Title *"}),e.jsx(w,{id:"edit-title",value:i.title,onChange:s=>d(m(x({},i),{title:s.target.value})),placeholder:"Brief description of the issue"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx(l,{htmlFor:"edit-description",children:"Description"}),e.jsx(K,{id:"edit-description",value:i.description,onChange:s=>d(m(x({},i),{description:s.target.value})),placeholder:"Detailed description of the problem",rows:3})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"edit-vehicle",children:"Vehicle *"}),e.jsxs(g,{value:i.vehicle_id,onValueChange:s=>d(m(x({},i),{vehicle_id:s})),children:[e.jsx(f,{children:e.jsx(y,{placeholder:"Select vehicle"})}),e.jsx(N,{children:ie.map(s=>e.jsxs(t,{value:s.id,children:[s.vehicle_number," - ",s.make," ",s.model]},s.id))})]})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"edit-defectType",children:"Defect Type"}),e.jsxs(g,{value:i.defect_type,onValueChange:s=>d(m(x({},i),{defect_type:s})),children:[e.jsx(f,{children:e.jsx(y,{})}),e.jsxs(N,{children:[e.jsx(t,{value:"safety",children:"Safety"}),e.jsx(t,{value:"mechanical",children:"Mechanical"}),e.jsx(t,{value:"electrical",children:"Electrical"}),e.jsx(t,{value:"cosmetic",children:"Cosmetic"}),e.jsx(t,{value:"other",children:"Other"})]})]})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"edit-severity",children:"Severity"}),e.jsxs(g,{value:i.severity,onValueChange:s=>d(m(x({},i),{severity:s})),children:[e.jsx(f,{children:e.jsx(y,{})}),e.jsxs(N,{children:[e.jsx(t,{value:"low",children:"Low"}),e.jsx(t,{value:"medium",children:"Medium"}),e.jsx(t,{value:"high",children:"High"}),e.jsx(t,{value:"critical",children:"Critical"})]})]})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"edit-priority",children:"Priority"}),e.jsxs(g,{value:i.priority,onValueChange:s=>d(m(x({},i),{priority:s})),children:[e.jsx(f,{children:e.jsx(y,{})}),e.jsxs(N,{children:[e.jsx(t,{value:"low",children:"Low"}),e.jsx(t,{value:"medium",children:"Medium"}),e.jsx(t,{value:"high",children:"High"}),e.jsx(t,{value:"urgent",children:"Urgent"})]})]})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"edit-location",children:"Location"}),e.jsx(w,{id:"edit-location",value:i.location,onChange:s=>d(m(x({},i),{location:s.target.value})),placeholder:"Where is the issue located?"})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"edit-estimatedCost",children:"Estimated Cost (£)"}),e.jsx(w,{id:"edit-estimatedCost",type:"number",value:i.estimated_cost,onChange:s=>d(m(x({},i),{estimated_cost:parseFloat(s.target.value)||0})),placeholder:"0.00"})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"edit-estimatedHours",children:"Estimated Hours"}),e.jsx(w,{id:"edit-estimatedHours",type:"number",value:i.estimated_hours,onChange:s=>d(m(x({},i),{estimated_hours:parseFloat(s.target.value)||0})),placeholder:"0.0"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx(l,{htmlFor:"edit-workNotes",children:"Work Notes"}),e.jsx(K,{id:"edit-workNotes",value:i.work_notes,onChange:s=>d(m(x({},i),{work_notes:s.target.value})),placeholder:"Additional notes for mechanics",rows:2})]})]}),e.jsxs(O,{children:[e.jsx(_,{variant:"outline",onClick:()=>q(!1),children:"Cancel"}),e.jsx(_,{onClick:He,disabled:te,children:te?"Updating...":"Update Work Order"})]})]})}),e.jsx(J,{open:De,onOpenChange:M,children:e.jsxs(X,{className:"max-w-2xl",children:[e.jsxs(Y,{children:[e.jsx(Z,{children:"Work Order Details"}),e.jsx($,{children:"View complete work order information"})]}),r&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(l,{className:"font-medium",children:"Title"}),e.jsx("p",{className:"text-gray-700",children:r.title})]}),e.jsxs("div",{children:[e.jsx(l,{className:"font-medium",children:"Defect Number"}),e.jsx("p",{className:"text-gray-700",children:r.defect_number})]}),e.jsxs("div",{children:[e.jsx(l,{className:"font-medium",children:"Vehicle"}),e.jsxs("p",{className:"text-gray-700",children:[(de=r.vehicle)==null?void 0:de.vehicle_number," - ",(oe=r.vehicle)==null?void 0:oe.make," ",(he=r.vehicle)==null?void 0:he.model]})]}),e.jsxs("div",{children:[e.jsx(l,{className:"font-medium",children:"Status"}),e.jsx(L,{className:re(r.status),children:r.status})]}),e.jsxs("div",{children:[e.jsx(l,{className:"font-medium",children:"Severity"}),e.jsx(L,{className:ae(r.severity),children:r.severity})]}),e.jsxs("div",{children:[e.jsx(l,{className:"font-medium",children:"Defect Type"}),e.jsx(L,{className:ce(r.defect_type),children:r.defect_type})]}),e.jsxs("div",{children:[e.jsx(l,{className:"font-medium",children:"Reported Date"}),e.jsx("p",{className:"text-gray-700",children:new Date(r.reported_date).toLocaleDateString()})]}),e.jsxs("div",{children:[e.jsx(l,{className:"font-medium",children:"Reported By"}),e.jsxs("p",{className:"text-gray-700",children:[(xe=r.reported_by_profile)==null?void 0:xe.first_name," ",(me=r.reported_by_profile)==null?void 0:me.last_name]})]}),e.jsxs("div",{children:[e.jsx(l,{className:"font-medium",children:"Assigned To"}),e.jsxs("p",{className:"text-gray-700",children:[(ue=r.assigned_mechanic)==null?void 0:ue.first_name," ",(je=r.assigned_mechanic)==null?void 0:je.last_name," || 'Unassigned'"]})]}),e.jsxs("div",{children:[e.jsx(l,{className:"font-medium",children:"Location"}),e.jsx("p",{className:"text-gray-700",children:r.location||"Not specified"})]}),e.jsxs("div",{children:[e.jsx(l,{className:"font-medium",children:"Estimated Cost"}),e.jsxs("p",{className:"text-gray-700",children:["£",r.estimated_cost.toFixed(2)]})]}),e.jsxs("div",{children:[e.jsx(l,{className:"font-medium",children:"Actual Cost"}),e.jsxs("p",{className:"text-gray-700",children:["£",r.actual_cost.toFixed(2)]})]}),e.jsxs("div",{children:[e.jsx(l,{className:"font-medium",children:"Estimated Hours"}),e.jsxs("p",{className:"text-gray-700",children:[r.estimated_hours||0," hours"]})]}),e.jsxs("div",{children:[e.jsx(l,{className:"font-medium",children:"Actual Hours"}),e.jsxs("p",{className:"text-gray-700",children:[r.actual_hours||0," hours"]})]})]}),r.description&&e.jsxs("div",{children:[e.jsx(l,{className:"font-medium",children:"Description"}),e.jsx("p",{className:"text-gray-700",children:r.description})]}),r.work_notes&&e.jsxs("div",{children:[e.jsx(l,{className:"font-medium",children:"Work Notes"}),e.jsx("p",{className:"text-gray-700",children:r.work_notes})]})]}),e.jsxs(O,{children:[e.jsx(_,{variant:"outline",onClick:()=>M(!1),children:"Close"}),r&&e.jsx(_,{onClick:()=>{M(!1),ne(r)},children:"Edit Work Order"})]})]})})]})};export{us as default};
