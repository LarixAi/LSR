var p=(t,c,a)=>new Promise((d,n)=>{var o=e=>{try{r(a.next(e))}catch(l){n(l)}},i=e=>{try{r(a.throw(e))}catch(l){n(l)}},r=e=>e.done?d(e.value):Promise.resolve(e.value).then(o,i);r((a=a.apply(t,c)).next())});import{s as u}from"./index-ZwIgorfy.js";const b=(t,c,a,d,n)=>p(void 0,null,function*(){try{const o=t.name.split(".").pop(),i=`${Date.now()}_${Math.random().toString(36).substring(2)}.${o}`,r=`${a}/${i}`;console.log("Uploading file:",{bucket:c,storagePath:r,fileSize:t.size}),console.log("Checking bucket access...");const{data:e,error:l}=yield u.storage.listBuckets();l?console.error("Bucket list error:",l):console.log("Available buckets:",e==null?void 0:e.map(f=>f.name));const{data:m,error:s}=yield u.storage.from(c).upload(r,t,{cacheControl:"3600",upsert:!1});if(s)return console.error("Upload error:",s),console.error("Upload error details:",{code:s.code,message:s.message,details:s.details,hint:s.hint}),{success:!1,error:s.message};const{data:{publicUrl:g}}=u.storage.from(c).getPublicUrl(r);return console.log("File uploaded successfully:",{storagePath:r,publicUrl:g}),{success:!0,fileUrl:g,storagePath:r}}catch(o){return console.error("File upload failed:",o),{success:!1,error:o instanceof Error?o.message:"Unknown error occurred"}}});export{b as u};
