import{a1 as Te,r as j,j as e,az as ge,E as W,B as c,aq as Ne,am as ve,e as h,k as m,O as Se,Q as Le,V as Y,Y as Z,au as De,I as x,ab as S,ac as L,bC as V,ad as D,ae as A,af as r,n as f,f as Ae,ax as U,bE as Qe,M as Be,ak as ke,an as qe,g as C,h as F,a as $e,D as Ee,Z as Ve,a4 as ce,a5 as ne,a6 as re,a7 as de,q as a,s as fe,X as ie,x as We,m as Ye,at as Ze,b as Ge,i as _e,ag as Ke,a8 as Ce}from"./main-DVuL102c.js";import{T as Xe,a as Je,b as Fe,c as q,d as es,e as E}from"./table-Jjtal2IW.js";import{u as Me,a as Re,b as Oe,c as Ue,d as Ie}from"./useFuelPurchases-D-HO7J6e.js";import{u as ze}from"./useVehicles-DG5ys_xt.js";import{T as He}from"./trash-2-uDLx8yM9.js";import{S as oe}from"./save-D41s1EFm.js";import{p as Pe}from"./parseISO-1k6pJICp.js";import{T as ss}from"./trending-down-DwD0VVi4.js";function ls(){var le,ae,$,d,te,s,w,_;Te();const[xe,he]=j.useState("purchases"),[P,me]=j.useState(""),[M,ue]=j.useState("all"),[T,k]=j.useState(!1),[y,G]=j.useState(null),[u,b]=j.useState(null),{data:g=[],isLoading:K,error:o,refetch:I}=Me(),{data:X=[]}=ze(),z=Re(),J=Oe(),ee=Ue(),{statistics:t}=Ie(),[p,H]=j.useState({vehicle_id:"",fuel_type:"diesel",quantity:0,unit_price:0,total_cost:0,location:"",odometer_reading:0,purchase_date:new Date().toISOString().split("T")[0],notes:""}),se=g.filter(l=>{var v,ye,be,we;const i=((v=l.vehicle_number)==null?void 0:v.toLowerCase().includes(P.toLowerCase()))||((ye=l.license_plate)==null?void 0:ye.toLowerCase().includes(P.toLowerCase()))||((be=l.location)==null?void 0:be.toLowerCase().includes(P.toLowerCase()))||((we=l.notes)==null?void 0:we.toLowerCase().includes(P.toLowerCase())),O=M==="all"||l.fuel_type===M;return i&&O}),R=l=>{switch(l){case"diesel":return e.jsx(f,{variant:"outline",className:"text-blue-600",children:"Diesel"});case"petrol":return e.jsx(f,{variant:"outline",className:"text-green-600",children:"Petrol"});case"electric":return e.jsx(f,{variant:"outline",className:"text-purple-600",children:"Electric"});default:return e.jsx(f,{variant:"outline",children:l})}},n=()=>{H({vehicle_id:"",fuel_type:"diesel",quantity:0,unit_price:0,total_cost:0,location:"",odometer_reading:0,purchase_date:new Date().toISOString().split("T")[0],notes:""}),k(!0)},Q=l=>{G(l),H({vehicle_id:l.vehicle_id,fuel_type:l.fuel_type,quantity:Number(l.quantity),unit_price:Number(l.unit_price),total_cost:Number(l.total_cost),location:l.location||"",odometer_reading:l.odometer_reading||0,purchase_date:l.purchase_date,notes:l.notes||""}),k(!0)},B=l=>{b(l)},je=async l=>{if(confirm("Are you sure you want to delete this fuel purchase?"))try{await ee.mutateAsync(l)}catch{}},pe=async()=>{try{y?await J.mutateAsync({id:y.id,updates:p}):await z.mutateAsync(p),k(!1),G(null)}catch{}},N=(l,i)=>{H(O=>{const v={...O,[l]:i};return(l==="quantity"||l==="unit_price")&&(v.total_cost=Number(v.quantity)*Number(v.unit_price)),v})};return K?e.jsx(ge,{children:e.jsx("div",{className:"flex items-center justify-center min-h-[60vh]",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-primary mb-4"}),e.jsx("p",{className:"text-lg",children:"Loading fuel system..."})]})})}):o?e.jsx(ge,{children:e.jsx("div",{className:"flex items-center justify-center min-h-[60vh]",children:e.jsxs("div",{className:"text-center",children:[e.jsx(W,{className:"w-12 h-12 text-red-500 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-red-900 mb-2",children:"Error Loading Fuel Data"}),e.jsx("p",{className:"text-red-700 mb-4",children:o.message}),e.jsxs(c,{onClick:()=>I(),variant:"outline",children:[e.jsx(Ne,{className:"w-4 h-4 mr-2"}),"Try Again"]})]})})}):e.jsx(ge,{children:e.jsxs("div",{className:"space-y-4 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"Fuel System"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Manage fuel purchases and track consumption"})]}),e.jsxs(c,{size:"sm",className:"ml-4 flex-shrink-0",onClick:n,children:[e.jsx(ve,{className:"w-4 h-4 mr-2"}),"Add Fuel"]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[e.jsx(h,{children:e.jsx(m,{className:"pt-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-primary",children:g.length}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Purchases"})]})})}),e.jsx(h,{children:e.jsx(m,{className:"pt-6",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-green-600",children:["£",((le=t==null?void 0:t.totalSpent)==null?void 0:le.toFixed(2))||"0.00"]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Spent"})]})})}),e.jsx(h,{children:e.jsx(m,{className:"pt-6",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-blue-600",children:[((ae=t==null?void 0:t.totalQuantity)==null?void 0:ae.toFixed(1))||"0.0","L"]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Fuel"})]})})}),e.jsx(h,{children:e.jsx(m,{className:"pt-6",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-orange-600",children:["£",(($=t==null?void 0:t.averagePrice)==null?void 0:$.toFixed(2))||"0.00"]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Avg Price/L"})]})})})]}),e.jsxs(Se,{value:xe,onValueChange:he,className:"w-full",children:[e.jsxs(Le,{className:"grid w-full grid-cols-3 mb-6",children:[e.jsx(Y,{value:"purchases",className:"text-xs",children:"Purchases"}),e.jsx(Y,{value:"analytics",className:"text-xs",children:"Analytics"}),e.jsx(Y,{value:"settings",className:"text-xs",children:"Settings"})]}),e.jsxs(Z,{value:"purchases",className:"space-y-4",children:[e.jsx(h,{className:"mb-6",children:e.jsx(m,{className:"pt-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(De,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx(x,{placeholder:"Search purchases",value:P,onChange:l=>me(l.target.value),className:"pl-10"})]}),e.jsxs(S,{value:M,onValueChange:ue,children:[e.jsxs(L,{children:[e.jsx(V,{className:"w-4 h-4 mr-2"}),e.jsx(D,{placeholder:"Filter by fuel type"})]}),e.jsxs(A,{children:[e.jsx(r,{value:"all",children:"All Types"}),e.jsx(r,{value:"diesel",children:"Diesel"}),e.jsx(r,{value:"petrol",children:"Petrol"}),e.jsx(r,{value:"electric",children:"Electric"})]})]})]})})}),se.length===0?e.jsx(h,{children:e.jsx(m,{className:"pt-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx(V,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No fuel purchases found"}),e.jsx("p",{className:"text-gray-600 mb-4",children:P||M!=="all"?"No purchases match your search criteria":"You haven't recorded any fuel purchases yet"}),e.jsxs(c,{onClick:n,children:[e.jsx(ve,{className:"w-4 h-4 mr-2"}),"Add First Purchase"]})]})})}):e.jsx("div",{className:"space-y-4",children:se.map(l=>{var i;return e.jsx(h,{className:"overflow-hidden",children:e.jsxs(m,{className:"p-4 space-y-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex-1 pr-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 leading-tight",children:l.vehicle_number||"Unknown Vehicle"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:l.license_plate||"No license plate"})]}),e.jsxs("div",{className:"flex flex-col gap-1 flex-shrink-0",children:[R(l.fuel_type),e.jsxs(f,{variant:"outline",className:"text-green-600",children:["£",Number(l.total_cost).toFixed(2)]})]})]}),e.jsxs("div",{className:"space-y-2 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(Ae,{className:"w-4 h-4 text-gray-400"}),U(Pe(l.purchase_date),"MMM dd, yyyy")]}),e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(Qe,{className:"w-4 h-4 text-gray-400"}),((i=l.odometer_reading)==null?void 0:i.toLocaleString())||"N/A"," km"]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(Be,{className:"w-4 h-4 text-gray-400"}),l.location||"Location not specified"]}),e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(V,{className:"w-4 h-4 text-gray-400"}),Number(l.quantity).toFixed(1),"L"]})]})]}),l.notes&&e.jsx("div",{className:"bg-gray-50 rounded-lg p-3",children:e.jsx("p",{className:"text-sm text-gray-600",children:l.notes})}),e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsxs(c,{variant:"outline",size:"sm",onClick:()=>B(l),children:[e.jsx(ke,{className:"w-3 h-3 mr-1"}),"View"]}),e.jsxs(c,{variant:"outline",size:"sm",onClick:()=>Q(l),children:[e.jsx(qe,{className:"w-3 h-3 mr-1"}),"Edit"]}),e.jsxs(c,{variant:"outline",size:"sm",onClick:()=>je(l.id),children:[e.jsx(He,{className:"w-3 h-3 mr-1"}),"Delete"]})]})]})},l.id)})})]}),e.jsx(Z,{value:"analytics",className:"space-y-4",children:e.jsxs(h,{children:[e.jsx(C,{children:e.jsxs(F,{className:"flex items-center gap-2",children:[e.jsx($e,{className:"w-5 h-5 text-blue-600"}),"Fuel Analytics"]})}),e.jsxs(m,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"p-3 bg-blue-50 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-blue-800 mb-1",children:"Monthly Average"}),e.jsxs("p",{className:"text-2xl font-bold text-blue-600",children:["£",((d=t==null?void 0:t.monthlyAverage)==null?void 0:d.toFixed(2))||"0.00"]}),e.jsx("p",{className:"text-sm text-blue-600",children:"per month"})]}),e.jsxs("div",{className:"p-3 bg-green-50 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-green-800 mb-1",children:"Efficiency"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:((te=t==null?void 0:t.averageEfficiency)==null?void 0:te.toFixed(1))||"0.0"}),e.jsx("p",{className:"text-sm text-green-600",children:"km/L"})]}),e.jsxs("div",{className:"p-3 bg-orange-50 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-orange-800 mb-1",children:"Best Price"}),e.jsxs("p",{className:"text-2xl font-bold text-orange-600",children:["£",((s=t==null?void 0:t.bestPricePerLiter)==null?void 0:s.toFixed(2))||"0.00"]}),e.jsx("p",{className:"text-sm text-orange-600",children:"per liter"})]}),e.jsxs("div",{className:"p-3 bg-purple-50 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-purple-800 mb-1",children:"Total Distance"}),e.jsx("p",{className:"text-2xl font-bold text-purple-600",children:((w=t==null?void 0:t.totalDistance)==null?void 0:w.toFixed(0))||"0"}),e.jsx("p",{className:"text-sm text-purple-600",children:"km"})]})]}),e.jsxs(c,{className:"w-full mt-4",children:[e.jsx(Ee,{className:"w-4 h-4 mr-2"}),"Export Analytics Report"]})]})]})}),e.jsx(Z,{value:"settings",className:"space-y-4",children:e.jsxs(h,{children:[e.jsx(C,{children:e.jsxs(F,{className:"flex items-center gap-2",children:[e.jsx(Ve,{className:"w-5 h-5 text-yellow-600"}),"Fuel System Settings"]})}),e.jsxs(m,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-3 bg-yellow-50 rounded-lg border-l-4 border-yellow-400",children:[e.jsx("h4",{className:"font-medium text-yellow-800 mb-2",children:"Fuel Alerts"}),e.jsxs("ul",{className:"text-sm text-yellow-700 space-y-1",children:[e.jsx("li",{children:"• Low fuel level notifications"}),e.jsx("li",{children:"• Price change alerts"}),e.jsx("li",{children:"• Maintenance reminders"})]})]}),e.jsxs("div",{className:"p-3 bg-blue-50 rounded-lg border-l-4 border-blue-400",children:[e.jsx("h4",{className:"font-medium text-blue-800 mb-2",children:"Data Management"}),e.jsxs("ul",{className:"text-sm text-blue-700 space-y-1",children:[e.jsx("li",{children:"• Auto-sync with vehicle systems"}),e.jsx("li",{children:"• Backup fuel purchase history"}),e.jsx("li",{children:"• Export data for reporting"})]})]}),e.jsxs("div",{className:"p-3 bg-green-50 rounded-lg border-l-4 border-green-400",children:[e.jsx("h4",{className:"font-medium text-green-800 mb-2",children:"Preferences"}),e.jsxs("ul",{className:"text-sm text-green-700 space-y-1",children:[e.jsx("li",{children:"• Default fuel type"}),e.jsx("li",{children:"• Preferred fuel stations"}),e.jsx("li",{children:"• Currency settings"})]})]})]}),e.jsxs(c,{className:"w-full mt-4",children:[e.jsx(oe,{className:"w-4 h-4 mr-2"}),"Save Settings"]})]})]})})]}),e.jsx(ce,{open:T,onOpenChange:k,children:e.jsxs(ne,{className:"max-w-md",children:[e.jsx(re,{children:e.jsx(de,{children:y?"Edit Fuel Purchase":"Add New Fuel Purchase"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(a,{htmlFor:"vehicle",children:"Vehicle"}),e.jsxs(S,{value:p.vehicle_id,onValueChange:l=>N("vehicle_id",l),children:[e.jsx(L,{children:e.jsx(D,{placeholder:"Select vehicle"})}),e.jsx(A,{children:X.map(l=>e.jsxs(r,{value:l.id,children:[l.vehicle_number," - ",l.license_plate]},l.id))})]})]}),e.jsxs("div",{children:[e.jsx(a,{htmlFor:"fuel_type",children:"Fuel Type"}),e.jsxs(S,{value:p.fuel_type,onValueChange:l=>N("fuel_type",l),children:[e.jsx(L,{children:e.jsx(D,{})}),e.jsxs(A,{children:[e.jsx(r,{value:"diesel",children:"Diesel"}),e.jsx(r,{value:"petrol",children:"Petrol"}),e.jsx(r,{value:"electric",children:"Electric"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(a,{htmlFor:"quantity",children:"Quantity (L)"}),e.jsx(x,{id:"quantity",type:"number",step:"0.1",value:p.quantity,onChange:l=>N("quantity",parseFloat(l.target.value)||0)})]}),e.jsxs("div",{children:[e.jsx(a,{htmlFor:"unit_price",children:"Unit Price (£)"}),e.jsx(x,{id:"unit_price",type:"number",step:"0.01",value:p.unit_price,onChange:l=>N("unit_price",parseFloat(l.target.value)||0)})]})]}),e.jsxs("div",{children:[e.jsx(a,{htmlFor:"total_cost",children:"Total Cost (£)"}),e.jsx(x,{id:"total_cost",type:"number",step:"0.01",value:p.total_cost,onChange:l=>N("total_cost",parseFloat(l.target.value)||0)})]}),e.jsxs("div",{children:[e.jsx(a,{htmlFor:"location",children:"Location"}),e.jsx(x,{id:"location",value:p.location,onChange:l=>N("location",l.target.value),placeholder:"Fuel station name"})]}),e.jsxs("div",{children:[e.jsx(a,{htmlFor:"odometer",children:"Odometer Reading (km)"}),e.jsx(x,{id:"odometer",type:"number",value:p.odometer_reading,onChange:l=>N("odometer_reading",parseInt(l.target.value)||0)})]}),e.jsxs("div",{children:[e.jsx(a,{htmlFor:"purchase_date",children:"Purchase Date"}),e.jsx(x,{id:"purchase_date",type:"date",value:p.purchase_date,onChange:l=>N("purchase_date",l.target.value)})]}),e.jsxs("div",{children:[e.jsx(a,{htmlFor:"notes",children:"Notes"}),e.jsx(fe,{id:"notes",value:p.notes,onChange:l=>N("notes",l.target.value),placeholder:"Additional notes..."})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(c,{onClick:pe,className:"flex-1",children:[e.jsx(oe,{className:"w-4 h-4 mr-2"}),y?"Update":"Save"]}),e.jsxs(c,{variant:"outline",onClick:()=>k(!1),children:[e.jsx(ie,{className:"w-4 h-4 mr-2"}),"Cancel"]})]})]})]})}),e.jsx(ce,{open:!!u,onOpenChange:()=>b(null),children:e.jsxs(ne,{className:"max-w-md",children:[e.jsx(re,{children:e.jsx(de,{children:"Fuel Purchase Details"})}),u&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Vehicle:"}),e.jsx("p",{children:u.vehicle_number})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"License Plate:"}),e.jsx("p",{children:u.license_plate})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Fuel Type:"}),e.jsx("p",{children:R(u.fuel_type)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Quantity:"}),e.jsxs("p",{children:[Number(u.quantity).toFixed(1),"L"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Unit Price:"}),e.jsxs("p",{children:["£",Number(u.unit_price).toFixed(2)]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Total Cost:"}),e.jsxs("p",{children:["£",Number(u.total_cost).toFixed(2)]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Location:"}),e.jsx("p",{children:u.location||"Not specified"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Odometer:"}),e.jsxs("p",{children:[((_=u.odometer_reading)==null?void 0:_.toLocaleString())||"N/A"," km"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Date:"}),e.jsx("p",{children:U(Pe(u.purchase_date),"MMM dd, yyyy")})]})]}),u.notes&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Notes:"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:u.notes})]})]})]})})]})})}const xs=()=>{const xe=We(),{profile:he,loading:P}=Ye(),{toast:me}=Te(),[M,ue]=j.useState("new-purchase"),[T,k]=j.useState(""),[y,G]=j.useState("all"),[u,b]=j.useState(!1),[g,K]=j.useState(null),[o,I]=j.useState(null),{data:X=[],isLoading:z,error:J,refetch:ee}=Me(),{data:t=[]}=ze(),p=Re(),H=Oe(),se=Ue(),{statistics:R}=Ie(),[n,Q]=j.useState({vehicle_id:"",fuel_type:"diesel",quantity:0,unit_price:0,total_cost:0,location:"",odometer_reading:0,purchase_date:new Date().toISOString().split("T")[0],notes:""});if(xe)return e.jsx(ls,{});if(P||z)return e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-primary mb-4"}),e.jsx("p",{className:"text-lg",children:"Loading fuel system..."})]})});if(!he)return e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsxs("div",{className:"text-center",children:[e.jsx(W,{className:"w-12 h-12 text-red-500 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-red-900 mb-2",children:"Authentication Required"}),e.jsx("p",{className:"text-red-700",children:"Please log in to access the fuel system."})]})});if(J)return e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsxs("div",{className:"text-center",children:[e.jsx(W,{className:"w-12 h-12 text-red-500 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-red-900 mb-2",children:"Error Loading Fuel Data"}),e.jsx("p",{className:"text-red-700 mb-4",children:J.message}),e.jsxs(c,{onClick:()=>ee(),variant:"outline",children:[e.jsx(Ne,{className:"w-4 h-4 mr-2"}),"Try Again"]})]})});const B=X.filter(s=>{var l,i,O,v;const w=((l=s.vehicle_number)==null?void 0:l.toLowerCase().includes(T.toLowerCase()))||((i=s.license_plate)==null?void 0:i.toLowerCase().includes(T.toLowerCase()))||((O=s.location)==null?void 0:O.toLowerCase().includes(T.toLowerCase()))||((v=s.notes)==null?void 0:v.toLowerCase().includes(T.toLowerCase())),_=y==="all"||s.fuel_type===y;return w&&_}),je=s=>{switch(s){case"diesel":return e.jsx(f,{variant:"outline",className:"text-blue-600",children:"Diesel"});case"petrol":return e.jsx(f,{variant:"outline",className:"text-green-600",children:"Petrol"});case"electric":return e.jsx(f,{variant:"outline",className:"text-purple-600",children:"Electric"});default:return e.jsx(f,{variant:"outline",children:s})}},pe=()=>{Q({vehicle_id:"",fuel_type:"diesel",quantity:0,unit_price:0,total_cost:0,location:"",odometer_reading:0,purchase_date:new Date().toISOString().split("T")[0],notes:""}),b(!0)},N=s=>{K(s),Q({vehicle_id:s.vehicle_id,fuel_type:s.fuel_type,quantity:Number(s.quantity),unit_price:Number(s.unit_price),total_cost:Number(s.total_cost),location:s.location||"",odometer_reading:s.odometer_reading||0,purchase_date:s.purchase_date,notes:s.notes||""}),b(!0)},le=s=>{I(s)},ae=async s=>{if(confirm("Are you sure you want to delete this fuel purchase?"))try{await se.mutateAsync(s)}catch{}},$=async()=>{try{g?await H.mutateAsync({id:g.id,updates:n}):await p.mutateAsync(n),b(!1),K(null)}catch{}},d=(s,w)=>{Q(_=>{const l={..._,[s]:w};return(s==="quantity"||s==="unit_price")&&(l.total_cost=Number(l.quantity)*Number(l.unit_price)),l})},te=()=>{const s=[["Date","Vehicle","License Plate","Fuel Type","Quantity (L)","Unit Price (£)","Total Cost (£)","Location","Odometer","Notes"],...B.map(i=>[i.purchase_date,i.vehicle_number||"",i.license_plate||"",i.fuel_type,i.quantity,i.unit_price,i.total_cost,i.location||"",i.odometer_reading||"",i.notes||""])].map(i=>i.join(",")).join(`
`),w=new Blob([s],{type:"text/csv"}),_=window.URL.createObjectURL(w),l=document.createElement("a");l.href=_,l.download=`fuel-purchases-${new Date().toISOString().split("T")[0]}.csv`,l.click(),window.URL.revokeObjectURL(_),me({title:"Export Successful",description:"Fuel purchase data exported to CSV"})};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Fuel System"}),e.jsx("p",{className:"text-muted-foreground",children:"Record fuel purchases and track consumption"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(c,{onClick:()=>ee(),variant:"outline",size:"sm",disabled:z,children:[e.jsx(Ne,{className:`w-4 h-4 mr-2 ${z?"animate-spin":""}`}),"Refresh"]}),e.jsxs(c,{onClick:te,variant:"outline",size:"sm",children:[e.jsx(Ee,{className:"w-4 h-4 mr-2"}),"Export"]}),e.jsxs(c,{onClick:pe,children:[e.jsx(ve,{className:"w-4 h-4 mr-2"}),"Add Purchase"]})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[e.jsxs(h,{children:[e.jsxs(C,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(F,{className:"text-sm font-medium",children:"Total Spent"}),e.jsx(Ze,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(m,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:["£",R.totalSpent.toFixed(2)]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"This month"})]})]}),e.jsxs(h,{children:[e.jsxs(C,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(F,{className:"text-sm font-medium",children:"Total Fuel"}),e.jsx(V,{className:"h-4 w-4 text-blue-600"})]}),e.jsxs(m,{children:[e.jsxs("div",{className:"text-2xl font-bold text-blue-600",children:[R.totalQuantity.toFixed(1),"L"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Liters purchased"})]})]}),e.jsxs(h,{children:[e.jsxs(C,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(F,{className:"text-sm font-medium",children:"Avg Price"}),e.jsx(Ge,{className:"h-4 w-4 text-green-600"})]}),e.jsxs(m,{children:[e.jsxs("div",{className:"text-2xl font-bold text-green-600",children:["£",R.averagePrice.toFixed(2)]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Per liter"})]})]}),e.jsxs(h,{children:[e.jsxs(C,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(F,{className:"text-sm font-medium",children:"Purchases"}),e.jsx(Ae,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(m,{children:[e.jsx("div",{className:"text-2xl font-bold",children:X.length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"This month"})]})]})]}),e.jsxs(Se,{value:M,onValueChange:ue,className:"space-y-4",children:[e.jsxs(Le,{className:"grid w-full grid-cols-2",children:[e.jsx(Y,{value:"new-purchase",children:"New Purchase"}),e.jsx(Y,{value:"history",children:"Purchase History"})]}),e.jsxs(Z,{value:"new-purchase",className:"space-y-4",children:[e.jsxs(h,{children:[e.jsxs(C,{children:[e.jsxs(F,{className:"flex items-center space-x-2",children:[e.jsx(V,{className:"w-5 h-5"}),e.jsx("span",{children:"Record Fuel Purchase"})]}),e.jsx(_e,{children:"Add a new fuel purchase for your assigned vehicle"})]}),e.jsxs(m,{className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"vehicle",children:"Select Vehicle"}),e.jsxs(S,{onValueChange:s=>d("vehicle_id",s),value:n.vehicle_id,children:[e.jsx(L,{children:e.jsx(D,{placeholder:"Choose your vehicle"})}),e.jsx(A,{children:t.map(s=>e.jsxs(r,{value:s.id,children:[s.vehicle_number," - ",s.license_plate]},s.id))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"fuel-type",children:"Fuel Type"}),e.jsxs(S,{onValueChange:s=>d("fuel_type",s),value:n.fuel_type,children:[e.jsx(L,{children:e.jsx(D,{placeholder:"Select fuel type"})}),e.jsxs(A,{children:[e.jsx(r,{value:"diesel",children:"Diesel"}),e.jsx(r,{value:"petrol",children:"Petrol"}),e.jsx(r,{value:"electric",children:"Electric"})]})]})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"quantity",children:"Quantity (Liters/kWh)"}),e.jsx(x,{id:"quantity",type:"number",placeholder:"0.00",step:"0.1",value:n.quantity,onChange:s=>d("quantity",s.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"unit-price",children:"Unit Price (£)"}),e.jsx(x,{id:"unit-price",type:"number",placeholder:"0.00",step:"0.01",value:n.unit_price,onChange:s=>d("unit_price",s.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"total-cost",children:"Total Cost (£)"}),e.jsx(x,{id:"total-cost",type:"number",placeholder:"0.00",step:"0.01",value:n.total_cost,onChange:s=>d("total_cost",s.target.value)})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"location",children:"Location"}),e.jsx(x,{id:"location",placeholder:"Fuel station name and location",value:n.location,onChange:s=>d("location",s.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"odometer",children:"Odometer Reading"}),e.jsx(x,{id:"odometer",type:"number",placeholder:"Current mileage",value:n.odometer_reading,onChange:s=>d("odometer_reading",s.target.value)})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"notes",children:"Notes"}),e.jsx(fe,{id:"notes",placeholder:"Any additional notes about this purchase...",rows:3,value:n.notes,onChange:s=>d("notes",s.target.value)})]}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsxs(c,{variant:"outline",onClick:()=>b(!1),children:[e.jsx(ie,{className:"w-4 h-4 mr-2"}),"Cancel"]}),e.jsxs(c,{onClick:$,children:[e.jsx(oe,{className:"w-4 h-4 mr-2"}),g?"Update Purchase":"Record Purchase"]})]})]})]}),e.jsxs(h,{children:[e.jsx(C,{children:e.jsxs(F,{className:"flex items-center space-x-2",children:[e.jsx(Ve,{className:"w-5 h-5 text-yellow-600"}),e.jsx("span",{children:"Fuel Efficiency Tips"})]})}),e.jsx(m,{children:e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(Ke,{className:"w-5 h-5 text-blue-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:"Smooth Driving"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Avoid rapid acceleration and braking to improve fuel efficiency"})]})]}),e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(W,{className:"w-5 h-5 text-orange-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:"Regular Maintenance"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Keep tires properly inflated and engine well-maintained"})]})]}),e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(ss,{className:"w-5 h-5 text-green-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:"Reduce Idling"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Turn off engine when parked for more than 30 seconds"})]})]})]})})]})]}),e.jsxs(Z,{value:"history",className:"space-y-4",children:[e.jsxs(h,{children:[e.jsxs(C,{children:[e.jsx(F,{children:"Purchase History"}),e.jsx(_e,{children:"View and manage your fuel purchase history"})]}),e.jsx(m,{children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(a,{htmlFor:"search",children:"Search"}),e.jsxs("div",{className:"relative",children:[e.jsx(De,{className:"absolute left-2 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(x,{id:"search",placeholder:"Search by vehicle, location, or notes...",value:T,onChange:s=>k(s.target.value),className:"pl-8"})]})]}),e.jsxs("div",{className:"sm:w-48",children:[e.jsx(a,{htmlFor:"fuel-type-filter",children:"Fuel Type"}),e.jsxs(S,{value:y,onValueChange:G,children:[e.jsx(L,{children:e.jsx(D,{})}),e.jsxs(A,{children:[e.jsx(r,{value:"all",children:"All Types"}),e.jsx(r,{value:"diesel",children:"Diesel"}),e.jsx(r,{value:"petrol",children:"Petrol"}),e.jsx(r,{value:"electric",children:"Electric"})]})]})]})]})})]}),e.jsx(h,{children:e.jsxs(m,{className:"p-0",children:[e.jsxs(Xe,{children:[e.jsx(Je,{children:e.jsxs(Fe,{children:[e.jsx(q,{children:"Vehicle"}),e.jsx(q,{children:"Date"}),e.jsx(q,{children:"Fuel Type"}),e.jsx(q,{children:"Quantity"}),e.jsx(q,{children:"Total Cost"}),e.jsx(q,{children:"Location"}),e.jsx(q,{className:"text-right",children:"Actions"})]})}),e.jsx(es,{children:B.map(s=>e.jsxs(Fe,{children:[e.jsx(E,{children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:s.vehicle_number}),e.jsx("div",{className:"text-sm text-muted-foreground",children:s.license_plate})]})}),e.jsx(E,{children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:U(new Date(s.purchase_date),"MMM dd, yyyy")}),e.jsx("div",{className:"text-sm text-muted-foreground",children:U(new Date(s.created_at),"HH:mm")})]})}),e.jsx(E,{children:je(s.fuel_type)}),e.jsx(E,{children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:s.fuel_type==="electric"?`${s.quantity}kWh`:`${s.quantity}L`}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:["£",s.unit_price.toFixed(2),"/unit"]})]})}),e.jsx(E,{children:e.jsxs("div",{className:"font-medium",children:["£",s.total_cost.toFixed(2)]})}),e.jsx(E,{children:e.jsx("div",{className:"max-w-xs truncate",children:s.location})}),e.jsx(E,{className:"text-right",children:e.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[e.jsx(c,{variant:"ghost",size:"sm",onClick:()=>le(s),children:e.jsx(ke,{className:"w-4 h-4"})}),e.jsx(c,{variant:"ghost",size:"sm",onClick:()=>N(s),children:e.jsx(qe,{className:"w-4 h-4"})}),e.jsx(c,{variant:"ghost",size:"sm",onClick:()=>ae(s.id),children:e.jsx(He,{className:"w-4 h-4 text-red-500"})})]})})]},s.id))})]}),B.length===0&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx(V,{className:"w-12 h-12 text-muted-foreground mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium",children:"No fuel purchases found"}),e.jsx("p",{className:"text-muted-foreground",children:T||y!=="all"?"Try adjusting your search or filter criteria":"Record your first fuel purchase to see it here"})]})]})})]})]}),e.jsx(ce,{open:u,onOpenChange:b,children:e.jsxs(ne,{className:"max-w-2xl",children:[e.jsxs(re,{children:[e.jsx(de,{children:g?"Edit Fuel Purchase":"Add Fuel Purchase"}),e.jsx(Ce,{children:"Record a new fuel purchase for your vehicle"})]}),e.jsxs("div",{className:"space-y-4",children:[g&&e.jsxs("div",{className:"flex items-center space-x-2 text-red-500",children:[e.jsx(W,{className:"w-5 h-5"}),e.jsxs("p",{children:["Editing existing purchase: ",g.vehicle_number," - ",g.license_plate]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"vehicle",children:"Select Vehicle"}),e.jsxs(S,{onValueChange:s=>d("vehicle_id",s),value:n.vehicle_id,children:[e.jsx(L,{children:e.jsx(D,{placeholder:"Choose your vehicle"})}),e.jsx(A,{children:t.map(s=>e.jsxs(r,{value:s.id,children:[s.vehicle_number," - ",s.license_plate]},s.id))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"fuel-type",children:"Fuel Type"}),e.jsxs(S,{onValueChange:s=>d("fuel_type",s),value:n.fuel_type,children:[e.jsx(L,{children:e.jsx(D,{placeholder:"Select fuel type"})}),e.jsxs(A,{children:[e.jsx(r,{value:"diesel",children:"Diesel"}),e.jsx(r,{value:"petrol",children:"Petrol"}),e.jsx(r,{value:"electric",children:"Electric"})]})]})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"quantity",children:"Quantity (Liters/kWh)"}),e.jsx(x,{id:"quantity",type:"number",placeholder:"0.00",step:"0.1",value:n.quantity,onChange:s=>d("quantity",s.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"unit-price",children:"Unit Price (£)"}),e.jsx(x,{id:"unit-price",type:"number",placeholder:"0.00",step:"0.01",value:n.unit_price,onChange:s=>d("unit_price",s.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"total-cost",children:"Total Cost (£)"}),e.jsx(x,{id:"total-cost",type:"number",placeholder:"0.00",step:"0.01",value:n.total_cost,onChange:s=>d("total_cost",s.target.value)})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"location",children:"Location"}),e.jsx(x,{id:"location",placeholder:"Fuel station name and location",value:n.location,onChange:s=>d("location",s.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"odometer",children:"Odometer Reading"}),e.jsx(x,{id:"odometer",type:"number",placeholder:"Current mileage",value:n.odometer_reading,onChange:s=>d("odometer_reading",s.target.value)})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"notes",children:"Notes"}),e.jsx(fe,{id:"notes",placeholder:"Any additional notes about this purchase...",rows:3,value:n.notes,onChange:s=>d("notes",s.target.value)})]}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsxs(c,{variant:"outline",onClick:()=>b(!1),children:[e.jsx(ie,{className:"w-4 h-4 mr-2"}),"Cancel"]}),e.jsxs(c,{onClick:$,children:[e.jsx(oe,{className:"w-4 h-4 mr-2"}),g?"Update Purchase":"Record Purchase"]})]})]})]})}),e.jsx(ce,{open:!!o,onOpenChange:s=>!s&&I(null),children:e.jsxs(ne,{className:"max-w-2xl",children:[e.jsxs(re,{children:[e.jsx(de,{children:"View Fuel Purchase"}),e.jsx(Ce,{children:"Details of a specific fuel purchase"})]}),o?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{children:"Vehicle"}),e.jsx("div",{className:"font-medium",children:o.vehicle_number}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:["License Plate: ",o.license_plate]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{children:"Date"}),e.jsx("div",{className:"font-medium",children:U(new Date(o.purchase_date),"MMM dd, yyyy")}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Created: ",U(new Date(o.created_at),"MMM dd, yyyy HH:mm")]})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{children:"Fuel Type"}),e.jsx(f,{variant:"outline",children:o.fuel_type})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{children:"Quantity"}),e.jsx("div",{className:"font-medium",children:o.fuel_type==="electric"?`${o.quantity}kWh`:`${o.quantity}L`}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:["£",o.unit_price.toFixed(2),"/unit"]})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{children:"Total Cost"}),e.jsxs("div",{className:"font-medium",children:["£",o.total_cost.toFixed(2)]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{children:"Location"}),e.jsx("div",{className:"font-medium",children:o.location})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{children:"Odometer Reading"}),e.jsx("div",{className:"font-medium",children:o.odometer_reading||"N/A"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{children:"Notes"}),e.jsx("div",{className:"font-medium",children:o.notes||"No notes"})]})]}),e.jsx("div",{className:"flex justify-end space-x-2",children:e.jsxs(c,{variant:"outline",onClick:()=>I(null),children:[e.jsx(ie,{className:"w-4 h-4 mr-2"}),"Close"]})})]}):e.jsxs("div",{className:"text-center py-4",children:[e.jsx(V,{className:"w-12 h-12 text-muted-foreground mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"No purchase selected for viewing."})]})]})})]})};export{xs as default};
