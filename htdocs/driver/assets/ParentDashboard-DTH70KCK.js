import{c as Me,m as O,j as e,e as y,g as _,h as k,i as je,k as C,S as ie,d as U,U as V,a1 as K,x as Te,r as v,ci as Ee,cn as Le,co as Oe,cp as Ie,cq as Be,aO as ne,a4 as J,as as le,B as m,am as Q,a5 as X,a6 as ee,a7 as se,a8 as te,q as d,I as w,s as T,aA as re,cr as ze,n as E,E as pe,an as $e,ab as ce,ac as de,ad as oe,ae as me,af as M,H as ye,J as ge,G as be,a2 as we,f as L,$ as he,C as xe,a0 as fe,ap as Y,M as ae,bp as _e,cm as ke,ay as Ue,cs as We,ax as Z,bO as He,ag as ue,aq as Ge,l as Ve,O as Ye,Q as Qe,V as z,Y as $,aP as ve,P as Ke}from"./main-DVuL102c.js";import{H as Ce}from"./heart-CNuKn9NJ.js";import Ze from"./ParentRouteTracker-BAPh1Wo_.js";import Je from"./ParentCommunicationCenter-tuxZWQZD.js";import Xe from"./NotificationCenter-BMKBAyoE.js";import{G as es}from"./globe-DQ6WkPH1.js";import{C as ss}from"./chevron-left-CejOeOBB.js";import{a as Se}from"./addWeeks-D7_dq2Pd.js";import{e as ts}from"./endOfWeek-aLw_agy5.js";import{e as as}from"./eachDayOfInterval-CZlqfhSB.js";import{i as Ne}from"./isToday-RtUDijym.js";import{E as ns}from"./EmergencyContacts-CMDgzTFP.js";import"./switch-Ct9qaOvk.js";import"./addDays-CXxLH7jZ.js";import"./isSameDay-X0xWrpXd.js";import"./star-Dk-sf7Q0.js";import"./trash-2-uDLx8yM9.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rs=Me("Brain",[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z",key:"ep3f8r"}],["path",{d:"M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4",key:"1p4c4q"}],["path",{d:"M17.599 6.5a3 3 0 0 0 .399-1.375",key:"tmeiqw"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M19.938 10.5a4 4 0 0 1 .585.396",key:"1qfode"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M19.967 17.484A4 4 0 0 1 18 18",key:"159ez6"}]]);function is(i,n){return Se(i,-n)}const ls=()=>{const{profile:i}=O(),n=new Date().getHours(),l=()=>n<12?"Good morning":n<17?"Good afternoon":"Good evening",o=()=>{const h=["Your child's safety is our top priority.","Every journey matters when it comes to your family.","We're here to make transportation worry-free for you.","Your trust in us drives everything we do.","Safe travels start with caring parents like you."],x=Math.floor((new Date().getTime()-new Date(new Date().getFullYear(),0,0).getTime())/864e5);return h[x%h.length]};return e.jsxs(y,{className:"bg-gradient-to-r from-teal-600 to-cyan-600 text-white border-0 shadow-xl",children:[e.jsx(_,{className:"pb-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(k,{className:"text-2xl font-bold mb-2",children:[l(),", ",(i==null?void 0:i.first_name)||"Parent","! ðŸ‘‹"]}),e.jsx(je,{className:"text-teal-100 text-lg",children:o()})]}),e.jsx("div",{className:"hidden md:block",children:e.jsx("div",{className:"w-20 h-20 bg-white/10 rounded-full flex items-center justify-center",children:e.jsx(Ce,{className:"w-10 h-10 text-white"})})})]})}),e.jsx(C,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-3 bg-white/10 rounded-lg p-3",children:[e.jsx(ie,{className:"w-8 h-8 text-white"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:"Safe Transport"}),e.jsx("p",{className:"text-sm text-teal-100",children:"Trusted drivers & vehicles"})]})]}),e.jsxs("div",{className:"flex items-center space-x-3 bg-white/10 rounded-lg p-3",children:[e.jsx(U,{className:"w-8 h-8 text-white"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:"Real-time Updates"}),e.jsx("p",{className:"text-sm text-teal-100",children:"Live tracking & notifications"})]})]}),e.jsxs("div",{className:"flex items-center space-x-3 bg-white/10 rounded-lg p-3",children:[e.jsx(V,{className:"w-8 h-8 text-white"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:"Family Care"}),e.jsx("p",{className:"text-sm text-teal-100",children:"Personalized attention"})]})]})]})})]})},cs=()=>{O();const{toast:i}=K(),n=Te(),[l,o]=v.useState(null),[h,x]=v.useState(!1),[p,b]=v.useState(!1),[u,A]=v.useState(null),[F,D]=v.useState(!1),[r,q]=v.useState({first_name:"",last_name:"",date_of_birth:"",grade:"",school:"",pickup_location:"",dropoff_location:"",emergency_contact_name:"",emergency_contact_phone:"",medical_conditions:"",allergies:"",special_instructions:""}),[f,P]=v.useState({assessment_type:"",risk_level:"low",description:"",required_equipment:""}),{data:a=[],isLoading:t,refetch:j}=Ee(),{data:N=[],isLoading:R,refetch:S}=Le(l==null?void 0:l.id),I=Oe(),W=Ie(),c=Be(),g=(s,H)=>{q(G=>({...G,[s]:H}))},B=(s,H)=>{P(G=>({...G,[s]:H}))},Ae=async()=>{try{await I.mutateAsync({...r,is_active:!0}),i({title:"Child added successfully",description:`${r.first_name} ${r.last_name} has been added to your family.`}),q({first_name:"",last_name:"",date_of_birth:"",grade:"",school:"",pickup_location:"",dropoff_location:"",emergency_contact_name:"",emergency_contact_phone:"",medical_conditions:"",allergies:"",special_instructions:""}),x(!1),j()}catch{i({title:"Failed to add child",description:"There was an error adding your child. Please try again.",variant:"destructive"})}},De=async()=>{if(u)try{await W.mutateAsync({id:u.id,...r}),i({title:"Child updated successfully",description:`${r.first_name} ${r.last_name}'s information has been updated.`}),D(!1),A(null),j()}catch{i({title:"Failed to update child",description:"There was an error updating your child's information. Please try again.",variant:"destructive"})}},qe=async()=>{if(l)try{await c.mutateAsync({child_id:l.id,assessment_type:f.assessment_type,risk_level:f.risk_level,description:f.description,required_equipment:f.required_equipment,is_active:!0,assessment_date:new Date().toISOString().split("T")[0]}),i({title:"Risk assessment added successfully",description:"The risk assessment has been added to your child's profile."}),P({assessment_type:"",risk_level:"low",description:"",required_equipment:""}),b(!1),S()}catch{i({title:"Failed to add risk assessment",description:"There was an error adding the risk assessment. Please try again.",variant:"destructive"})}},Fe=s=>{A(s),q({first_name:s.first_name,last_name:s.last_name,date_of_birth:s.date_of_birth,grade:s.grade||"",school:s.school||"",pickup_location:s.pickup_location||"",dropoff_location:s.dropoff_location||"",emergency_contact_name:s.emergency_contact_name||"",emergency_contact_phone:s.emergency_contact_phone||"",medical_conditions:s.medical_conditions||"",allergies:s.allergies||"",special_instructions:s.special_instructions||""}),D(!0)},Pe=s=>{switch(s){case"low":return"bg-green-100 text-green-800";case"medium":return"bg-yellow-100 text-yellow-800";case"high":return"bg-orange-100 text-orange-800";case"critical":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},Re=s=>{switch(s){case"medical":return e.jsx(Ce,{className:"w-4 h-4"});case"behavioral":return e.jsx(rs,{className:"w-4 h-4"});case"physical":return e.jsx(ne,{className:"w-4 h-4"});case"environmental":return e.jsx(es,{className:"w-4 h-4"});default:return e.jsx(pe,{className:"w-4 h-4"})}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(y,{children:[e.jsx(_,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(k,{className:"flex items-center space-x-2",children:[e.jsx(ne,{className:"w-5 h-5"}),e.jsx("span",{children:"My Children"})]}),e.jsxs(J,{open:h,onOpenChange:x,children:[e.jsx(le,{asChild:!0,children:e.jsxs(m,{size:"sm",children:[e.jsx(Q,{className:"w-4 h-4 mr-2"}),"Add Child"]})}),e.jsxs(X,{className:n?"w-[95vw] max-w-none mx-2":"",children:[e.jsxs(ee,{children:[e.jsx(se,{children:"Add New Child"}),e.jsx(te,{children:"Add a new child to your family profile"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(d,{htmlFor:"firstName",children:"First Name"}),e.jsx(w,{id:"firstName",value:r.first_name,onChange:s=>g("first_name",s.target.value),placeholder:"Enter first name"})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"lastName",children:"Last Name"}),e.jsx(w,{id:"lastName",value:r.last_name,onChange:s=>g("last_name",s.target.value),placeholder:"Enter last name"})]})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"dateOfBirth",children:"Date of Birth"}),e.jsx(w,{id:"dateOfBirth",type:"date",value:r.date_of_birth,onChange:s=>g("date_of_birth",s.target.value)})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(d,{htmlFor:"grade",children:"Grade"}),e.jsx(w,{id:"grade",value:r.grade,onChange:s=>g("grade",s.target.value),placeholder:"e.g., 3rd Grade"})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"school",children:"School"}),e.jsx(w,{id:"school",value:r.school,onChange:s=>g("school",s.target.value),placeholder:"Enter school name"})]})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"pickupLocation",children:"Pickup Location"}),e.jsx(w,{id:"pickupLocation",value:r.pickup_location,onChange:s=>g("pickup_location",s.target.value),placeholder:"Enter pickup address"})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"dropoffLocation",children:"Dropoff Location"}),e.jsx(w,{id:"dropoffLocation",value:r.dropoff_location,onChange:s=>g("dropoff_location",s.target.value),placeholder:"Enter dropoff address"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(d,{htmlFor:"emergencyContactName",children:"Emergency Contact Name"}),e.jsx(w,{id:"emergencyContactName",value:r.emergency_contact_name,onChange:s=>g("emergency_contact_name",s.target.value),placeholder:"Emergency contact name"})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"emergencyContactPhone",children:"Emergency Contact Phone"}),e.jsx(w,{id:"emergencyContactPhone",value:r.emergency_contact_phone,onChange:s=>g("emergency_contact_phone",s.target.value),placeholder:"Emergency contact phone"})]})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"medicalConditions",children:"Medical Conditions"}),e.jsx(T,{id:"medicalConditions",value:r.medical_conditions,onChange:s=>g("medical_conditions",s.target.value),placeholder:"Any medical conditions or special needs"})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"allergies",children:"Allergies"}),e.jsx(T,{id:"allergies",value:r.allergies,onChange:s=>g("allergies",s.target.value),placeholder:"Any allergies or dietary restrictions"})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"specialInstructions",children:"Special Instructions"}),e.jsx(T,{id:"specialInstructions",value:r.special_instructions,onChange:s=>g("special_instructions",s.target.value),placeholder:"Any special instructions for transport"})]})]}),e.jsxs(re,{children:[e.jsx(m,{variant:"outline",onClick:()=>x(!1),children:"Cancel"}),e.jsx(m,{onClick:Ae,disabled:!r.first_name||!r.last_name||!r.date_of_birth||I.isPending,children:I.isPending?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Adding..."]}):"Add Child"})]})]})]})]})}),e.jsx(C,{children:t?e.jsx("div",{className:"flex items-center justify-center h-32",children:e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-primary"})}):a.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(ne,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"No children added yet"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Add your children to manage their transport information"})]}):e.jsx("div",{className:"space-y-4",children:a.map(s=>{const H=ze(s.date_of_birth);return e.jsx("div",{className:`border rounded-lg p-4 cursor-pointer transition-all hover:shadow-md ${(l==null?void 0:l.id)===s.id?"ring-2 ring-blue-500 bg-blue-50":""}`,onClick:()=>o(s),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsxs("h3",{className:"font-semibold",children:[s.first_name," ",s.last_name]}),e.jsxs(E,{variant:"outline",children:[H," years old"]}),s.grade&&e.jsx(E,{variant:"secondary",children:s.grade})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.school||"School not set"}),s.medical_conditions&&s.medical_conditions!=="None"||s.allergies&&s.allergies!=="None"?e.jsxs("div",{className:"flex items-center space-x-2 mt-2",children:[e.jsx(pe,{className:"w-4 h-4 text-orange-500"}),e.jsx("span",{className:"text-sm text-orange-600",children:"Medical alerts"})]}):null]}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsx(m,{variant:"outline",size:"sm",onClick:G=>{G.stopPropagation(),Fe(s)},children:e.jsx($e,{className:"w-4 h-4"})})})]})},s.id)})})})]}),l&&e.jsxs(y,{children:[e.jsx(_,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(k,{className:"flex items-center space-x-2",children:[e.jsx(ie,{className:"w-5 h-5"}),e.jsxs("span",{children:["Risk Assessments - ",l.first_name]})]}),e.jsxs(J,{open:p,onOpenChange:b,children:[e.jsx(le,{asChild:!0,children:e.jsxs(m,{size:"sm",children:[e.jsx(Q,{className:"w-4 h-4 mr-2"}),"Add Assessment"]})}),e.jsxs(X,{className:n?"w-[95vw] max-w-none mx-2":"",children:[e.jsxs(ee,{children:[e.jsx(se,{children:"Add Risk Assessment"}),e.jsxs(te,{children:["Add a new risk assessment for ",l.first_name]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(d,{htmlFor:"assessmentType",children:"Assessment Type"}),e.jsxs(ce,{value:f.assessment_type,onValueChange:s=>B("assessment_type",s),children:[e.jsx(de,{children:e.jsx(oe,{placeholder:"Select assessment type"})}),e.jsxs(me,{children:[e.jsx(M,{value:"medical",children:"Medical"}),e.jsx(M,{value:"behavioral",children:"Behavioral"}),e.jsx(M,{value:"physical",children:"Physical"}),e.jsx(M,{value:"environmental",children:"Environmental"})]})]})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"riskLevel",children:"Risk Level"}),e.jsxs(ce,{value:f.risk_level,onValueChange:s=>B("risk_level",s),children:[e.jsx(de,{children:e.jsx(oe,{})}),e.jsxs(me,{children:[e.jsx(M,{value:"low",children:"Low"}),e.jsx(M,{value:"medium",children:"Medium"}),e.jsx(M,{value:"high",children:"High"}),e.jsx(M,{value:"critical",children:"Critical"})]})]})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"description",children:"Description"}),e.jsx(T,{id:"description",value:f.description,onChange:s=>B("description",s.target.value),placeholder:"Describe the risk assessment"})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"requiredEquipment",children:"Required Equipment"}),e.jsx(T,{id:"requiredEquipment",value:f.required_equipment,onChange:s=>B("required_equipment",s.target.value),placeholder:"Any required equipment or accommodations"})]})]}),e.jsxs(re,{children:[e.jsx(m,{variant:"outline",onClick:()=>b(!1),children:"Cancel"}),e.jsx(m,{onClick:qe,disabled:!f.assessment_type||!f.description||c.isPending,children:c.isPending?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Adding..."]}):"Add Assessment"})]})]})]})]})}),e.jsx(C,{children:R?e.jsx("div",{className:"flex items-center justify-center h-32",children:e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-primary"})}):N.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(ie,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"No risk assessments yet"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Add risk assessments to ensure safe transport"})]}):e.jsx("div",{className:"space-y-4",children:N.map(s=>e.jsx("div",{className:"border rounded-lg p-4",children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[Re(s.assessment_type),e.jsx("span",{className:"font-medium capitalize",children:s.assessment_type}),e.jsx(E,{className:Pe(s.risk_level),children:s.risk_level})]}),e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:s.description}),s.required_equipment&&e.jsxs("p",{className:"text-sm text-muted-foreground",children:[e.jsx("strong",{children:"Required:"})," ",s.required_equipment]})]})})},s.id))})})]}),e.jsx(J,{open:F,onOpenChange:D,children:e.jsxs(X,{className:n?"w-[95vw] max-w-none mx-2":"",children:[e.jsxs(ee,{children:[e.jsx(se,{children:"Edit Child Information"}),e.jsxs(te,{children:["Update ",u==null?void 0:u.first_name,"'s information"]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(d,{htmlFor:"editFirstName",children:"First Name"}),e.jsx(w,{id:"editFirstName",value:r.first_name,onChange:s=>g("first_name",s.target.value)})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"editLastName",children:"Last Name"}),e.jsx(w,{id:"editLastName",value:r.last_name,onChange:s=>g("last_name",s.target.value)})]})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"editDateOfBirth",children:"Date of Birth"}),e.jsx(w,{id:"editDateOfBirth",type:"date",value:r.date_of_birth,onChange:s=>g("date_of_birth",s.target.value)})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(d,{htmlFor:"editGrade",children:"Grade"}),e.jsx(w,{id:"editGrade",value:r.grade,onChange:s=>g("grade",s.target.value)})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"editSchool",children:"School"}),e.jsx(w,{id:"editSchool",value:r.school,onChange:s=>g("school",s.target.value)})]})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"editMedicalConditions",children:"Medical Conditions"}),e.jsx(T,{id:"editMedicalConditions",value:r.medical_conditions,onChange:s=>g("medical_conditions",s.target.value)})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"editAllergies",children:"Allergies"}),e.jsx(T,{id:"editAllergies",value:r.allergies,onChange:s=>g("allergies",s.target.value)})]})]}),e.jsxs(re,{children:[e.jsx(m,{variant:"outline",onClick:()=>D(!1),children:"Cancel"}),e.jsx(m,{onClick:De,disabled:!r.first_name||!r.last_name||W.isPending,children:W.isPending?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Updating..."]}):"Update Child"})]})]})})]})},ds=i=>{const{user:n}=O(),o=new Date().toISOString().split("T")[0];return ye({queryKey:["attendance",n==null?void 0:n.id,o],queryFn:async()=>{if(!(n!=null&&n.id))return[];console.log("Fetching attendance for date:",o);try{const{data:h,error:x}=await ge.from("daily_attendance").select(`
            *,
            child_profiles:child_profiles(
              id,
              first_name,
              last_name,
              pickup_location,
              dropoff_location
            ),
            routes:routes(
              id,
              name,
              start_location,
              end_location
            )
          `).eq("attendance_date",o).order("created_at",{ascending:!1});if(x)throw console.error("Error fetching attendance:",x),x;return console.log("Fetched attendance records:",h),h||[]}catch(h){return console.error("Error in useAttendance:",h),[]}},enabled:!!(n!=null&&n.id)})},os=()=>{const{toast:i}=K(),n=be();return we({mutationFn:async({id:l,status:o,pickup_status:h,dropoff_status:x,parent_notes:p,driver_notes:b})=>{const u={};o&&(u.status=o),h&&(u.pickup_status=h),x&&(u.dropoff_status=x),p!==void 0&&(u.parent_notes=p),b!==void 0&&(u.driver_notes=b);const{data:A,error:F}=await ge.from("daily_attendance").update(u).eq("id",l).select().single();if(F)throw F;return A},onSuccess:l=>{n.invalidateQueries({queryKey:["attendance"]}),i({title:"Attendance Updated",description:"The attendance record has been updated successfully."})},onError:l=>{console.error("Error updating attendance:",l),i({title:"Error",description:"Failed to update attendance. Please try again.",variant:"destructive"})}})},ms=()=>{O(),K();const[i,n]=v.useState(!1),[l,o]=v.useState(null),[h,x]=v.useState(""),{data:p=[],isLoading:b}=ds(),u=os(),A=a=>{switch(a){case"attending":return e.jsx(xe,{className:"w-5 h-5 text-green-500"});case"absent":return e.jsx(fe,{className:"w-5 h-5 text-red-500"});case"late_pickup":return e.jsx(U,{className:"w-5 h-5 text-yellow-500"});case"sick":return e.jsx(Y,{className:"w-5 h-5 text-orange-500"});case"holiday":return e.jsx(L,{className:"w-5 h-5 text-blue-500"});default:return e.jsx(Y,{className:"w-5 h-5 text-gray-500"})}},F=a=>{switch(a){case"attending":return"bg-green-100 text-green-800 border-green-200";case"absent":return"bg-red-100 text-red-800 border-red-200";case"late_pickup":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"sick":return"bg-orange-100 text-orange-800 border-orange-200";case"holiday":return"bg-blue-100 text-blue-800 border-blue-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},D=a=>{switch(a){case"attending":return"Attending";case"absent":return"Absent";case"late_pickup":return"Late Pickup";case"sick":return"Sick";case"holiday":return"Holiday";default:return"Unknown"}},r=a=>{switch(a){case"picked_up":return"bg-green-100 text-green-800 border-green-200";case"pending":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"missed":return"bg-red-100 text-red-800 border-red-200";case"cancelled":return"bg-gray-100 text-gray-800 border-gray-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},q=a=>{switch(a){case"picked_up":return"Picked Up";case"pending":return"Pending";case"missed":return"Missed";case"cancelled":return"Cancelled";default:return"Unknown"}},f=async(a,t)=>{try{await u.mutateAsync({id:a,status:t,parent_notes:h}),x(""),o(null)}catch(j){console.error("Failed to update attendance:",j)}},P=a=>{n(a),a||(o(null),x(""))};return e.jsxs(J,{open:i,onOpenChange:P,children:[e.jsx(le,{asChild:!0,children:e.jsxs(m,{variant:"outline",size:"sm",children:[e.jsx(L,{className:"w-4 h-4 mr-2"}),"View Attendance"]})}),e.jsxs(X,{className:"max-w-4xl max-h-[80vh] overflow-y-auto",children:[e.jsxs(ee,{children:[e.jsx(se,{children:"Daily Attendance"}),e.jsx(te,{children:"View and update attendance records for today"})]}),b?e.jsxs("div",{className:"flex items-center justify-center py-8",children:[e.jsx(he,{className:"w-8 h-8 animate-spin text-blue-600"}),e.jsx("span",{className:"ml-2",children:"Loading attendance data..."})]}):p.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(L,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Attendance Records"}),e.jsx("p",{className:"text-gray-600",children:"No attendance records found for today. Attendance records are created automatically when children are assigned to routes."})]}):e.jsx("div",{className:"space-y-6",children:p.map(a=>{var t,j,N;return e.jsxs(y,{children:[e.jsx(_,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(k,{className:"text-lg",children:[(t=a.child_profiles)==null?void 0:t.first_name," ",(j=a.child_profiles)==null?void 0:j.last_name]}),e.jsxs(je,{children:["Route: ",((N=a.routes)==null?void 0:N.name)||"No route assigned"]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[A(a.status),e.jsx(E,{variant:"outline",className:F(a.status),children:D(a.status)})]})]})}),e.jsxs(C,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx(d,{className:"text-sm font-medium",children:"Pickup Status"}),e.jsx(E,{variant:"outline",className:r(a.pickup_status),children:q(a.pickup_status)})]}),e.jsxs("div",{children:[e.jsx(d,{className:"text-sm font-medium",children:"Dropoff Status"}),e.jsx(E,{variant:"outline",className:r(a.dropoff_status),children:q(a.dropoff_status)})]})]}),a.parent_notes&&e.jsxs("div",{className:"mb-4",children:[e.jsx(d,{className:"text-sm font-medium",children:"Parent Notes"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:a.parent_notes})]}),a.driver_notes&&e.jsxs("div",{className:"mb-4",children:[e.jsx(d,{className:"text-sm font-medium",children:"Driver Notes"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:a.driver_notes})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(d,{htmlFor:`notes-${a.id}`,className:"text-sm font-medium",children:"Add/Update Notes"}),e.jsx(T,{id:`notes-${a.id}`,placeholder:"Add any notes about today's attendance...",value:(l==null?void 0:l.id)===a.id?h:"",onChange:R=>{(l==null?void 0:l.id)===a.id||o(a),x(R.target.value)},className:"mt-1"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(m,{variant:"outline",size:"sm",onClick:()=>f(a.id,"attending"),disabled:u.isPending,children:[e.jsx(xe,{className:"w-4 h-4 mr-1"}),"Mark Attending"]}),e.jsxs(m,{variant:"outline",size:"sm",onClick:()=>f(a.id,"absent"),disabled:u.isPending,children:[e.jsx(fe,{className:"w-4 h-4 mr-1"}),"Mark Absent"]}),e.jsxs(m,{variant:"outline",size:"sm",onClick:()=>f(a.id,"sick"),disabled:u.isPending,children:[e.jsx(Y,{className:"w-4 h-4 mr-1"}),"Mark Sick"]}),u.isPending&&e.jsx(he,{className:"w-4 h-4 animate-spin"})]})]})]})]},a.id)})})]})]})},hs=()=>{const i=be(),{profile:n}=O();return we({mutationFn:async l=>{if(!(n!=null&&n.organization_id))throw new Error("Organization ID is required");const{data:o,error:h}=await ge.from("customer_bookings").insert([{...l,organization_id:n.organization_id,created_by:n.id}]).select().single();if(h)throw h;return o},onSuccess:()=>{i.invalidateQueries({queryKey:["customer-bookings"]})}})},xs=()=>{const{profile:i}=O(),{toast:n}=K(),l=hs(),[o,h]=v.useState(""),[x,p]=v.useState(""),[b,u]=v.useState(""),[A,F]=v.useState(""),[D,r]=v.useState(""),[q,f]=v.useState(!1),{data:P}=ye({queryKey:["available-routes"],queryFn:async()=>(console.log("Fetching available routes"),[{id:"route-1",name:"City Center Route",transport_company:"Logistics Solution Resources",route_number:"R001",is_active:!0},{id:"route-2",name:"Suburban Express",transport_company:"Logistics Solution Resources",route_number:"R002",is_active:!0},{id:"route-3",name:"School Run Special",transport_company:"Logistics Solution Resources",route_number:"R003",is_active:!0}])}),a=async t=>{t.preventDefault(),f(!0);try{const j=`BK-${Date.now()}-${Math.random().toString(36).substr(2,5).toUpperCase()}`,N={booking_number:j,customer_name:`${(i==null?void 0:i.first_name)||""} ${(i==null?void 0:i.last_name)||""}`.trim(),customer_email:i==null?void 0:i.email,customer_phone:i==null?void 0:i.phone,customer_id:i==null?void 0:i.id,pickup_location:b,dropoff_location:A,service_type:"school_transport",passengers:1,special_requirements:D,booking_date:x,estimated_price:25};await l.mutateAsync(N),n({title:"Booking Request Submitted",description:`Your transport booking request (${j}) has been submitted for review.`}),h(""),p(""),u(""),F(""),r("")}catch(j){console.error("Booking submission error:",j),n({title:"Submission Failed",description:"Failed to submit booking request. Please try again.",variant:"destructive"})}finally{f(!1)}};return e.jsxs(y,{children:[e.jsxs(_,{children:[e.jsxs(k,{className:"flex items-center space-x-2",children:[e.jsx(L,{className:"w-5 h-5 text-blue-500"}),e.jsx("span",{children:"Request Transport Booking"})]}),e.jsx(je,{children:"Submit a request for transport services"})]}),e.jsx(C,{children:e.jsxs("form",{onSubmit:a,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"route",children:"Preferred Route"}),e.jsxs(ce,{value:o,onValueChange:h,children:[e.jsx(de,{children:e.jsx(oe,{placeholder:"Select a route"})}),e.jsx(me,{children:P==null?void 0:P.map(t=>e.jsx(M,{value:t.id,children:t.name},t.id))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"date",children:"Request Date"}),e.jsx(w,{id:"date",type:"date",value:x,onChange:t=>p(t.target.value),min:new Date().toISOString().split("T")[0],required:!0})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"pickup",children:"Pickup Location"}),e.jsxs("div",{className:"relative",children:[e.jsx(ae,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx(w,{id:"pickup",value:b,onChange:t=>u(t.target.value),placeholder:"Enter pickup address",className:"pl-10",required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"dropoff",children:"Drop-off Location"}),e.jsxs("div",{className:"relative",children:[e.jsx(ae,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx(w,{id:"dropoff",value:A,onChange:t=>F(t.target.value),placeholder:"Enter drop-off address",className:"pl-10",required:!0})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"requests",children:"Special Requests or Notes"}),e.jsxs("div",{className:"relative",children:[e.jsx(_e,{className:"absolute left-3 top-3 text-gray-400 w-4 h-4"}),e.jsx(T,{id:"requests",value:D,onChange:t=>r(t.target.value),placeholder:"Any special requirements, accessibility needs, or additional information...",className:"pl-10",rows:3})]})]}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsx("h4",{className:"font-medium text-blue-900 mb-2",children:"Important Information"}),e.jsxs("ul",{className:"text-sm text-blue-800 space-y-1",children:[e.jsx("li",{children:"â€¢ Booking requests are subject to availability and approval"}),e.jsx("li",{children:"â€¢ You will receive confirmation within 24 hours"}),e.jsx("li",{children:"â€¢ Special requirements may affect pricing"}),e.jsx("li",{children:"â€¢ Cancellations must be made at least 24 hours in advance"})]})]}),e.jsx(m,{type:"submit",className:"w-full",disabled:q||!x||!b||!A,children:q?"Submitting...":"Submit Booking Request"})]})})]})},us=({className:i})=>{const[n,l]=v.useState(new Date);ke();const o=Ue(n,{weekStartsOn:1}),h=ts(n,{weekStartsOn:1}),x=as({start:o,end:h}),p=[];for(let t=0;t<7;t++){const j=new Date(o);j.setDate(o.getDate()+t);const{data:N=[]}=We(j);p.push(N)}const b=t=>{l(t==="next"?Se(n,1):is(n,1))},u=t=>{try{const[j,N]=t.split(":"),R=parseInt(j),S=R>=12?"PM":"AM";return`${R%12||12}:${N} ${S}`}catch{return t}},A=t=>t==="pickup"?e.jsx(ue,{className:"w-3 h-3"}):e.jsx(V,{className:"w-3 h-3"}),F=t=>t==="pickup"?"text-blue-600 bg-blue-50":"text-green-600 bg-green-50",D=t=>{switch(t){case"completed":return"bg-green-100 text-green-800 border-green-200";case"in_progress":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"delayed":return"bg-red-100 text-red-800 border-red-200";default:return"bg-blue-100 text-blue-800 border-blue-200"}},r=t=>{switch(t){case"completed":return"Completed";case"in_progress":return"In Progress";case"delayed":return"Delayed";default:return"Scheduled"}},q=t=>p[t]||[],f=()=>{const t=p.flat();return[...new Set(t.map(N=>N.childName))]},P=(t,j)=>q(t).filter(N=>N.childName===j),a=f();return e.jsxs("div",{className:`space-y-6 ${i}`,children:[e.jsx(y,{children:e.jsx(_,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(k,{className:"flex items-center space-x-2",children:[e.jsx(L,{className:"w-5 h-5"}),e.jsx("span",{children:"Weekly Schedule"})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(m,{variant:"outline",size:"sm",onClick:()=>b("prev"),children:e.jsx(ss,{className:"w-4 h-4"})}),e.jsxs("span",{className:"text-sm font-medium",children:[Z(o,"MMM d")," - ",Z(h,"MMM d, yyyy")]}),e.jsx(m,{variant:"outline",size:"sm",onClick:()=>b("next"),children:e.jsx(He,{className:"w-4 h-4"})})]}),e.jsx(m,{variant:"outline",size:"sm",onClick:()=>l(new Date),children:"Today"})]})]})})}),e.jsx(y,{children:e.jsx(C,{className:"p-6",children:a.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(L,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Schedule Data"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"No children are assigned to routes for this week."}),e.jsxs(m,{variant:"outline",children:[e.jsx(Q,{className:"w-4 h-4 mr-2"}),"Add Children to Routes"]})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"grid grid-cols-7 gap-4 border-b pb-4",children:x.map((t,j)=>e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:`text-sm font-medium ${Ne(t)?"text-blue-600":"text-gray-600"}`,children:Z(t,"EEE")}),e.jsx("div",{className:`text-lg font-bold ${Ne(t)?"text-blue-600":"text-gray-900"}`,children:Z(t,"d")})]},j))}),a.map(t=>e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsx("h3",{className:"font-semibold text-lg mb-4 text-gray-900",children:t}),e.jsx("div",{className:"grid grid-cols-7 gap-4",children:x.map((j,N)=>{const R=P(N,t);return e.jsx("div",{className:"min-h-[120px]",children:R.length===0?e.jsx("div",{className:"text-center text-gray-400 text-xs py-8",children:"No schedule"}):e.jsx("div",{className:"space-y-2",children:R.map(S=>e.jsxs("div",{className:`p-2 rounded-lg border text-xs ${F(S.type)}`,children:[e.jsxs("div",{className:"flex items-center space-x-1 mb-1",children:[A(S.type),e.jsx("span",{className:"font-medium",children:S.type==="pickup"?"Pickup":"Dropoff"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(U,{className:"w-3 h-3"}),e.jsx("span",{children:u(S.time)})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(ae,{className:"w-3 h-3"}),e.jsx("span",{className:"truncate",title:S.location,children:S.location})]}),e.jsx("div",{className:"text-xs text-gray-600",children:S.driverName}),e.jsx(E,{variant:"outline",className:`text-xs ${D(S.status)}`,children:r(S.status)})]})]},S.id))})},N)})})]},t))]})})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs(y,{children:[e.jsx(_,{children:e.jsx(k,{className:"text-sm font-medium",children:"Total Trips This Week"})}),e.jsxs(C,{children:[e.jsx("div",{className:"text-2xl font-bold",children:p.flat().length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Pickups and dropoffs combined"})]})]}),e.jsxs(y,{children:[e.jsx(_,{children:e.jsx(k,{className:"text-sm font-medium",children:"Children with Schedules"})}),e.jsxs(C,{children:[e.jsx("div",{className:"text-2xl font-bold",children:a.length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Active this week"})]})]}),e.jsxs(y,{children:[e.jsx(_,{children:e.jsx(k,{className:"text-sm font-medium",children:"Completed Trips"})}),e.jsxs(C,{children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:p.flat().filter(t=>t.status==="completed").length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Successfully completed"})]})]})]})]})},Ps=()=>{const{user:i,profile:n}=O();K();const[l,o]=v.useState("overview");if((n==null?void 0:n.role)!=="parent")return e.jsx(Navigate,{to:"/dashboard",replace:!0});const{children:h,notifications:x,stats:p,isLoading:b,childrenError:u,notificationsError:A,markNotificationRead:F,refreshAllData:D,getChildStatus:r}=ke(),q=h,[f,P]=v.useState(!1),[a,t]=v.useState(!1),[j,N]=v.useState(!1);if(b)return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-indigo-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(he,{className:"h-8 w-8 animate-spin text-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading your dashboard..."})]})});if(u||A)return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-indigo-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Y,{className:"h-8 w-8 text-red-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Failed to load dashboard data. Please try again."}),e.jsx(m,{onClick:D,className:"mt-4",children:"Retry"})]})});const R=c=>{switch(c){case"on_route":return"text-blue-600 bg-blue-50 border-blue-200";case"at_school":return"text-green-600 bg-green-50 border-green-200";case"at_home":return"text-gray-600 bg-gray-50 border-gray-200";case"pickup_scheduled":return"text-orange-600 bg-orange-50 border-orange-200";default:return"text-gray-600 bg-gray-50 border-gray-200"}},S=c=>{switch(c){case"on_route":return"On Route";case"at_school":return"At School";case"at_home":return"At Home";case"pickup_scheduled":return"Pickup Scheduled";default:return"Unknown"}},I=c=>{switch(c){case"on_route":return e.jsx(ue,{className:"w-4 h-4"});case"at_school":return e.jsx(xe,{className:"w-4 h-4"});case"at_home":return e.jsx(V,{className:"w-4 h-4"});case"pickup_scheduled":return e.jsx(U,{className:"w-4 h-4"});default:return e.jsx(Y,{className:"w-4 h-4"})}},W=c=>{F.mutate(c)};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-indigo-50",children:e.jsxs("div",{className:"container mx-auto p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Parent Dashboard"}),e.jsxs("p",{className:"text-gray-600 mt-1",children:["Welcome back, ",(n==null?void 0:n.first_name)||"Parent","! Here's what's happening with your children today."]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs(m,{variant:"outline",size:"sm",onClick:D,children:[e.jsx(Ge,{className:"w-4 h-4 mr-2"}),"Refresh"]}),e.jsxs(m,{variant:"outline",size:"sm",children:[e.jsx(Ve,{className:"w-4 h-4 mr-2"}),"Settings"]})]})]}),e.jsx(ls,{}),e.jsxs(Ye,{value:l,onValueChange:o,className:"space-y-6",children:[e.jsxs(Qe,{className:"grid w-full grid-cols-6",children:[e.jsx(z,{value:"overview",children:"Overview"}),e.jsx(z,{value:"tracking",children:"Live Tracking"}),e.jsx(z,{value:"schedule",children:"Schedule"}),e.jsx(z,{value:"emergency",children:"Emergency Contacts"}),e.jsx(z,{value:"communication",children:"Communication"}),e.jsxs(z,{value:"notifications",children:["Notifications (",p.unreadNotifications,")"]})]}),e.jsxs($,{value:"overview",className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsxs(y,{children:[e.jsxs(_,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(k,{className:"text-sm font-medium",children:"My Children"}),e.jsx(V,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(C,{children:[e.jsx("div",{className:"text-2xl font-bold",children:p.totalChildren}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Active registrations"})]})]}),e.jsxs(y,{children:[e.jsxs(_,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(k,{className:"text-sm font-medium",children:"On Route"}),e.jsx(ue,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(C,{children:[e.jsx("div",{className:"text-2xl font-bold",children:p.childrenOnRoute}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Currently traveling"})]})]}),e.jsxs(y,{children:[e.jsxs(_,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(k,{className:"text-sm font-medium",children:"Notifications"}),e.jsx(ve,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(C,{children:[e.jsx("div",{className:"text-2xl font-bold",children:p.unreadNotifications}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Unread messages"})]})]}),e.jsxs(y,{children:[e.jsxs(_,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(k,{className:"text-sm font-medium",children:"Today's Pickups"}),e.jsx(U,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(C,{children:[e.jsx("div",{className:"text-2xl font-bold",children:p.todaysPickups}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Scheduled today"})]})]})]}),e.jsxs(y,{children:[e.jsx(_,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(k,{children:"Children Status"}),e.jsxs(m,{variant:"outline",size:"sm",onClick:()=>P(!0),children:[e.jsx(Q,{className:"w-4 h-4 mr-2"}),"Manage Children"]})]})}),e.jsx(C,{children:e.jsx("div",{className:"space-y-4",children:q.map(c=>{const g=r(c.id),B=c.date_of_birth?new Date().getFullYear()-new Date(c.date_of_birth).getFullYear():"N/A";return e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx(V,{className:"w-6 h-6 text-blue-600"})}),e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold",children:[c.first_name," ",c.last_name]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[c.grade_level||"N/A"," â€¢ Age ",B]}),c.pickup_location&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Pickup: ",c.pickup_location]})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(E,{variant:"outline",className:R(g),children:e.jsxs("div",{className:"flex items-center space-x-1",children:[I(g),e.jsx("span",{children:S(g)})]})}),e.jsx(m,{variant:"ghost",size:"sm",children:e.jsx(Ke,{className:"w-4 h-4"})})]})]},c.id)})})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs(y,{children:[e.jsx(_,{children:e.jsxs(k,{className:"flex items-center space-x-2",children:[e.jsx(L,{className:"w-5 h-5"}),e.jsx("span",{children:"Quick Actions"})]})}),e.jsxs(C,{className:"space-y-3",children:[e.jsxs(m,{variant:"outline",className:"w-full justify-start",onClick:()=>t(!0),children:[e.jsx(U,{className:"w-4 h-4 mr-2"}),"View Attendance"]}),e.jsxs(m,{variant:"outline",className:"w-full justify-start",onClick:()=>N(!0),children:[e.jsx(Q,{className:"w-4 h-4 mr-2"}),"Request Booking"]}),e.jsxs(m,{variant:"outline",className:"w-full justify-start",onClick:()=>o("communication"),children:[e.jsx(_e,{className:"w-4 h-4 mr-2"}),"Contact Transport"]})]})]}),e.jsxs(y,{children:[e.jsx(_,{children:e.jsxs(k,{className:"flex items-center space-x-2",children:[e.jsx(ve,{className:"w-5 h-5"}),e.jsx("span",{children:"Recent Notifications"})]})}),e.jsxs(C,{children:[e.jsx("div",{className:"space-y-3",children:x.slice(0,3).map(c=>e.jsx("div",{className:`p-3 rounded-lg border cursor-pointer transition-colors ${c.is_read?"bg-gray-50":"bg-blue-50 border-blue-200"}`,onClick:()=>W(c.id),children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:c.title}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:new Date(c.created_at).toLocaleTimeString()})]}),!c.is_read&&e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"})]})},c.id))}),e.jsx(m,{variant:"ghost",size:"sm",className:"w-full mt-3",onClick:()=>o("notifications"),children:"View All Notifications"})]})]}),e.jsxs(y,{children:[e.jsx(_,{children:e.jsxs(k,{className:"flex items-center space-x-2",children:[e.jsx(ae,{className:"w-5 h-5"}),e.jsx("span",{children:"Today's Schedule"})]})}),e.jsx(C,{children:e.jsx("div",{className:"space-y-3",children:q.map(c=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h4",{className:"font-medium text-sm",children:[c.first_name," ",c.last_name]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsx("span",{children:"Pickup:"}),e.jsx("span",{className:"font-medium",children:c.pickup_time||"N/A"})]}),e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsx("span",{children:"Dropoff:"}),e.jsx("span",{className:"font-medium",children:c.dropoff_time||"N/A"})]})]})]},c.id))})})]})]})]}),e.jsx($,{value:"tracking",className:"space-y-6",children:e.jsx(Ze,{})}),e.jsx($,{value:"schedule",className:"space-y-6",children:e.jsx(us,{})}),e.jsx($,{value:"emergency",className:"space-y-6",children:e.jsx(ns,{})}),e.jsx($,{value:"communication",className:"space-y-6",children:e.jsx(Je,{})}),e.jsx($,{value:"notifications",className:"space-y-6",children:e.jsx(Xe,{})})]}),f&&e.jsx(cs,{}),a&&e.jsx(ms,{}),j&&e.jsx(xs,{})]})})};export{Ps as default};
