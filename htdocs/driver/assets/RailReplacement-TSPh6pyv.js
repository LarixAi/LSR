import{m as ae,a1 as te,r as o,j as e,N as P,ch as v,a4 as D,as as le,B as u,am as ce,a5 as A,a6 as L,a7 as T,I as n,s as ne,e as r,k as i,C as N,d as y,p as k,U as b,at as E,ab as re,ac as ie,ad as de,ae as oe,af as j,g as xe,h as me,ax as h,n as M,ak as he,P as je,v as ue,M as R,a0 as pe}from"./main-DVuL102c.js";import{T as ge,a as fe,b as I,c as x,d as ve,e as m}from"./table-Jjtal2IW.js";const Ne=[{id:"1",routeName:"Northern Line Replacement",affectedLine:"Northern Line (King's Cross to Finchley Central)",startDate:"2024-01-15",endDate:"2024-02-28",status:"active",vehiclesAssigned:12,passengersAffected:850,pickupPoints:["King's Cross Station","Camden Town","Kentish Town","Tufnell Park"],dropoffPoints:["Archway","Highgate","East Finchley","Finchley Central"],frequency:"Every 10 minutes",estimatedCost:125e3,contactPerson:"Sarah Mitchell",contactPhone:"+44 20 7946 0958",contactEmail:"sarah.mitchell@lsr.co.uk",notes:"Major track upgrade works requiring full line closure",createdAt:"2024-01-10T09:00:00Z",updatedAt:"2024-01-15T14:30:00Z"},{id:"2",routeName:"Victoria Line Weekend Service",affectedLine:"Victoria Line (Tottenham Hale to Brixton)",startDate:"2024-02-03",endDate:"2024-02-04",status:"planned",vehiclesAssigned:8,passengersAffected:420,pickupPoints:["Tottenham Hale","Seven Sisters","Finsbury Park","Highbury & Islington"],dropoffPoints:["King's Cross","Oxford Circus","Victoria","Brixton"],frequency:"Every 15 minutes",estimatedCost:45e3,contactPerson:"James Rodriguez",contactPhone:"+44 20 7946 0723",contactEmail:"james.rodriguez@lsr.co.uk",notes:"Weekend engineering works - signalling system upgrade",createdAt:"2024-01-20T11:15:00Z",updatedAt:"2024-01-25T16:45:00Z"},{id:"3",routeName:"Central Line Emergency Replacement",affectedLine:"Central Line (Liverpool Street to Stratford)",startDate:"2024-01-28",endDate:"2024-01-28",status:"completed",vehiclesAssigned:6,passengersAffected:320,pickupPoints:["Liverpool Street","Bethnal Green","Mile End"],dropoffPoints:["Stratford","West Ham","Plaistow"],frequency:"Every 8 minutes",estimatedCost:18500,contactPerson:"Emma Thompson",contactPhone:"+44 20 7946 0634",contactEmail:"emma.thompson@lsr.co.uk",notes:"Emergency service due to signal failure - resolved same day",createdAt:"2024-01-28T06:30:00Z",updatedAt:"2024-01-28T20:15:00Z"}],Ce=()=>{const{user:H,profile:C,loading:q}=ae(),{toast:F}=te(),[d,V]=o.useState(Ne),[p,B]=o.useState(""),[g,O]=o.useState("all");o.useState("overview");const[Z,f]=o.useState(!1),[z,S]=o.useState(!1),[t,K]=o.useState(null),[l,c]=o.useState({routeName:"",affectedLine:"",startDate:"",endDate:"",status:"planned",vehiclesAssigned:0,passengersAffected:0,pickupPoints:[],dropoffPoints:[],frequency:"",estimatedCost:0,contactPerson:"",contactPhone:"",contactEmail:"",notes:""});if(q)return e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-primary mb-4"}),e.jsx("p",{className:"text-lg",children:"Loading rail replacement services..."})]})});if(!H||!C)return e.jsx(P,{to:"/auth",replace:!0});if(!["admin","council"].includes(C.role))return e.jsx(P,{to:"/unauthorized",replace:!0});const U=d.filter(s=>{const a=s.routeName.toLowerCase().includes(p.toLowerCase())||s.affectedLine.toLowerCase().includes(p.toLowerCase()),se=g==="all"||s.status===g;return a&&se}),W=d.length,G=d.filter(s=>s.status==="active").length,J=d.filter(s=>s.status==="planned").length,X=d.reduce((s,a)=>s+a.vehiclesAssigned,0),$=d.reduce((s,a)=>s+a.passengersAffected,0),Q=d.reduce((s,a)=>s+a.estimatedCost,0),w=s=>{switch(s){case"active":return"bg-green-100 text-green-800";case"planned":return"bg-blue-100 text-blue-800";case"completed":return"bg-gray-100 text-gray-800";case"cancelled":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},Y=s=>{switch(s){case"active":return e.jsx(N,{className:"w-4 h-4"});case"planned":return e.jsx(y,{className:"w-4 h-4"});case"completed":return e.jsx(N,{className:"w-4 h-4"});case"cancelled":return e.jsx(pe,{className:"w-4 h-4"});default:return e.jsx(y,{className:"w-4 h-4"})}},_=()=>{const s={...l,id:Date.now().toString(),createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};V([...d,s]),f(!1),c({routeName:"",affectedLine:"",startDate:"",endDate:"",status:"planned",vehiclesAssigned:0,passengersAffected:0,pickupPoints:[],dropoffPoints:[],frequency:"",estimatedCost:0,contactPerson:"",contactPhone:"",contactEmail:"",notes:""}),F({title:"Success",description:"Rail replacement service created successfully."})},ee=s=>{K(s),S(!0)};return e.jsxs("div",{className:"container mx-auto p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center space-x-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(v,{className:"h-8 w-8 text-primary"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Rail Replacement Services"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage bus replacement services for rail disruptions"})]})]})}),e.jsxs(D,{open:Z,onOpenChange:f,children:[e.jsx(le,{asChild:!0,children:e.jsxs(u,{className:"flex items-center space-x-2",children:[e.jsx(ce,{className:"w-4 h-4"}),e.jsx("span",{children:"New Service"})]})}),e.jsxs(A,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsx(L,{children:e.jsx(T,{children:"Create Rail Replacement Service"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Route Name"}),e.jsx(n,{value:l.routeName||"",onChange:s=>c(a=>({...a,routeName:s.target.value})),placeholder:"Enter route name"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Affected Line"}),e.jsx(n,{value:l.affectedLine||"",onChange:s=>c(a=>({...a,affectedLine:s.target.value})),placeholder:"Enter affected rail line"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Start Date"}),e.jsx(n,{type:"date",value:l.startDate||"",onChange:s=>c(a=>({...a,startDate:s.target.value}))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"End Date"}),e.jsx(n,{type:"date",value:l.endDate||"",onChange:s=>c(a=>({...a,endDate:s.target.value}))})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Vehicles Required"}),e.jsx(n,{type:"number",value:l.vehiclesAssigned||0,onChange:s=>c(a=>({...a,vehiclesAssigned:parseInt(s.target.value)||0})),placeholder:"0"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Passengers Affected"}),e.jsx(n,{type:"number",value:l.passengersAffected||0,onChange:s=>c(a=>({...a,passengersAffected:parseInt(s.target.value)||0})),placeholder:"0"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Estimated Cost (£)"}),e.jsx(n,{type:"number",value:l.estimatedCost||0,onChange:s=>c(a=>({...a,estimatedCost:parseInt(s.target.value)||0})),placeholder:"0"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Service Frequency"}),e.jsx(n,{value:l.frequency||"",onChange:s=>c(a=>({...a,frequency:s.target.value})),placeholder:"e.g., Every 10 minutes"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Contact Person"}),e.jsx(n,{value:l.contactPerson||"",onChange:s=>c(a=>({...a,contactPerson:s.target.value})),placeholder:"Full name"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Contact Phone"}),e.jsx(n,{value:l.contactPhone||"",onChange:s=>c(a=>({...a,contactPhone:s.target.value})),placeholder:"+44 20 ..."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Contact Email"}),e.jsx(n,{type:"email",value:l.contactEmail||"",onChange:s=>c(a=>({...a,contactEmail:s.target.value})),placeholder:"email@lsr.co.uk"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Notes"}),e.jsx(ne,{value:l.notes||"",onChange:s=>c(a=>({...a,notes:s.target.value})),placeholder:"Additional notes about the replacement service",rows:3})]}),e.jsxs("div",{className:"flex space-x-2 pt-4",children:[e.jsx(u,{variant:"outline",onClick:()=>f(!1),className:"flex-1",children:"Cancel"}),e.jsx(u,{onClick:_,className:"flex-1",children:"Create Service"})]})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-6 gap-4",children:[e.jsx(r,{children:e.jsx(i,{className:"p-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(v,{className:"h-8 w-8 text-blue-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:W}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Total Services"})]})]})})}),e.jsx(r,{children:e.jsx(i,{className:"p-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(N,{className:"h-8 w-8 text-green-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:G}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Active Services"})]})]})})}),e.jsx(r,{children:e.jsx(i,{className:"p-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(y,{className:"h-8 w-8 text-blue-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:J}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Planned Services"})]})]})})}),e.jsx(r,{children:e.jsx(i,{className:"p-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(k,{className:"h-8 w-8 text-orange-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:X}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Vehicles Deployed"})]})]})})}),e.jsx(r,{children:e.jsx(i,{className:"p-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(b,{className:"h-8 w-8 text-purple-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:$.toLocaleString()}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Passengers Served"})]})]})})}),e.jsx(r,{children:e.jsx(i,{className:"p-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(E,{className:"h-8 w-8 text-green-600"}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-2xl font-bold",children:["£",(Q/1e3).toFixed(0),"k"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Total Cost"})]})]})})})]}),e.jsx(r,{children:e.jsx(i,{className:"p-4",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(n,{placeholder:"Search by route name or affected line...",value:p,onChange:s=>B(s.target.value),className:"flex-1"}),e.jsxs(re,{value:g,onValueChange:O,children:[e.jsx(ie,{className:"w-40",children:e.jsx(de,{placeholder:"Status"})}),e.jsxs(oe,{children:[e.jsx(j,{value:"all",children:"All Status"}),e.jsx(j,{value:"active",children:"Active"}),e.jsx(j,{value:"planned",children:"Planned"}),e.jsx(j,{value:"completed",children:"Completed"}),e.jsx(j,{value:"cancelled",children:"Cancelled"})]})]})]})})}),e.jsxs(r,{children:[e.jsx(xe,{children:e.jsx(me,{children:"Rail Replacement Services"})}),e.jsx(i,{children:e.jsxs(ge,{children:[e.jsx(fe,{children:e.jsxs(I,{children:[e.jsx(x,{children:"Route Name"}),e.jsx(x,{children:"Affected Line"}),e.jsx(x,{children:"Period"}),e.jsx(x,{children:"Status"}),e.jsx(x,{children:"Vehicles"}),e.jsx(x,{children:"Passengers"}),e.jsx(x,{children:"Cost"}),e.jsx(x,{children:"Actions"})]})}),e.jsx(ve,{children:U.map(s=>e.jsxs(I,{children:[e.jsx(m,{className:"font-medium",children:s.routeName}),e.jsx(m,{className:"text-sm text-muted-foreground",children:s.affectedLine}),e.jsx(m,{children:e.jsxs("div",{className:"text-sm",children:[h(new Date(s.startDate),"MMM dd")," - ",h(new Date(s.endDate),"MMM dd, yyyy")]})}),e.jsx(m,{children:e.jsx(M,{className:w(s.status),children:e.jsxs("div",{className:"flex items-center space-x-1",children:[Y(s.status),e.jsx("span",{className:"capitalize",children:s.status})]})})}),e.jsx(m,{children:s.vehiclesAssigned}),e.jsx(m,{children:s.passengersAffected.toLocaleString()}),e.jsxs(m,{children:["£",(s.estimatedCost/1e3).toFixed(0),"k"]}),e.jsx(m,{children:e.jsx(u,{variant:"ghost",size:"sm",onClick:()=>ee(s),children:e.jsx(he,{className:"w-4 h-4"})})})]},s.id))})]})})]}),e.jsx(D,{open:z,onOpenChange:S,children:e.jsxs(A,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsx(L,{children:e.jsxs(T,{className:"flex items-center space-x-2",children:[e.jsx(v,{className:"w-5 h-5"}),e.jsx("span",{children:t==null?void 0:t.routeName})]})}),t&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Service Information"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Affected Line:"})," ",t.affectedLine]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Period:"})," ",h(new Date(t.startDate),"MMM dd, yyyy")," - ",h(new Date(t.endDate),"MMM dd, yyyy")]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Frequency:"})," ",t.frequency]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Status:"}),e.jsx(M,{className:`ml-2 ${w(t.status)}`,children:t.status})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Contact Information"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(b,{className:"w-4 h-4"}),e.jsx("span",{children:t.contactPerson})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(je,{className:"w-4 h-4"}),e.jsx("span",{children:t.contactPhone})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ue,{className:"w-4 h-4"}),e.jsx("span",{children:t.contactEmail})]})]})]})]}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Service Metrics"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(r,{children:e.jsx(i,{className:"p-3",children:e.jsxs("div",{className:"text-center",children:[e.jsx(k,{className:"w-6 h-6 mx-auto mb-1 text-orange-600"}),e.jsx("div",{className:"text-lg font-bold",children:t.vehiclesAssigned}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Vehicles"})]})})}),e.jsx(r,{children:e.jsx(i,{className:"p-3",children:e.jsxs("div",{className:"text-center",children:[e.jsx(b,{className:"w-6 h-6 mx-auto mb-1 text-purple-600"}),e.jsx("div",{className:"text-lg font-bold",children:t.passengersAffected.toLocaleString()}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Passengers"})]})})}),e.jsx(r,{className:"col-span-2",children:e.jsx(i,{className:"p-3",children:e.jsxs("div",{className:"text-center",children:[e.jsx(E,{className:"w-6 h-6 mx-auto mb-1 text-green-600"}),e.jsxs("div",{className:"text-lg font-bold",children:["£",t.estimatedCost.toLocaleString()]}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Estimated Cost"})]})})})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold mb-2 flex items-center space-x-2",children:[e.jsx(R,{className:"w-4 h-4 text-green-600"}),e.jsx("span",{children:"Pickup Points"})]}),e.jsx("div",{className:"space-y-1",children:t.pickupPoints.map((s,a)=>e.jsx("div",{className:"text-sm p-2 bg-green-50 rounded border-l-4 border-green-200",children:s},a))})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold mb-2 flex items-center space-x-2",children:[e.jsx(R,{className:"w-4 h-4 text-red-600"}),e.jsx("span",{children:"Dropoff Points"})]}),e.jsx("div",{className:"space-y-1",children:t.dropoffPoints.map((s,a)=>e.jsx("div",{className:"text-sm p-2 bg-red-50 rounded border-l-4 border-red-200",children:s},a))})]})]}),t.notes&&e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Notes"}),e.jsx("div",{className:"p-3 bg-gray-50 rounded border text-sm",children:t.notes})]}),e.jsxs("div",{className:"text-xs text-muted-foreground border-t pt-4",children:[e.jsxs("div",{children:["Created: ",h(new Date(t.createdAt),"MMM dd, yyyy HH:mm")]}),e.jsxs("div",{children:["Updated: ",h(new Date(t.updatedAt),"MMM dd, yyyy HH:mm")]})]})]})]})})]})};export{Ce as default};
