import{m as O,r as n,j as e,N as P,R as u,a4 as U,as as q,B as r,am as $,a5 as K,a6 as G,a7 as J,q as p,I as h,e as c,k as d,K as Q,at as W,b4 as v,g as X,h as Y,au as Z,ab as N,ac as b,ad as f,ae as y,af as a,M as ee,T as se,U as ae,ak as te,an as le,n as w}from"./main-DVuL102c.js";import{T as ie,a as ne,b as S,c as t,d as re,e as l}from"./table-Jjtal2IW.js";import{u as ce,a as de,b as xe}from"./useRoutes-C3gsKibR.js";import{C as oe}from"./copy-CYsGklED.js";const ve=()=>{const{user:C,profile:R,loading:T}=O(),[x,D]=n.useState(""),[m,L]=n.useState("all"),[j,F]=n.useState("all"),[k,A]=n.useState(!1);n.useState({name:"",start_location:"",end_location:"",distance:0,estimated_time:0,status:"active"});const{data:_=[],isLoading:B,error:he}=ce(),g=de();if(xe(),T||B)return e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-primary mb-4"}),e.jsx("p",{className:"text-lg",children:"Loading route management..."})]})});if(!C||!R)return e.jsx(P,{to:"/auth",replace:!0});const E=_.map(s=>({id:s.id,name:s.name||`${s.start_location} → ${s.end_location}`,type:"school",origin:s.start_location||"Unknown",destination:s.end_location||"Unknown",distance:s.distance||0,stops:0,assignedVehicle:void 0,assignedDriver:void 0,status:s.status==="active"?"active":"inactive",students:void 0,revenue:0})),M=s=>{const i={active:"bg-green-100 text-green-800",inactive:"bg-gray-100 text-gray-800",planned:"bg-blue-100 text-blue-800",completed:"bg-purple-100 text-purple-800"};return e.jsx(w,{className:i[s]||"bg-gray-100 text-gray-800",children:s})},V=s=>{const i={school:"bg-yellow-100 text-yellow-800",medical:"bg-red-100 text-red-800",charter:"bg-purple-100 text-purple-800",corporate:"bg-blue-100 text-blue-800"};return e.jsx(w,{className:i[s]||"bg-gray-100 text-gray-800",children:s})},I=E.filter(s=>{const i=s.name.toLowerCase().includes(x.toLowerCase())||s.origin.toLowerCase().includes(x.toLowerCase())||s.destination.toLowerCase().includes(x.toLowerCase()),z=m==="all"||s.status===m,H=j==="all"||s.type===j;return i&&z&&H}),o={totalRoutes:g.total,activeRoutes:g.active,totalRevenue:0,totalDistance:g.total_distance||0};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-3",children:[e.jsx(u,{className:"w-8 h-8 text-blue-600"}),"School Routes Management"]}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Manage and optimize school transportation routes"})]}),e.jsxs(U,{open:k,onOpenChange:A,children:[e.jsx(q,{asChild:!0,children:e.jsxs(r,{className:"bg-blue-600 hover:bg-blue-700",children:[e.jsx($,{className:"w-4 h-4 mr-2"}),"Create Route"]})}),e.jsxs(K,{className:"max-w-2xl",children:[e.jsx(G,{children:e.jsx(J,{children:"Create New Route"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(p,{htmlFor:"route-name",children:"Route Name"}),e.jsx(h,{id:"route-name",placeholder:"Enter route name"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(p,{htmlFor:"origin",children:"Origin"}),e.jsx(h,{id:"origin",placeholder:"Starting location"})]}),e.jsxs("div",{children:[e.jsx(p,{htmlFor:"destination",children:"Destination"}),e.jsx(h,{id:"destination",placeholder:"End location"})]})]}),e.jsx(r,{className:"w-full bg-blue-600 hover:bg-blue-700",children:"Create Route"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsx(c,{children:e.jsx(d,{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(u,{className:"w-8 h-8 text-blue-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Routes"}),e.jsx("p",{className:"text-2xl font-bold",children:o.totalRoutes})]})]})})}),e.jsx(c,{children:e.jsx(d,{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Q,{className:"w-8 h-8 text-green-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Active Routes"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:o.activeRoutes})]})]})})}),e.jsx(c,{children:e.jsx(d,{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(W,{className:"w-8 h-8 text-emerald-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Revenue"}),e.jsxs("p",{className:"text-2xl font-bold text-emerald-600",children:["£",o.totalRevenue.toLocaleString()]})]})]})})}),e.jsx(c,{children:e.jsx(d,{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(v,{className:"w-8 h-8 text-purple-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Distance"}),e.jsxs("p",{className:"text-2xl font-bold text-purple-600",children:[o.totalDistance.toFixed(1)," km"]})]})]})})})]}),e.jsxs(c,{children:[e.jsxs(X,{children:[e.jsxs(Y,{className:"flex items-center gap-2",children:[e.jsx(u,{className:"w-5 h-5"}),"School Routes Management"]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx(h,{placeholder:"Search routes...",value:x,onChange:s=>D(s.target.value),className:"pl-10"})]}),e.jsxs(N,{value:m,onValueChange:L,children:[e.jsx(b,{className:"w-48",children:e.jsx(f,{})}),e.jsxs(y,{children:[e.jsx(a,{value:"all",children:"All Status"}),e.jsx(a,{value:"active",children:"Active"}),e.jsx(a,{value:"inactive",children:"Inactive"}),e.jsx(a,{value:"planned",children:"Planned"})]})]}),e.jsxs(N,{value:j,onValueChange:F,children:[e.jsx(b,{className:"w-48",children:e.jsx(f,{})}),e.jsxs(y,{children:[e.jsx(a,{value:"all",children:"All Types"}),e.jsx(a,{value:"school",children:"School Transport"}),e.jsx(a,{value:"medical",children:"Medical Transport"}),e.jsx(a,{value:"charter",children:"Charter Service"}),e.jsx(a,{value:"corporate",children:"Corporate Shuttle"})]})]})]})]}),e.jsx(d,{children:e.jsxs(ie,{children:[e.jsx(ne,{children:e.jsxs(S,{children:[e.jsx(t,{children:"Route Name"}),e.jsx(t,{children:"Type"}),e.jsx(t,{children:"Route"}),e.jsx(t,{children:"Distance"}),e.jsx(t,{children:"Stops"}),e.jsx(t,{children:"Assigned"}),e.jsx(t,{children:"Status"}),e.jsx(t,{children:"Revenue"}),e.jsx(t,{children:"Actions"})]})}),e.jsx(re,{children:I.map(s=>e.jsxs(S,{children:[e.jsx(l,{children:e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s.name}),e.jsx("p",{className:"text-sm text-gray-500",children:s.id})]})}),e.jsx(l,{children:V(s.type)}),e.jsx(l,{children:e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(ee,{className:"w-4 h-4 text-gray-400"}),e.jsxs("span",{className:"truncate",children:[s.origin," → ",s.destination]})]})}),e.jsx(l,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(v,{className:"w-4 h-4 text-gray-400"}),e.jsxs("span",{children:[s.distance," km"]})]})}),e.jsx(l,{children:s.stops}),e.jsx(l,{children:e.jsxs("div",{className:"text-sm",children:[s.assignedVehicle&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(se,{className:"w-3 h-3 text-gray-400"}),e.jsx("span",{children:s.assignedVehicle})]}),s.assignedDriver&&e.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[e.jsx(ae,{className:"w-3 h-3 text-gray-400"}),e.jsx("span",{children:s.assignedDriver})]})]})}),e.jsx(l,{children:M(s.status)}),e.jsx(l,{children:e.jsxs("span",{className:"font-medium",children:["£",s.revenue]})}),e.jsx(l,{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(r,{variant:"outline",size:"sm",children:e.jsx(te,{className:"w-4 h-4"})}),e.jsx(r,{variant:"outline",size:"sm",children:e.jsx(le,{className:"w-4 h-4"})}),e.jsx(r,{variant:"outline",size:"sm",children:e.jsx(oe,{className:"w-4 h-4"})})]})})]},s.id))})]})})]})]})};export{ve as default};
