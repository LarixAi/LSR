import{m as Nn,H as Dn,J as ce,r as l,y as K,cx as $e,ao as os,G as as,a2 as Re,j as r,n as F,B as _,am as jt,ag as Zt,E as en,e as tn,g as nn,h as sn,l as Ct,k as rn,ai as cs,ak as ls,an as Mt,X as ds,F as St,a4 as nt,a5 as st,a6 as rt,a7 as it,a8 as ot,q as P,I as on,s as at,ab as an,ac as cn,ad as ln,ae as dn,af as T,a3 as z,C as us,bC as fs,S as hs,bD as gs,bE as ps}from"./main-DVuL102c.js";import{S as fe}from"./switch-Ct9qaOvk.js";import{T as It}from"./trash-2-uDLx8yM9.js";import{S as xs}from"./save-D41s1EFm.js";import{G as Rn}from"./grip-vertical-lrEKdnOU.js";import{L as vs}from"./lightbulb-BaDmslCX.js";const En=()=>{const{profile:e}=Nn(),{data:t}=Dn({queryKey:["subscription-access",e==null?void 0:e.organization_id],queryFn:async()=>{var v;if(!(e!=null&&e.organization_id))return{planName:null,planId:null};const{data:h}=await ce.from("subscriptions").select(`
          *,
          plan:subscription_plans(name)
        `).eq("organization_id",e.organization_id).eq("status","active").maybeSingle();if(h)return{planName:((v=h.plan)==null?void 0:v.name)||"Unknown",planId:h.plan_id};const{data:x}=await ce.from("organization_trials").select("*").eq("organization_id",e.organization_id).eq("trial_status","active").maybeSingle();return x?{planName:"Trial",planId:"trial"}:{planName:"Starter",planId:"starter"}},enabled:!!(e!=null&&e.organization_id),staleTime:5*60*1e3}),n=(t==null?void 0:t.planName)||"Starter",s=["Professional","Enterprise","Trial"].includes(n),i=n==="Enterprise",o=s,c=s,d=s,u=s,f=!s;return{canEditQuestions:o,canCreateQuestionSets:c,canReorderQuestions:d,canAccessAdvancedFeatures:u,currentPlan:n,isProfessionalOrHigher:s,isEnterprise:i,upgradeRequired:f,upgradeMessage:f?"Upgrade to Professional or Enterprise plan to edit and create custom question sets":""}};function ms(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return l.useMemo(()=>s=>{t.forEach(i=>i(s))},t)}const pt=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function _e(e){const t=Object.prototype.toString.call(e);return t==="[object Window]"||t==="[object global]"}function _t(e){return"nodeType"in e}function G(e){var t,n;return e?_e(e)?e:_t(e)&&(t=(n=e.ownerDocument)==null?void 0:n.defaultView)!=null?t:window:window}function Ft(e){const{Document:t}=G(e);return e instanceof t}function Ge(e){return _e(e)?!1:e instanceof G(e).HTMLElement}function Mn(e){return e instanceof G(e).SVGElement}function Fe(e){return e?_e(e)?e.document:_t(e)?Ft(e)?e:Ge(e)||Mn(e)?e.ownerDocument:document:document:document}const he=pt?l.useLayoutEffect:l.useEffect;function Lt(e){const t=l.useRef(e);return he(()=>{t.current=e}),l.useCallback(function(){for(var n=arguments.length,s=new Array(n),i=0;i<n;i++)s[i]=arguments[i];return t.current==null?void 0:t.current(...s)},[])}function bs(){const e=l.useRef(null),t=l.useCallback((s,i)=>{e.current=setInterval(s,i)},[]),n=l.useCallback(()=>{e.current!==null&&(clearInterval(e.current),e.current=null)},[]);return[t,n]}function He(e,t){t===void 0&&(t=[e]);const n=l.useRef(e);return he(()=>{n.current!==e&&(n.current=e)},t),n}function Je(e,t){const n=l.useRef();return l.useMemo(()=>{const s=e(n.current);return n.current=s,s},[...t])}function ut(e){const t=Lt(e),n=l.useRef(null),s=l.useCallback(i=>{i!==n.current&&(t==null||t(i,n.current)),n.current=i},[]);return[n,s]}function At(e){const t=l.useRef();return l.useEffect(()=>{t.current=e},[e]),t.current}let Nt={};function Ze(e,t){return l.useMemo(()=>{if(t)return t;const n=Nt[e]==null?0:Nt[e]+1;return Nt[e]=n,e+"-"+n},[e,t])}function In(e){return function(t){for(var n=arguments.length,s=new Array(n>1?n-1:0),i=1;i<n;i++)s[i-1]=arguments[i];return s.reduce((o,c)=>{const d=Object.entries(c);for(const[u,f]of d){const g=o[u];g!=null&&(o[u]=g+e*f)}return o},{...t})}}const Te=In(1),Ve=In(-1);function ys(e){return"clientX"in e&&"clientY"in e}function Qt(e){if(!e)return!1;const{KeyboardEvent:t}=G(e.target);return t&&e instanceof t}function ws(e){if(!e)return!1;const{TouchEvent:t}=G(e.target);return t&&e instanceof t}function kt(e){if(ws(e)){if(e.touches&&e.touches.length){const{clientX:t,clientY:n}=e.touches[0];return{x:t,y:n}}else if(e.changedTouches&&e.changedTouches.length){const{clientX:t,clientY:n}=e.changedTouches[0];return{x:t,y:n}}}return ys(e)?{x:e.clientX,y:e.clientY}:null}const We=Object.freeze({Translate:{toString(e){if(!e)return;const{x:t,y:n}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(n?Math.round(n):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;const{scaleX:t,scaleY:n}=e;return"scaleX("+t+") scaleY("+n+")"}},Transform:{toString(e){if(e)return[We.Translate.toString(e),We.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:n,easing:s}=e;return t+" "+n+"ms "+s}}}),un="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function js(e){return e.matches(un)?e:e.querySelector(un)}const Cs={display:"none"};function Ss(e){let{id:t,value:n}=e;return K.createElement("div",{id:t,style:Cs},n)}function Ns(e){let{id:t,announcement:n,ariaLiveType:s="assertive"}=e;const i={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return K.createElement("div",{id:t,style:i,role:"status","aria-live":s,"aria-atomic":!0},n)}function Ds(){const[e,t]=l.useState("");return{announce:l.useCallback(s=>{s!=null&&t(s)},[]),announcement:e}}const An=l.createContext(null);function Rs(e){const t=l.useContext(An);l.useEffect(()=>{if(!t)throw new Error("useDndMonitor must be used within a children of <DndContext>");return t(e)},[e,t])}function Es(){const[e]=l.useState(()=>new Set),t=l.useCallback(s=>(e.add(s),()=>e.delete(s)),[e]);return[l.useCallback(s=>{let{type:i,event:o}=s;e.forEach(c=>{var d;return(d=c[i])==null?void 0:d.call(c,o)})},[e]),t]}const Ms={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},Is={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was moved over droppable area "+n.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was dropped over droppable area "+n.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function As(e){let{announcements:t=Is,container:n,hiddenTextDescribedById:s,screenReaderInstructions:i=Ms}=e;const{announce:o,announcement:c}=Ds(),d=Ze("DndLiveRegion"),[u,f]=l.useState(!1);if(l.useEffect(()=>{f(!0)},[]),Rs(l.useMemo(()=>({onDragStart(h){let{active:x}=h;o(t.onDragStart({active:x}))},onDragMove(h){let{active:x,over:v}=h;t.onDragMove&&o(t.onDragMove({active:x,over:v}))},onDragOver(h){let{active:x,over:v}=h;o(t.onDragOver({active:x,over:v}))},onDragEnd(h){let{active:x,over:v}=h;o(t.onDragEnd({active:x,over:v}))},onDragCancel(h){let{active:x,over:v}=h;o(t.onDragCancel({active:x,over:v}))}}),[o,t])),!u)return null;const g=K.createElement(K.Fragment,null,K.createElement(Ss,{id:s,value:i.draggable}),K.createElement(Ns,{id:d,announcement:c}));return n?$e.createPortal(g,n):g}var L;(function(e){e.DragStart="dragStart",e.DragMove="dragMove",e.DragEnd="dragEnd",e.DragCancel="dragCancel",e.DragOver="dragOver",e.RegisterDroppable="registerDroppable",e.SetDroppableDisabled="setDroppableDisabled",e.UnregisterDroppable="unregisterDroppable"})(L||(L={}));function ft(){}function fn(e,t){return l.useMemo(()=>({sensor:e,options:t??{}}),[e,t])}function ks(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return l.useMemo(()=>[...t].filter(s=>s!=null),[...t])}const le=Object.freeze({x:0,y:0});function kn(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function qn(e,t){let{data:{value:n}}=e,{data:{value:s}}=t;return n-s}function qs(e,t){let{data:{value:n}}=e,{data:{value:s}}=t;return s-n}function hn(e){let{left:t,top:n,height:s,width:i}=e;return[{x:t,y:n},{x:t+i,y:n},{x:t,y:n+s},{x:t+i,y:n+s}]}function On(e,t){if(!e||e.length===0)return null;const[n]=e;return n[t]}function gn(e,t,n){return t===void 0&&(t=e.left),n===void 0&&(n=e.top),{x:t+e.width*.5,y:n+e.height*.5}}const Os=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:s}=e;const i=gn(t,t.left,t.top),o=[];for(const c of s){const{id:d}=c,u=n.get(d);if(u){const f=kn(gn(u),i);o.push({id:d,data:{droppableContainer:c,value:f}})}}return o.sort(qn)},Ts=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:s}=e;const i=hn(t),o=[];for(const c of s){const{id:d}=c,u=n.get(d);if(u){const f=hn(u),g=i.reduce((x,v,N)=>x+kn(f[N],v),0),h=Number((g/4).toFixed(4));o.push({id:d,data:{droppableContainer:c,value:h}})}}return o.sort(qn)};function _s(e,t){const n=Math.max(t.top,e.top),s=Math.max(t.left,e.left),i=Math.min(t.left+t.width,e.left+e.width),o=Math.min(t.top+t.height,e.top+e.height),c=i-s,d=o-n;if(s<i&&n<o){const u=t.width*t.height,f=e.width*e.height,g=c*d,h=g/(u+f-g);return Number(h.toFixed(4))}return 0}const Fs=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:s}=e;const i=[];for(const o of s){const{id:c}=o,d=n.get(c);if(d){const u=_s(d,t);u>0&&i.push({id:c,data:{droppableContainer:o,value:u}})}}return i.sort(qs)};function Ls(e,t,n){return{...e,scaleX:t&&n?t.width/n.width:1,scaleY:t&&n?t.height/n.height:1}}function Tn(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:le}function Qs(e){return function(n){for(var s=arguments.length,i=new Array(s>1?s-1:0),o=1;o<s;o++)i[o-1]=arguments[o];return i.reduce((c,d)=>({...c,top:c.top+e*d.y,bottom:c.bottom+e*d.y,left:c.left+e*d.x,right:c.right+e*d.x}),{...n})}}const Ps=Qs(1);function zs(e){if(e.startsWith("matrix3d(")){const t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}else if(e.startsWith("matrix(")){const t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}function Bs(e,t,n){const s=zs(t);if(!s)return e;const{scaleX:i,scaleY:o,x:c,y:d}=s,u=e.left-c-(1-i)*parseFloat(n),f=e.top-d-(1-o)*parseFloat(n.slice(n.indexOf(" ")+1)),g=i?e.width/i:e.width,h=o?e.height/o:e.height;return{width:g,height:h,top:f,right:u+g,bottom:f+h,left:u}}const $s={ignoreTransform:!1};function Le(e,t){t===void 0&&(t=$s);let n=e.getBoundingClientRect();if(t.ignoreTransform){const{transform:f,transformOrigin:g}=G(e).getComputedStyle(e);f&&(n=Bs(n,f,g))}const{top:s,left:i,width:o,height:c,bottom:d,right:u}=n;return{top:s,left:i,width:o,height:c,bottom:d,right:u}}function pn(e){return Le(e,{ignoreTransform:!0})}function Us(e){const t=e.innerWidth,n=e.innerHeight;return{top:0,left:0,right:t,bottom:n,width:t,height:n}}function Xs(e,t){return t===void 0&&(t=G(e).getComputedStyle(e)),t.position==="fixed"}function Ys(e,t){t===void 0&&(t=G(e).getComputedStyle(e));const n=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(i=>{const o=t[i];return typeof o=="string"?n.test(o):!1})}function xt(e,t){const n=[];function s(i){if(t!=null&&n.length>=t||!i)return n;if(Ft(i)&&i.scrollingElement!=null&&!n.includes(i.scrollingElement))return n.push(i.scrollingElement),n;if(!Ge(i)||Mn(i)||n.includes(i))return n;const o=G(e).getComputedStyle(i);return i!==e&&Ys(i,o)&&n.push(i),Xs(i,o)?n:s(i.parentNode)}return e?s(e):n}function _n(e){const[t]=xt(e,1);return t??null}function Dt(e){return!pt||!e?null:_e(e)?e:_t(e)?Ft(e)||e===Fe(e).scrollingElement?window:Ge(e)?e:null:null}function Fn(e){return _e(e)?e.scrollX:e.scrollLeft}function Ln(e){return _e(e)?e.scrollY:e.scrollTop}function qt(e){return{x:Fn(e),y:Ln(e)}}var B;(function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"})(B||(B={}));function Qn(e){return!pt||!e?!1:e===document.scrollingElement}function Pn(e){const t={x:0,y:0},n=Qn(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},s={x:e.scrollWidth-n.width,y:e.scrollHeight-n.height},i=e.scrollTop<=t.y,o=e.scrollLeft<=t.x,c=e.scrollTop>=s.y,d=e.scrollLeft>=s.x;return{isTop:i,isLeft:o,isBottom:c,isRight:d,maxScroll:s,minScroll:t}}const Hs={x:.2,y:.2};function Vs(e,t,n,s,i){let{top:o,left:c,right:d,bottom:u}=n;s===void 0&&(s=10),i===void 0&&(i=Hs);const{isTop:f,isBottom:g,isLeft:h,isRight:x}=Pn(e),v={x:0,y:0},N={x:0,y:0},m={height:t.height*i.y,width:t.width*i.x};return!f&&o<=t.top+m.height?(v.y=B.Backward,N.y=s*Math.abs((t.top+m.height-o)/m.height)):!g&&u>=t.bottom-m.height&&(v.y=B.Forward,N.y=s*Math.abs((t.bottom-m.height-u)/m.height)),!x&&d>=t.right-m.width?(v.x=B.Forward,N.x=s*Math.abs((t.right-m.width-d)/m.width)):!h&&c<=t.left+m.width&&(v.x=B.Backward,N.x=s*Math.abs((t.left+m.width-c)/m.width)),{direction:v,speed:N}}function Ws(e){if(e===document.scrollingElement){const{innerWidth:o,innerHeight:c}=window;return{top:0,left:0,right:o,bottom:c,width:o,height:c}}const{top:t,left:n,right:s,bottom:i}=e.getBoundingClientRect();return{top:t,left:n,right:s,bottom:i,width:e.clientWidth,height:e.clientHeight}}function zn(e){return e.reduce((t,n)=>Te(t,qt(n)),le)}function Ks(e){return e.reduce((t,n)=>t+Fn(n),0)}function Gs(e){return e.reduce((t,n)=>t+Ln(n),0)}function Js(e,t){if(t===void 0&&(t=Le),!e)return;const{top:n,left:s,bottom:i,right:o}=t(e);_n(e)&&(i<=0||o<=0||n>=window.innerHeight||s>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}const Zs=[["x",["left","right"],Ks],["y",["top","bottom"],Gs]];class Pt{constructor(t,n){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const s=xt(n),i=zn(s);this.rect={...t},this.width=t.width,this.height=t.height;for(const[o,c,d]of Zs)for(const u of c)Object.defineProperty(this,u,{get:()=>{const f=d(s),g=i[o]-f;return this.rect[u]+g},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class Ue{constructor(t){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(n=>{var s;return(s=this.target)==null?void 0:s.removeEventListener(...n)})},this.target=t}add(t,n,s){var i;(i=this.target)==null||i.addEventListener(t,n,s),this.listeners.push([t,n,s])}}function er(e){const{EventTarget:t}=G(e);return e instanceof t?e:Fe(e)}function Rt(e,t){const n=Math.abs(e.x),s=Math.abs(e.y);return typeof t=="number"?Math.sqrt(n**2+s**2)>t:"x"in t&&"y"in t?n>t.x&&s>t.y:"x"in t?n>t.x:"y"in t?s>t.y:!1}var re;(function(e){e.Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange"})(re||(re={}));function xn(e){e.preventDefault()}function tr(e){e.stopPropagation()}var M;(function(e){e.Space="Space",e.Down="ArrowDown",e.Right="ArrowRight",e.Left="ArrowLeft",e.Up="ArrowUp",e.Esc="Escape",e.Enter="Enter",e.Tab="Tab"})(M||(M={}));const Bn={start:[M.Space,M.Enter],cancel:[M.Esc],end:[M.Space,M.Enter,M.Tab]},nr=(e,t)=>{let{currentCoordinates:n}=t;switch(e.code){case M.Right:return{...n,x:n.x+25};case M.Left:return{...n,x:n.x-25};case M.Down:return{...n,y:n.y+25};case M.Up:return{...n,y:n.y-25}}};class zt{constructor(t){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=t;const{event:{target:n}}=t;this.props=t,this.listeners=new Ue(Fe(n)),this.windowListeners=new Ue(G(n)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(re.Resize,this.handleCancel),this.windowListeners.add(re.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(re.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:t,onStart:n}=this.props,s=t.node.current;s&&Js(s),n(le)}handleKeyDown(t){if(Qt(t)){const{active:n,context:s,options:i}=this.props,{keyboardCodes:o=Bn,coordinateGetter:c=nr,scrollBehavior:d="smooth"}=i,{code:u}=t;if(o.end.includes(u)){this.handleEnd(t);return}if(o.cancel.includes(u)){this.handleCancel(t);return}const{collisionRect:f}=s.current,g=f?{x:f.left,y:f.top}:le;this.referenceCoordinates||(this.referenceCoordinates=g);const h=c(t,{active:n,context:s.current,currentCoordinates:g});if(h){const x=Ve(h,g),v={x:0,y:0},{scrollableAncestors:N}=s.current;for(const m of N){const y=t.code,{isTop:R,isRight:D,isLeft:b,isBottom:j,maxScroll:w,minScroll:C}=Pn(m),S=Ws(m),E={x:Math.min(y===M.Right?S.right-S.width/2:S.right,Math.max(y===M.Right?S.left:S.left+S.width/2,h.x)),y:Math.min(y===M.Down?S.bottom-S.height/2:S.bottom,Math.max(y===M.Down?S.top:S.top+S.height/2,h.y))},q=y===M.Right&&!D||y===M.Left&&!b,O=y===M.Down&&!j||y===M.Up&&!R;if(q&&E.x!==h.x){const A=m.scrollLeft+x.x,Y=y===M.Right&&A<=w.x||y===M.Left&&A>=C.x;if(Y&&!x.y){m.scrollTo({left:A,behavior:d});return}Y?v.x=m.scrollLeft-A:v.x=y===M.Right?m.scrollLeft-w.x:m.scrollLeft-C.x,v.x&&m.scrollBy({left:-v.x,behavior:d});break}else if(O&&E.y!==h.y){const A=m.scrollTop+x.y,Y=y===M.Down&&A<=w.y||y===M.Up&&A>=C.y;if(Y&&!x.x){m.scrollTo({top:A,behavior:d});return}Y?v.y=m.scrollTop-A:v.y=y===M.Down?m.scrollTop-w.y:m.scrollTop-C.y,v.y&&m.scrollBy({top:-v.y,behavior:d});break}}this.handleMove(t,Te(Ve(h,this.referenceCoordinates),v))}}}handleMove(t,n){const{onMove:s}=this.props;t.preventDefault(),s(n)}handleEnd(t){const{onEnd:n}=this.props;t.preventDefault(),this.detach(),n()}handleCancel(t){const{onCancel:n}=this.props;t.preventDefault(),this.detach(),n()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}zt.activators=[{eventName:"onKeyDown",handler:(e,t,n)=>{let{keyboardCodes:s=Bn,onActivation:i}=t,{active:o}=n;const{code:c}=e.nativeEvent;if(s.start.includes(c)){const d=o.activatorNode.current;return d&&e.target!==d?!1:(e.preventDefault(),i==null||i({event:e.nativeEvent}),!0)}return!1}}];function vn(e){return!!(e&&"distance"in e)}function mn(e){return!!(e&&"delay"in e)}class Bt{constructor(t,n,s){var i;s===void 0&&(s=er(t.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=t,this.events=n;const{event:o}=t,{target:c}=o;this.props=t,this.events=n,this.document=Fe(c),this.documentListeners=new Ue(this.document),this.listeners=new Ue(s),this.windowListeners=new Ue(G(c)),this.initialCoordinates=(i=kt(o))!=null?i:le,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:t,props:{options:{activationConstraint:n,bypassActivationConstraint:s}}}=this;if(this.listeners.add(t.move.name,this.handleMove,{passive:!1}),this.listeners.add(t.end.name,this.handleEnd),t.cancel&&this.listeners.add(t.cancel.name,this.handleCancel),this.windowListeners.add(re.Resize,this.handleCancel),this.windowListeners.add(re.DragStart,xn),this.windowListeners.add(re.VisibilityChange,this.handleCancel),this.windowListeners.add(re.ContextMenu,xn),this.documentListeners.add(re.Keydown,this.handleKeydown),n){if(s!=null&&s({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(mn(n)){this.timeoutId=setTimeout(this.handleStart,n.delay),this.handlePending(n);return}if(vn(n)){this.handlePending(n);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(t,n){const{active:s,onPending:i}=this.props;i(s,t,this.initialCoordinates,n)}handleStart(){const{initialCoordinates:t}=this,{onStart:n}=this.props;t&&(this.activated=!0,this.documentListeners.add(re.Click,tr,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(re.SelectionChange,this.removeTextSelection),n(t))}handleMove(t){var n;const{activated:s,initialCoordinates:i,props:o}=this,{onMove:c,options:{activationConstraint:d}}=o;if(!i)return;const u=(n=kt(t))!=null?n:le,f=Ve(i,u);if(!s&&d){if(vn(d)){if(d.tolerance!=null&&Rt(f,d.tolerance))return this.handleCancel();if(Rt(f,d.distance))return this.handleStart()}if(mn(d)&&Rt(f,d.tolerance))return this.handleCancel();this.handlePending(d,f);return}t.cancelable&&t.preventDefault(),c(u)}handleEnd(){const{onAbort:t,onEnd:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleCancel(){const{onAbort:t,onCancel:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleKeydown(t){t.code===M.Esc&&this.handleCancel()}removeTextSelection(){var t;(t=this.document.getSelection())==null||t.removeAllRanges()}}const sr={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class $t extends Bt{constructor(t){const{event:n}=t,s=Fe(n.target);super(t,sr,s)}}$t.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:s}=t;return!n.isPrimary||n.button!==0?!1:(s==null||s({event:n}),!0)}}];const rr={move:{name:"mousemove"},end:{name:"mouseup"}};var Ot;(function(e){e[e.RightClick=2]="RightClick"})(Ot||(Ot={}));class ir extends Bt{constructor(t){super(t,rr,Fe(t.event.target))}}ir.activators=[{eventName:"onMouseDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:s}=t;return n.button===Ot.RightClick?!1:(s==null||s({event:n}),!0)}}];const Et={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class or extends Bt{constructor(t){super(t,Et)}static setup(){return window.addEventListener(Et.move.name,t,{capture:!1,passive:!1}),function(){window.removeEventListener(Et.move.name,t)};function t(){}}}or.activators=[{eventName:"onTouchStart",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:s}=t;const{touches:i}=n;return i.length>1?!1:(s==null||s({event:n}),!0)}}];var Xe;(function(e){e[e.Pointer=0]="Pointer",e[e.DraggableRect=1]="DraggableRect"})(Xe||(Xe={}));var ht;(function(e){e[e.TreeOrder=0]="TreeOrder",e[e.ReversedTreeOrder=1]="ReversedTreeOrder"})(ht||(ht={}));function ar(e){let{acceleration:t,activator:n=Xe.Pointer,canScroll:s,draggingRect:i,enabled:o,interval:c=5,order:d=ht.TreeOrder,pointerCoordinates:u,scrollableAncestors:f,scrollableAncestorRects:g,delta:h,threshold:x}=e;const v=lr({delta:h,disabled:!o}),[N,m]=bs(),y=l.useRef({x:0,y:0}),R=l.useRef({x:0,y:0}),D=l.useMemo(()=>{switch(n){case Xe.Pointer:return u?{top:u.y,bottom:u.y,left:u.x,right:u.x}:null;case Xe.DraggableRect:return i}},[n,i,u]),b=l.useRef(null),j=l.useCallback(()=>{const C=b.current;if(!C)return;const S=y.current.x*R.current.x,E=y.current.y*R.current.y;C.scrollBy(S,E)},[]),w=l.useMemo(()=>d===ht.TreeOrder?[...f].reverse():f,[d,f]);l.useEffect(()=>{if(!o||!f.length||!D){m();return}for(const C of w){if((s==null?void 0:s(C))===!1)continue;const S=f.indexOf(C),E=g[S];if(!E)continue;const{direction:q,speed:O}=Vs(C,E,D,t,x);for(const A of["x","y"])v[A][q[A]]||(O[A]=0,q[A]=0);if(O.x>0||O.y>0){m(),b.current=C,N(j,c),y.current=O,R.current=q;return}}y.current={x:0,y:0},R.current={x:0,y:0},m()},[t,j,s,m,o,c,JSON.stringify(D),JSON.stringify(v),N,f,w,g,JSON.stringify(x)])}const cr={x:{[B.Backward]:!1,[B.Forward]:!1},y:{[B.Backward]:!1,[B.Forward]:!1}};function lr(e){let{delta:t,disabled:n}=e;const s=At(t);return Je(i=>{if(n||!s||!i)return cr;const o={x:Math.sign(t.x-s.x),y:Math.sign(t.y-s.y)};return{x:{[B.Backward]:i.x[B.Backward]||o.x===-1,[B.Forward]:i.x[B.Forward]||o.x===1},y:{[B.Backward]:i.y[B.Backward]||o.y===-1,[B.Forward]:i.y[B.Forward]||o.y===1}}},[n,t,s])}function dr(e,t){const n=t!=null?e.get(t):void 0,s=n?n.node.current:null;return Je(i=>{var o;return t==null?null:(o=s??i)!=null?o:null},[s,t])}function ur(e,t){return l.useMemo(()=>e.reduce((n,s)=>{const{sensor:i}=s,o=i.activators.map(c=>({eventName:c.eventName,handler:t(c.handler,s)}));return[...n,...o]},[]),[e,t])}var Ke;(function(e){e[e.Always=0]="Always",e[e.BeforeDragging=1]="BeforeDragging",e[e.WhileDragging=2]="WhileDragging"})(Ke||(Ke={}));var Tt;(function(e){e.Optimized="optimized"})(Tt||(Tt={}));const bn=new Map;function fr(e,t){let{dragging:n,dependencies:s,config:i}=t;const[o,c]=l.useState(null),{frequency:d,measure:u,strategy:f}=i,g=l.useRef(e),h=y(),x=He(h),v=l.useCallback(function(R){R===void 0&&(R=[]),!x.current&&c(D=>D===null?R:D.concat(R.filter(b=>!D.includes(b))))},[x]),N=l.useRef(null),m=Je(R=>{if(h&&!n)return bn;if(!R||R===bn||g.current!==e||o!=null){const D=new Map;for(let b of e){if(!b)continue;if(o&&o.length>0&&!o.includes(b.id)&&b.rect.current){D.set(b.id,b.rect.current);continue}const j=b.node.current,w=j?new Pt(u(j),j):null;b.rect.current=w,w&&D.set(b.id,w)}return D}return R},[e,o,n,h,u]);return l.useEffect(()=>{g.current=e},[e]),l.useEffect(()=>{h||v()},[n,h]),l.useEffect(()=>{o&&o.length>0&&c(null)},[JSON.stringify(o)]),l.useEffect(()=>{h||typeof d!="number"||N.current!==null||(N.current=setTimeout(()=>{v(),N.current=null},d))},[d,h,v,...s]),{droppableRects:m,measureDroppableContainers:v,measuringScheduled:o!=null};function y(){switch(f){case Ke.Always:return!1;case Ke.BeforeDragging:return n;default:return!n}}}function $n(e,t){return Je(n=>e?n||(typeof t=="function"?t(e):e):null,[t,e])}function hr(e,t){return $n(e,t)}function gr(e){let{callback:t,disabled:n}=e;const s=Lt(t),i=l.useMemo(()=>{if(n||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:o}=window;return new o(s)},[s,n]);return l.useEffect(()=>()=>i==null?void 0:i.disconnect(),[i]),i}function vt(e){let{callback:t,disabled:n}=e;const s=Lt(t),i=l.useMemo(()=>{if(n||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:o}=window;return new o(s)},[n]);return l.useEffect(()=>()=>i==null?void 0:i.disconnect(),[i]),i}function pr(e){return new Pt(Le(e),e)}function yn(e,t,n){t===void 0&&(t=pr);const[s,i]=l.useState(null);function o(){i(u=>{if(!e)return null;if(e.isConnected===!1){var f;return(f=u??n)!=null?f:null}const g=t(e);return JSON.stringify(u)===JSON.stringify(g)?u:g})}const c=gr({callback(u){if(e)for(const f of u){const{type:g,target:h}=f;if(g==="childList"&&h instanceof HTMLElement&&h.contains(e)){o();break}}}}),d=vt({callback:o});return he(()=>{o(),e?(d==null||d.observe(e),c==null||c.observe(document.body,{childList:!0,subtree:!0})):(d==null||d.disconnect(),c==null||c.disconnect())},[e]),s}function xr(e){const t=$n(e);return Tn(e,t)}const wn=[];function vr(e){const t=l.useRef(e),n=Je(s=>e?s&&s!==wn&&e&&t.current&&e.parentNode===t.current.parentNode?s:xt(e):wn,[e]);return l.useEffect(()=>{t.current=e},[e]),n}function mr(e){const[t,n]=l.useState(null),s=l.useRef(e),i=l.useCallback(o=>{const c=Dt(o.target);c&&n(d=>d?(d.set(c,qt(c)),new Map(d)):null)},[]);return l.useEffect(()=>{const o=s.current;if(e!==o){c(o);const d=e.map(u=>{const f=Dt(u);return f?(f.addEventListener("scroll",i,{passive:!0}),[f,qt(f)]):null}).filter(u=>u!=null);n(d.length?new Map(d):null),s.current=e}return()=>{c(e),c(o)};function c(d){d.forEach(u=>{const f=Dt(u);f==null||f.removeEventListener("scroll",i)})}},[i,e]),l.useMemo(()=>e.length?t?Array.from(t.values()).reduce((o,c)=>Te(o,c),le):zn(e):le,[e,t])}function jn(e,t){t===void 0&&(t=[]);const n=l.useRef(null);return l.useEffect(()=>{n.current=null},t),l.useEffect(()=>{const s=e!==le;s&&!n.current&&(n.current=e),!s&&n.current&&(n.current=null)},[e]),n.current?Ve(e,n.current):le}function br(e){l.useEffect(()=>{if(!pt)return;const t=e.map(n=>{let{sensor:s}=n;return s.setup==null?void 0:s.setup()});return()=>{for(const n of t)n==null||n()}},e.map(t=>{let{sensor:n}=t;return n}))}function yr(e,t){return l.useMemo(()=>e.reduce((n,s)=>{let{eventName:i,handler:o}=s;return n[i]=c=>{o(c,t)},n},{}),[e,t])}function Un(e){return l.useMemo(()=>e?Us(e):null,[e])}const Cn=[];function wr(e,t){t===void 0&&(t=Le);const[n]=e,s=Un(n?G(n):null),[i,o]=l.useState(Cn);function c(){o(()=>e.length?e.map(u=>Qn(u)?s:new Pt(t(u),u)):Cn)}const d=vt({callback:c});return he(()=>{d==null||d.disconnect(),c(),e.forEach(u=>d==null?void 0:d.observe(u))},[e]),i}function jr(e){if(!e)return null;if(e.children.length>1)return e;const t=e.children[0];return Ge(t)?t:e}function Cr(e){let{measure:t}=e;const[n,s]=l.useState(null),i=l.useCallback(f=>{for(const{target:g}of f)if(Ge(g)){s(h=>{const x=t(g);return h?{...h,width:x.width,height:x.height}:x});break}},[t]),o=vt({callback:i}),c=l.useCallback(f=>{const g=jr(f);o==null||o.disconnect(),g&&(o==null||o.observe(g)),s(g?t(g):null)},[t,o]),[d,u]=ut(c);return l.useMemo(()=>({nodeRef:d,rect:n,setRef:u}),[n,d,u])}const Sr=[{sensor:$t,options:{}},{sensor:zt,options:{}}],Nr={current:{}},dt={draggable:{measure:pn},droppable:{measure:pn,strategy:Ke.WhileDragging,frequency:Tt.Optimized},dragOverlay:{measure:Le}};class Ye extends Map{get(t){var n;return t!=null&&(n=super.get(t))!=null?n:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(t=>{let{disabled:n}=t;return!n})}getNodeFor(t){var n,s;return(n=(s=this.get(t))==null?void 0:s.node.current)!=null?n:void 0}}const Dr={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new Ye,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:ft},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:dt,measureDroppableContainers:ft,windowRect:null,measuringScheduled:!1},Rr={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:ft,draggableNodes:new Map,over:null,measureDroppableContainers:ft},mt=l.createContext(Rr),Xn=l.createContext(Dr);function Er(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new Ye}}}function Mr(e,t){switch(t.type){case L.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case L.DragMove:return e.draggable.active==null?e:{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}};case L.DragEnd:case L.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case L.RegisterDroppable:{const{element:n}=t,{id:s}=n,i=new Ye(e.droppable.containers);return i.set(s,n),{...e,droppable:{...e.droppable,containers:i}}}case L.SetDroppableDisabled:{const{id:n,key:s,disabled:i}=t,o=e.droppable.containers.get(n);if(!o||s!==o.key)return e;const c=new Ye(e.droppable.containers);return c.set(n,{...o,disabled:i}),{...e,droppable:{...e.droppable,containers:c}}}case L.UnregisterDroppable:{const{id:n,key:s}=t,i=e.droppable.containers.get(n);if(!i||s!==i.key)return e;const o=new Ye(e.droppable.containers);return o.delete(n),{...e,droppable:{...e.droppable,containers:o}}}default:return e}}function Ir(e){let{disabled:t}=e;const{active:n,activatorEvent:s,draggableNodes:i}=l.useContext(mt),o=At(s),c=At(n==null?void 0:n.id);return l.useEffect(()=>{if(!t&&!s&&o&&c!=null){if(!Qt(o)||document.activeElement===o.target)return;const d=i.get(c);if(!d)return;const{activatorNode:u,node:f}=d;if(!u.current&&!f.current)return;requestAnimationFrame(()=>{for(const g of[u.current,f.current]){if(!g)continue;const h=js(g);if(h){h.focus();break}}})}},[s,t,i,c,o]),null}function Ar(e,t){let{transform:n,...s}=t;return e!=null&&e.length?e.reduce((i,o)=>o({transform:i,...s}),n):n}function kr(e){return l.useMemo(()=>({draggable:{...dt.draggable,...e==null?void 0:e.draggable},droppable:{...dt.droppable,...e==null?void 0:e.droppable},dragOverlay:{...dt.dragOverlay,...e==null?void 0:e.dragOverlay}}),[e==null?void 0:e.draggable,e==null?void 0:e.droppable,e==null?void 0:e.dragOverlay])}function qr(e){let{activeNode:t,measure:n,initialRect:s,config:i=!0}=e;const o=l.useRef(!1),{x:c,y:d}=typeof i=="boolean"?{x:i,y:i}:i;he(()=>{if(!c&&!d||!t){o.current=!1;return}if(o.current||!s)return;const f=t==null?void 0:t.node.current;if(!f||f.isConnected===!1)return;const g=n(f),h=Tn(g,s);if(c||(h.x=0),d||(h.y=0),o.current=!0,Math.abs(h.x)>0||Math.abs(h.y)>0){const x=_n(f);x&&x.scrollBy({top:h.y,left:h.x})}},[t,c,d,s,n])}const Yn=l.createContext({...le,scaleX:1,scaleY:1});var Ce;(function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"})(Ce||(Ce={}));const Or=l.memo(function(t){var n,s,i,o;let{id:c,accessibility:d,autoScroll:u=!0,children:f,sensors:g=Sr,collisionDetection:h=Fs,measuring:x,modifiers:v,...N}=t;const m=l.useReducer(Mr,void 0,Er),[y,R]=m,[D,b]=Es(),[j,w]=l.useState(Ce.Uninitialized),C=j===Ce.Initialized,{draggable:{active:S,nodes:E,translate:q},droppable:{containers:O}}=y,A=S!=null?E.get(S):null,Y=l.useRef({initial:null,translated:null}),W=l.useMemo(()=>{var X;return S!=null?{id:S,data:(X=A==null?void 0:A.data)!=null?X:Nr,rect:Y}:null},[S,A]),te=l.useRef(null),[Se,Ee]=l.useState(null),[H,Me]=l.useState(null),ie=He(N,Object.values(N)),Ne=Ze("DndDescribedBy",c),De=l.useMemo(()=>O.getEnabled(),[O]),U=kr(x),{droppableRects:oe,measureDroppableContainers:ae,measuringScheduled:ge}=fr(De,{dragging:C,dependencies:[q.x,q.y],config:U.droppable}),a=dr(E,S),p=l.useMemo(()=>H?kt(H):null,[H]),k=is(),Q=hr(a,U.draggable.measure);qr({activeNode:S!=null?E.get(S):null,config:k.layoutShiftCompensation,initialRect:Q,measure:U.draggable.measure});const I=yn(a,U.draggable.measure,Q),ne=yn(a?a.parentElement:null),V=l.useRef({activatorEvent:null,active:null,activeNode:a,collisionRect:null,collisions:null,droppableRects:oe,draggableNodes:E,draggingNode:null,draggingNodeRect:null,droppableContainers:O,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),ve=O.getNodeFor((n=V.current.over)==null?void 0:n.id),pe=Cr({measure:U.dragOverlay.measure}),Ie=(s=pe.nodeRef.current)!=null?s:a,Ae=C?(i=pe.rect)!=null?i:I:null,Xt=!!(pe.nodeRef.current&&pe.rect),Yt=xr(Xt?null:I),bt=Un(Ie?G(Ie):null),me=vr(C?ve??a:null),et=wr(me),tt=Ar(v,{transform:{x:q.x-Yt.x,y:q.y-Yt.y,scaleX:1,scaleY:1},activatorEvent:H,active:W,activeNodeRect:I,containerNodeRect:ne,draggingNodeRect:Ae,over:V.current.over,overlayNodeRect:pe.rect,scrollableAncestors:me,scrollableAncestorRects:et,windowRect:bt}),Ht=p?Te(p,q):null,Vt=mr(me),Jn=jn(Vt),Zn=jn(Vt,[I]),ke=Te(tt,Jn),qe=Ae?Ps(Ae,tt):null,Qe=W&&qe?h({active:W,collisionRect:qe,droppableRects:oe,droppableContainers:De,pointerCoordinates:Ht}):null,Wt=On(Qe,"id"),[be,Kt]=l.useState(null),es=Xt?tt:Te(tt,Zn),ts=Ls(es,(o=be==null?void 0:be.rect)!=null?o:null,I),yt=l.useRef(null),Gt=l.useCallback((X,J)=>{let{sensor:Z,options:ye}=J;if(te.current==null)return;const se=E.get(te.current);if(!se)return;const ee=X.nativeEvent,de=new Z({active:te.current,activeNode:se,event:ee,options:ye,context:V,onAbort($){if(!E.get($))return;const{onDragAbort:ue}=ie.current,xe={id:$};ue==null||ue(xe),D({type:"onDragAbort",event:xe})},onPending($,we,ue,xe){if(!E.get($))return;const{onDragPending:ze}=ie.current,je={id:$,constraint:we,initialCoordinates:ue,offset:xe};ze==null||ze(je),D({type:"onDragPending",event:je})},onStart($){const we=te.current;if(we==null)return;const ue=E.get(we);if(!ue)return;const{onDragStart:xe}=ie.current,Pe={activatorEvent:ee,active:{id:we,data:ue.data,rect:Y}};$e.unstable_batchedUpdates(()=>{xe==null||xe(Pe),w(Ce.Initializing),R({type:L.DragStart,initialCoordinates:$,active:we}),D({type:"onDragStart",event:Pe}),Ee(yt.current),Me(ee)})},onMove($){R({type:L.DragMove,coordinates:$})},onEnd:Oe(L.DragEnd),onCancel:Oe(L.DragCancel)});yt.current=de;function Oe($){return async function(){const{active:ue,collisions:xe,over:Pe,scrollAdjustedTranslate:ze}=V.current;let je=null;if(ue&&ze){const{cancelDrop:Be}=ie.current;je={activatorEvent:ee,active:ue,collisions:xe,delta:ze,over:Pe},$===L.DragEnd&&typeof Be=="function"&&await Promise.resolve(Be(je))&&($=L.DragCancel)}te.current=null,$e.unstable_batchedUpdates(()=>{R({type:$}),w(Ce.Uninitialized),Kt(null),Ee(null),Me(null),yt.current=null;const Be=$===L.DragEnd?"onDragEnd":"onDragCancel";if(je){const wt=ie.current[Be];wt==null||wt(je),D({type:Be,event:je})}})}}},[E]),ns=l.useCallback((X,J)=>(Z,ye)=>{const se=Z.nativeEvent,ee=E.get(ye);if(te.current!==null||!ee||se.dndKit||se.defaultPrevented)return;const de={active:ee};X(Z,J.options,de)===!0&&(se.dndKit={capturedBy:J.sensor},te.current=ye,Gt(Z,J))},[E,Gt]),Jt=ur(g,ns);br(g),he(()=>{I&&j===Ce.Initializing&&w(Ce.Initialized)},[I,j]),l.useEffect(()=>{const{onDragMove:X}=ie.current,{active:J,activatorEvent:Z,collisions:ye,over:se}=V.current;if(!J||!Z)return;const ee={active:J,activatorEvent:Z,collisions:ye,delta:{x:ke.x,y:ke.y},over:se};$e.unstable_batchedUpdates(()=>{X==null||X(ee),D({type:"onDragMove",event:ee})})},[ke.x,ke.y]),l.useEffect(()=>{const{active:X,activatorEvent:J,collisions:Z,droppableContainers:ye,scrollAdjustedTranslate:se}=V.current;if(!X||te.current==null||!J||!se)return;const{onDragOver:ee}=ie.current,de=ye.get(Wt),Oe=de&&de.rect.current?{id:de.id,rect:de.rect.current,data:de.data,disabled:de.disabled}:null,$={active:X,activatorEvent:J,collisions:Z,delta:{x:se.x,y:se.y},over:Oe};$e.unstable_batchedUpdates(()=>{Kt(Oe),ee==null||ee($),D({type:"onDragOver",event:$})})},[Wt]),he(()=>{V.current={activatorEvent:H,active:W,activeNode:a,collisionRect:qe,collisions:Qe,droppableRects:oe,draggableNodes:E,draggingNode:Ie,draggingNodeRect:Ae,droppableContainers:O,over:be,scrollableAncestors:me,scrollAdjustedTranslate:ke},Y.current={initial:Ae,translated:qe}},[W,a,Qe,qe,E,Ie,Ae,oe,O,be,me,ke]),ar({...k,delta:q,draggingRect:qe,pointerCoordinates:Ht,scrollableAncestors:me,scrollableAncestorRects:et});const ss=l.useMemo(()=>({active:W,activeNode:a,activeNodeRect:I,activatorEvent:H,collisions:Qe,containerNodeRect:ne,dragOverlay:pe,draggableNodes:E,droppableContainers:O,droppableRects:oe,over:be,measureDroppableContainers:ae,scrollableAncestors:me,scrollableAncestorRects:et,measuringConfiguration:U,measuringScheduled:ge,windowRect:bt}),[W,a,I,H,Qe,ne,pe,E,O,oe,be,ae,me,et,U,ge,bt]),rs=l.useMemo(()=>({activatorEvent:H,activators:Jt,active:W,activeNodeRect:I,ariaDescribedById:{draggable:Ne},dispatch:R,draggableNodes:E,over:be,measureDroppableContainers:ae}),[H,Jt,W,I,R,Ne,E,be,ae]);return K.createElement(An.Provider,{value:b},K.createElement(mt.Provider,{value:rs},K.createElement(Xn.Provider,{value:ss},K.createElement(Yn.Provider,{value:ts},f)),K.createElement(Ir,{disabled:(d==null?void 0:d.restoreFocus)===!1})),K.createElement(As,{...d,hiddenTextDescribedById:Ne}));function is(){const X=(Se==null?void 0:Se.autoScrollEnabled)===!1,J=typeof u=="object"?u.enabled===!1:u===!1,Z=C&&!X&&!J;return typeof u=="object"?{...u,enabled:Z}:{enabled:Z}}}),Tr=l.createContext(null),Sn="button",_r="Draggable";function Fr(e){let{id:t,data:n,disabled:s=!1,attributes:i}=e;const o=Ze(_r),{activators:c,activatorEvent:d,active:u,activeNodeRect:f,ariaDescribedById:g,draggableNodes:h,over:x}=l.useContext(mt),{role:v=Sn,roleDescription:N="draggable",tabIndex:m=0}=i??{},y=(u==null?void 0:u.id)===t,R=l.useContext(y?Yn:Tr),[D,b]=ut(),[j,w]=ut(),C=yr(c,t),S=He(n);he(()=>(h.set(t,{id:t,key:o,node:D,activatorNode:j,data:S}),()=>{const q=h.get(t);q&&q.key===o&&h.delete(t)}),[h,t]);const E=l.useMemo(()=>({role:v,tabIndex:m,"aria-disabled":s,"aria-pressed":y&&v===Sn?!0:void 0,"aria-roledescription":N,"aria-describedby":g.draggable}),[s,v,m,y,N,g.draggable]);return{active:u,activatorEvent:d,activeNodeRect:f,attributes:E,isDragging:y,listeners:s?void 0:C,node:D,over:x,setNodeRef:b,setActivatorNodeRef:w,transform:R}}function Lr(){return l.useContext(Xn)}const Qr="Droppable",Pr={timeout:25};function zr(e){let{data:t,disabled:n=!1,id:s,resizeObserverConfig:i}=e;const o=Ze(Qr),{active:c,dispatch:d,over:u,measureDroppableContainers:f}=l.useContext(mt),g=l.useRef({disabled:n}),h=l.useRef(!1),x=l.useRef(null),v=l.useRef(null),{disabled:N,updateMeasurementsFor:m,timeout:y}={...Pr,...i},R=He(m??s),D=l.useCallback(()=>{if(!h.current){h.current=!0;return}v.current!=null&&clearTimeout(v.current),v.current=setTimeout(()=>{f(Array.isArray(R.current)?R.current:[R.current]),v.current=null},y)},[y]),b=vt({callback:D,disabled:N||!c}),j=l.useCallback((E,q)=>{b&&(q&&(b.unobserve(q),h.current=!1),E&&b.observe(E))},[b]),[w,C]=ut(j),S=He(t);return l.useEffect(()=>{!b||!w.current||(b.disconnect(),h.current=!1,b.observe(w.current))},[w,b]),l.useEffect(()=>(d({type:L.RegisterDroppable,element:{id:s,key:o,disabled:n,node:w,rect:x,data:S}}),()=>d({type:L.UnregisterDroppable,key:o,id:s})),[s]),l.useEffect(()=>{n!==g.current.disabled&&(d({type:L.SetDroppableDisabled,id:s,key:o,disabled:n}),g.current.disabled=n)},[s,o,n,d]),{active:c,rect:x,isOver:(u==null?void 0:u.id)===s,node:w,over:u,setNodeRef:C}}function Ut(e,t,n){const s=e.slice();return s.splice(n<0?s.length+n:n,0,s.splice(t,1)[0]),s}function Br(e,t){return e.reduce((n,s,i)=>{const o=t.get(s);return o&&(n[i]=o),n},Array(e.length))}function ct(e){return e!==null&&e>=0}function $r(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function Ur(e){return typeof e=="boolean"?{draggable:e,droppable:e}:e}const Hn=e=>{let{rects:t,activeIndex:n,overIndex:s,index:i}=e;const o=Ut(t,s,n),c=t[i],d=o[i];return!d||!c?null:{x:d.left-c.left,y:d.top-c.top,scaleX:d.width/c.width,scaleY:d.height/c.height}},lt={scaleX:1,scaleY:1},Xr=e=>{var t;let{activeIndex:n,activeNodeRect:s,index:i,rects:o,overIndex:c}=e;const d=(t=o[n])!=null?t:s;if(!d)return null;if(i===n){const f=o[c];return f?{x:0,y:n<c?f.top+f.height-(d.top+d.height):f.top-d.top,...lt}:null}const u=Yr(o,i,n);return i>n&&i<=c?{x:0,y:-d.height-u,...lt}:i<n&&i>=c?{x:0,y:d.height+u,...lt}:{x:0,y:0,...lt}};function Yr(e,t,n){const s=e[t],i=e[t-1],o=e[t+1];return s?n<t?i?s.top-(i.top+i.height):o?o.top-(s.top+s.height):0:o?o.top-(s.top+s.height):i?s.top-(i.top+i.height):0:0}const Vn="Sortable",Wn=K.createContext({activeIndex:-1,containerId:Vn,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:Hn,disabled:{draggable:!1,droppable:!1}});function Hr(e){let{children:t,id:n,items:s,strategy:i=Hn,disabled:o=!1}=e;const{active:c,dragOverlay:d,droppableRects:u,over:f,measureDroppableContainers:g}=Lr(),h=Ze(Vn,n),x=d.rect!==null,v=l.useMemo(()=>s.map(C=>typeof C=="object"&&"id"in C?C.id:C),[s]),N=c!=null,m=c?v.indexOf(c.id):-1,y=f?v.indexOf(f.id):-1,R=l.useRef(v),D=!$r(v,R.current),b=y!==-1&&m===-1||D,j=Ur(o);he(()=>{D&&N&&g(v)},[D,v,N,g]),l.useEffect(()=>{R.current=v},[v]);const w=l.useMemo(()=>({activeIndex:m,containerId:h,disabled:j,disableTransforms:b,items:v,overIndex:y,useDragOverlay:x,sortedRects:Br(v,u),strategy:i}),[m,h,j.draggable,j.droppable,b,v,y,u,x,i]);return K.createElement(Wn.Provider,{value:w},t)}const Vr=e=>{let{id:t,items:n,activeIndex:s,overIndex:i}=e;return Ut(n,s,i).indexOf(t)},Wr=e=>{let{containerId:t,isSorting:n,wasDragging:s,index:i,items:o,newIndex:c,previousItems:d,previousContainerId:u,transition:f}=e;return!f||!s||d!==o&&i===c?!1:n?!0:c!==i&&t===u},Kr={duration:200,easing:"ease"},Kn="transform",Gr=We.Transition.toString({property:Kn,duration:0,easing:"linear"}),Jr={roleDescription:"sortable"};function Zr(e){let{disabled:t,index:n,node:s,rect:i}=e;const[o,c]=l.useState(null),d=l.useRef(n);return he(()=>{if(!t&&n!==d.current&&s.current){const u=i.current;if(u){const f=Le(s.current,{ignoreTransform:!0}),g={x:u.left-f.left,y:u.top-f.top,scaleX:u.width/f.width,scaleY:u.height/f.height};(g.x||g.y)&&c(g)}}n!==d.current&&(d.current=n)},[t,n,s,i]),l.useEffect(()=>{o&&c(null)},[o]),o}function ei(e){let{animateLayoutChanges:t=Wr,attributes:n,disabled:s,data:i,getNewIndex:o=Vr,id:c,strategy:d,resizeObserverConfig:u,transition:f=Kr}=e;const{items:g,containerId:h,activeIndex:x,disabled:v,disableTransforms:N,sortedRects:m,overIndex:y,useDragOverlay:R,strategy:D}=l.useContext(Wn),b=ti(s,v),j=g.indexOf(c),w=l.useMemo(()=>({sortable:{containerId:h,index:j,items:g},...i}),[h,i,j,g]),C=l.useMemo(()=>g.slice(g.indexOf(c)),[g,c]),{rect:S,node:E,isOver:q,setNodeRef:O}=zr({id:c,data:w,disabled:b.droppable,resizeObserverConfig:{updateMeasurementsFor:C,...u}}),{active:A,activatorEvent:Y,activeNodeRect:W,attributes:te,setNodeRef:Se,listeners:Ee,isDragging:H,over:Me,setActivatorNodeRef:ie,transform:Ne}=Fr({id:c,data:w,attributes:{...Jr,...n},disabled:b.draggable}),De=ms(O,Se),U=!!A,oe=U&&!N&&ct(x)&&ct(y),ae=!R&&H,ge=ae&&oe?Ne:null,p=oe?ge??(d??D)({rects:m,activeNodeRect:W,activeIndex:x,overIndex:y,index:j}):null,k=ct(x)&&ct(y)?o({id:c,items:g,activeIndex:x,overIndex:y}):j,Q=A==null?void 0:A.id,I=l.useRef({activeId:Q,items:g,newIndex:k,containerId:h}),ne=g!==I.current.items,V=t({active:A,containerId:h,isDragging:H,isSorting:U,id:c,index:j,items:g,newIndex:I.current.newIndex,previousItems:I.current.items,previousContainerId:I.current.containerId,transition:f,wasDragging:I.current.activeId!=null}),ve=Zr({disabled:!V,index:j,node:E,rect:S});return l.useEffect(()=>{U&&I.current.newIndex!==k&&(I.current.newIndex=k),h!==I.current.containerId&&(I.current.containerId=h),g!==I.current.items&&(I.current.items=g)},[U,k,h,g]),l.useEffect(()=>{if(Q===I.current.activeId)return;if(Q!=null&&I.current.activeId==null){I.current.activeId=Q;return}const Ie=setTimeout(()=>{I.current.activeId=Q},50);return()=>clearTimeout(Ie)},[Q]),{active:A,activeIndex:x,attributes:te,data:w,rect:S,index:j,newIndex:k,items:g,isOver:q,isSorting:U,isDragging:H,listeners:Ee,node:E,overIndex:y,over:Me,setNodeRef:De,setActivatorNodeRef:ie,setDroppableNodeRef:O,setDraggableNodeRef:Se,transform:ve??p,transition:pe()};function pe(){if(ve||ne&&I.current.newIndex===j)return Gr;if(!(ae&&!Qt(Y)||!f)&&(U||V))return We.Transition.toString({...f,property:Kn})}}function ti(e,t){var n,s;return typeof e=="boolean"?{draggable:e,droppable:!1}:{draggable:(n=e==null?void 0:e.draggable)!=null?n:t.draggable,droppable:(s=e==null?void 0:e.droppable)!=null?s:t.droppable}}function gt(e){if(!e)return!1;const t=e.data.current;return!!(t&&"sortable"in t&&typeof t.sortable=="object"&&"containerId"in t.sortable&&"items"in t.sortable&&"index"in t.sortable)}const ni=[M.Down,M.Right,M.Up,M.Left],si=(e,t)=>{let{context:{active:n,collisionRect:s,droppableRects:i,droppableContainers:o,over:c,scrollableAncestors:d}}=t;if(ni.includes(e.code)){if(e.preventDefault(),!n||!s)return;const u=[];o.getEnabled().forEach(h=>{if(!h||h!=null&&h.disabled)return;const x=i.get(h.id);if(x)switch(e.code){case M.Down:s.top<x.top&&u.push(h);break;case M.Up:s.top>x.top&&u.push(h);break;case M.Left:s.left>x.left&&u.push(h);break;case M.Right:s.left<x.left&&u.push(h);break}});const f=Ts({active:n,collisionRect:s,droppableRects:i,droppableContainers:u,pointerCoordinates:null});let g=On(f,"id");if(g===(c==null?void 0:c.id)&&f.length>1&&(g=f[1].id),g!=null){const h=o.get(n.id),x=o.get(g),v=x?i.get(x.id):null,N=x==null?void 0:x.node.current;if(N&&v&&h&&x){const y=xt(N).some((C,S)=>d[S]!==C),R=Gn(h,x),D=ri(h,x),b=y||!R?{x:0,y:0}:{x:D?s.width-v.width:0,y:D?s.height-v.height:0},j={x:v.left,y:v.top};return b.x&&b.y?j:Ve(j,b)}}}};function Gn(e,t){return!gt(e)||!gt(t)?!1:e.data.current.sortable.containerId===t.data.current.sortable.containerId}function ri(e,t){return!gt(e)||!gt(t)||!Gn(e,t)?!1:e.data.current.sortable.index<t.data.current.sortable.index}const ii=({question:e,onEdit:t,onDelete:n,getCategoryColor:s,getCategoryIcon:i})=>{const{attributes:o,listeners:c,setNodeRef:d,transform:u,transition:f,isDragging:g}=ei({id:e.id}),h={transform:We.Transform.toString(u),transition:f,opacity:g?.5:1},x=En();return r.jsxs("div",{ref:d,style:h,className:`flex items-center space-x-3 p-3 border rounded-lg ${g?"shadow-lg bg-blue-50":"bg-white"}`,children:[r.jsx("div",{...o,...c,className:"cursor-grab active:cursor-grabbing p-1 hover:bg-gray-100 rounded",title:"Drag to reorder",children:r.jsx(Rn,{className:"w-4 h-4 text-gray-400"})}),r.jsx("div",{className:"flex items-center space-x-2 flex-1",children:r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx("div",{className:`p-2 rounded ${s(e.category)}`,children:i(e.category)}),r.jsxs("div",{className:"flex-1",children:[r.jsx("p",{className:"font-medium",children:e.question}),r.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[r.jsxs(F,{variant:"outline",className:"text-xs",children:["#",e.order_index+1]}),r.jsx(F,{variant:"outline",className:"text-xs",children:e.category}),e.is_required&&r.jsx(F,{className:"bg-red-100 text-red-800 text-xs",children:"Required"}),e.has_photo&&r.jsx(F,{className:"bg-blue-100 text-blue-800 text-xs",children:"Photo"}),e.has_notes&&r.jsx(F,{className:"bg-green-100 text-green-800 text-xs",children:"Notes"})]})]})]})}),r.jsxs("div",{className:"flex items-center space-x-1",children:[r.jsx(_,{variant:"outline",size:"sm",onClick:()=>t(e),disabled:!x.canEditQuestions,title:x.canEditQuestions?"":x.upgradeMessage,children:r.jsx(Mt,{className:"w-4 h-4"})}),r.jsx(_,{variant:"outline",size:"sm",onClick:()=>n(e.id),disabled:!x.canEditQuestions,title:x.canEditQuestions?"":x.upgradeMessage,children:r.jsx(It,{className:"w-4 h-4"})})]})]})},fi=()=>{const e=ks(fn($t,{activationConstraint:{distance:8}}),fn(zt,{coordinateGetter:si})),{profile:t}=Nn(),{selectedOrganizationId:n}=os(),s=as(),i=En(),[o,c]=l.useState(null),[d,u]=l.useState(!1),[f,g]=l.useState(!1),[h,x]=l.useState(!1),[v,N]=l.useState(!1),[m,y]=l.useState(null),[R,D]=l.useState(!1),[b,j]=l.useState({name:"",description:"",is_active:!0,is_default:!1}),[w,C]=l.useState({question:"",category:"general",is_required:!0,has_photo:!1,has_notes:!0}),{data:S=[],isLoading:E}=Dn({queryKey:["inspection-question-sets",n],queryFn:async()=>{if(!n)return[];const{data:a,error:p}=await ce.from("inspection_question_sets").select(`
          *,
          questions:inspection_questions(*)
        `).eq("organization_id",n).order("created_at",{ascending:!1});if(p)throw p;return a},enabled:!!n}),q=Re({mutationFn:async a=>{const{data:p,error:k}=await ce.from("inspection_question_sets").insert(a).select().single();if(k)throw k;return p},onSuccess:()=>{s.invalidateQueries(["inspection-question-sets"]),u(!1),j({name:"",description:"",is_active:!0,is_default:!1}),z.success("Question set created successfully")},onError:a=>{z.error(`Failed to create question set: ${a.message}`)}}),O=Re({mutationFn:async({id:a,...p})=>{const{data:k,error:Q}=await ce.from("inspection_question_sets").update(p).eq("id",a).select().single();if(Q)throw Q;return k},onSuccess:()=>{s.invalidateQueries(["inspection-question-sets"]),g(!1),c(null),z.success("Question set updated successfully")},onError:a=>{z.error(`Failed to update question set: ${a.message}`)}}),A=Re({mutationFn:async a=>{const{data:p,error:k}=await ce.from("inspection_questions").insert(a).select().single();if(k)throw k;return p},onSuccess:()=>{s.invalidateQueries(["inspection-question-sets"]),x(!1),C({question:"",category:"general",is_required:!0,has_photo:!1,has_notes:!0}),z.success("Question added successfully")},onError:a=>{z.error(`Failed to add question: ${a.message}`)}}),Y=Re({mutationFn:async({id:a,...p})=>{const{data:k,error:Q}=await ce.from("inspection_questions").update(p).eq("id",a).select().single();if(Q)throw Q;return k},onSuccess:()=>{s.invalidateQueries(["inspection-question-sets"]),N(!1),y(null),z.success("Question updated successfully")},onError:a=>{z.error(`Failed to update question: ${a.message}`)}}),W=Re({mutationFn:async a=>{const{error:p}=await ce.from("inspection_questions").delete().eq("id",a);if(p)throw p},onSuccess:()=>{s.invalidateQueries(["inspection-question-sets"]),z.success("Question deleted successfully")},onError:a=>{z.error(`Failed to delete question: ${a.message}`)}}),te=Re({mutationFn:async({questionId:a,newOrderIndex:p})=>{const{error:k}=await ce.from("inspection_questions").update({order_index:p}).eq("id",a);if(k)throw k;return{questionId:a,newOrderIndex:p}},onSuccess:()=>{s.invalidateQueries({queryKey:["question-sets"]}),D(!1),z.success("Question order updated successfully")},onError:a=>{z.error(`Failed to update question order: ${a.message}`)}}),Se=a=>{const{active:p,over:k}=a;if(p.id!==(k==null?void 0:k.id)&&o){const Q=o.questions.findIndex(ne=>ne.id===p.id),I=o.questions.findIndex(ne=>ne.id===(k==null?void 0:k.id));if(Q!==-1&&I!==-1){const ne=Ut(o.questions,Q,I);c(V=>V?{...V,questions:ne}:null),D(!0),ne.forEach((V,ve)=>{te.mutate({questionId:V.id,newOrderIndex:ve})})}}},Ee=Re({mutationFn:async a=>{const{error:p}=await ce.from("inspection_question_sets").delete().eq("id",a);if(p)throw p},onSuccess:()=>{s.invalidateQueries(["inspection-question-sets"]),c(null),z.success("Question set deleted successfully")},onError:a=>{z.error(`Failed to delete question set: ${a.message}`)}}),H=()=>{!n||!(t!=null&&t.id)||q.mutate({...b,organization_id:n,created_by:t.id})},Me=()=>{o&&O.mutate({id:o.id,...b})},ie=()=>{if(!o)return;const a=Math.max(0,...o.questions.map(p=>p.order_index));A.mutate({...w,question_set_id:o.id,order_index:a+1})},Ne=()=>{m&&Y.mutate({id:m.id,...w})},De=a=>{y(a),C({question:a.question,category:a.category,is_required:a.is_required,has_photo:a.has_photo,has_notes:a.has_notes}),N(!0)},U=a=>{c(a),j({name:a.name,description:a.description,is_active:a.is_active,is_default:a.is_default}),g(!0)},oe=async()=>{if(!n||!(t!=null&&t.id)){z.error("Authentication required");return}try{const{data:a,error:p}=await ce.rpc("create_default_daily_pretrip_questions",{org_id:n,creator_id:t.id});if(p){console.error("Error creating default questions:",p),z.error(`Failed to create default questions: ${p.message}`);return}s.invalidateQueries(["inspection-question-sets"]),z.success('Default "Daily Pre-Trip Inspection" question set created with 56 comprehensive questions!')}catch(a){console.error("Error:",a),z.error("Failed to create default question set")}},ae=a=>{switch(a.toLowerCase()){case"exterior":return r.jsx(Zt,{className:"w-4 h-4"});case"interior":return r.jsx(Ct,{className:"w-4 h-4"});case"engine":return r.jsx(ps,{className:"w-4 h-4"});case"tires":return r.jsx(gs,{className:"w-4 h-4"});case"lights":return r.jsx(vs,{className:"w-4 h-4"});case"brakes":return r.jsx(hs,{className:"w-4 h-4"});case"fuel":return r.jsx(fs,{className:"w-4 h-4"});case"safety":return r.jsx(en,{className:"w-4 h-4"});case"documentation":return r.jsx(St,{className:"w-4 h-4"});case"driver":return r.jsx(us,{className:"w-4 h-4"});default:return r.jsx(St,{className:"w-4 h-4"})}},ge=a=>{switch(a.toLowerCase()){case"exterior":return"bg-blue-100 text-blue-800";case"interior":return"bg-purple-100 text-purple-800";case"engine":return"bg-orange-100 text-orange-800";case"tires":return"bg-slate-100 text-slate-800";case"lights":return"bg-yellow-100 text-yellow-800";case"brakes":return"bg-red-100 text-red-800";case"fuel":return"bg-green-100 text-green-800";case"safety":return"bg-amber-100 text-amber-800";case"documentation":return"bg-indigo-100 text-indigo-800";case"driver":return"bg-emerald-100 text-emerald-800";default:return"bg-gray-100 text-gray-800"}};return E?r.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:r.jsxs("div",{className:"text-center space-y-4",children:[r.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto"}),r.jsx("p",{className:"text-muted-foreground",children:"Loading vehicle check questions..."})]})}):r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:" Vehicle Check Questions Management"}),r.jsx("p",{className:"text-gray-600 mt-2",children:"Manage vehicle inspection question sets and customize checklists"}),i.currentPlan&&r.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[r.jsxs(F,{variant:"outline",className:"text-xs",children:["Current Plan: ",i.currentPlan]}),i.upgradeRequired&&r.jsx(F,{variant:"destructive",className:"text-xs",children:"Upgrade Required"})]})]}),r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsxs(F,{variant:"outline",className:"text-sm",children:[S.length,"/5 Question Sets"]}),r.jsxs(_,{onClick:()=>u(!0),disabled:S.length>=5||!i.canCreateQuestionSets,title:i.canCreateQuestionSets?"":i.upgradeMessage,children:[r.jsx(jt,{className:"w-4 h-4 mr-2"}),"Create Question Set"]}),r.jsxs(_,{variant:"outline",onClick:oe,disabled:S.some(a=>a.name==="Daily Pre-Trip Inspection"),children:[r.jsx(Zt,{className:"w-4 h-4 mr-2"}),"Import Default Questions"]})]})]}),i.upgradeRequired&&r.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:r.jsxs("div",{className:"flex items-start space-x-3",children:[r.jsx("div",{className:"flex-shrink-0",children:r.jsx(en,{className:"w-5 h-5 text-blue-600"})}),r.jsxs("div",{className:"flex-1",children:[r.jsx("h3",{className:"text-sm font-medium text-blue-800",children:"Upgrade Required for Advanced Features"}),r.jsx("p",{className:"text-sm text-blue-700 mt-1",children:i.upgradeMessage}),r.jsx("div",{className:"mt-3",children:r.jsx(_,{variant:"outline",size:"sm",onClick:()=>window.location.href="/subscriptions",children:"View Plans"})})]})]})}),r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:S.map(a=>r.jsxs(tn,{className:`${a.is_active?"border-blue-200":"border-gray-200"}`,children:[r.jsx(nn,{className:"pb-3",children:r.jsx("div",{className:"flex items-start justify-between",children:r.jsxs("div",{className:"flex-1",children:[r.jsxs(sn,{className:"flex items-center space-x-2",children:[r.jsx(Ct,{className:"w-5 h-5 text-blue-600"}),r.jsx("span",{children:a.name}),a.is_default&&r.jsx(F,{className:"bg-green-100 text-green-800 text-xs",children:"Default"}),!a.is_active&&r.jsx(F,{variant:"secondary",className:"text-xs",children:"Inactive"})]}),r.jsx("p",{className:"text-sm text-gray-600 mt-1",children:a.description})]})})}),r.jsxs(rn,{className:"space-y-4",children:[r.jsxs("div",{className:"flex items-center justify-between text-sm",children:[r.jsx("span",{className:"text-gray-600",children:"Questions:"}),r.jsx(F,{variant:"outline",children:a.questions.length})]}),r.jsxs("div",{className:"space-y-2",children:[a.questions.slice(0,3).map(p=>r.jsxs("div",{className:"flex items-center space-x-2 text-sm",children:[r.jsx("div",{className:`p-1 rounded ${ge(p.category)}`,children:ae(p.category)}),r.jsx("span",{className:"text-gray-700 truncate",children:p.question})]},p.id)),a.questions.length>3&&r.jsxs("p",{className:"text-xs text-gray-500",children:["+",a.questions.length-3," more questions"]})]}),r.jsx(cs,{}),r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsxs(_,{variant:"outline",size:"sm",onClick:()=>c(a),children:[r.jsx(ls,{className:"w-4 h-4 mr-1"}),"View"]}),r.jsxs(_,{variant:"outline",size:"sm",onClick:()=>U(a),disabled:!i.canEditQuestions,title:i.canEditQuestions?"":i.upgradeMessage,children:[r.jsx(Mt,{className:"w-4 h-4 mr-1"}),"Edit"]})]}),r.jsx(_,{variant:"outline",size:"sm",onClick:()=>Ee.mutate(a.id),disabled:a.is_default||!i.canEditQuestions,title:i.canEditQuestions?"":i.upgradeMessage,children:r.jsx(It,{className:"w-4 h-4"})})]})]})]},a.id))}),o&&r.jsxs(tn,{children:[r.jsxs(nn,{children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs(sn,{className:"flex items-center space-x-2",children:[r.jsx(Ct,{className:"w-5 h-5 text-blue-600"}),r.jsx("span",{children:o.name}),o.is_default&&r.jsx(F,{className:"bg-green-100 text-green-800",children:"Default"}),R&&r.jsxs(F,{className:"bg-blue-100 text-blue-800 animate-pulse",children:[r.jsx(xs,{className:"w-3 h-3 mr-1"}),"Saving..."]})]}),r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsxs(_,{variant:"outline",onClick:()=>x(!0),disabled:!i.canEditQuestions,title:i.canEditQuestions?"":i.upgradeMessage,children:[r.jsx(jt,{className:"w-4 h-4 mr-2"}),"Add Question"]}),r.jsx(_,{variant:"outline",onClick:()=>c(null),children:r.jsx(ds,{className:"w-4 h-4"})})]})]}),r.jsx("p",{className:"text-gray-600",children:o.description})]}),r.jsx(rn,{children:r.jsx("div",{className:"space-y-4",children:o.questions.length===0?r.jsxs("div",{className:"text-center py-8",children:[r.jsx(St,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),r.jsx("p",{className:"text-gray-600",children:"No questions in this set yet."}),r.jsxs(_,{variant:"outline",className:"mt-4",onClick:()=>x(!0),children:[r.jsx(jt,{className:"w-4 h-4 mr-2"}),"Add First Question"]})]}):r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx(Rn,{className:"w-4 h-4 text-gray-400"}),r.jsx("span",{className:"text-sm font-medium text-gray-600",children:i.canReorderQuestions?"Drag to reorder questions":"Question reordering requires Professional plan"})]}),r.jsxs(F,{variant:"outline",className:"text-xs",children:[o.questions.length," questions"]})]}),i.canReorderQuestions?r.jsx(Or,{sensors:e,collisionDetection:Os,onDragEnd:Se,children:r.jsx(Hr,{items:o.questions.sort((a,p)=>a.order_index-p.order_index).map(a=>a.id),strategy:Xr,children:o.questions.sort((a,p)=>a.order_index-p.order_index).map(a=>r.jsx(ii,{question:a,onEdit:De,onDelete:p=>W.mutate(p),getCategoryColor:ge,getCategoryIcon:ae},a.id))})}):r.jsx("div",{className:"space-y-3",children:o.questions.sort((a,p)=>a.order_index-p.order_index).map(a=>r.jsxs("div",{className:"flex items-center space-x-3 p-3 border rounded-lg bg-white",children:[r.jsxs("div",{className:"flex items-center space-x-2 flex-1",children:[r.jsx("div",{className:`p-2 rounded ${ge(a.category)}`,children:ae(a.category)}),r.jsxs("div",{className:"flex-1",children:[r.jsx("p",{className:"font-medium",children:a.question}),r.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[r.jsxs(F,{variant:"outline",className:"text-xs",children:["#",a.order_index+1]}),r.jsx(F,{variant:"outline",className:"text-xs",children:a.category}),a.is_required&&r.jsx(F,{className:"bg-red-100 text-red-800 text-xs",children:"Required"}),a.has_photo&&r.jsx(F,{className:"bg-blue-100 text-blue-800 text-xs",children:"Photo"}),a.has_notes&&r.jsx(F,{className:"bg-green-100 text-green-800 text-xs",children:"Notes"})]})]})]}),r.jsxs("div",{className:"flex items-center space-x-1",children:[r.jsx(_,{variant:"outline",size:"sm",onClick:()=>De(a),disabled:!i.canEditQuestions,title:i.canEditQuestions?"":i.upgradeMessage,children:r.jsx(Mt,{className:"w-4 h-4"})}),r.jsx(_,{variant:"outline",size:"sm",onClick:()=>W.mutate(a.id),disabled:!i.canEditQuestions,title:i.canEditQuestions?"":i.upgradeMessage,children:r.jsx(It,{className:"w-4 h-4"})})]})]},a.id))})]})})})]}),r.jsx(nt,{open:d,onOpenChange:u,children:r.jsxs(st,{className:"max-w-md","aria-describedby":"create-set-description",children:[r.jsxs(rt,{children:[r.jsx(it,{children:"Create Question Set"}),r.jsx(ot,{id:"create-set-description",children:"Create a new set of inspection questions for your vehicles."})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx(P,{htmlFor:"set-name",children:"Set Name"}),r.jsx(on,{id:"set-name",value:b.name,onChange:a=>j(p=>({...p,name:a.target.value})),placeholder:"e.g., Daily Pre-Trip Inspection"})]}),r.jsxs("div",{children:[r.jsx(P,{htmlFor:"set-description",children:"Description"}),r.jsx(at,{id:"set-description",value:b.description,onChange:a=>j(p=>({...p,description:a.target.value})),placeholder:"Brief description of this question set"})]}),r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx(fe,{id:"is-active",checked:b.is_active,onCheckedChange:a=>j(p=>({...p,is_active:a}))}),r.jsx(P,{htmlFor:"is-active",children:"Active"})]}),r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx(fe,{id:"is-default",checked:b.is_default,onCheckedChange:a=>j(p=>({...p,is_default:a}))}),r.jsx(P,{htmlFor:"is-default",children:"Set as Default"})]}),r.jsxs("div",{className:"flex justify-end space-x-2",children:[r.jsx(_,{variant:"outline",onClick:()=>u(!1),children:"Cancel"}),r.jsx(_,{onClick:H,disabled:!b.name||q.isPending,children:q.isPending?"Creating...":"Create Set"})]})]})]})}),r.jsx(nt,{open:f,onOpenChange:g,children:r.jsxs(st,{className:"max-w-md","aria-describedby":"edit-set-description",children:[r.jsxs(rt,{children:[r.jsx(it,{children:"Edit Question Set"}),r.jsx(ot,{id:"edit-set-description",children:"Modify the question set details and settings."})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx(P,{htmlFor:"edit-set-name",children:"Set Name"}),r.jsx(on,{id:"edit-set-name",value:b.name,onChange:a=>j(p=>({...p,name:a.target.value})),placeholder:"e.g., Daily Pre-Trip Inspection"})]}),r.jsxs("div",{children:[r.jsx(P,{htmlFor:"edit-set-description",children:"Description"}),r.jsx(at,{id:"edit-set-description",value:b.description,onChange:a=>j(p=>({...p,description:a.target.value})),placeholder:"Brief description of this question set"})]}),r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx(fe,{id:"edit-is-active",checked:b.is_active,onCheckedChange:a=>j(p=>({...p,is_active:a}))}),r.jsx(P,{htmlFor:"edit-is-active",children:"Active"})]}),r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx(fe,{id:"edit-is-default",checked:b.is_default,onCheckedChange:a=>j(p=>({...p,is_default:a}))}),r.jsx(P,{htmlFor:"edit-is-default",children:"Set as Default"})]}),r.jsxs("div",{className:"flex justify-end space-x-2",children:[r.jsx(_,{variant:"outline",onClick:()=>g(!1),children:"Cancel"}),r.jsx(_,{onClick:Me,disabled:!b.name||O.isPending,children:O.isPending?"Updating...":"Update Set"})]})]})]})}),r.jsx(nt,{open:h,onOpenChange:x,children:r.jsxs(st,{className:"max-w-md","aria-describedby":"add-question-description",children:[r.jsxs(rt,{children:[r.jsx(it,{children:"Add Question"}),r.jsx(ot,{id:"add-question-description",children:"Add a new question to the inspection checklist."})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx(P,{htmlFor:"question-text",children:"Question"}),r.jsx(at,{id:"question-text",value:w.question,onChange:a=>C(p=>({...p,question:a.target.value})),placeholder:"e.g., Are all lights working properly?"})]}),r.jsxs("div",{children:[r.jsx(P,{htmlFor:"question-category",children:"Category"}),r.jsxs(an,{value:w.category,onValueChange:a=>C(p=>({...p,category:a})),children:[r.jsx(cn,{children:r.jsx(ln,{})}),r.jsxs(dn,{children:[r.jsx(T,{value:"general",children:"General"}),r.jsx(T,{value:"exterior",children:"Exterior"}),r.jsx(T,{value:"interior",children:"Interior"}),r.jsx(T,{value:"engine",children:"Engine"}),r.jsx(T,{value:"tires",children:"Tires"}),r.jsx(T,{value:"lights",children:"Lights"}),r.jsx(T,{value:"brakes",children:"Brakes"}),r.jsx(T,{value:"fuel",children:"Fuel"}),r.jsx(T,{value:"safety",children:"Safety"}),r.jsx(T,{value:"documentation",children:"Documentation"}),r.jsx(T,{value:"driver",children:"Driver"})]})]})]}),r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx(fe,{id:"is-required",checked:w.is_required,onCheckedChange:a=>C(p=>({...p,is_required:a}))}),r.jsx(P,{htmlFor:"is-required",children:"Required Question"})]}),r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx(fe,{id:"has-photo",checked:w.has_photo,onCheckedChange:a=>C(p=>({...p,has_photo:a}))}),r.jsx(P,{htmlFor:"has-photo",children:"Require Photo"})]}),r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx(fe,{id:"has-notes",checked:w.has_notes,onCheckedChange:a=>C(p=>({...p,has_notes:a}))}),r.jsx(P,{htmlFor:"has-notes",children:"Allow Notes"})]}),r.jsxs("div",{className:"flex justify-end space-x-2",children:[r.jsx(_,{variant:"outline",onClick:()=>x(!1),children:"Cancel"}),r.jsx(_,{onClick:ie,disabled:!w.question||A.isPending,children:A.isPending?"Adding...":"Add Question"})]})]})]})}),r.jsx(nt,{open:v,onOpenChange:N,children:r.jsxs(st,{className:"max-w-md","aria-describedby":"edit-question-description",children:[r.jsxs(rt,{children:[r.jsx(it,{children:"Edit Question"}),r.jsx(ot,{id:"edit-question-description",children:"Modify the question details and settings."})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx(P,{htmlFor:"edit-question-text",children:"Question"}),r.jsx(at,{id:"edit-question-text",value:w.question,onChange:a=>C(p=>({...p,question:a.target.value})),placeholder:"e.g., Are all lights working properly?"})]}),r.jsxs("div",{children:[r.jsx(P,{htmlFor:"edit-question-category",children:"Category"}),r.jsxs(an,{value:w.category,onValueChange:a=>C(p=>({...p,category:a})),children:[r.jsx(cn,{children:r.jsx(ln,{})}),r.jsxs(dn,{children:[r.jsx(T,{value:"general",children:"General"}),r.jsx(T,{value:"exterior",children:"Exterior"}),r.jsx(T,{value:"interior",children:"Interior"}),r.jsx(T,{value:"engine",children:"Engine"}),r.jsx(T,{value:"tires",children:"Tires"}),r.jsx(T,{value:"lights",children:"Lights"}),r.jsx(T,{value:"brakes",children:"Brakes"}),r.jsx(T,{value:"fuel",children:"Fuel"}),r.jsx(T,{value:"safety",children:"Safety"}),r.jsx(T,{value:"documentation",children:"Documentation"}),r.jsx(T,{value:"driver",children:"Driver"})]})]})]}),r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx(fe,{id:"edit-is-required",checked:w.is_required,onCheckedChange:a=>C(p=>({...p,is_required:a}))}),r.jsx(P,{htmlFor:"edit-is-required",children:"Required Question"})]}),r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx(fe,{id:"edit-has-photo",checked:w.has_photo,onCheckedChange:a=>C(p=>({...p,has_photo:a}))}),r.jsx(P,{htmlFor:"edit-has-photo",children:"Require Photo"})]}),r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx(fe,{id:"edit-has-notes",checked:w.has_notes,onCheckedChange:a=>C(p=>({...p,has_notes:a}))}),r.jsx(P,{htmlFor:"edit-has-notes",children:"Allow Notes"})]}),r.jsxs("div",{className:"flex justify-end space-x-2",children:[r.jsx(_,{variant:"outline",onClick:()=>N(!1),children:"Cancel"}),r.jsx(_,{onClick:Ne,disabled:!w.question||Y.isPending,children:Y.isPending?"Updating...":"Update Question"})]})]})]})})]})};export{fi as default};
