import{G,m as F,a2 as O,J as L,a1 as z,_ as U,r as g,j as e,e as f,k as y,C as Q,n as I,B as j,g as v,h as b,E as k,q as u,ab as K,ac as D,ad as J,ae as X,af as S,I as x,s as Z,aO as H,l as q,t as ee,x as se,u as te,b1 as P,O as ae,Q as ie,V as _,bb as re,Y as A,F as ne,am as oe}from"./main-DVuL102c.js";import{A as ce,a as le,b as de,c as ue,V as me}from"./accordion-CCUJ5Ue7.js";import{L as $}from"./lightbulb-BaDmslCX.js";import{M as V}from"./message-circle-LPY5AdFN.js";import{B as pe}from"./book-open-gFg9M0j_.js";const he=()=>{const t=G(),{profile:r}=F();return O({mutationFn:async m=>{if(!(r!=null&&r.organization_id))throw new Error("Organization ID is required");const{data:p,error:c}=await L.from("support_tickets").insert([{...m,organization_id:r.organization_id,created_by:r.id}]).select().single();if(c)throw c;return p},onSuccess:()=>{t.invalidateQueries({queryKey:["support-tickets"]})}})};var xe={};function ge(){const{profile:t}=F(),{toast:r}=z(),[m]=U(),[p,c]=g.useState(!1),[C,N]=g.useState(!1),[T,i]=g.useState(""),l=he(),[a,h]=g.useState({type:"support",priority:"medium",subject:"",description:"",userEmail:(t==null?void 0:t.email)||"",userName:`${(t==null?void 0:t.first_name)||""} ${(t==null?void 0:t.last_name)||""}`.trim(),userPhone:"",appVersion:"v1.0.0",deviceInfo:`${navigator.userAgent} - ${window.innerWidth}x${window.innerHeight}`,attachments:[]});g.useEffect(()=>{m.get("type")==="suggestion"&&h(n=>({...n,type:"suggestion"}))},[m]);const M=()=>{const s=Date.now().toString(36),n=Math.random().toString(36).substr(2,5);return`TKT-${s}-${n}`.toUpperCase()},o=(s,n)=>{h(d=>({...d,[s]:n}))},W=()=>a.subject.trim()?a.description.trim()?a.userEmail.trim()?!0:(r({title:"Missing Email",description:"Please enter your email address.",variant:"destructive"}),!1):(r({title:"Missing Description",description:"Please provide a detailed description of your issue or suggestion.",variant:"destructive"}),!1):(r({title:"Missing Subject",description:"Please enter a subject for your ticket.",variant:"destructive"}),!1),Y=async(s,n)=>{try{const d={ticket_id:n,type:s.type==="support"?"technical":"feature_request",priority:s.priority==="urgent"?"critical":s.priority,subject:s.subject,description:s.description,user_email:s.userEmail,user_name:s.userName,user_phone:s.userPhone,app_version:s.appVersion,device_info:s.deviceInfo,tags:[s.type]};await l.mutateAsync(d);try{const w=await fetch("/functions/v1/send-support-ticket",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${xe.REACT_APP_SUPABASE_ANON_KEY}`},body:JSON.stringify({ticketData:s,ticketId:n})}),R=await w.json();w.ok||console.warn("Email notification failed:",R.error)}catch(w){console.warn("Email notification failed:",w)}return!0}catch(d){throw console.error("Error creating support ticket:",d),d}},B=async s=>{if(s.preventDefault(),!W())return;c(!0);const n=M();i(n);try{if(await Y(a,n))N(!0),r({title:"Ticket Submitted Successfully",description:`Your ticket (${n}) has been sent to our support team.`});else throw new Error("Failed to send email")}catch(d){console.error("Error submitting ticket:",d),r({title:"Submission Failed",description:"There was an error submitting your ticket. Please try again.",variant:"destructive"})}finally{c(!1)}},E=()=>{h({type:"support",priority:"medium",subject:"",description:"",userEmail:(t==null?void 0:t.email)||"",userName:`${(t==null?void 0:t.first_name)||""} ${(t==null?void 0:t.last_name)||""}`.trim(),userPhone:"",appVersion:"v1.0.0",deviceInfo:`${navigator.userAgent} - ${window.innerWidth}x${window.innerHeight}`,attachments:[]}),N(!1),i("")};return C?e.jsx("div",{className:"max-w-2xl mx-auto p-6",children:e.jsx(f,{className:"border-green-200 bg-green-50",children:e.jsxs(y,{className:"p-6 text-center",children:[e.jsx(Q,{className:"w-16 h-16 text-green-600 mx-auto mb-4"}),e.jsx("h2",{className:"text-2xl font-bold text-green-800 mb-2",children:"Ticket Submitted Successfully!"}),e.jsx("p",{className:"text-green-700 mb-4",children:"Your ticket has been sent to our support team. We'll get back to you soon."}),e.jsxs("div",{className:"bg-white p-4 rounded-lg border mb-4",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Ticket ID:"}),e.jsx(I,{variant:"outline",className:"text-lg font-mono",children:T})]}),e.jsxs("div",{className:"space-y-2 text-sm text-green-700",children:[e.jsx("p",{children:"â€¢ You'll receive a confirmation email shortly"}),e.jsx("p",{children:"â€¢ Our team will respond within the expected timeframe"}),e.jsx("p",{children:"â€¢ Keep this ticket ID for reference"})]}),e.jsx("div",{className:"mt-6 space-x-3",children:e.jsx(j,{onClick:E,variant:"outline",children:"Submit Another Ticket"})})]})})}):e.jsx("div",{className:"max-w-2xl mx-auto p-6",children:e.jsxs(f,{children:[e.jsx(v,{children:e.jsxs(b,{className:"flex items-center space-x-2",children:[a.type==="support"?e.jsx(k,{className:"w-6 h-6 text-red-600"}):e.jsx($,{className:"w-6 h-6 text-blue-600"}),e.jsx("span",{children:a.type==="support"?"IT Support Request":"Feature Suggestion"})]})}),e.jsx(y,{children:e.jsxs("form",{onSubmit:B,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs(j,{type:"button",variant:a.type==="support"?"default":"outline",className:"h-auto p-4 flex flex-col items-center space-y-2",onClick:()=>o("type","support"),children:[e.jsx(k,{className:"w-6 h-6"}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-medium",children:"IT Support"}),e.jsx("div",{className:"text-xs opacity-70",children:"Report issues or get help"})]})]}),e.jsxs(j,{type:"button",variant:a.type==="suggestion"?"default":"outline",className:"h-auto p-4 flex flex-col items-center space-y-2",onClick:()=>o("type","suggestion"),children:[e.jsx($,{className:"w-6 h-6"}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-medium",children:"Feature Suggestion"}),e.jsx("div",{className:"text-xs opacity-70",children:"Suggest improvements"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"priority",children:"Priority Level"}),e.jsxs(K,{value:a.priority,onValueChange:s=>o("priority",s),children:[e.jsx(D,{children:e.jsx(J,{})}),e.jsxs(X,{children:[e.jsx(S,{value:"low",children:"ðŸŸ¢ Low - General inquiry"}),e.jsx(S,{value:"medium",children:"ðŸŸ¡ Medium - Minor issue"}),e.jsx(S,{value:"high",children:"ðŸŸ  High - Important issue"}),e.jsx(S,{value:"urgent",children:"ðŸ”´ Urgent - Critical issue"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"subject",children:"Subject *"}),e.jsx(x,{id:"subject",value:a.subject,onChange:s=>o("subject",s.target.value),placeholder:a.type==="support"?"Brief description of your issue":"Brief description of your suggestion",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"description",children:"Description *"}),e.jsx(Z,{id:"description",value:a.description,onChange:s=>o("description",s.target.value),placeholder:a.type==="support"?"Please provide detailed information about your issue, including steps to reproduce, error messages, and what you were trying to do when the problem occurred.":"Please describe your feature suggestion in detail, including why it would be helpful and how it could improve the app.",rows:6,required:!0})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"font-semibold flex items-center space-x-2",children:[e.jsx(H,{className:"w-4 h-4"}),e.jsx("span",{children:"Contact Information"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"userName",children:"Name *"}),e.jsx(x,{id:"userName",value:a.userName,onChange:s=>o("userName",s.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"userEmail",children:"Email *"}),e.jsx(x,{id:"userEmail",type:"email",value:a.userEmail,onChange:s=>o("userEmail",s.target.value),required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"userPhone",children:"Phone (Optional)"}),e.jsx(x,{id:"userPhone",type:"tel",value:a.userPhone,onChange:s=>o("userPhone",s.target.value),placeholder:"For urgent issues"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"font-semibold flex items-center space-x-2",children:[e.jsx(q,{className:"w-4 h-4"}),e.jsx("span",{children:"System Information"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"appVersion",children:"App Version"}),e.jsx(x,{id:"appVersion",value:a.appVersion,onChange:s=>o("appVersion",s.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"deviceInfo",children:"Device Info"}),e.jsx(x,{id:"deviceInfo",value:a.deviceInfo,onChange:s=>o("deviceInfo",s.target.value)})]})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx(j,{type:"button",variant:"outline",onClick:E,disabled:p,children:"Reset"}),e.jsx(j,{type:"submit",disabled:p,className:"min-w-[120px]",children:p?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Sending..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ee,{className:"w-4 h-4 mr-2"}),"Submit Ticket"]})})]})]})})]})})}function Ne(){const{profile:t}=F(),r=se(),m=te(),[p,c]=g.useState("help"),C=[{category:"General",items:[{question:"How do I update my profile information?",answer:"Go to Settings > Profile to update your personal information, contact details, and preferences."},{question:"How do I change my password?",answer:"Navigate to Settings > Security to change your password. You'll need to enter your current password for verification."},{question:"What should I do if I forget my password?",answer:"Use the 'Forgot Password' option on the login screen. You'll receive a reset link via email."}]},{category:"Vehicle Checks",items:[{question:"How do I complete a vehicle check?",answer:"Tap the Vehicle Check icon in the navigation bar, then follow the step-by-step checklist. Make sure to complete all required items."},{question:"What if I find a defect during my vehicle check?",answer:"Report any defects immediately through the app. The system will automatically notify the maintenance team."},{question:"Can I save a vehicle check for later?",answer:"Yes, you can save your progress and complete the check later. Your data will be stored locally."}]},{category:"Fuel System",items:[{question:"How do I record a fuel purchase?",answer:"Go to Fuel System > Record Purchase. Enter the fuel amount, cost, and upload a photo of the receipt."},{question:"What if I lose my fuel receipt?",answer:"Contact your supervisor immediately. You may need to provide alternative documentation."},{question:"How do I view my fuel history?",answer:"Navigate to Fuel System > History to view all your recorded fuel purchases and expenses."}]},{category:"Time Management",items:[{question:"How do I clock in and out?",answer:"Use the Time Management feature to clock in when you start work and clock out when you finish."},{question:"What if I forget to clock out?",answer:"Contact your supervisor to manually adjust your time records. Always try to clock out at the end of your shift."},{question:"How do I view my timesheet?",answer:"Go to Time Management > Timesheet to view your work hours, breaks, and total time worked."}]},{category:"Compliance",items:[{question:"How do I check my license status?",answer:"Go to Compliance to view your current license status, expiry dates, and any required renewals."},{question:"What training do I need to complete?",answer:"Check the Training section in Compliance to see required courses and your completion status."},{question:"How do I upload documents?",answer:"Navigate to Documents to upload and manage your licenses, certificates, and other required documents."}]}],N=[{title:"Emergency Support",description:"For urgent issues affecting safety or operations",icon:k,contact:"+1 (555) 123-4567",response:"Immediate response",color:"text-red-600",bgColor:"bg-red-50"},{title:"IT Support",description:"For app issues and technical problems",icon:q,contact:"transport@logisticssolutionresources.com",response:"Within 2 hours",color:"text-blue-600",bgColor:"bg-blue-50"},{title:"General Inquiries",description:"For general questions and information",icon:V,contact:"support@lsr.com",response:"Within 24 hours",color:"text-green-600",bgColor:"bg-green-50"}],T=[{title:"Submit Support Ticket",description:"Report an issue or get help",icon:k,action:()=>c("ticket"),color:"bg-red-500 hover:bg-red-600"},{title:"Feature Suggestion",description:"Suggest improvements",icon:oe,action:()=>{c("ticket"),m("/support?type=suggestion")},color:"bg-blue-500 hover:bg-blue-600"},{title:"View Manual",description:"Download user guide",icon:pe,action:()=>window.open("/manual.pdf","_blank"),color:"bg-purple-500 hover:bg-purple-600"},{title:"Training Videos",description:"Watch tutorial videos",icon:me,action:()=>m("/training-videos"),color:"bg-green-500 hover:bg-green-600"}];return e.jsxs("div",{className:`space-y-6 ${r?"p-4":"p-6"}`,children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"flex items-center justify-center space-x-2 mb-2",children:[e.jsx(P,{className:"w-8 h-8 text-red-600"}),e.jsx("h1",{className:"text-2xl font-bold",children:"Help & Support"})]}),e.jsx("p",{className:"text-muted-foreground",children:"Get assistance with the LSR mobile app"})]}),e.jsxs(ae,{value:p,onValueChange:c,className:"w-full",children:[e.jsxs(ie,{className:"grid w-full grid-cols-2",children:[e.jsxs(_,{value:"help",className:"flex items-center space-x-2",children:[e.jsx(P,{className:"w-4 h-4"}),e.jsx("span",{children:"Help Center"})]}),e.jsxs(_,{value:"ticket",className:"flex items-center space-x-2",children:[e.jsx(re,{className:"w-4 h-4"}),e.jsx("span",{children:"Submit Ticket"})]})]}),e.jsxs(A,{value:"help",className:"space-y-6",children:[e.jsxs(f,{children:[e.jsx(v,{children:e.jsxs(b,{className:"flex items-center space-x-2",children:[e.jsx(q,{className:"w-5 h-5"}),e.jsx("span",{children:"Quick Actions"})]})}),e.jsx(y,{children:e.jsx("div",{className:"grid grid-cols-2 gap-3",children:T.map((i,l)=>{const a=i.icon;return e.jsxs(j,{variant:"outline",className:"h-auto p-4 flex flex-col items-center space-y-2",onClick:i.action,children:[e.jsx(a,{className:"w-6 h-6"}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-medium text-sm",children:i.title}),e.jsx("div",{className:"text-xs text-muted-foreground",children:i.description})]})]},l)})})})]}),e.jsxs(f,{children:[e.jsx(v,{children:e.jsxs(b,{className:"flex items-center space-x-2",children:[e.jsx(V,{className:"w-5 h-5"}),e.jsx("span",{children:"Contact Support"})]})}),e.jsx(y,{children:e.jsx("div",{className:"space-y-4",children:N.map((i,l)=>{const a=i.icon;return e.jsx("div",{className:`p-4 rounded-lg border ${i.bgColor}`,children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(a,{className:`w-5 h-5 mt-0.5 ${i.color}`}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-sm",children:i.title}),e.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:i.description}),e.jsxs("div",{className:"flex items-center space-x-4 text-sm",children:[e.jsx("span",{className:"font-medium",children:i.contact}),e.jsx(I,{variant:"outline",className:"text-xs",children:i.response})]})]})]})},l)})})})]}),e.jsxs(f,{children:[e.jsx(v,{children:e.jsxs(b,{className:"flex items-center space-x-2",children:[e.jsx(ne,{className:"w-5 h-5"}),e.jsx("span",{children:"Frequently Asked Questions"})]})}),e.jsx(y,{children:e.jsx(ce,{type:"single",collapsible:!0,className:"w-full",children:C.map((i,l)=>e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"font-semibold text-lg mb-3 text-gray-800",children:i.category}),i.items.map((a,h)=>e.jsxs(le,{value:`${l}-${h}`,children:[e.jsx(de,{className:"text-left",children:a.question}),e.jsx(ue,{className:"text-muted-foreground",children:a.answer})]},`${l}-${h}`))]},l))})})]}),e.jsxs(f,{className:"bg-gradient-to-r from-blue-50 to-indigo-50",children:[e.jsx(v,{children:e.jsxs(b,{className:"flex items-center space-x-2",children:[e.jsx(H,{className:"w-5 h-5"}),e.jsx("span",{children:"Your Information"})]})}),e.jsx(y,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Name:"}),e.jsxs("span",{className:"text-sm font-medium",children:[t==null?void 0:t.first_name," ",t==null?void 0:t.last_name]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Role:"}),e.jsx(I,{variant:"secondary",className:"capitalize",children:t==null?void 0:t.role})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"App Version:"}),e.jsx("span",{className:"text-sm font-medium",children:"v1.0.0"})]})]})})]})]}),e.jsx(A,{value:"ticket",children:e.jsx(ge,{})})]})]})}export{Ne as default};
