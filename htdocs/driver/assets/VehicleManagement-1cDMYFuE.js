import{m as ne,H as he,J as W,G as me,a2 as ue,a3 as I,r as U,j as e,a4 as je,a5 as pe,a6 as ve,a7 as ge,F as J,a8 as be,q as s,C as K,B as f,X as Ee,a9 as we,aa as xe,ab as V,ac as F,ad as S,ae as k,af as l,I as j,s as Z,y as ae,ag as H,n as $,O as Me,Q as Te,V as ee,Y as se,S as X,ah as Ce,d as Ve,ai as Fe,$ as fe,e as C,k as O,g as P,h as z,aj as _e,D as Pe,ak as ze,E as ie,al as T,W as te,i as oe,am as re,an as Ie,ao as Le,ap as Be,u as Ue,l as Ne,b as $e}from"./main-DVuL102c.js";import{u as ye,a as He,b as Qe,c as Se,d as Ye}from"./useVehicles-DG5ys_xt.js";import{T as ke,a as De,b as le,c as L,d as Re,e as B}from"./table-Jjtal2IW.js";import{u as Oe}from"./index.esm-Wi9rdkmu.js";import{C as q}from"./checkbox-BmxDZ4wY.js";import{u as Ge}from"./fileUpload-xD0CoN2c.js";import{S as We}from"./star-Dk-sf7Q0.js";import{T as qe}from"./trash-2-uDLx8yM9.js";import{D as Ke}from"./database-BkhDcnAk.js";const Je=t=>{const{profile:o}=ne();return he({queryKey:["vehicle-documents",t,o==null?void 0:o.organization_id],queryFn:async()=>{if(!(o!=null&&o.organization_id)||!t)return[];console.log("Fetching vehicle documents for vehicle:",t);const{data:p,error:v}=await W.from("documents").select("*").eq("organization_id",o.organization_id).eq("vehicle_id",t).order("created_at",{ascending:!1});return v?(console.error("Error fetching vehicle documents:",v),[]):(console.log("Fetched vehicle documents:",p),p||[])},enabled:!!(o!=null&&o.organization_id)&&!!t})},Xe=()=>{const{profile:t}=ne(),o=me();return ue({mutationFn:async p=>{if(!(t!=null&&t.organization_id)||!(t!=null&&t.id))throw new Error("Organization and user information required");const{data:v,error:x}=await W.from("documents").insert({...p,organization_id:t.organization_id,uploaded_by:t.id}).select().single();if(x)throw x;return v},onSuccess:(p,v)=>{o.invalidateQueries({queryKey:["vehicle-documents",v.vehicle_id]}),o.invalidateQueries({queryKey:["documents"]}),I.success("Vehicle document uploaded successfully")},onError:p=>{console.error("Error creating vehicle document:",p),I.error("Failed to upload vehicle document: "+p.message)}})},Ze=()=>{const t=me();return ue({mutationFn:async({id:o,vehicleId:p})=>{const{error:v}=await W.from("documents").delete().eq("id",o);if(v)throw v},onSuccess:(o,{vehicleId:p})=>{t.invalidateQueries({queryKey:["vehicle-documents",p]}),t.invalidateQueries({queryKey:["documents"]}),I.success("Vehicle document deleted successfully")},onError:o=>{console.error("Error deleting vehicle document:",o),I.error("Failed to delete vehicle document: "+o.message)}})},es=({open:t,onOpenChange:o,vehicleId:p,vehicleNumber:v,allowVehicleSelection:x=!1})=>{const{profile:u}=ne(),D=Xe(),{data:m=[]}=ye(),[g,n]=U.useState(p||""),[y,N]=U.useState(v||""),[h,c]=U.useState(null),[M,b]=U.useState(0),[_,A]=U.useState(!1),[i,w]=U.useState({name:"",category:"",description:"",expiryDate:"",tags:"",isConfidential:!1,priority:"medium",department:"",version:"1.0",isFavorite:!1}),Q=["Vehicle Registration","Vehicle Insurance","MOT Certificate","Service History","Maintenance Records","Safety Certificate","Compliance Documents","Inspection Reports","Repair Records","Warranty Documents","Other"],Y=["Fleet Management","Maintenance","Compliance","Operations","Safety","Administration","Other"],ce=r=>{var R;const d=(R=r.target.files)==null?void 0:R[0];if(d){if(d.size>50*1024*1024){I.error("File size must be less than 50MB");return}c(d),i.name||w(E=>({...E,name:d.name.split(".")[0]}))}},de=async r=>{if(r.preventDefault(),!h||!(u!=null&&u.organization_id)){I.error("Please select a file to upload");return}if(!i.name||!i.category){I.error("Please fill in all required fields");return}if(x&&!g){I.error("Please select a vehicle for this document");return}A(!0),b(0);try{b(25);const d=await Ge(h,"documents","vehicle-documents",u.organization_id,u.id);if(!d.success)throw new Error(d.error||"File upload failed");b(75);const R={name:i.name,category:i.category,description:i.description,expiry_date:i.expiryDate||void 0,tags:i.tags?i.tags.split(",").map(E=>E.trim()):[],is_public:!i.isConfidential,file_name:h.name,file_path:d.storagePath,file_type:h.type,file_size:h.size,status:"active",priority:i.priority,department:i.department,version:i.version,is_favorite:i.isFavorite,vehicle_id:g||p,organization_id:u.organization_id,uploaded_by:u.id};await D.mutateAsync(R),b(100),c(null),w({name:"",category:"",description:"",expiryDate:"",tags:"",isConfidential:!1,priority:"medium",department:"",version:"1.0",isFavorite:!1}),x&&(n(""),N("")),b(0),o(!1)}catch(d){console.error("Error uploading document:",d),I.error("Failed to upload document")}finally{A(!1)}},a=()=>{_||(c(null),w({name:"",category:"",description:"",expiryDate:"",tags:"",isConfidential:!1,priority:"medium",department:"",version:"1.0",isFavorite:!1}),x&&(n(""),N("")),b(0),o(!1))};return e.jsx(je,{open:t,onOpenChange:a,children:e.jsxs(pe,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(ve,{children:[e.jsxs(ge,{className:"flex items-center gap-2",children:[e.jsx(J,{className:"h-5 w-5"}),x?"Upload Vehicle Document":`Upload Document for ${v}`]}),e.jsx(be,{children:x?"Upload a document and select which vehicle it belongs to":`Upload a document for vehicle ${v}`})]}),e.jsxs("form",{onSubmit:de,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx(s,{htmlFor:"file",children:"Document File *"}),e.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:border-gray-400 transition-colors",children:[e.jsx("input",{id:"file",type:"file",onChange:ce,accept:".pdf,.doc,.docx,.xls,.xlsx,.jpg,.jpeg,.png,.txt",className:"hidden",disabled:_}),e.jsx("label",{htmlFor:"file",className:"cursor-pointer",children:h?e.jsxs("div",{className:"space-y-2",children:[e.jsx(K,{className:"h-8 w-8 text-green-500 mx-auto"}),e.jsx("p",{className:"font-medium",children:h.name}),e.jsxs("p",{className:"text-sm text-gray-500",children:[(h.size/1024/1024).toFixed(2)," MB"]}),e.jsxs(f,{type:"button",variant:"outline",size:"sm",onClick:()=>c(null),disabled:_,children:[e.jsx(Ee,{className:"h-4 w-4 mr-1"}),"Remove File"]})]}):e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{className:"h-8 w-8 text-gray-400 mx-auto"}),e.jsx("p",{className:"font-medium",children:"Click to select file"}),e.jsx("p",{className:"text-sm text-gray-500",children:"PDF, DOC, XLS, Images, or Text files up to 50MB"})]})})]})]}),_&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Uploading..."}),e.jsxs("span",{children:[M,"%"]})]}),e.jsx(xe,{value:M,className:"w-full"})]}),x&&e.jsxs("div",{className:"col-span-full",children:[e.jsx(s,{htmlFor:"vehicle",children:"Select Vehicle *"}),e.jsxs(V,{value:g,onValueChange:r=>{n(r);const d=m.find(R=>R.id===r);N((d==null?void 0:d.vehicle_number)||"")},disabled:_,children:[e.jsx(F,{children:e.jsx(S,{placeholder:"Choose a vehicle"})}),e.jsx(k,{children:m.map(r=>e.jsxs(l,{value:r.id,children:[r.vehicle_number," - ",r.make," ",r.model," (",r.license_plate,")"]},r.id))})]}),y&&e.jsxs("p",{className:"text-sm text-muted-foreground mt-1",children:["Selected: ",y]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(s,{htmlFor:"name",children:"Document Name *"}),e.jsx(j,{id:"name",value:i.name,onChange:r=>w(d=>({...d,name:r.target.value})),placeholder:"Enter document name",disabled:_})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"category",children:"Category *"}),e.jsxs(V,{value:i.category,onValueChange:r=>w(d=>({...d,category:r})),disabled:_,children:[e.jsx(F,{children:e.jsx(S,{placeholder:"Select category"})}),e.jsx(k,{children:Q.map(r=>e.jsx(l,{value:r,children:r},r))})]})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"priority",children:"Priority"}),e.jsxs(V,{value:i.priority,onValueChange:r=>w(d=>({...d,priority:r})),disabled:_,children:[e.jsx(F,{children:e.jsx(S,{})}),e.jsxs(k,{children:[e.jsx(l,{value:"low",children:"Low"}),e.jsx(l,{value:"medium",children:"Medium"}),e.jsx(l,{value:"high",children:"High"}),e.jsx(l,{value:"critical",children:"Critical"})]})]})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"department",children:"Department"}),e.jsxs(V,{value:i.department,onValueChange:r=>w(d=>({...d,department:r})),disabled:_,children:[e.jsx(F,{children:e.jsx(S,{placeholder:"Select department"})}),e.jsx(k,{children:Y.map(r=>e.jsx(l,{value:r,children:r},r))})]})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"expiryDate",children:"Expiry Date"}),e.jsx(j,{id:"expiryDate",type:"date",value:i.expiryDate,onChange:r=>w(d=>({...d,expiryDate:r.target.value})),disabled:_})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"version",children:"Version"}),e.jsx(j,{id:"version",value:i.version,onChange:r=>w(d=>({...d,version:r.target.value})),placeholder:"1.0",disabled:_})]})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"tags",children:"Tags"}),e.jsx(j,{id:"tags",value:i.tags,onChange:r=>w(d=>({...d,tags:r.target.value})),placeholder:"Enter tags separated by commas",disabled:_})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"description",children:"Description"}),e.jsx(Z,{id:"description",value:i.description,onChange:r=>w(d=>({...d,description:r.target.value})),placeholder:"Enter document description",rows:3,disabled:_})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(q,{id:"isConfidential",checked:i.isConfidential,onCheckedChange:r=>w(d=>({...d,isConfidential:r})),disabled:_}),e.jsx(s,{htmlFor:"isConfidential",children:"Mark as confidential"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(q,{id:"isFavorite",checked:i.isFavorite,onCheckedChange:r=>w(d=>({...d,isFavorite:r})),disabled:_}),e.jsx(s,{htmlFor:"isFavorite",children:"Mark as favorite"})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[e.jsx(f,{type:"button",variant:"outline",onClick:a,disabled:_,children:"Cancel"}),e.jsx(f,{type:"submit",disabled:!h||!i.name||!i.category||_,children:_?"Uploading...":"Upload Document"})]})]})]})})},Ae=({vehicle:t,open:o,onOpenChange:p,onSuccess:v})=>{const x=He(),[u,D]=ae.useState(!1),{register:m,handleSubmit:g,reset:n,setValue:y,watch:N,formState:{errors:h,isSubmitting:c}}=Oe({defaultValues:{make:"",model:"",year:new Date().getFullYear(),license_plate:"",vehicle_number:"",vehicle_type:"bus",status:"active",vin:"",capacity:0,fuel_type:"Diesel",mileage:0,orv_off_road_reason:"",orv_expected_return_date:"",orv_location:"",orv_responsible_person:"",orv_insurance_status:"covered",orv_maintenance_type:"planned",bor_return_ready:!1,bor_safety_inspection_complete:!1,bor_documentation_verified:!1,bor_driver_assigned:!1,bor_quality_assurance_complete:!1,bor_return_authorization:"pending"}});ae.useEffect(()=>{t&&n({make:t.make||"",model:t.model||"",year:t.year||new Date().getFullYear(),license_plate:t.license_plate||"",vehicle_number:t.vehicle_number||"",vehicle_type:t.type||"bus",status:t.status||"active",vin:t.vin||"",capacity:t.capacity||0,fuel_type:t.fuel_type||"Diesel",mileage:t.mileage||0,orv_off_road_reason:"",orv_expected_return_date:"",orv_location:"",orv_responsible_person:"",orv_insurance_status:"covered",orv_maintenance_type:"planned",bor_return_ready:!1,bor_safety_inspection_complete:!1,bor_documentation_verified:!1,bor_driver_assigned:!1,bor_quality_assurance_complete:!1,bor_return_authorization:"pending"})},[t,n]);const M=async i=>{if(t){if(!i.make.trim()){T({title:"Validation Error",description:"Make is required",variant:"destructive"});return}if(!i.model.trim()){T({title:"Validation Error",description:"Model is required",variant:"destructive"});return}if(!i.license_plate.trim()){T({title:"Validation Error",description:"License plate is required",variant:"destructive"});return}if(!i.vehicle_number.trim()){T({title:"Validation Error",description:"Vehicle number is required",variant:"destructive"});return}try{await x.mutateAsync({id:t.id,updates:{make:i.make,model:i.model,year:i.year,license_plate:i.license_plate,vehicle_number:i.vehicle_number,type:i.vehicle_type,status:i.status,capacity:i.capacity,fuel_type:i.fuel_type,mileage:i.mileage}}),T({title:"Success",description:"Vehicle updated successfully!"}),p(!1),v==null||v()}catch(w){console.error("Error updating vehicle:",w),T({title:"Error",description:"Failed to update vehicle. Please try again.",variant:"destructive"})}}},b=()=>{n(),p(!1)},A=(()=>{if(!t)return{status:"unknown",icon:e.jsx(H,{className:"w-4 h-4 text-gray-400"}),color:"gray"};switch(t.status){case"active":return{status:"Compliant",icon:e.jsx(K,{className:"w-4 h-4 text-green-600"}),color:"green"};case"maintenance":return{status:"ORV: Maintenance",icon:e.jsx(te,{className:"w-4 h-4 text-yellow-600"}),color:"yellow"};case"out_of_service":return{status:"ORV: Off Road",icon:e.jsx(ie,{className:"w-4 h-4 text-red-600"}),color:"red"};default:return{status:"Unknown",icon:e.jsx(H,{className:"w-4 h-4 text-gray-400"}),color:"gray"}}})();return t?e.jsx(je,{open:o,onOpenChange:b,children:e.jsxs(pe,{className:"sm:max-w-[900px] max-h-[90vh] overflow-y-auto",children:[e.jsxs(ve,{children:[e.jsxs(ge,{className:"flex items-center gap-2",children:[e.jsx(H,{className:"h-5 w-5"}),"Edit Vehicle - ",t.vehicle_number]}),e.jsxs("div",{className:"text-sm text-muted-foreground flex items-center gap-2",children:["Update vehicle details and ORV & BOR compliance settings",e.jsxs($,{variant:"outline",className:`text-${A.color}-600 border-${A.color}-200`,children:[A.icon,A.status]})]})]}),e.jsxs("form",{onSubmit:g(M),className:"space-y-6",children:[e.jsxs(Me,{defaultValue:"basic",className:"w-full",children:[e.jsxs(Te,{className:"grid w-full grid-cols-5",children:[e.jsx(ee,{value:"basic",children:"Basic Info"}),e.jsx(ee,{value:"orv",children:"ORV Status"}),e.jsx(ee,{value:"bor",children:"BOR Status"}),e.jsx(ee,{value:"compliance",children:"Compliance"}),e.jsx(ee,{value:"documents",children:"Documents"})]}),e.jsx(se,{value:"basic",className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(s,{htmlFor:"vehicle_number",children:"Vehicle Number"}),e.jsx(j,{id:"vehicle_number",placeholder:"e.g., BUS001",...m("vehicle_number",{required:!0})}),h.vehicle_number&&e.jsx("p",{className:"text-sm text-destructive mt-1",children:"Vehicle number is required"})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"license_plate",children:"License Plate"}),e.jsx(j,{id:"license_plate",placeholder:"e.g., LDN 001A",...m("license_plate",{required:!0})}),h.license_plate&&e.jsx("p",{className:"text-sm text-destructive mt-1",children:"License plate is required"})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"make",children:"Make"}),e.jsx(j,{id:"make",placeholder:"e.g., Mercedes",...m("make",{required:!0})}),h.make&&e.jsx("p",{className:"text-sm text-destructive mt-1",children:"Make is required"})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"model",children:"Model"}),e.jsx(j,{id:"model",placeholder:"e.g., Citaro",...m("model",{required:!0})}),h.model&&e.jsx("p",{className:"text-sm text-destructive mt-1",children:"Model is required"})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"year",children:"Year"}),e.jsx(j,{id:"year",type:"number",placeholder:"e.g., 2023",...m("year",{required:!0,valueAsNumber:!0,min:1900,max:new Date().getFullYear()+1})}),h.year&&e.jsx("p",{className:"text-sm text-destructive mt-1",children:"Valid year is required"})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"capacity",children:"Capacity"}),e.jsx(j,{id:"capacity",type:"number",placeholder:"e.g., 50",...m("capacity",{valueAsNumber:!0,min:1})})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"vehicle_type",children:"Vehicle Type"}),e.jsxs(V,{onValueChange:i=>y("vehicle_type",i),defaultValue:N("vehicle_type"),children:[e.jsx(F,{children:e.jsx(S,{placeholder:"Select vehicle type"})}),e.jsxs(k,{children:[e.jsx(l,{value:"bus",children:"Bus"}),e.jsx(l,{value:"coach",children:"Coach"}),e.jsx(l,{value:"hgv",children:"HGV"}),e.jsx(l,{value:"minibus",children:"Minibus"}),e.jsx(l,{value:"double_decker_bus",children:"Double Decker Bus"})]})]})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"status",children:"Status"}),e.jsxs(V,{onValueChange:i=>y("status",i),defaultValue:N("status"),children:[e.jsx(F,{children:e.jsx(S,{placeholder:"Select status"})}),e.jsxs(k,{children:[e.jsx(l,{value:"active",children:"Active"}),e.jsx(l,{value:"maintenance",children:"Maintenance"}),e.jsx(l,{value:"out_of_service",children:"Out of Service"})]})]})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"fuel_type",children:"Fuel Type"}),e.jsxs(V,{onValueChange:i=>y("fuel_type",i),defaultValue:N("fuel_type"),children:[e.jsx(F,{children:e.jsx(S,{placeholder:"Select fuel type"})}),e.jsxs(k,{children:[e.jsx(l,{value:"Diesel",children:"Diesel"}),e.jsx(l,{value:"Petrol",children:"Petrol"}),e.jsx(l,{value:"Electric",children:"Electric"}),e.jsx(l,{value:"Hybrid",children:"Hybrid"}),e.jsx(l,{value:"LPG",children:"LPG"})]})]})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"mileage",children:"Mileage"}),e.jsx(j,{id:"mileage",type:"number",placeholder:"e.g., 50000",...m("mileage",{valueAsNumber:!0,min:0})})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx(s,{htmlFor:"vin",children:"VIN (Optional)"}),e.jsx(j,{id:"vin",placeholder:"Vehicle Identification Number",...m("vin")})]})]})}),e.jsxs(se,{value:"orv",className:"space-y-4",children:[e.jsxs("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(X,{className:"h-4 w-4 text-orange-600"}),e.jsx("span",{className:"font-semibold text-orange-800",children:"ORV (Off-Road Vehicle) Management"})]}),e.jsx("p",{className:"text-sm text-orange-700",children:"Manage off-road vehicle status, documentation, and compliance requirements."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(s,{htmlFor:"orv_off_road_reason",children:"Reason for Off-Road Usage"}),e.jsx(Z,{id:"orv_off_road_reason",placeholder:"e.g., Scheduled maintenance, Emergency repairs, Operational requirements",...m("orv_off_road_reason")})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"orv_expected_return_date",children:"Expected Return Date"}),e.jsx(j,{id:"orv_expected_return_date",type:"date",...m("orv_expected_return_date")})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"orv_location",children:"Location of Off-Road Usage"}),e.jsx(j,{id:"orv_location",placeholder:"e.g., Maintenance facility, Storage location",...m("orv_location")})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"orv_responsible_person",children:"Responsible Person"}),e.jsx(j,{id:"orv_responsible_person",placeholder:"e.g., Fleet Manager, Maintenance Supervisor",...m("orv_responsible_person")})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"orv_insurance_status",children:"Insurance Status"}),e.jsxs(V,{onValueChange:i=>y("orv_insurance_status",i),defaultValue:N("orv_insurance_status"),children:[e.jsx(F,{children:e.jsx(S,{placeholder:"Select insurance status"})}),e.jsxs(k,{children:[e.jsx(l,{value:"covered",children:"Covered"}),e.jsx(l,{value:"suspended",children:"Suspended"}),e.jsx(l,{value:"expired",children:"Expired"})]})]})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"orv_maintenance_type",children:"Maintenance Type"}),e.jsxs(V,{onValueChange:i=>y("orv_maintenance_type",i),defaultValue:N("orv_maintenance_type"),children:[e.jsx(F,{children:e.jsx(S,{placeholder:"Select maintenance type"})}),e.jsxs(k,{children:[e.jsx(l,{value:"planned",children:"Planned"}),e.jsx(l,{value:"unplanned",children:"Unplanned"}),e.jsx(l,{value:"operational",children:"Operational"}),e.jsx(l,{value:"regulatory",children:"Regulatory"})]})]})]})]})]}),e.jsxs(se,{value:"bor",className:"space-y-4",children:[e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Ce,{className:"h-4 w-4 text-blue-600"}),e.jsx("span",{className:"font-semibold text-blue-800",children:"BOR (Back On Road) Management"})]}),e.jsx("p",{className:"text-sm text-blue-700",children:"Manage vehicle return to service process and compliance verification."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx("div",{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(q,{id:"bor_return_ready",checked:N("bor_return_ready"),onCheckedChange:i=>y("bor_return_ready",i)}),e.jsx(s,{htmlFor:"bor_return_ready",children:"Return Ready"})]})}),e.jsx("div",{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(q,{id:"bor_safety_inspection_complete",checked:N("bor_safety_inspection_complete"),onCheckedChange:i=>y("bor_safety_inspection_complete",i)}),e.jsx(s,{htmlFor:"bor_safety_inspection_complete",children:"Safety Inspection Complete"})]})}),e.jsx("div",{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(q,{id:"bor_documentation_verified",checked:N("bor_documentation_verified"),onCheckedChange:i=>y("bor_documentation_verified",i)}),e.jsx(s,{htmlFor:"bor_documentation_verified",children:"Documentation Verified"})]})}),e.jsx("div",{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(q,{id:"bor_driver_assigned",checked:N("bor_driver_assigned"),onCheckedChange:i=>y("bor_driver_assigned",i)}),e.jsx(s,{htmlFor:"bor_driver_assigned",children:"Driver Assigned"})]})}),e.jsx("div",{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(q,{id:"bor_quality_assurance_complete",checked:N("bor_quality_assurance_complete"),onCheckedChange:i=>y("bor_quality_assurance_complete",i)}),e.jsx(s,{htmlFor:"bor_quality_assurance_complete",children:"Quality Assurance Complete"})]})}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"bor_return_authorization",children:"Return Authorization"}),e.jsxs(V,{onValueChange:i=>y("bor_return_authorization",i),defaultValue:N("bor_return_authorization"),children:[e.jsx(F,{children:e.jsx(S,{placeholder:"Select return authorization status"})}),e.jsxs(k,{children:[e.jsx(l,{value:"pending",children:"Pending"}),e.jsx(l,{value:"approved",children:"Approved"}),e.jsx(l,{value:"rejected",children:"Rejected"})]})]})]})]})]}),e.jsxs(se,{value:"compliance",className:"space-y-4",children:[e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(K,{className:"h-4 w-4 text-green-600"}),e.jsx("span",{className:"font-semibold text-green-800",children:"Compliance Overview"})]}),e.jsx("p",{className:"text-sm text-green-700",children:"View and manage overall compliance status and requirements."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center p-4 border rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:A.icon}),e.jsx("div",{className:"font-semibold mt-2",children:"Current Status"}),e.jsx("div",{className:"text-sm text-gray-600",children:A.status})]}),e.jsxs("div",{className:"text-center p-4 border rounded-lg",children:[e.jsx(Ve,{className:"w-8 h-8 mx-auto text-orange-600"}),e.jsx("div",{className:"font-semibold mt-2",children:"ORV Duration"}),e.jsx("div",{className:"text-sm text-gray-600",children:t.status==="active"?"N/A":"Tracked"})]}),e.jsxs("div",{className:"text-center p-4 border rounded-lg",children:[e.jsx(J,{className:"w-8 h-8 mx-auto text-green-600"}),e.jsx("div",{className:"font-semibold mt-2",children:"Documentation"}),e.jsx("div",{className:"text-sm text-gray-600",children:t.status==="active"?"Complete":"Required"})]})]}),e.jsx(Fe,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-semibold",children:"Compliance Checklist"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(q,{id:"check1",checked:t.status==="active",disabled:!0}),e.jsx(s,{htmlFor:"check1",children:"Vehicle Roadworthy"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(q,{id:"check2",checked:t.status==="active",disabled:!0}),e.jsx(s,{htmlFor:"check2",children:"Documentation Current"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(q,{id:"check3",checked:t.status==="active",disabled:!0}),e.jsx(s,{htmlFor:"check3",children:"Insurance Valid"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(q,{id:"check4",checked:t.status==="active",disabled:!0}),e.jsx(s,{htmlFor:"check4",children:"Driver Assigned"})]})]})]})]}),e.jsxs(se,{value:"documents",className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Vehicle Documents"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Manage all documents related to this vehicle"})]}),e.jsxs(f,{onClick:()=>D(!0),children:[e.jsx(we,{className:"h-4 w-4 mr-2"}),"Upload Document"]})]}),e.jsx(ss,{vehicleId:t.id,vehicleNumber:t.vehicle_number})]})]}),e.jsxs("div",{className:"flex justify-end space-x-2 pt-4",children:[e.jsx(f,{type:"button",variant:"outline",onClick:b,disabled:c,children:"Cancel"}),e.jsxs(f,{type:"submit",disabled:c,children:[c&&e.jsx(fe,{className:"mr-2 h-4 w-4 animate-spin"}),"Update Vehicle"]})]})]}),e.jsx(es,{open:u,onOpenChange:D,vehicleId:t.id,vehicleNumber:t.vehicle_number,allowVehicleSelection:!1})]})}):null},ss=({vehicleId:t,vehicleNumber:o})=>{const{data:p=[],isLoading:v}=Je(t),x=Ze(),u=async n=>{if(confirm("Are you sure you want to delete this document?"))try{await x.mutateAsync({id:n,vehicleId:t})}catch(y){console.error("Error deleting document:",y)}},D=n=>{n.file_url?window.open(n.file_url,"_blank"):T.error("Download URL not available")},m=n=>{switch(n){case"active":return"bg-green-100 text-green-800";case"expired":return"bg-red-100 text-red-800";case"pending":return"bg-yellow-100 text-yellow-800";case"archived":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}},g=n=>{switch(n){case"critical":return"bg-red-100 text-red-800";case"high":return"bg-orange-100 text-orange-800";case"medium":return"bg-yellow-100 text-yellow-800";case"low":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}};return v?e.jsxs("div",{className:"flex items-center justify-center py-8",children:[e.jsx(fe,{className:"h-6 w-6 animate-spin"}),e.jsx("span",{className:"ml-2",children:"Loading documents..."})]}):p.length===0?e.jsx(C,{children:e.jsxs(O,{className:"flex flex-col items-center justify-center py-8",children:[e.jsx(J,{className:"h-12 w-12 text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No documents uploaded"}),e.jsx("p",{className:"text-gray-500 text-center mb-4",children:"Upload documents like registration, insurance, MOT certificates, and maintenance records."})]})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs(C,{children:[e.jsx(P,{children:e.jsxs(z,{className:"flex items-center gap-2",children:[e.jsx(J,{className:"h-5 w-5"}),"Documents (",p.length,")"]})}),e.jsx(O,{children:e.jsxs(ke,{children:[e.jsx(De,{children:e.jsxs(le,{children:[e.jsx(L,{children:"Document"}),e.jsx(L,{children:"Category"}),e.jsx(L,{children:"Status"}),e.jsx(L,{children:"Priority"}),e.jsx(L,{children:"Uploaded"}),e.jsx(L,{children:"Expiry"}),e.jsx(L,{className:"text-right",children:"Actions"})]})}),e.jsx(Re,{children:p.map(n=>e.jsxs(le,{children:[e.jsx(B,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[n.is_favorite&&e.jsx(We,{className:"h-4 w-4 text-yellow-500"}),!n.is_public&&e.jsx(_e,{className:"h-4 w-4 text-red-500"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:n.name}),n.description&&e.jsx("div",{className:"text-sm text-gray-500",children:n.description})]})]})}),e.jsx(B,{children:e.jsx($,{variant:"outline",children:n.category})}),e.jsx(B,{children:e.jsx($,{className:m(n.status),children:n.status})}),e.jsx(B,{children:n.priority&&e.jsx($,{className:g(n.priority),children:n.priority})}),e.jsx(B,{children:e.jsx("div",{className:"text-sm",children:new Date(n.uploaded_at).toLocaleDateString()})}),e.jsx(B,{children:n.expiry_date?e.jsx("div",{className:"text-sm",children:new Date(n.expiry_date).toLocaleDateString()}):e.jsx("span",{className:"text-gray-400",children:"No expiry"})}),e.jsx(B,{className:"text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx(f,{variant:"ghost",size:"sm",onClick:()=>D(n),title:"Download",children:e.jsx(Pe,{className:"h-4 w-4"})}),e.jsx(f,{variant:"ghost",size:"sm",onClick:()=>window.open(n.file_url,"_blank"),title:"View",children:e.jsx(ze,{className:"h-4 w-4"})}),e.jsx(f,{variant:"ghost",size:"sm",onClick:()=>u(n.id),title:"Delete",className:"text-red-600 hover:text-red-700",children:e.jsx(qe,{className:"h-4 w-4"})})]})})]},n.id))})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(C,{children:e.jsx(O,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(J,{className:"h-5 w-5 text-blue-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold",children:p.length}),e.jsx("div",{className:"text-sm text-gray-600",children:"Total Documents"})]})]})})}),e.jsx(C,{children:e.jsx(O,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(K,{className:"h-5 w-5 text-green-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold",children:p.filter(n=>n.status==="active").length}),e.jsx("div",{className:"text-sm text-gray-600",children:"Active"})]})]})})}),e.jsx(C,{children:e.jsx(O,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ie,{className:"h-5 w-5 text-red-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold",children:p.filter(n=>n.status==="expired").length}),e.jsx("div",{className:"text-sm text-gray-600",children:"Expired"})]})]})})}),e.jsx(C,{children:e.jsx(O,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_e,{className:"h-5 w-5 text-orange-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold",children:p.filter(n=>!n.is_public).length}),e.jsx("div",{className:"text-sm text-gray-600",children:"Confidential"})]})]})})})]})]})},as=({open:t,onOpenChange:o,onSuccess:p})=>{const v=Qe(),{register:x,handleSubmit:u,reset:D,setValue:m,watch:g,formState:{errors:n,isSubmitting:y}}=Oe({defaultValues:{vehicle_number:"",license_plate:"",make:"",model:"",year:new Date().getFullYear(),vin:"",vehicle_type:"bus",fuel_type:"Diesel",color:"",capacity:1,status:"active",purchase_date:"",registration_expiry:"",insurance_expiry:"",service_interval_months:6,notes:"",orv_off_road_reason:"",orv_expected_return_date:"",orv_location:"",orv_responsible_person:"",orv_insurance_status:"covered",orv_maintenance_type:"planned",bor_return_ready:!1,bor_safety_inspection_complete:!1,bor_documentation_verified:!1,bor_driver_assigned:!1,bor_quality_assurance_complete:!1,bor_return_authorization:"pending"}}),N=async c=>{if(!c.vehicle_number.trim()){T({title:"Validation Error",description:"Vehicle number is required",variant:"destructive"});return}if(!c.license_plate.trim()){T({title:"Validation Error",description:"License plate is required",variant:"destructive"});return}if(c.capacity<1){T({title:"Validation Error",description:"Capacity must be at least 1",variant:"destructive"});return}try{await v.mutateAsync({vehicle_number:c.vehicle_number,license_plate:c.license_plate,make:c.make||null,model:c.model||null,year:c.year||null,type:c.vehicle_type,fuel_type:c.fuel_type||null,capacity:c.capacity,status:c.status}),T({title:"Success",description:"Vehicle added successfully!"}),o(!1),p==null||p(),D()}catch(M){console.error("Error adding vehicle:",M),T({title:"Error",description:"Failed to add vehicle. Please try again.",variant:"destructive"})}},h=()=>{D(),o(!1)};return e.jsx(je,{open:t,onOpenChange:h,children:e.jsxs(pe,{className:"sm:max-w-[800px] max-h-[90vh] overflow-y-auto",children:[e.jsxs(ve,{children:[e.jsxs(ge,{className:"flex items-center gap-2",children:[e.jsx(H,{className:"h-5 w-5"}),"Add New Vehicle"]}),e.jsx(be,{children:"Register a new vehicle in your fleet management system."})]}),e.jsxs("form",{onSubmit:u(N),className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Basic Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(s,{htmlFor:"vehicle_number",children:"Vehicle Number *"}),e.jsx(j,{id:"vehicle_number",placeholder:"e.g., BUS001",...x("vehicle_number",{required:!0})}),n.vehicle_number&&e.jsx("p",{className:"text-sm text-destructive mt-1",children:"Vehicle number is required"})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"license_plate",children:"License Plate *"}),e.jsx(j,{id:"license_plate",placeholder:"e.g., LDN 001A",...x("license_plate",{required:!0})}),n.license_plate&&e.jsx("p",{className:"text-sm text-destructive mt-1",children:"License plate is required"})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"capacity",children:"Passenger Capacity *"}),e.jsx(j,{id:"capacity",type:"number",placeholder:"Number of seats",...x("capacity",{required:!0,valueAsNumber:!0,min:1})}),n.capacity&&e.jsx("p",{className:"text-sm text-destructive mt-1",children:"Valid capacity is required"})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"vehicle_type",children:"Vehicle Type *"}),e.jsxs(V,{onValueChange:c=>m("vehicle_type",c),defaultValue:g("vehicle_type"),children:[e.jsx(F,{children:e.jsx(S,{placeholder:"Select vehicle type"})}),e.jsxs(k,{children:[e.jsx(l,{value:"Bus",children:"Bus"}),e.jsx(l,{value:"Coach",children:"Coach"}),e.jsx(l,{value:"HGV",children:"HGV"}),e.jsx(l,{value:"Minibus",children:"Minibus"}),e.jsx(l,{value:"Van",children:"Van"})]})]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Vehicle Specifications"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(s,{htmlFor:"make",children:"Make"}),e.jsx(j,{id:"make",placeholder:"e.g., Mercedes",...x("make")})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"model",children:"Model"}),e.jsx(j,{id:"model",placeholder:"e.g., Citaro",...x("model")})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"year",children:"Year"}),e.jsx(j,{id:"year",type:"number",placeholder:"e.g., 2023",...x("year",{valueAsNumber:!0,min:1900,max:new Date().getFullYear()+1})})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"color",children:"Color"}),e.jsx(j,{id:"color",placeholder:"e.g., White",...x("color")})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"fuel_type",children:"Fuel Type"}),e.jsxs(V,{onValueChange:c=>m("fuel_type",c),defaultValue:g("fuel_type"),children:[e.jsx(F,{children:e.jsx(S,{placeholder:"Select fuel type"})}),e.jsxs(k,{children:[e.jsx(l,{value:"Diesel",children:"Diesel"}),e.jsx(l,{value:"Petrol",children:"Petrol"}),e.jsx(l,{value:"Electric",children:"Electric"}),e.jsx(l,{value:"Hybrid",children:"Hybrid"}),e.jsx(l,{value:"CNG",children:"CNG"})]})]})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"vin",children:"VIN (Vehicle Identification Number)"}),e.jsx(j,{id:"vin",placeholder:"17-character VIN",...x("vin")})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Compliance & Registration"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(s,{htmlFor:"purchase_date",children:"Purchase Date"}),e.jsx(j,{id:"purchase_date",type:"date",...x("purchase_date")})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"registration_expiry",children:"Registration Expiry"}),e.jsx(j,{id:"registration_expiry",type:"date",...x("registration_expiry")})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"insurance_expiry",children:"Insurance Expiry"}),e.jsx(j,{id:"insurance_expiry",type:"date",...x("insurance_expiry")})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"service_interval_months",children:"Service Interval (Months)"}),e.jsx(j,{id:"service_interval_months",type:"number",placeholder:"e.g., 6",...x("service_interval_months",{valueAsNumber:!0,min:1})})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"status",children:"Initial Status"}),e.jsxs(V,{onValueChange:c=>m("status",c),defaultValue:g("status"),children:[e.jsx(F,{children:e.jsx(S,{placeholder:"Select status"})}),e.jsxs(k,{children:[e.jsx(l,{value:"active",children:"Active"}),e.jsx(l,{value:"maintenance",children:"Maintenance"}),e.jsx(l,{value:"out_of_service",children:"Out of Service"})]})]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Off-Road Vehicle Compliance"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(s,{htmlFor:"orv_off_road_reason",children:"Reason for Off-Road Usage"}),e.jsx(Z,{id:"orv_off_road_reason",placeholder:"e.g., Construction site access, Emergency response, Site survey",...x("orv_off_road_reason")})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"orv_expected_return_date",children:"Expected Return Date"}),e.jsx(j,{id:"orv_expected_return_date",type:"date",...x("orv_expected_return_date")})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"orv_location",children:"Location of Off-Road Usage"}),e.jsx(j,{id:"orv_location",placeholder:"e.g., 123 Main St, City, Country",...x("orv_location")})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"orv_responsible_person",children:"Responsible Person"}),e.jsx(j,{id:"orv_responsible_person",placeholder:"e.g., John Doe, Manager",...x("orv_responsible_person")})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"orv_insurance_status",children:"Insurance Status"}),e.jsxs(V,{onValueChange:c=>m("orv_insurance_status",c),defaultValue:g("orv_insurance_status"),children:[e.jsx(F,{children:e.jsx(S,{placeholder:"Select insurance status"})}),e.jsxs(k,{children:[e.jsx(l,{value:"covered",children:"Covered"}),e.jsx(l,{value:"suspended",children:"Suspended"}),e.jsx(l,{value:"expired",children:"Expired"})]})]})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"orv_maintenance_type",children:"Maintenance Type"}),e.jsxs(V,{onValueChange:c=>m("orv_maintenance_type",c),defaultValue:g("orv_maintenance_type"),children:[e.jsx(F,{children:e.jsx(S,{placeholder:"Select maintenance type"})}),e.jsxs(k,{children:[e.jsx(l,{value:"planned",children:"Planned"}),e.jsx(l,{value:"unplanned",children:"Unplanned"}),e.jsx(l,{value:"operational",children:"Operational"}),e.jsx(l,{value:"regulatory",children:"Regulatory"})]})]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Back On Road Compliance"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(s,{htmlFor:"bor_return_ready",children:"Return Ready"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(q,{id:"bor_return_ready",checked:g("bor_return_ready"),onCheckedChange:c=>m("bor_return_ready",c)}),e.jsx(s,{htmlFor:"bor_return_ready",children:"Return Ready"})]})]}),e.jsx("div",{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(q,{id:"bor_safety_inspection_complete",checked:g("bor_safety_inspection_complete"),onCheckedChange:c=>m("bor_safety_inspection_complete",c)}),e.jsx(s,{htmlFor:"bor_safety_inspection_complete",children:"Safety Inspection Complete"})]})}),e.jsx("div",{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(q,{id:"bor_documentation_verified",checked:g("bor_documentation_verified"),onCheckedChange:c=>m("bor_documentation_verified",c)}),e.jsx(s,{htmlFor:"bor_documentation_verified",children:"Documentation Verified"})]})}),e.jsx("div",{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(q,{id:"bor_driver_assigned",checked:g("bor_driver_assigned"),onCheckedChange:c=>m("bor_driver_assigned",c)}),e.jsx(s,{htmlFor:"bor_driver_assigned",children:"Driver Assigned"})]})}),e.jsx("div",{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(q,{id:"bor_quality_assurance_complete",checked:g("bor_quality_assurance_complete"),onCheckedChange:c=>m("bor_quality_assurance_complete",c)}),e.jsx(s,{htmlFor:"bor_quality_assurance_complete",children:"Quality Assurance Complete"})]})}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"bor_return_authorization",children:"Return Authorization"}),e.jsxs(V,{onValueChange:c=>m("bor_return_authorization",c),defaultValue:g("bor_return_authorization"),children:[e.jsx(F,{children:e.jsx(S,{placeholder:"Select return authorization status"})}),e.jsxs(k,{children:[e.jsx(l,{value:"pending",children:"Pending"}),e.jsx(l,{value:"approved",children:"Approved"}),e.jsx(l,{value:"rejected",children:"Rejected"})]})]})]})]})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"notes",children:"Additional Notes"}),e.jsx(Z,{id:"notes",placeholder:"Any additional information about the vehicle...",...x("notes")})]}),e.jsxs("div",{className:"flex justify-end space-x-2 pt-4 border-t",children:[e.jsx(f,{type:"button",variant:"outline",onClick:h,disabled:y,children:"Cancel"}),e.jsxs(f,{type:"submit",disabled:y,children:[y&&e.jsx(fe,{className:"mr-2 h-4 w-4 animate-spin"}),"Add Vehicle"]})]})]})]})})},is=()=>{const{data:t=[],isLoading:o,error:p}=ye(),v=Se(),[x,u]=ae.useState(null),[D,m]=ae.useState(null),[g,n]=ae.useState(!1),y=async h=>{try{await v.mutateAsync(h.id),I.success("Vehicle deleted successfully"),m(null)}catch(c){console.error("Error deleting vehicle:",c),I.error("Failed to delete vehicle")}},N=h=>{const c=h.status||"active";switch(c){case"active":return e.jsxs($,{variant:"default",className:"bg-green-100 text-green-800 border-green-200",children:[e.jsx(K,{className:"w-3 h-3 mr-1"}),"Active"]});case"maintenance":return e.jsxs($,{variant:"outline",className:"text-yellow-600 border-yellow-200",children:[e.jsx(te,{className:"w-3 h-3 mr-1"}),"ORV: Maintenance"]});case"out_of_service":return e.jsxs($,{variant:"destructive",className:"bg-red-100 text-red-800 border-red-200",children:[e.jsx(ie,{className:"w-3 h-3 mr-1"}),"ORV: Off Road"]});default:return e.jsxs($,{variant:"secondary",children:[e.jsx(H,{className:"w-3 h-3 mr-1"}),c]})}};return o?e.jsx(C,{children:e.jsxs(P,{children:[e.jsx(z,{children:"Vehicles"}),e.jsx(oe,{children:"Loading vehicles..."})]})}):p?e.jsx(C,{children:e.jsxs(P,{children:[e.jsx(z,{children:"Vehicles"}),e.jsxs(oe,{children:["Error loading vehicles: ",p.message]})]})}):e.jsxs(e.Fragment,{children:[e.jsxs(C,{children:[e.jsxs(P,{children:[e.jsx(z,{children:"Vehicle Fleet"}),e.jsx(oe,{children:"Manage your vehicle fleet with ORV & BOR roadworthiness compliance tracking"})]}),e.jsx(O,{children:t.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(H,{className:"mx-auto h-12 w-12 text-gray-400"}),e.jsx("h3",{className:"mt-2 text-sm font-semibold text-gray-900",children:"No vehicles"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Get started by adding your first vehicle to the fleet."}),e.jsx("div",{className:"mt-6",children:e.jsxs(f,{onClick:()=>n(!0),children:[e.jsx(re,{className:"mr-2 h-4 w-4"}),"Add Vehicle"]})})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(X,{className:"h-4 w-4 text-orange-600"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"ORV: Off-Road Vehicle | BOR: Back On Road"})]}),e.jsxs(f,{onClick:()=>n(!0),children:[e.jsx(re,{className:"mr-2 h-4 w-4"}),"Add Vehicle"]})]}),e.jsx("div",{className:"border rounded-lg",children:e.jsxs(ke,{children:[e.jsx(De,{children:e.jsxs(le,{children:[e.jsx(L,{children:"Vehicle"}),e.jsx(L,{children:"Type"}),e.jsx(L,{children:"Status"}),e.jsx(L,{children:"Capacity"}),e.jsx(L,{children:"Actions"})]})}),e.jsx(Re,{children:t.map(h=>e.jsxs(le,{children:[e.jsx(B,{children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:h.vehicle_number}),e.jsx("div",{className:"text-sm text-gray-500",children:h.license_plate}),e.jsxs("div",{className:"text-xs text-gray-400",children:[h.make," ",h.model," (",h.year,")"]})]})}),e.jsx(B,{children:e.jsx($,{variant:"outline",className:"capitalize",children:h.type||"bus"})}),e.jsx(B,{children:N(h)}),e.jsx(B,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium",children:h.capacity||0}),e.jsx("span",{className:"text-xs text-gray-500",children:"seats"})]})}),e.jsx(B,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(f,{variant:"outline",size:"sm",onClick:()=>u(h),children:e.jsx(Ie,{className:"h-4 w-4"})}),e.jsx(f,{variant:"outline",size:"sm",onClick:()=>m(h),children:e.jsx(qe,{className:"h-4 w-4"})})]})})]},h.id))})]})}),e.jsx("div",{className:"text-xs text-gray-500 text-center",children:e.jsxs("div",{className:"flex items-center justify-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(K,{className:"w-3 h-3 text-green-600"}),e.jsx("span",{children:"Active"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(te,{className:"w-3 h-3 text-yellow-600"}),e.jsx("span",{children:"ORV: Maintenance"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ie,{className:"w-3 h-3 text-red-600"}),e.jsx("span",{children:"ORV: Off Road"})]})]})})]})})]}),e.jsx(as,{open:g,onOpenChange:n,onSuccess:()=>{n(!1)}}),e.jsx(Ae,{vehicle:x,open:!!x,onOpenChange:h=>{h||u(null)},onSuccess:()=>{u(null)}}),D&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Delete Vehicle"}),e.jsxs("p",{className:"text-gray-600 mb-6",children:["Are you sure you want to delete ",D.vehicle_number,"? This action cannot be undone."]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx(f,{variant:"outline",onClick:()=>m(null),disabled:v.isPending,children:"Cancel"}),e.jsx(f,{variant:"destructive",onClick:()=>y(D),disabled:v.isPending,children:v.isPending?"Deleting...":"Delete"})]})]})})]})},ts=()=>{const{profile:t}=ne(),{selectedOrganizationId:o}=Le(),p=me(),[v,x]=U.useState(1),[u,D]=U.useState({vehicle_number:"",make:"",model:"",year:"",license_plate:"",vin:"",fuel_type:"",transmission:"",color:"",mileage:"",notes:""}),[m,g]=U.useState([]),[n,y]=U.useState([]),{data:N=[],isLoading:h}=he({queryKey:["inspection-templates",o],queryFn:async()=>{if(!o)return[];const{data:a,error:r}=await W.from("inspection_templates").select("*").eq("organization_id",o).eq("is_active",!0).order("frequency_days",{ascending:!0});return r?(console.error("Error fetching templates:",r),[]):a},enabled:!!o}),{data:c=[]}=he({queryKey:["drivers",o],queryFn:async()=>{if(!o)return[];const{data:a,error:r}=await W.from("profiles").select("id, first_name, last_name, email").eq("organization_id",o).eq("role","driver").order("first_name");return r?(console.error("Error fetching drivers:",r),[]):a},enabled:!!o}),M=ue({mutationFn:async()=>{if(!o||!(t!=null&&t.id))throw new Error("Missing organization or user data");const{data:a,error:r}=await W.from("vehicles").insert({...u,organization_id:o,created_by:t.id,status:"active"}).select().single();if(r)throw r;const d=m.map(G=>W.from("inspection_schedules").insert({vehicle_id:a.id,template_id:G.template_id,scheduled_date:G.next_inspection_date,assigned_driver_id:G.assigned_driver_id,notes:G.notes,organization_id:o,status:"scheduled"}));if((await Promise.all(d)).filter(G=>G.error).length>0)throw await W.from("vehicles").delete().eq("id",a.id),new Error("Failed to create inspection schedules");return a},onSuccess:()=>{I.success("Vehicle created successfully with inspection schedules!"),p.invalidateQueries(["vehicles"]),p.invalidateQueries(["inspection-schedules"]),D({vehicle_number:"",make:"",model:"",year:"",license_plate:"",vin:"",fuel_type:"",transmission:"",color:"",mileage:"",notes:""}),g([]),y([]),x(1)},onError:a=>{I.error(`Failed to create vehicle: ${a.message}`)}}),b=(a,r)=>{D(d=>({...d,[a]:r}))},_=a=>{y(r=>{if(r.includes(a))return g(R=>R.filter(E=>E.template_id!==a)),r.filter(R=>R!==a);{const R=N.find(E=>E.id===a);if(R){const E=new Date;E.setDate(E.getDate()+R.frequency_days),g(G=>[...G,{template_id:a,frequency_days:R.frequency_days,next_inspection_date:E.toISOString().split("T")[0],notes:`Initial ${R.name} schedule`}])}return[...r,a]}})},A=(a,r,d)=>{g(R=>R.map(E=>E.template_id===a?{...E,[r]:d}:E))},i=a=>a===1?"Daily":a===7?"Weekly":a===28?"4-Weekly":a===42?"6-Weekly":`Every ${a} days`,w=()=>u.vehicle_number&&u.make&&u.model&&u.license_plate,Q=()=>n.length>0&&m.every(a=>a.next_inspection_date),Y=()=>{v===1&&w()&&x(2)},ce=()=>{v===2&&x(1)},de=()=>{Q()&&M.mutate()};return h?e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto"}),e.jsx("p",{className:"text-muted-foreground",children:"Loading inspection templates..."})]})}):e.jsxs("div",{className:"container mx-auto px-4 py-8 max-w-4xl",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Add New Vehicle"}),e.jsx("p",{className:"text-gray-600",children:"Create a new vehicle and set up its inspection schedules"})]}),e.jsx("div",{className:"flex items-center justify-center mb-8",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:`flex items-center justify-center w-10 h-10 rounded-full border-2 ${v>=1?"bg-primary text-primary-foreground border-primary":"bg-gray-100 border-gray-300"}`,children:e.jsx(H,{className:"w-5 h-5"})}),e.jsx("div",{className:`h-1 w-16 ${v>=2?"bg-primary":"bg-gray-300"}`}),e.jsx("div",{className:`flex items-center justify-center w-10 h-10 rounded-full border-2 ${v>=2?"bg-primary text-primary-foreground border-primary":"bg-gray-100 border-gray-300"}`,children:e.jsx(X,{className:"w-5 h-5"})})]})}),v===1&&e.jsxs(C,{children:[e.jsx(P,{children:e.jsxs(z,{className:"flex items-center space-x-2",children:[e.jsx(H,{className:"w-5 h-5"}),e.jsx("span",{children:"Vehicle Information"})]})}),e.jsxs(O,{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(s,{htmlFor:"vehicle_number",children:"Vehicle Number *"}),e.jsx(j,{id:"vehicle_number",value:u.vehicle_number,onChange:a=>b("vehicle_number",a.target.value),placeholder:"e.g., V001"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(s,{htmlFor:"license_plate",children:"License Plate *"}),e.jsx(j,{id:"license_plate",value:u.license_plate,onChange:a=>b("license_plate",a.target.value),placeholder:"e.g., ABC123"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(s,{htmlFor:"make",children:"Make *"}),e.jsx(j,{id:"make",value:u.make,onChange:a=>b("make",a.target.value),placeholder:"e.g., Ford"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(s,{htmlFor:"model",children:"Model *"}),e.jsx(j,{id:"model",value:u.model,onChange:a=>b("model",a.target.value),placeholder:"e.g., Transit"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(s,{htmlFor:"year",children:"Year"}),e.jsx(j,{id:"year",value:u.year,onChange:a=>b("year",a.target.value),placeholder:"e.g., 2023"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(s,{htmlFor:"vin",children:"VIN"}),e.jsx(j,{id:"vin",value:u.vin,onChange:a=>b("vin",a.target.value),placeholder:"Vehicle Identification Number"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(s,{htmlFor:"fuel_type",children:"Fuel Type"}),e.jsxs(V,{value:u.fuel_type,onValueChange:a=>b("fuel_type",a),children:[e.jsx(F,{children:e.jsx(S,{placeholder:"Select fuel type"})}),e.jsxs(k,{children:[e.jsx(l,{value:"diesel",children:"Diesel"}),e.jsx(l,{value:"petrol",children:"Petrol"}),e.jsx(l,{value:"electric",children:"Electric"}),e.jsx(l,{value:"hybrid",children:"Hybrid"}),e.jsx(l,{value:"lpg",children:"LPG"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(s,{htmlFor:"transmission",children:"Transmission"}),e.jsxs(V,{value:u.transmission,onValueChange:a=>b("transmission",a),children:[e.jsx(F,{children:e.jsx(S,{placeholder:"Select transmission"})}),e.jsxs(k,{children:[e.jsx(l,{value:"manual",children:"Manual"}),e.jsx(l,{value:"automatic",children:"Automatic"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(s,{htmlFor:"color",children:"Color"}),e.jsx(j,{id:"color",value:u.color,onChange:a=>b("color",a.target.value),placeholder:"e.g., White"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(s,{htmlFor:"mileage",children:"Current Mileage"}),e.jsx(j,{id:"mileage",value:u.mileage,onChange:a=>b("mileage",a.target.value),placeholder:"e.g., 50000"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(s,{htmlFor:"notes",children:"Notes"}),e.jsx(Z,{id:"notes",value:u.notes,onChange:a=>b("notes",a.target.value),placeholder:"Additional notes about the vehicle...",rows:3})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(f,{onClick:Y,disabled:!w(),className:"bg-primary hover:bg-primary/90",children:["Next: Setup Inspections",e.jsx(X,{className:"w-4 h-4 ml-2"})]})})]})]}),v===2&&e.jsxs(C,{children:[e.jsxs(P,{children:[e.jsxs(z,{className:"flex items-center space-x-2",children:[e.jsx(X,{className:"w-5 h-5"}),e.jsx("span",{children:"Inspection Schedule Setup"})]}),e.jsx("p",{className:"text-sm text-gray-600 mt-2",children:"Select the inspection types that apply to this vehicle and set up their schedules"})]}),e.jsxs(O,{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Available Inspection Types"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:N.map(a=>e.jsx("div",{className:"border rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(q,{checked:n.includes(a.id),onCheckedChange:()=>_(a.id)}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium",children:a.name}),e.jsx("p",{className:"text-sm text-gray-600",children:a.description}),e.jsx($,{variant:"outline",className:"mt-2",children:i(a.frequency_days)})]})]})},a.id))})]}),e.jsx(Fe,{}),n.length>0&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Inspection Schedules"}),e.jsx("div",{className:"space-y-4",children:m.map(a=>{const r=N.find(d=>d.id===a.template_id);return e.jsxs(C,{className:"p-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(s,{className:"text-sm font-medium",children:"Inspection Type"}),e.jsx("p",{className:"text-sm text-gray-600",children:r==null?void 0:r.name})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:`date-${a.template_id}`,className:"text-sm font-medium",children:"Next Inspection Date *"}),e.jsx(j,{id:`date-${a.template_id}`,type:"date",value:a.next_inspection_date,onChange:d=>A(a.template_id,"next_inspection_date",d.target.value),min:new Date().toISOString().split("T")[0]})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:`driver-${a.template_id}`,className:"text-sm font-medium",children:"Assigned Driver"}),e.jsxs(V,{value:a.assigned_driver_id||"",onValueChange:d=>A(a.template_id,"assigned_driver_id",d||null),children:[e.jsx(F,{children:e.jsx(S,{placeholder:"Select driver"})}),e.jsxs(k,{children:[e.jsx(l,{value:"",children:"No driver assigned"}),c.map(d=>e.jsxs(l,{value:d.id,children:[d.first_name," ",d.last_name]},d.id))]})]})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx(s,{htmlFor:`notes-${a.template_id}`,className:"text-sm font-medium",children:"Notes"}),e.jsx(Z,{id:`notes-${a.template_id}`,value:a.notes||"",onChange:d=>A(a.template_id,"notes",d.target.value),placeholder:"Additional notes for this inspection schedule...",rows:2})]})]},a.template_id)})})]}),n.length===0&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Be,{className:"h-12 w-12 text-yellow-500 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Inspection Types Selected"}),e.jsx("p",{className:"text-gray-600",children:"Please select at least one inspection type above to continue."})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(f,{variant:"outline",onClick:ce,children:"Back to Vehicle Info"}),e.jsx(f,{onClick:de,disabled:!Q()||M.isPending,className:"bg-primary hover:bg-primary/90",children:M.isPending?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Creating Vehicle..."]}):e.jsxs(e.Fragment,{children:[e.jsx(re,{className:"w-4 h-4 mr-2"}),"Create Vehicle with Inspections"]})})]})]})]})]})};function us(){const[t,o]=U.useState(null),[p,v]=U.useState(!1),x=Ue(),{data:u=[],isLoading:D,error:m}=ye(),g=Ye(),n=Se(),y=()=>{v(!0)},N=async()=>{if(confirm("Are you sure you want to delete ALL vehicles? This action cannot be undone."))try{for(const Y of u)await n.mutateAsync(Y.id);T({title:"Success!",description:"All vehicles have been removed from your fleet."})}catch(Y){console.error("Error clearing vehicles:",Y),T({title:"Error",description:"Failed to clear all vehicles. Please try again.",variant:"destructive"})}},h=()=>{x("/vehicle-settings")},c=g.total,M=g.active,b=g.maintenance,_=g.out_of_service,A=c>0?Math.round(M/c*100):0,i=c>0?Math.round((c-_)/c*100):0,w=b+_,Q=Math.floor(w*.3);return m?e.jsxs("div",{className:"space-y-6",children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Vehicle Management"}),e.jsx(C,{children:e.jsx(O,{className:"p-8",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("p",{className:"text-destructive",children:["Error loading vehicles: ",m.message]}),e.jsx(f,{onClick:()=>window.location.reload(),className:"mt-4",children:"Try Again"})]})})})]}):p?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Vehicle Management"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Fleet management with ORV & BOR roadworthiness compliance"})]}),e.jsx(f,{variant:"outline",onClick:()=>v(!1),children:"Back to Vehicle List"})]}),e.jsx(ts,{})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Vehicle Management"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Fleet management with ORV & BOR roadworthiness compliance"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(f,{onClick:h,variant:"outline",className:"inline-flex items-center",children:[e.jsx(Ne,{className:"mr-2 h-4 w-4"}),"Fleet Settings"]}),u.length>0&&e.jsxs(f,{onClick:N,variant:"destructive",className:"inline-flex items-center",disabled:n.isPending,children:[e.jsx(Ke,{className:"mr-2 h-4 w-4"}),n.isPending?"Clearing...":"Clear All Vehicles"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs(C,{className:"border-orange-200 bg-orange-50 vehicle-card",children:[e.jsxs(P,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsxs(z,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(X,{className:"h-4 w-4 text-orange-600"}),"ORV (Off-Road Vehicle) Status"]}),e.jsxs($,{variant:w>0?"destructive":"default",className:"badge",children:[w," Off-Road"]})]}),e.jsx(O,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Compliance Rate"}),e.jsxs("span",{className:"font-semibold",children:[A,"%"]})]}),e.jsx(xe,{value:A,className:"h-2"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs text-gray-600",children:[e.jsxs("div",{children:["Maintenance: ",b]}),e.jsxs("div",{children:["Out of Service: ",_]})]})]})})]}),e.jsxs(C,{className:"border-blue-200 bg-blue-50 vehicle-card",children:[e.jsxs(P,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsxs(z,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(Ce,{className:"h-4 w-4 text-blue-600"}),"BOR (Back On Road) Status"]}),e.jsxs($,{variant:Q>0?"default":"secondary",className:"badge",children:[Q," Returning Soon"]})]}),e.jsx(O,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Return Readiness"}),e.jsxs("span",{className:"font-semibold",children:[i,"%"]})]}),e.jsx(xe,{value:i,className:"h-2"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs text-gray-600",children:[e.jsxs("div",{children:["Ready to Return: ",Q]}),e.jsxs("div",{children:["In Process: ",w-Q]})]})]})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs(C,{className:"stats-card",children:[e.jsxs(P,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(z,{className:"text-sm font-medium stats-label",children:"Total Vehicles"}),e.jsx(H,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(O,{children:[e.jsx("div",{className:"text-2xl font-bold stats-number",children:c}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1 stats-label",children:"Fleet size"})]})]}),e.jsxs(C,{className:"stats-card",children:[e.jsxs(P,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(z,{className:"text-sm font-medium stats-label",children:"Active"}),e.jsx(K,{className:"h-4 w-4 text-green-600"})]}),e.jsxs(O,{children:[e.jsx("div",{className:"text-2xl font-bold stats-number",children:M}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1 stats-label",children:[c>0?Math.round(M/c*100):0,"% of fleet"]})]})]}),e.jsxs(C,{className:"stats-card",children:[e.jsxs(P,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(z,{className:"text-sm font-medium stats-label",children:"In Maintenance"}),e.jsx(te,{className:"h-4 w-4 text-yellow-600"})]}),e.jsxs(O,{children:[e.jsx("div",{className:"text-2xl font-bold stats-number",children:b}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1 stats-label",children:"ORV: Planned/Unplanned"})]})]}),e.jsxs(C,{children:[e.jsxs(P,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(z,{className:"text-sm font-medium",children:"Out of Service"}),e.jsx(ie,{className:"h-4 w-4 text-red-600"})]}),e.jsxs(O,{children:[e.jsx("div",{className:"text-2xl font-bold",children:_}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"ORV: Regulatory/Operational"})]})]})]}),u.length>0&&e.jsxs(C,{children:[e.jsx(P,{children:e.jsx(z,{className:"text-lg",children:"Compliance Quick Actions"})}),e.jsx(O,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs(f,{variant:"outline",className:"h-auto p-4 flex flex-col items-center gap-2",children:[e.jsx(J,{className:"h-6 w-6 text-blue-600"}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-semibold",children:"ORV Documentation"}),e.jsx("div",{className:"text-xs text-gray-600",children:"Manage off-road declarations"})]})]}),e.jsxs(f,{variant:"outline",className:"h-auto p-4 flex flex-col items-center gap-2",children:[e.jsx(Ve,{className:"h-6 w-6 text-orange-600"}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-semibold",children:"BOR Return Process"}),e.jsx("div",{className:"text-xs text-gray-600",children:"Vehicle return to service"})]})]}),e.jsxs(f,{variant:"outline",className:"h-auto p-4 flex flex-col items-center gap-2",children:[e.jsx($e,{className:"h-6 w-6 text-green-600"}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-semibold",children:"Compliance Reports"}),e.jsx("div",{className:"text-xs text-gray-600",children:"View compliance analytics"})]})]})]})})]}),!D&&u.length===0?e.jsx(C,{children:e.jsx(O,{className:"p-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx(H,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No Vehicles Found"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"You haven't added any vehicles to your fleet yet. Start by adding your first vehicle with mandatory inspection schedules to get started with vehicle management and ORV/BOR compliance tracking."}),e.jsxs("div",{className:"flex gap-2 justify-center",children:[e.jsxs(f,{onClick:y,className:"inline-flex items-center",children:[e.jsx(re,{className:"mr-2 h-4 w-4"}),"Add Your First Vehicle"]}),e.jsxs(f,{onClick:h,variant:"outline",className:"inline-flex items-center",children:[e.jsx(Ne,{className:"mr-2 h-4 w-4"}),"Configure Fleet Settings"]})]})]})})}):e.jsx(is,{}),e.jsx(Ae,{vehicle:t,open:!!t,onOpenChange:Y=>!Y&&o(null),onSuccess:()=>{o(null)}})]})}export{us as default};
