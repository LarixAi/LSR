import{m as ge,G as Ve,H as pe,J as fe,ao as Ae,r as x,j as e,N as ue,B as g,am as He,e as w,g as M,h as P,F as je,k as S,W as Re,E as ve,at as qe,q as l,au as Me,I as p,ab as m,ac as u,ad as j,ae as v,af as t,O as Pe,Q as Ue,V as F,Y as Be,n as D,ak as Ie,an as ze,a4 as Q,a5 as K,a6 as G,a7 as J,a8 as Y,s as U,aA as X,al as N}from"./main-DVuL102c.js";import{T as Qe}from"./trash-2-uDLx8yM9.js";const Ke=(_,f,k)=>{ge(),Ve();const{data:h=[],isLoading:b,error:B}=pe({queryKey:["work-orders",_,f,k],queryFn:async()=>{if(!_)return[];try{let o=fe.from("work_orders").select(`
            *,
            vehicle:vehicles!work_orders_vehicle_id_fkey(id, vehicle_number, make, model, license_plate),
            assigned_mechanic:profiles!work_orders_assigned_mechanic_id_fkey(id, first_name, last_name, email),
            created_by_profile:profiles!work_orders_created_by_fkey(id, first_name, last_name)
          `).eq("organization_id",_).order("created_at",{ascending:!1});const{data:T,error:r}=await o;return r?(console.error("Error fetching work orders:",r),[]):T||[]}catch(o){return console.error("Error in work orders query:",o),[]}},enabled:!!_}),I=(()=>{if(!h||h.length===0)return{total:0,byStatus:{open:0,assigned:0,in_progress:0,on_hold:0,completed:0,cancelled:0},byPriority:{low:0,medium:0,high:0,urgent:0,critical:0},byType:{preventive:0,corrective:0,emergency:0,inspection:0,modification:0,other:0},totalCost:0,totalHours:0,overdue:0};const o={total:h.length,byStatus:{open:0,assigned:0,in_progress:0,on_hold:0,completed:0,cancelled:0},byPriority:{low:0,medium:0,high:0,urgent:0,critical:0},byType:{preventive:0,corrective:0,emergency:0,inspection:0,modification:0,other:0},totalCost:0,totalHours:0,overdue:0},T=new Date;return h.forEach(r=>{r.status&&o.byStatus[r.status]++,r.priority&&o.byPriority[r.priority]++,r.work_type&&o.byType[r.work_type]++,r.total_cost&&(o.totalCost+=r.total_cost),r.actual_hours&&(o.totalHours+=r.actual_hours),r.due_date&&r.status!=="completed"&&r.status!=="cancelled"&&new Date(r.due_date)<T&&o.overdue++}),o})();return{workOrders:h,isLoading:b,error:B,stats:I,hasData:h.length>0}},Xe=()=>{var re,ce,ne,de,oe,he,xe;const{user:_,profile:f,loading:k}=ge(),{selectedOrganizationId:h}=Ae(),[b,B]=x.useState("all"),[C,I]=x.useState(""),[o,T]=x.useState("all"),[r,Z]=x.useState("all"),[W,ye]=x.useState("all"),[Ne,L]=x.useState(!1),[_e,V]=x.useState(!1),[be,A]=x.useState(!1),[a,z]=x.useState(null);x.useState(null);const[i,c]=x.useState({title:"",description:"",vehicle_id:"",defect_type:"mechanical",severity:"medium",priority:"medium",location:"",estimated_cost:0,estimated_hours:0,work_notes:""}),{workOrders:Ce,isLoading:we,error:Se,createWorkOrder:Fe,updateWorkOrder:De,deleteWorkOrder:ke,isCreating:$,isUpdating:O,isDeleting:Ge,workOrderStats:n}=Ke(h),{data:ee=[]}=pe({queryKey:["vehicles",h],queryFn:async()=>{if(!h)return[];const{data:s,error:d}=await fe.from("vehicles").select("id, vehicle_number, make, model, license_plate").eq("organization_id",h).order("vehicle_number");return d?(console.error("Error fetching vehicles:",d),[]):s||[]},enabled:!!h});if(k)return e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-primary mb-4"}),e.jsx("p",{className:"text-lg",children:"Loading work orders..."})]})});if(!_||!f)return e.jsx(ue,{to:"/auth",replace:!0});if(f.role!=="mechanic"&&f.role!=="admin")return e.jsx(ue,{to:"/dashboard",replace:!0});const y=Ce.filter(s=>{var E,me;const d=s.title.toLowerCase().includes(C.toLowerCase())||s.defect_number.toLowerCase().includes(C.toLowerCase())||((me=(E=s.vehicle)==null?void 0:E.vehicle_number)==null?void 0:me.toLowerCase().includes(C.toLowerCase())),H=o==="all"||s.severity===o,R=r==="all"||s.status===r,q=W==="all"||s.defect_type===W;return d&&H&&R&&q}),se=s=>{switch(s){case"reported":return y.filter(d=>d.status==="reported");case"investigating":return y.filter(d=>d.status==="investigating");case"repairing":return y.filter(d=>d.status==="repairing");case"resolved":return y.filter(d=>d.status==="resolved");case"closed":return y.filter(d=>d.status==="closed");default:return y}},te=s=>{switch(s){case"reported":return"bg-blue-100 text-blue-800";case"investigating":return"bg-yellow-100 text-yellow-800";case"repairing":return"bg-orange-100 text-orange-800";case"resolved":return"bg-green-100 text-green-800";case"closed":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}},ie=s=>{switch(s){case"critical":return"bg-red-100 text-red-800";case"high":return"bg-orange-100 text-orange-800";case"medium":return"bg-yellow-100 text-yellow-800";case"low":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}},le=s=>{switch(s){case"safety":return"bg-red-100 text-red-800";case"mechanical":return"bg-blue-100 text-blue-800";case"electrical":return"bg-purple-100 text-purple-800";case"cosmetic":return"bg-gray-100 text-gray-800";case"other":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}},Te=()=>{if(!i.title||!i.vehicle_id){N({title:"Error",description:"Please fill in all required fields",variant:"destructive"});return}Fe(i,{onSuccess:()=>{N({title:"Success",description:"Work order created successfully"}),L(!1),c({title:"",description:"",vehicle_id:"",defect_type:"mechanical",severity:"medium",priority:"medium",location:"",estimated_cost:0,estimated_hours:0,work_notes:""})},onError:s=>{N({title:"Error",description:"Failed to create work order",variant:"destructive"})}})},Ee=()=>{a&&De({id:a.id,data:i},{onSuccess:()=>{N({title:"Success",description:"Work order updated successfully"}),V(!1),z(null)},onError:s=>{N({title:"Error",description:"Failed to update work order",variant:"destructive"})}})},We=s=>{confirm("Are you sure you want to delete this work order?")&&ke(s,{onSuccess:()=>{N({title:"Success",description:"Work order deleted successfully"})},onError:d=>{N({title:"Error",description:"Failed to delete work order",variant:"destructive"})}})},ae=s=>{z(s),c({title:s.title,description:s.description||"",vehicle_id:s.vehicle_id,defect_type:s.defect_type,severity:s.severity,priority:s.priority||"medium",location:s.location||"",estimated_cost:s.estimated_cost,estimated_hours:s.estimated_hours||0,work_notes:s.work_notes||""}),V(!0)},Le=s=>{z(s),A(!0)};return e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Work Orders"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Manage vehicle defects and repairs"})]}),e.jsxs(g,{onClick:()=>L(!0),children:[e.jsx(He,{className:"h-4 w-4 mr-2"}),"New Work Order"]})]}),n&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[e.jsxs(w,{children:[e.jsxs(M,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(P,{className:"text-sm font-medium",children:"Total Work Orders"}),e.jsx(je,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(S,{children:[e.jsx("div",{className:"text-2xl font-bold",children:n.total}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"All time"})]})]}),e.jsxs(w,{children:[e.jsxs(M,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(P,{className:"text-sm font-medium",children:"In Progress"}),e.jsx(Re,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(S,{children:[e.jsx("div",{className:"text-2xl font-bold",children:n.byStatus.investigating+n.byStatus.repairing}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Investigating & Repairing"})]})]}),e.jsxs(w,{children:[e.jsxs(M,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(P,{className:"text-sm font-medium",children:"Critical Issues"}),e.jsx(ve,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(S,{children:[e.jsx("div",{className:"text-2xl font-bold",children:n.bySeverity.critical}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Safety priority"})]})]}),e.jsxs(w,{children:[e.jsxs(M,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(P,{className:"text-sm font-medium",children:"Total Cost"}),e.jsx(qe,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(S,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:["Â£",n.totalEstimatedCost.toFixed(2)]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Estimated total"})]})]})]}),e.jsx(w,{className:"mb-6",children:e.jsx(S,{className:"p-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"search",children:"Search"}),e.jsxs("div",{className:"relative",children:[e.jsx(Me,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(p,{id:"search",placeholder:"Search work orders...",value:C,onChange:s=>I(s.target.value),className:"pl-10"})]})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"severity",children:"Severity"}),e.jsxs(m,{value:o,onValueChange:T,children:[e.jsx(u,{children:e.jsx(j,{placeholder:"All severities"})}),e.jsxs(v,{children:[e.jsx(t,{value:"all",children:"All Severities"}),e.jsx(t,{value:"low",children:"Low"}),e.jsx(t,{value:"medium",children:"Medium"}),e.jsx(t,{value:"high",children:"High"}),e.jsx(t,{value:"critical",children:"Critical"})]})]})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"status",children:"Status"}),e.jsxs(m,{value:r,onValueChange:Z,children:[e.jsx(u,{children:e.jsx(j,{placeholder:"All statuses"})}),e.jsxs(v,{children:[e.jsx(t,{value:"all",children:"All Statuses"}),e.jsx(t,{value:"reported",children:"Reported"}),e.jsx(t,{value:"investigating",children:"Investigating"}),e.jsx(t,{value:"repairing",children:"Repairing"}),e.jsx(t,{value:"resolved",children:"Resolved"}),e.jsx(t,{value:"closed",children:"Closed"})]})]})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"defectType",children:"Defect Type"}),e.jsxs(m,{value:W,onValueChange:ye,children:[e.jsx(u,{children:e.jsx(j,{placeholder:"All types"})}),e.jsxs(v,{children:[e.jsx(t,{value:"all",children:"All Types"}),e.jsx(t,{value:"safety",children:"Safety"}),e.jsx(t,{value:"mechanical",children:"Mechanical"}),e.jsx(t,{value:"electrical",children:"Electrical"}),e.jsx(t,{value:"cosmetic",children:"Cosmetic"}),e.jsx(t,{value:"other",children:"Other"})]})]})]})]})})}),e.jsxs(Pe,{value:b,onValueChange:B,className:"space-y-6",children:[e.jsxs(Ue,{className:"grid w-full grid-cols-6",children:[e.jsxs(F,{value:"all",children:["All (",y.length,")"]}),e.jsxs(F,{value:"reported",children:["Reported (",(n==null?void 0:n.byStatus.reported)||0,")"]}),e.jsxs(F,{value:"investigating",children:["Investigating (",(n==null?void 0:n.byStatus.investigating)||0,")"]}),e.jsxs(F,{value:"repairing",children:["Repairing (",(n==null?void 0:n.byStatus.repairing)||0,")"]}),e.jsxs(F,{value:"resolved",children:["Resolved (",(n==null?void 0:n.byStatus.resolved)||0,")"]}),e.jsxs(F,{value:"closed",children:["Closed (",(n==null?void 0:n.byStatus.closed)||0,")"]})]}),e.jsx(Be,{value:b,className:"space-y-6",children:we?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-primary mb-4"}),e.jsx("p",{children:"Loading work orders..."})]}):Se?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(ve,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),e.jsx("p",{className:"text-red-600",children:"Error loading work orders"})]}):se(b).length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(je,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Work Orders"}),e.jsx("p",{className:"text-gray-600",children:C||o!=="all"||r!=="all"||W!=="all"?"No work orders match your current filters":"No work orders found. Create your first work order to get started."})]}):e.jsx("div",{className:"space-y-4",children:se(b).map(s=>{var d,H,R,q,E;return e.jsx(w,{className:"hover:shadow-md transition-shadow",children:e.jsx(S,{className:"p-6",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[e.jsx("h3",{className:"text-lg font-semibold",children:s.title}),e.jsx(D,{className:te(s.status),children:s.status}),e.jsx(D,{className:ie(s.severity),children:s.severity}),e.jsx(D,{className:le(s.defect_type),children:s.defect_type})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm text-gray-600 mb-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Defect #:"})," ",s.defect_number]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Vehicle:"})," ",((d=s.vehicle)==null?void 0:d.vehicle_number)||"N/A"]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Reported:"})," ",new Date(s.reported_date).toLocaleDateString()]})]}),s.description&&e.jsx("p",{className:"text-gray-700 mb-4",children:s.description}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Estimated Cost:"})," Â£",s.estimated_cost.toFixed(2)]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Actual Cost:"})," Â£",s.actual_cost.toFixed(2)]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Reported By:"})," ",(H=s.reported_by_profile)==null?void 0:H.first_name," ",(R=s.reported_by_profile)==null?void 0:R.last_name]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Assigned To:"})," ",(q=s.assigned_mechanic)==null?void 0:q.first_name," ",(E=s.assigned_mechanic)==null?void 0:E.last_name," || 'Unassigned'"]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2 ml-4",children:[e.jsx(g,{variant:"outline",size:"sm",onClick:()=>Le(s),children:e.jsx(Ie,{className:"h-4 w-4"})}),e.jsx(g,{variant:"outline",size:"sm",onClick:()=>ae(s),children:e.jsx(ze,{className:"h-4 w-4"})}),e.jsx(g,{variant:"outline",size:"sm",onClick:()=>We(s.id),children:e.jsx(Qe,{className:"h-4 w-4"})})]})]})})},s.id)})})})]}),e.jsx(Q,{open:Ne,onOpenChange:L,children:e.jsxs(K,{className:"max-w-2xl",children:[e.jsxs(G,{children:[e.jsx(J,{children:"Create New Work Order"}),e.jsx(Y,{children:"Report a new vehicle defect or maintenance issue"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx(l,{htmlFor:"title",children:"Title *"}),e.jsx(p,{id:"title",value:i.title,onChange:s=>c({...i,title:s.target.value}),placeholder:"Brief description of the issue"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx(l,{htmlFor:"description",children:"Description"}),e.jsx(U,{id:"description",value:i.description,onChange:s=>c({...i,description:s.target.value}),placeholder:"Detailed description of the problem",rows:3})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"vehicle",children:"Vehicle *"}),e.jsxs(m,{value:i.vehicle_id,onValueChange:s=>c({...i,vehicle_id:s}),children:[e.jsx(u,{children:e.jsx(j,{placeholder:"Select vehicle"})}),e.jsx(v,{children:ee.map(s=>e.jsxs(t,{value:s.id,children:[s.vehicle_number," - ",s.make," ",s.model]},s.id))})]})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"defectType",children:"Defect Type"}),e.jsxs(m,{value:i.defect_type,onValueChange:s=>c({...i,defect_type:s}),children:[e.jsx(u,{children:e.jsx(j,{})}),e.jsxs(v,{children:[e.jsx(t,{value:"safety",children:"Safety"}),e.jsx(t,{value:"mechanical",children:"Mechanical"}),e.jsx(t,{value:"electrical",children:"Electrical"}),e.jsx(t,{value:"cosmetic",children:"Cosmetic"}),e.jsx(t,{value:"other",children:"Other"})]})]})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"severity",children:"Severity"}),e.jsxs(m,{value:i.severity,onValueChange:s=>c({...i,severity:s}),children:[e.jsx(u,{children:e.jsx(j,{})}),e.jsxs(v,{children:[e.jsx(t,{value:"low",children:"Low"}),e.jsx(t,{value:"medium",children:"Medium"}),e.jsx(t,{value:"high",children:"High"}),e.jsx(t,{value:"critical",children:"Critical"})]})]})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"priority",children:"Priority"}),e.jsxs(m,{value:i.priority,onValueChange:s=>c({...i,priority:s}),children:[e.jsx(u,{children:e.jsx(j,{})}),e.jsxs(v,{children:[e.jsx(t,{value:"low",children:"Low"}),e.jsx(t,{value:"medium",children:"Medium"}),e.jsx(t,{value:"high",children:"High"}),e.jsx(t,{value:"urgent",children:"Urgent"})]})]})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"location",children:"Location"}),e.jsx(p,{id:"location",value:i.location,onChange:s=>c({...i,location:s.target.value}),placeholder:"Where is the issue located?"})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"estimatedCost",children:"Estimated Cost (Â£)"}),e.jsx(p,{id:"estimatedCost",type:"number",value:i.estimated_cost,onChange:s=>c({...i,estimated_cost:parseFloat(s.target.value)||0}),placeholder:"0.00"})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"estimatedHours",children:"Estimated Hours"}),e.jsx(p,{id:"estimatedHours",type:"number",value:i.estimated_hours,onChange:s=>c({...i,estimated_hours:parseFloat(s.target.value)||0}),placeholder:"0.0"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx(l,{htmlFor:"workNotes",children:"Work Notes"}),e.jsx(U,{id:"workNotes",value:i.work_notes,onChange:s=>c({...i,work_notes:s.target.value}),placeholder:"Additional notes for mechanics",rows:2})]})]}),e.jsxs(X,{children:[e.jsx(g,{variant:"outline",onClick:()=>L(!1),children:"Cancel"}),e.jsx(g,{onClick:Te,disabled:$,children:$?"Creating...":"Create Work Order"})]})]})}),e.jsx(Q,{open:_e,onOpenChange:V,children:e.jsxs(K,{className:"max-w-2xl",children:[e.jsxs(G,{children:[e.jsx(J,{children:"Edit Work Order"}),e.jsx(Y,{children:"Update work order details"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx(l,{htmlFor:"edit-title",children:"Title *"}),e.jsx(p,{id:"edit-title",value:i.title,onChange:s=>c({...i,title:s.target.value}),placeholder:"Brief description of the issue"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx(l,{htmlFor:"edit-description",children:"Description"}),e.jsx(U,{id:"edit-description",value:i.description,onChange:s=>c({...i,description:s.target.value}),placeholder:"Detailed description of the problem",rows:3})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"edit-vehicle",children:"Vehicle *"}),e.jsxs(m,{value:i.vehicle_id,onValueChange:s=>c({...i,vehicle_id:s}),children:[e.jsx(u,{children:e.jsx(j,{placeholder:"Select vehicle"})}),e.jsx(v,{children:ee.map(s=>e.jsxs(t,{value:s.id,children:[s.vehicle_number," - ",s.make," ",s.model]},s.id))})]})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"edit-defectType",children:"Defect Type"}),e.jsxs(m,{value:i.defect_type,onValueChange:s=>c({...i,defect_type:s}),children:[e.jsx(u,{children:e.jsx(j,{})}),e.jsxs(v,{children:[e.jsx(t,{value:"safety",children:"Safety"}),e.jsx(t,{value:"mechanical",children:"Mechanical"}),e.jsx(t,{value:"electrical",children:"Electrical"}),e.jsx(t,{value:"cosmetic",children:"Cosmetic"}),e.jsx(t,{value:"other",children:"Other"})]})]})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"edit-severity",children:"Severity"}),e.jsxs(m,{value:i.severity,onValueChange:s=>c({...i,severity:s}),children:[e.jsx(u,{children:e.jsx(j,{})}),e.jsxs(v,{children:[e.jsx(t,{value:"low",children:"Low"}),e.jsx(t,{value:"medium",children:"Medium"}),e.jsx(t,{value:"high",children:"High"}),e.jsx(t,{value:"critical",children:"Critical"})]})]})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"edit-priority",children:"Priority"}),e.jsxs(m,{value:i.priority,onValueChange:s=>c({...i,priority:s}),children:[e.jsx(u,{children:e.jsx(j,{})}),e.jsxs(v,{children:[e.jsx(t,{value:"low",children:"Low"}),e.jsx(t,{value:"medium",children:"Medium"}),e.jsx(t,{value:"high",children:"High"}),e.jsx(t,{value:"urgent",children:"Urgent"})]})]})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"edit-location",children:"Location"}),e.jsx(p,{id:"edit-location",value:i.location,onChange:s=>c({...i,location:s.target.value}),placeholder:"Where is the issue located?"})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"edit-estimatedCost",children:"Estimated Cost (Â£)"}),e.jsx(p,{id:"edit-estimatedCost",type:"number",value:i.estimated_cost,onChange:s=>c({...i,estimated_cost:parseFloat(s.target.value)||0}),placeholder:"0.00"})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"edit-estimatedHours",children:"Estimated Hours"}),e.jsx(p,{id:"edit-estimatedHours",type:"number",value:i.estimated_hours,onChange:s=>c({...i,estimated_hours:parseFloat(s.target.value)||0}),placeholder:"0.0"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx(l,{htmlFor:"edit-workNotes",children:"Work Notes"}),e.jsx(U,{id:"edit-workNotes",value:i.work_notes,onChange:s=>c({...i,work_notes:s.target.value}),placeholder:"Additional notes for mechanics",rows:2})]})]}),e.jsxs(X,{children:[e.jsx(g,{variant:"outline",onClick:()=>V(!1),children:"Cancel"}),e.jsx(g,{onClick:Ee,disabled:O,children:O?"Updating...":"Update Work Order"})]})]})}),e.jsx(Q,{open:be,onOpenChange:A,children:e.jsxs(K,{className:"max-w-2xl",children:[e.jsxs(G,{children:[e.jsx(J,{children:"Work Order Details"}),e.jsx(Y,{children:"View complete work order information"})]}),a&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(l,{className:"font-medium",children:"Title"}),e.jsx("p",{className:"text-gray-700",children:a.title})]}),e.jsxs("div",{children:[e.jsx(l,{className:"font-medium",children:"Defect Number"}),e.jsx("p",{className:"text-gray-700",children:a.defect_number})]}),e.jsxs("div",{children:[e.jsx(l,{className:"font-medium",children:"Vehicle"}),e.jsxs("p",{className:"text-gray-700",children:[(re=a.vehicle)==null?void 0:re.vehicle_number," - ",(ce=a.vehicle)==null?void 0:ce.make," ",(ne=a.vehicle)==null?void 0:ne.model]})]}),e.jsxs("div",{children:[e.jsx(l,{className:"font-medium",children:"Status"}),e.jsx(D,{className:te(a.status),children:a.status})]}),e.jsxs("div",{children:[e.jsx(l,{className:"font-medium",children:"Severity"}),e.jsx(D,{className:ie(a.severity),children:a.severity})]}),e.jsxs("div",{children:[e.jsx(l,{className:"font-medium",children:"Defect Type"}),e.jsx(D,{className:le(a.defect_type),children:a.defect_type})]}),e.jsxs("div",{children:[e.jsx(l,{className:"font-medium",children:"Reported Date"}),e.jsx("p",{className:"text-gray-700",children:new Date(a.reported_date).toLocaleDateString()})]}),e.jsxs("div",{children:[e.jsx(l,{className:"font-medium",children:"Reported By"}),e.jsxs("p",{className:"text-gray-700",children:[(de=a.reported_by_profile)==null?void 0:de.first_name," ",(oe=a.reported_by_profile)==null?void 0:oe.last_name]})]}),e.jsxs("div",{children:[e.jsx(l,{className:"font-medium",children:"Assigned To"}),e.jsxs("p",{className:"text-gray-700",children:[(he=a.assigned_mechanic)==null?void 0:he.first_name," ",(xe=a.assigned_mechanic)==null?void 0:xe.last_name," || 'Unassigned'"]})]}),e.jsxs("div",{children:[e.jsx(l,{className:"font-medium",children:"Location"}),e.jsx("p",{className:"text-gray-700",children:a.location||"Not specified"})]}),e.jsxs("div",{children:[e.jsx(l,{className:"font-medium",children:"Estimated Cost"}),e.jsxs("p",{className:"text-gray-700",children:["Â£",a.estimated_cost.toFixed(2)]})]}),e.jsxs("div",{children:[e.jsx(l,{className:"font-medium",children:"Actual Cost"}),e.jsxs("p",{className:"text-gray-700",children:["Â£",a.actual_cost.toFixed(2)]})]}),e.jsxs("div",{children:[e.jsx(l,{className:"font-medium",children:"Estimated Hours"}),e.jsxs("p",{className:"text-gray-700",children:[a.estimated_hours||0," hours"]})]}),e.jsxs("div",{children:[e.jsx(l,{className:"font-medium",children:"Actual Hours"}),e.jsxs("p",{className:"text-gray-700",children:[a.actual_hours||0," hours"]})]})]}),a.description&&e.jsxs("div",{children:[e.jsx(l,{className:"font-medium",children:"Description"}),e.jsx("p",{className:"text-gray-700",children:a.description})]}),a.work_notes&&e.jsxs("div",{children:[e.jsx(l,{className:"font-medium",children:"Work Notes"}),e.jsx("p",{className:"text-gray-700",children:a.work_notes})]})]}),e.jsxs(X,{children:[e.jsx(g,{variant:"outline",onClick:()=>A(!1),children:"Close"}),a&&e.jsx(g,{onClick:()=>{A(!1),ae(a)},children:"Edit Work Order"})]})]})})]})};export{Xe as default};
