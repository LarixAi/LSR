import{a2 as i,J as u,a3 as s}from"./main-DVuL102c.js";const l=()=>i({mutationFn:async({planId:e,isAnnual:n=!1})=>{console.log("Starting Stripe checkout process:",{planId:e,isAnnual:n});const{data:{session:t}}=await u.auth.getSession();if(!(t!=null&&t.access_token))throw console.error("No authentication token found"),new Error("No authentication token found");console.log("Making request to create-checkout function");const o=await fetch("https://dznbihypzmvcmradijqn.supabase.co/functions/v1/create-checkout",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t.access_token}`},body:JSON.stringify({planId:e,isAnnual:n})});if(console.log("Response status:",o.status),console.log("Response headers:",Object.fromEntries(o.headers.entries())),!o.ok){const a=await o.json().catch(()=>({error:"Unknown error"}));throw console.error("Checkout function error:",a),new Error(a.error||`HTTP ${o.status}: Failed to create checkout session`)}const c=await o.json();console.log("Checkout function response:",c);const{url:r}=c;if(!r)throw console.error("No checkout URL received in response"),new Error("No checkout URL received");return console.log("Redirecting to Stripe checkout:",r),s.loading("Redirecting to payment page..."),window.location.href=r,{url:r}},onError:e=>{console.error("Stripe checkout error:",e),s.error("Failed to create checkout session: "+e.message)},onSuccess:e=>{console.log("Stripe checkout success:",e),s.dismiss()}});export{l as u};
