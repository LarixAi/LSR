import{c as F,j as e,i as v,k as N,l as w,S as E,m as C,n as S,E as y,B as p,p as L,v as V,H as O,q as $,r as d,s as I,a2 as H,J as Q,I as J,C as P,R as Y,W as Z,O as G}from"./main-piTIAPSx.js";import{T as X,a as ee,b as T,c as q}from"./tabs-N5TLptOb.js";import{C as U}from"./circle-check-big-CD0jvDn0.js";import{u as K}from"./useQuery-Dbdyc74j.js";import{Z as B}from"./zap-C72QVc6f.js";import{u as se}from"./useMutation-B8vlA97s.js";import{M as W}from"./message-square-DPQpPpm_.js";import{S as te}from"./send-CbMnoHMq.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A=F("Bot",[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=F("Minimize2",[["polyline",{points:"4 14 10 14 10 20",key:"11kfnr"}],["polyline",{points:"20 10 14 10 14 4",key:"rlmsce"}],["line",{x1:"14",x2:"21",y1:"10",y2:"3",key:"o5lafz"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]),ie=()=>{const s=[{id:"1",type:"inspection_due",title:"Vehicle Inspection Due",description:"Annual MOT inspection due for vehicle BUS123",urgency:"medium",due_date:new Date(Date.now()+6048e5).toISOString(),affected_entity:"BUS123",action_required:"Schedule inspection"},{id:"2",type:"license_renewal",title:"Driver License Expiry",description:"Commercial driver license expires soon",urgency:"high",due_date:new Date(Date.now()+1728e5).toISOString(),affected_entity:"John Smith",action_required:"Renew license"}],m=i=>{switch(i){case"critical":return"bg-red-500 text-white";case"high":return"bg-orange-500 text-white";case"medium":return"bg-yellow-500 text-black";case"low":return"bg-blue-500 text-white";default:return"bg-gray-500 text-white"}},n=i=>{switch(i){case"critical":return e.jsx(O,{className:"w-4 h-4"});case"high":return e.jsx(O,{className:"w-4 h-4"});case"medium":return e.jsx(V,{className:"w-4 h-4"});case"low":return e.jsx(L,{className:"w-4 h-4"});default:return e.jsx(L,{className:"w-4 h-4"})}},l=i=>{console.log("Resolving alert:",i)};return e.jsxs(v,{children:[e.jsxs(N,{children:[e.jsxs(w,{className:"flex items-center space-x-2",children:[e.jsx(E,{className:"w-5 h-5 text-blue-600"}),e.jsx("span",{children:"Compliance Assistant"})]}),e.jsx(C,{children:"AI-powered monitoring for regulations and documentation"})]}),e.jsx(S,{className:"space-y-4",children:s.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center p-8 text-center",children:[e.jsx(U,{className:"w-12 h-12 text-green-500 mb-3"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"All Clear!"}),e.jsx("p",{className:"text-muted-foreground",children:"No compliance alerts at this time"})]}):s.map(i=>e.jsxs("div",{className:"border rounded-lg p-4 space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[n(i.urgency),e.jsx("h4",{className:"font-medium",children:i.title})]}),e.jsx(y,{className:m(i.urgency),children:i.urgency.toUpperCase()})]}),e.jsx("p",{className:"text-sm text-gray-600",children:i.description}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500",children:[e.jsxs("span",{children:["Affected: ",i.affected_entity]}),e.jsxs("span",{children:["Due: ",new Date(i.due_date).toLocaleDateString()]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm font-medium",children:["Action: ",i.action_required]}),e.jsx(p,{size:"sm",variant:"outline",onClick:()=>l(i.id),children:"Mark Resolved"})]})]},i.id))})]})},ne=()=>{const{profile:s}=$(),[m,n]=d.useState(!1),{data:l=[],isLoading:i}=K({queryKey:["schedule-analysis",s==null?void 0:s.organization_id],queryFn:async()=>{if(!(s!=null&&s.organization_id))return[];const[a,b,g]=await Promise.all([I.from("routes").select("*").eq("organization_id",s.organization_id).eq("status","active"),I.from("jobs").select("*").eq("organization_id",s.organization_id).in("status",["assigned","scheduled","active"]),I.from("profiles").select("id, first_name, last_name, employee_id").eq("organization_id",s.organization_id).eq("role","driver").eq("is_active",!0)]);if(a.error||b.error||g.error)return console.error("Error fetching scheduling data"),[];const D=a.data||[],j=b.data||[],u=g.data||[],f=[];if(D.length>0&&f.push({id:"1",type:"optimization",title:"Route Optimization Opportunity",description:`Found ${D.length} active routes. AI analysis suggests optimizing route sequences could save up to 15% travel time.`,impact:"high",affected_drivers:u.slice(0,2).map(o=>`${o.first_name||""} ${o.last_name||""}`.trim()),suggested_action:"Optimize Routes",confidence:85}),u.length>0){const o=Math.min(95,j.length/u.length*100);o<80&&f.push({id:"2",type:"coverage_needed",title:"Driver Utilization Analysis",description:`Current driver utilization is ${o.toFixed(1)}%. Consider reassigning drivers for better efficiency.`,impact:"medium",affected_drivers:u.slice(0,3).map(h=>`${h.first_name||""} ${h.last_name||""}`.trim()),suggested_action:"Review Assignments",confidence:78})}const z=j.filter((o,h)=>j.some((k,M)=>h!==M&&o.assigned_to===k.assigned_to&&o.created_at.split("T")[0]===k.created_at.split("T")[0]));return z.length>0&&f.push({id:"3",type:"overtime_alert",title:"Schedule Conflicts Detected",description:`Found ${z.length} potential scheduling conflicts that need attention.`,impact:"high",affected_drivers:["Multiple Drivers"],suggested_action:"Resolve Conflicts",confidence:95}),j.length>0&&f.push({id:"4",type:"optimization",title:"Peak Hours Analysis",description:"Morning shifts (7-9 AM) show highest demand. Consider adding capacity during these hours.",impact:"low",affected_drivers:["All Drivers"],suggested_action:"Review Capacity",confidence:72}),f},enabled:!!(s!=null&&s.organization_id)}),_=async()=>{n(!0);try{await new Promise(a=>setTimeout(a,2e3))}catch(a){console.error("Error analyzing schedules:",a)}finally{n(!1)}},R=a=>{switch(a){case"high":return"bg-red-100 text-red-800";case"medium":return"bg-yellow-100 text-yellow-800";case"low":return"bg-blue-100 text-blue-800";default:return"bg-gray-100 text-gray-800"}};return i?e.jsxs(v,{children:[e.jsx(N,{children:e.jsxs(w,{className:"flex items-center space-x-2",children:[e.jsx(B,{className:"w-5 h-5 text-purple-600"}),e.jsx("span",{children:"Smart Scheduling AI"})]})}),e.jsx(S,{children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-primary"}),e.jsx("p",{className:"mt-2 text-gray-500",children:"Analyzing schedules..."})]})})]}):e.jsxs(v,{children:[e.jsxs(N,{children:[e.jsxs(w,{className:"flex items-center space-x-2",children:[e.jsx(B,{className:"w-5 h-5 text-purple-600"}),e.jsx("span",{children:"Smart Scheduling AI"})]}),e.jsx(C,{children:"AI-powered schedule optimization and intelligent shift management"})]}),e.jsxs(S,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm text-gray-600",children:["Last analysis: ",new Date().toLocaleTimeString()]}),e.jsx(p,{size:"sm",onClick:_,disabled:m,className:"flex items-center space-x-1",children:m?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-white"}),e.jsx("span",{children:"Analyzing..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(B,{className:"w-3 h-3"}),e.jsx("span",{children:"Re-analyze"})]})})]}),l.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(U,{className:"w-12 h-12 mx-auto mb-2 text-green-500"}),e.jsx("p",{children:"All schedules are optimally configured!"}),e.jsx("p",{className:"text-sm",children:"No improvements detected at this time."})]}):e.jsx("div",{className:"space-y-3",children:l.map(a=>e.jsxs("div",{className:"border rounded-lg p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"font-medium",children:a.title}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(y,{className:R(a.impact),children:[a.impact," impact"]}),e.jsxs(y,{variant:"outline",children:[a.confidence,"% confidence"]})]})]}),e.jsx("p",{className:"text-sm text-gray-600",children:a.description}),e.jsx("div",{className:"flex items-center space-x-4 text-xs text-gray-500",children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(H,{className:"w-3 h-3"}),e.jsxs("span",{children:["Affects: ",a.affected_drivers.join(", ")]})]})}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm font-medium",children:["Suggested: ",a.suggested_action]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(p,{size:"sm",variant:"outline",children:"Apply"}),e.jsx(p,{size:"sm",variant:"ghost",children:"Dismiss"})]})]})]},a.id))})]})]})},re=()=>{const{profile:s}=$(),m=Q(),[n,l]=d.useState(""),[i,_]=d.useState(!1),[R,a]=d.useState(!1),b=d.useRef(null),{data:g=[],isLoading:D}=K({queryKey:["chat-history",s==null?void 0:s.id],queryFn:async()=>[{id:"1",type:"bot",message:"Hello! I'm your LSR Transport Assistant. How can I help you today?",timestamp:new Date,quickReplies:["Route Information","Schedule Changes","Contact Driver","Report Issue"]}],enabled:!!(s!=null&&s.id)}),[j,u]=d.useState(g);d.useEffect(()=>{g.length>0&&u(g)},[g]),d.useEffect(()=>{z()},[j]);const f=se({mutationFn:async t=>{if(!(s!=null&&s.id)||!(s!=null&&s.organization_id))throw new Error("Profile not found");const{data:r,error:c}=await I.from("support_tickets").insert({title:"Chat Support Request",description:t,category:"general",priority:"normal",ticket_number:`TKT-${Date.now()}`,organization_id:s.organization_id}).select().single();if(c)throw c;return r},onSuccess:()=>{m.invalidateQueries({queryKey:["chat-history"]})}}),z=()=>{var t;(t=b.current)==null||t.scrollIntoView({behavior:"smooth"})},o=t=>{const r=t.toLowerCase();let c="",x=[];return r.includes("route")||r.includes("schedule")?(c="I can help you with route information and schedules. Which specific route or time are you asking about?",x=["Route A Schedule","Route B Schedule","All Routes","Tomorrow's Schedule"]):r.includes("late")||r.includes("delay")?(c="I understand you're asking about delays. Let me check the current status of all routes for you. Route A is running 5 minutes behind due to traffic. Would you like me to notify affected parents?",x=["Yes, notify parents","Check other routes","Contact dispatcher"]):r.includes("contact")||r.includes("driver")?(c="I can help you contact a driver or dispatcher. For safety reasons, drivers cannot receive calls while driving. Would you like me to send a message or connect you with dispatch?",x=["Send message","Call dispatch","Emergency contact"]):r.includes("problem")||r.includes("issue")||r.includes("report")?(c="I'm here to help with any issues. Can you tell me more about the problem you're experiencing?",x=["Vehicle issue","Driver concern","Route problem","App issue"]):(c="I'm here to help with routes, schedules, driver contact, and reporting issues. What would you like assistance with?",x=["Route Information","Schedule Changes","Contact Driver","Report Issue"]),{id:Date.now().toString(),type:"bot",message:c,timestamp:new Date,quickReplies:x}},h=async()=>{if(!n.trim())return;const t={id:Date.now().toString(),type:"user",message:n.trim(),timestamp:new Date};u(c=>[...c,t]);const r=n.trim();l(""),a(!0);try{await f.mutateAsync(r),setTimeout(()=>{const c=o(r);u(x=>[...x,c]),a(!1)},1e3)}catch(c){console.error("Error sending message:",c),a(!1)}},k=t=>{l(t),setTimeout(()=>h(),100)},M=t=>{t.key==="Enter"&&h()};return i?e.jsx("div",{className:"fixed bottom-4 right-4 z-50",children:e.jsx(p,{onClick:()=>_(!1),className:"rounded-full w-12 h-12 bg-blue-600 hover:bg-blue-700 shadow-lg",children:e.jsx(W,{className:"w-6 h-6"})})}):e.jsx("div",{className:"fixed bottom-4 right-4 z-50 w-80 h-96",children:e.jsxs(v,{className:"h-full flex flex-col shadow-xl",children:[e.jsx(N,{className:"pb-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(A,{className:"w-5 h-5 text-blue-600"}),e.jsxs("div",{children:[e.jsx(w,{className:"text-sm",children:"LSR Assistant"}),e.jsx(C,{className:"text-xs",children:"24/7 Support"})]})]}),e.jsx("div",{className:"flex space-x-1",children:e.jsx(p,{size:"sm",variant:"ghost",onClick:()=>_(!0),className:"h-6 w-6 p-0",children:e.jsx(ae,{className:"w-3 h-3"})})})]})}),e.jsxs(S,{className:"flex-1 flex flex-col p-3 space-y-3",children:[e.jsxs("div",{className:"flex-1 overflow-y-auto space-y-2 pr-2",children:[j.map(t=>e.jsx("div",{className:`flex ${t.type==="user"?"justify-end":"justify-start"}`,children:e.jsxs("div",{className:`max-w-[80%] p-2 rounded-lg text-xs ${t.type==="user"?"bg-blue-600 text-white":"bg-gray-100 text-gray-800"}`,children:[e.jsxs("div",{className:"flex items-center space-x-1 mb-1",children:[t.type==="bot"?e.jsx(A,{className:"w-3 h-3"}):e.jsx(H,{className:"w-3 h-3"}),e.jsx("span",{className:"font-medium",children:t.type==="bot"?"Assistant":"You"})]}),e.jsx("p",{children:t.message}),t.quickReplies&&e.jsx("div",{className:"mt-2 space-y-1",children:t.quickReplies.map((r,c)=>e.jsx(p,{size:"sm",variant:"outline",className:"text-xs h-6 mr-1 mb-1",onClick:()=>k(r),children:r},c))})]})},t.id)),R&&e.jsx("div",{className:"flex justify-start",children:e.jsx("div",{className:"bg-gray-100 p-2 rounded-lg text-xs",children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(A,{className:"w-3 h-3"}),e.jsx("span",{children:"Assistant is typing..."}),e.jsxs("div",{className:"flex space-x-1",children:[e.jsx("div",{className:"w-1 h-1 bg-gray-400 rounded-full animate-bounce"}),e.jsx("div",{className:"w-1 h-1 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),e.jsx("div",{className:"w-1 h-1 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]})]})})}),e.jsx("div",{ref:b})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(J,{value:n,onChange:t=>l(t.target.value),onKeyPress:M,placeholder:"Type your message...",className:"text-xs h-8"}),e.jsx(p,{size:"sm",onClick:h,className:"h-8 w-8 p-0",children:e.jsx(te,{className:"w-3 h-3"})})]})]})]})})},ce=()=>{d.useState({compliance:!0,scheduling:!0,chatbot:!0,routes:!1,maintenance:!1,performance:!1});const s=[{id:"compliance",name:"Compliance Assistant",icon:E,description:"Monitors regulations and ensures documentation is up to date",status:"active",alerts:3},{id:"scheduling",name:"Smart Scheduling AI",icon:P,description:"Optimizes driver schedules and handles shift management",status:"active",alerts:2},{id:"chatbot",name:"Customer Service Bot",icon:W,description:"24/7 support for parents, drivers, and administrators",status:"active",alerts:0},{id:"routes",name:"Route Optimization AI",icon:Y,description:"Analyzes traffic patterns for optimal route planning",status:"coming_soon",alerts:0},{id:"maintenance",name:"Predictive Maintenance",icon:Z,description:"Predicts vehicle maintenance needs before breakdowns",status:"coming_soon",alerts:0},{id:"performance",name:"Performance Coach",icon:G,description:"Provides personalized feedback on driving patterns",status:"coming_soon",alerts:0}],m=n=>{switch(n){case"active":return e.jsx(y,{className:"bg-green-500 text-white",children:"Active"});case"coming_soon":return e.jsx(y,{variant:"outline",children:"Coming Soon"});default:return e.jsx(y,{variant:"secondary",children:"Inactive"})}};return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold flex items-center space-x-2",children:[e.jsx(A,{className:"w-8 h-8 text-blue-600"}),e.jsx("span",{children:"AI Assistant Hub"})]}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Intelligent automation and assistance for your transport management"})]})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-6",children:s.map(n=>{const l=n.icon;return e.jsx(v,{className:"relative",children:e.jsxs(N,{className:"pb-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(l,{className:"w-6 h-6 text-blue-600"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[m(n.status),n.alerts>0&&e.jsx(y,{variant:"destructive",className:"text-xs",children:n.alerts})]})]}),e.jsx(w,{className:"text-lg",children:n.name}),e.jsx(C,{className:"text-sm",children:n.description})]})},n.id)})}),e.jsxs(X,{defaultValue:"compliance",className:"w-full",children:[e.jsxs(ee,{className:"grid w-full grid-cols-3",children:[e.jsxs(T,{value:"compliance",className:"flex items-center space-x-2",children:[e.jsx(E,{className:"w-4 h-4"}),e.jsx("span",{children:"Compliance"})]}),e.jsxs(T,{value:"scheduling",className:"flex items-center space-x-2",children:[e.jsx(P,{className:"w-4 h-4"}),e.jsx("span",{children:"Scheduling"})]}),e.jsxs(T,{value:"overview",className:"flex items-center space-x-2",children:[e.jsx(A,{className:"w-4 h-4"}),e.jsx("span",{children:"Overview"})]})]}),e.jsx(q,{value:"compliance",className:"mt-6",children:e.jsx(ie,{})}),e.jsx(q,{value:"scheduling",className:"mt-6",children:e.jsx(ne,{})}),e.jsx(q,{value:"overview",className:"mt-6",children:e.jsxs(v,{children:[e.jsxs(N,{children:[e.jsx(w,{children:"AI Assistant Performance"}),e.jsx(C,{children:"Overview of all AI assistants and their current status"})]}),e.jsxs(S,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:"3"}),e.jsx("div",{className:"text-sm text-gray-600",children:"Active Assistants"})]}),e.jsxs("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:"5"}),e.jsx("div",{className:"text-sm text-gray-600",children:"Active Alerts"})]}),e.jsxs("div",{className:"text-center p-4 bg-purple-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:"94%"}),e.jsx("div",{className:"text-sm text-gray-600",children:"Efficiency Score"})]})]}),e.jsxs("div",{className:"pt-4",children:[e.jsx("h4",{className:"font-medium mb-2",children:"Recent AI Actions"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between items-center p-2 bg-gray-50 rounded",children:[e.jsx("span",{children:"Compliance alert generated for CDL renewal"}),e.jsx("span",{className:"text-gray-500",children:"2 min ago"})]}),e.jsxs("div",{className:"flex justify-between items-center p-2 bg-gray-50 rounded",children:[e.jsx("span",{children:"Schedule optimization suggested for Route A"}),e.jsx("span",{className:"text-gray-500",children:"15 min ago"})]}),e.jsxs("div",{className:"flex justify-between items-center p-2 bg-gray-50 rounded",children:[e.jsx("span",{children:"Customer query resolved automatically"}),e.jsx("span",{className:"text-gray-500",children:"32 min ago"})]})]})]})]})]})})]}),e.jsx(re,{})]})},ge=()=>e.jsx(ce,{});export{ge as default};
