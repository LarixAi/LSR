import{c as ne,q as ce,r as d,j as e,N as D,U as F,B as t,i as u,k as p,l as g,n as N,M as S,v,a2 as de,C as P,D as M,d as R,e as I,f as O,g as L,Y as r,I as n,a6 as oe,E as h}from"./main-piTIAPSx.js";import{T as me}from"./textarea-mxcr8nPj.js";import{S as _,a as B,b as $,c as J,d as o}from"./select-Brm_N20Q.js";import{T as he,a as xe,b as f,c as y}from"./tabs-N5TLptOb.js";import{E as je,C as ue}from"./ComprehensiveChildRegistration-BzfbqogJ.js";import{P as pe}from"./plus-CMGcTuiR.js";import{S as ge}from"./square-pen-DnuZJKej.js";import{N as q}from"./navigation-D0f2KySn.js";import{C as H}from"./circle-alert-9v4QUdZ6.js";import{P as b}from"./phone-D7pMV1Uy.js";import{C as V}from"./circle-check-big-CD0jvDn0.js";import"./index-Pp_niZQ8.js";import"./useQuery-Dbdyc74j.js";import"./useMutation-B8vlA97s.js";import"./star-D5LO9sgD.js";import"./trash-2-CMjiaIVh.js";import"./checkbox-DqvkB_ze.js";import"./progress-nJfMQ3MC.js";import"./chevron-left-BoLOTuB-.js";import"./car-B9KPzxYH.js";import"./heart-e8Bsk1RQ.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ne=ne("School",[["path",{d:"M14 22v-4a2 2 0 1 0-4 0v4",key:"hhkicm"}],["path",{d:"m18 10 3.447 1.724a1 1 0 0 1 .553.894V20a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2v-7.382a1 1 0 0 1 .553-.894L6 10",key:"1xqip1"}],["path",{d:"M18 5v17",key:"1sw6gf"}],["path",{d:"m4 6 7.106-3.553a2 2 0 0 1 1.788 0L20 6",key:"9d2mlk"}],["path",{d:"M6 5v17",key:"1xfsm0"}],["circle",{cx:"12",cy:"9",r:"2",key:"1092wv"}]]),Je=()=>{var E;const{user:z,profile:k,loading:U}=ce();d.useState(!1);const[W,C]=d.useState(!1),[T,Y]=d.useState(null),[ve,G]=d.useState(null),[i,x]=d.useState(null),[a,l]=d.useState(null),[K,j]=d.useState(!1);if(U)return e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-primary mb-4"}),e.jsx("p",{className:"text-lg",children:"Loading child management..."})]})});if(!z||!k)return e.jsx(D,{to:"/auth",replace:!0});if(k.role!=="parent")return e.jsx(D,{to:"/dashboard",replace:!0});const w=[{id:"1",firstName:"Emma",lastName:"Smith",age:8,grade:"Year 3",school:"Elmwood Primary School",emergencyContact:"+44 7123 456789",medicalNotes:"Mild asthma - inhaler required",pickupTime:"15:30",dropoffTime:"08:00",route:"Route 1",currentStatus:"at_school",transportStatus:"active",avatar:"/api/placeholder/100/100",driver:"John Smith",driverPhone:"+44 7123 456790",transportOffice:"+44 7123 456791",lastSeen:"15:25",estimatedArrival:"15:35"},{id:"2",firstName:"James",lastName:"Smith",age:6,grade:"Year 1",school:"Elmwood Primary School",emergencyContact:"+44 7123 456789",medicalNotes:"No known allergies",pickupTime:"15:30",dropoffTime:"08:00",route:"Route 1",currentStatus:"on_transport",transportStatus:"active",avatar:"/api/placeholder/100/100",driver:"Sarah Johnson",driverPhone:"+44 7123 456792",transportOffice:"+44 7123 456791",lastSeen:"15:20",estimatedArrival:"15:40"}],Q=[{id:"1",childId:"1",childName:"Emma",type:"pickup",time:"15:35",date:"2024-01-15",location:"Elmwood Primary School",status:"completed",driver:"John Smith",vehicle:"LSR-001"},{id:"2",childId:"2",childName:"James",type:"dropoff",time:"08:02",date:"2024-01-15",location:"Elmwood Primary School",status:"completed",driver:"John Smith",vehicle:"LSR-001"},{id:"3",childId:"1",childName:"Emma",type:"absence",date:"2024-01-12",reason:"Medical appointment",status:"approved"}],X=s=>{switch(s){case"at_home":return e.jsx(h,{className:"bg-blue-100 text-blue-800 hover:bg-blue-100",children:"At Home"});case"on_transport":return e.jsx(h,{className:"bg-yellow-100 text-yellow-800 hover:bg-yellow-100",children:"On Transport"});case"at_school":return e.jsx(h,{className:"bg-green-100 text-green-800 hover:bg-green-100",children:"At School"});case"absent":return e.jsx(h,{className:"bg-gray-100 text-gray-800 hover:bg-gray-100",children:"Absent"});default:return e.jsx(h,{variant:"secondary",children:s})}},Z=s=>{switch(s){case"pickup":return e.jsx(S,{className:"w-4 h-4 text-green-600"});case"dropoff":return e.jsx(S,{className:"w-4 h-4 text-blue-600"});case"absence":return e.jsx(H,{className:"w-4 h-4 text-red-600"});default:return e.jsx(v,{className:"w-4 h-4"})}},ee=(s,c)=>{Y(s),console.log(`Starting live tracking for ${c}`),window.open(`/tracking/${s}`,"_blank")},se=(s,c)=>{G(s),console.log(`Opening schedule for ${c}`),window.open(`/schedule/${s}`,"_blank")},ae=(s,c)=>{x(s),console.log(`Opening call options for ${c}`)},le=s=>{window.location.href=`tel:${s}`,x(null)},A=s=>{window.location.href=`tel:${s}`,x(null)},m=s=>w.find(c=>c.id===s),re=s=>{l({...s}),j(!0)},te=()=>{a&&(console.log("Saving child updates:",a),j(!1),l(null))},ie=()=>{j(!1),l(null)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-3",children:[e.jsx(F,{className:"w-8 h-8 text-blue-600"}),"My Children"]}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Manage your children's transport and school information"})]}),e.jsxs(t,{className:"bg-blue-600 hover:bg-blue-700",onClick:()=>C(!0),children:[e.jsx(pe,{className:"w-4 h-4 mr-2"}),"Add Child (Comprehensive)"]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:w.map(s=>e.jsxs(u,{className:"relative",children:[e.jsx(p,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx(F,{className:"w-8 h-8 text-blue-600"})}),e.jsxs("div",{children:[e.jsxs(g,{className:"text-xl",children:[s.firstName," ",s.lastName]}),e.jsxs("p",{className:"text-gray-600",children:[s.grade," • Age ",s.age]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[X(s.currentStatus),e.jsx(t,{variant:"outline",size:"sm",onClick:()=>re(s),children:e.jsx(ge,{className:"w-4 h-4"})})]})]})}),e.jsxs(N,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ne,{className:"w-4 h-4 text-purple-600"}),e.jsx("span",{children:s.school})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(S,{className:"w-4 h-4 text-red-600"}),e.jsx("span",{children:s.route})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(v,{className:"w-4 h-4 text-green-600"}),e.jsxs("span",{children:["Pickup: ",s.pickupTime]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(v,{className:"w-4 h-4 text-blue-600"}),e.jsxs("span",{children:["Dropoff: ",s.dropoffTime]})]}),s.currentStatus==="on_transport"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-2 col-span-2",children:[e.jsx(q,{className:"w-4 h-4 text-orange-600"}),e.jsxs("span",{className:"text-orange-600 font-medium",children:["Last seen: ",s.lastSeen," • ETA: ",s.estimatedArrival]})]}),e.jsxs("div",{className:"flex items-center gap-2 col-span-2",children:[e.jsx(de,{className:"w-4 h-4 text-gray-600"}),e.jsxs("span",{className:"text-gray-600",children:["Driver: ",s.driver]})]})]})]}),s.medicalNotes&&e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded p-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-yellow-800 mb-1",children:[e.jsx(H,{className:"w-4 h-4"}),e.jsx("span",{className:"font-medium",children:"Medical Notes"})]}),e.jsx("p",{className:"text-yellow-700 text-sm",children:s.medicalNotes})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(t,{size:"sm",className:"flex-1 bg-blue-600 hover:bg-blue-700",onClick:()=>ee(s.id,s.firstName),disabled:T===s.id,children:[e.jsx(q,{className:"w-4 h-4 mr-1"}),T===s.id?"Tracking...":"Track Live"]}),e.jsxs(t,{variant:"outline",size:"sm",className:"flex-1",onClick:()=>se(s.id,s.firstName),children:[e.jsx(P,{className:"w-4 h-4 mr-1"}),"Schedule"]}),e.jsx(t,{variant:"outline",size:"sm",onClick:()=>ae(s.id,s.firstName),children:e.jsx(b,{className:"w-4 h-4"})})]})]})]},s.id))}),e.jsxs(he,{defaultValue:"activity",className:"space-y-6",children:[e.jsxs(xe,{className:"grid w-full grid-cols-4",children:[e.jsx(f,{value:"activity",children:"Recent Activity"}),e.jsx(f,{value:"schedule",children:"Weekly Schedule"}),e.jsx(f,{value:"attendance",children:"Attendance"}),e.jsx(f,{value:"contacts",children:"Emergency Contacts"})]}),e.jsx(y,{value:"activity",className:"space-y-4",children:e.jsxs(u,{children:[e.jsx(p,{children:e.jsxs(g,{className:"flex items-center gap-2",children:[e.jsx(v,{className:"w-5 h-5"}),"Recent Transport Activity"]})}),e.jsx(N,{children:e.jsx("div",{className:"space-y-4",children:Q.map(s=>e.jsxs("div",{className:"flex items-center gap-4 p-3 border rounded-lg",children:[e.jsx("div",{className:"flex-shrink-0",children:Z(s.type)}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("h4",{className:"font-medium",children:[s.childName," - ",s.type==="pickup"?"Picked up":s.type==="dropoff"?"Dropped off":"Absence reported"]}),e.jsxs("div",{className:"text-sm text-gray-600",children:[s.time&&e.jsxs("span",{children:[s.time," • "]}),s.date,s.location&&e.jsxs("span",{children:[" • ",s.location]}),s.driver&&e.jsxs("span",{children:[" • Driver: ",s.driver]})]}),s.reason&&e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Reason: ",s.reason]})]}),e.jsx("div",{children:e.jsx(V,{className:"w-5 h-5 text-green-600"})})]},s.id))})})]})}),e.jsx(y,{value:"schedule",className:"space-y-4",children:e.jsxs(u,{children:[e.jsx(p,{children:e.jsxs(g,{className:"flex items-center gap-2",children:[e.jsx(P,{className:"w-5 h-5"}),"Weekly Transport Schedule"]})}),e.jsx(N,{children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-7 gap-4",children:["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"].map(s=>e.jsxs("div",{className:"border rounded-lg p-3",children:[e.jsx("h3",{className:"font-medium text-center mb-3",children:s}),e.jsx("div",{className:"space-y-2",children:s!=="Saturday"&&s!=="Sunday"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-blue-50 p-2 rounded text-xs",children:[e.jsx("div",{className:"font-medium",children:"Morning Pickup"}),e.jsx("div",{className:"text-gray-600",children:"08:00 - Route 1"})]}),e.jsxs("div",{className:"bg-green-50 p-2 rounded text-xs",children:[e.jsx("div",{className:"font-medium",children:"Afternoon Return"}),e.jsx("div",{className:"text-gray-600",children:"15:30 - Route 1"})]})]}):e.jsx("div",{className:"text-center text-gray-400 text-xs py-4",children:"No transport"})})]},s))})})]})}),e.jsx(y,{value:"attendance",className:"space-y-4",children:e.jsxs(u,{children:[e.jsx(p,{children:e.jsxs(g,{className:"flex items-center gap-2",children:[e.jsx(V,{className:"w-5 h-5"}),"Attendance Summary"]})}),e.jsx(N,{children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:w.map(s=>e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("h3",{className:"font-semibold mb-3",children:[s.firstName," ",s.lastName]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"This Month"}),e.jsx("span",{className:"font-medium",children:"18/20 days"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"This Term"}),e.jsx("span",{className:"font-medium",children:"85/90 days"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Attendance Rate"}),e.jsx("span",{className:"font-medium text-green-600",children:"94%"})]}),e.jsx("div",{className:"bg-green-100 rounded-full h-2",children:e.jsx("div",{className:"bg-green-600 rounded-full h-2 w-[94%]"})})]})]},s.id))})})]})}),e.jsx(y,{value:"contacts",className:"space-y-4",children:e.jsx(je,{})})]}),e.jsx(ue,{open:W,onOpenChange:C,onChildAdded:()=>{C(!1)}}),e.jsx(M,{open:!!i,onOpenChange:()=>x(null),children:e.jsxs(R,{className:"max-w-md",children:[e.jsxs(I,{children:[e.jsxs(O,{children:["Contact Options - ",i&&((E=m(i))==null?void 0:E.firstName)]}),e.jsx(L,{children:"Choose who you'd like to contact regarding your child's transport."})]}),e.jsx("div",{className:"space-y-4",children:i&&m(i)&&e.jsxs(e.Fragment,{children:[e.jsxs(t,{className:"w-full bg-red-600 hover:bg-red-700",onClick:()=>le(m(i).emergencyContact),children:[e.jsx(b,{className:"w-4 h-4 mr-2"}),"Emergency Contact"]}),e.jsxs(t,{variant:"outline",className:"w-full",onClick:()=>A(m(i).driverPhone),children:[e.jsx(b,{className:"w-4 h-4 mr-2"}),"Call Driver (",m(i).driver,")"]}),e.jsxs(t,{variant:"outline",className:"w-full",onClick:()=>A(m(i).transportOffice),children:[e.jsx(b,{className:"w-4 h-4 mr-2"}),"Call Transport Office"]})]})})]})}),e.jsx(M,{open:K,onOpenChange:j,children:e.jsxs(R,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(I,{children:[e.jsx(O,{children:"Edit Child Information"}),e.jsx(L,{children:"Update your child's transport and school information."})]}),a&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Basic Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(r,{htmlFor:"edit-firstName",children:"First Name"}),e.jsx(n,{id:"edit-firstName",value:a.firstName,onChange:s=>l({...a,firstName:s.target.value})})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"edit-lastName",children:"Last Name"}),e.jsx(n,{id:"edit-lastName",value:a.lastName,onChange:s=>l({...a,lastName:s.target.value})})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"edit-age",children:"Age"}),e.jsx(n,{id:"edit-age",type:"number",value:a.age,onChange:s=>l({...a,age:parseInt(s.target.value)})})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"edit-grade",children:"Grade"}),e.jsx(n,{id:"edit-grade",value:a.grade,onChange:s=>l({...a,grade:s.target.value})})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"School Information"}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsx(r,{htmlFor:"edit-school",children:"School"}),e.jsx(n,{id:"edit-school",value:a.school,onChange:s=>l({...a,school:s.target.value})})]})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Transport Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(r,{htmlFor:"edit-pickupTime",children:"Pickup Time"}),e.jsx(n,{id:"edit-pickupTime",type:"time",value:a.pickupTime,onChange:s=>l({...a,pickupTime:s.target.value})})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"edit-dropoffTime",children:"Dropoff Time"}),e.jsx(n,{id:"edit-dropoffTime",type:"time",value:a.dropoffTime,onChange:s=>l({...a,dropoffTime:s.target.value})})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"edit-route",children:"Route"}),e.jsx(n,{id:"edit-route",value:a.route,onChange:s=>l({...a,route:s.target.value})})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"edit-emergencyContact",children:"Emergency Contact"}),e.jsx(n,{id:"edit-emergencyContact",value:a.emergencyContact,onChange:s=>l({...a,emergencyContact:s.target.value})})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Medical Information"}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"edit-medicalNotes",children:"Medical Notes"}),e.jsx(me,{id:"edit-medicalNotes",value:a.medicalNotes,onChange:s=>l({...a,medicalNotes:s.target.value}),rows:3,placeholder:"Any medical conditions, allergies, or special requirements..."})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Status Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(r,{htmlFor:"edit-currentStatus",children:"Current Status"}),e.jsxs(_,{value:a.currentStatus,onValueChange:s=>l({...a,currentStatus:s}),children:[e.jsx(B,{children:e.jsx($,{})}),e.jsxs(J,{children:[e.jsx(o,{value:"at_home",children:"At Home"}),e.jsx(o,{value:"on_transport",children:"On Transport"}),e.jsx(o,{value:"at_school",children:"At School"}),e.jsx(o,{value:"absent",children:"Absent"})]})]})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"edit-transportStatus",children:"Transport Status"}),e.jsxs(_,{value:a.transportStatus,onValueChange:s=>l({...a,transportStatus:s}),children:[e.jsx(B,{children:e.jsx($,{})}),e.jsxs(J,{children:[e.jsx(o,{value:"active",children:"Active"}),e.jsx(o,{value:"suspended",children:"Suspended"}),e.jsx(o,{value:"cancelled",children:"Cancelled"})]})]})]})]})]})]}),e.jsxs(oe,{className:"flex gap-2",children:[e.jsx(t,{variant:"outline",onClick:ie,children:"Cancel"}),e.jsx(t,{onClick:te,className:"bg-blue-600 hover:bg-blue-700",children:"Save Changes"})]})]})})]})};export{Je as default};
