import{c as He,q as Je,J as $e,r as x,j as e,N as ge,aA as Q,B as a,h as ye,i as O,k as E,l as G,n as R,H as ve,a1 as fe,I as i,E as U,a0 as We,D as _,d as N,e as b,f as k,g as w,Y as n,a6 as C,F as Ye,M as _e,o as Ge,s as q,P as j,v as Xe}from"./main-piTIAPSx.js";import{T as V}from"./textarea-mxcr8nPj.js";import{S as I,a as A,b as M,c as T,d as l}from"./select-Brm_N20Q.js";import{T as Ze,a as es,b as X}from"./tabs-N5TLptOb.js";import{u as ce}from"./useQuery-Dbdyc74j.js";import{u as Z}from"./useMutation-B8vlA97s.js";import{D as ss}from"./download-C4W0Vf38.js";import{U as ts}from"./upload-CgVQC7ku.js";import{P as ee}from"./plus-CMGcTuiR.js";import{M as se}from"./minus-a8kAC2EO.js";import{S as rs}from"./search-HDsNrIL9.js";import{R as ns}from"./refresh-cw-BS9rbMP7.js";import{S as Ne}from"./square-pen-DnuZJKej.js";import{P as as}from"./phone-D7pMV1Uy.js";import{C as is}from"./circle-check-big-CD0jvDn0.js";import"./index-Pp_niZQ8.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const be=He("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]),bs=()=>{const{user:B,profile:m,loading:ke}=Je(),g=$e(),[K,we]=x.useState("inventory"),[H,Ce]=x.useState(""),[te,qe]=x.useState("all"),[re,Se]=x.useState("all"),[Fe,z]=x.useState(!1),[Pe,J]=x.useState(!1),[De,v]=x.useState(!1),[Oe,$]=x.useState(!1),[Ee,W]=x.useState(!1),[Ie,Y]=x.useState(!1),[Ae,ne]=x.useState(!1),[r,S]=x.useState(null),[t,c]=x.useState({part_number:"",name:"",description:"",category:"engine",quantity:0,min_quantity:0,unit_price:0,supplier:"",supplier_contact:"",location:"",notes:""}),[u,f]=x.useState({quantity:0,unit_price:0,reference_type:"manual",reference_number:"",notes:""}),[h,F]=x.useState({quantity:0,reference_type:"job",reference_number:"",notes:""}),[d,y]=x.useState({quantity:0,unit_price:0,supplier:"",supplier_contact:"",expected_delivery:"",notes:""});if(ke)return e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-primary mb-4"}),e.jsx("p",{className:"text-lg",children:"Loading parts inventory..."})]})});if(!B||!m)return e.jsx(ge,{to:"/auth",replace:!0});if(m.role!=="mechanic")return e.jsx(ge,{to:"/dashboard",replace:!0});const{data:P=[],isLoading:Me,refetch:Te}=ce({queryKey:["parts-inventory"],queryFn:async()=>{console.log("ðŸ” Fetching parts from backend..."),console.log("ðŸ‘¤ Current user profile:",m),console.log("ðŸ¢ User organization:",m==null?void 0:m.organization_id);const{data:s,error:o}=await q.from("parts_inventory").select("*").eq("organization_id",m==null?void 0:m.organization_id).order("name");return o?(console.error("Error fetching parts inventory:",o),[]):(console.log("ðŸ“Š Backend returned parts:",s),console.log("ðŸ“Š Parts count:",(s==null?void 0:s.length)||0),s||[])},staleTime:0,gcTime:0,refetchOnWindowFocus:!0,refetchOnMount:!0}),oe=async()=>{console.log("ðŸ”„ Force refreshing data..."),g.clear(),localStorage.clear(),sessionStorage.clear(),await g.invalidateQueries({queryKey:["parts-inventory"]}),await g.invalidateQueries({queryKey:["stock-movements"]}),await g.invalidateQueries({queryKey:["stock-orders"]}),await Te(),console.log("âœ… Force refresh completed")};x.useEffect(()=>{oe()},[]);const{data:ze=[]}=ce({queryKey:["stock-movements"],queryFn:async()=>{const{data:s,error:o}=await q.from("stock_movements").select(`
          *,
          part:parts_inventory(part_number, name)
        `).order("movement_date",{ascending:!1}).limit(50);return o?(console.error("Error fetching stock movements:",o),[]):s||[]}});ce({queryKey:["stock-orders"],queryFn:async()=>{const{data:s,error:o}=await q.from("stock_orders").select(`
          *,
          part:parts_inventory(part_number, name)
        `).order("order_date",{ascending:!1});return o?(console.error("Error fetching stock orders:",o),[]):s||[]}});const ae=Z({mutationFn:async s=>{const o={...s,organization_id:m==null?void 0:m.organization_id,created_by:B==null?void 0:B.id,status:"in_stock"},{data:p,error:L}=await q.from("parts_inventory").insert([o]).select().single();if(L)throw L;return p},onSuccess:()=>{g.invalidateQueries({queryKey:["parts-inventory"]}),j({title:"Success",description:"Part added successfully"}),z(!1),c({part_number:"",name:"",description:"",category:"engine",quantity:0,min_quantity:0,unit_price:0,supplier:"",supplier_contact:"",location:"",notes:""})},onError:s=>{j({title:"Error",description:"Failed to add part",variant:"destructive"})}}),ie=Z({mutationFn:async({id:s,data:o})=>{const{data:p,error:L}=await q.from("parts_inventory").update(o).eq("id",s).select().single();if(L)throw L;return p},onSuccess:()=>{g.invalidateQueries({queryKey:["parts-inventory"]}),j({title:"Success",description:"Part updated successfully"}),J(!1),S(null)},onError:s=>{j({title:"Error",description:"Failed to update part",variant:"destructive"})}}),D=Z({mutationFn:async s=>{const{data:o,error:p}=await q.from("stock_movements").insert([s]).select().single();if(p)throw p;return o},onSuccess:()=>{g.invalidateQueries({queryKey:["parts-inventory","stock-movements"]}),j({title:"Success",description:"Stock movement recorded successfully"}),$(!1),W(!1),f({quantity:0,unit_price:0,reference_type:"manual",reference_number:"",notes:""}),F({quantity:0,reference_type:"job",reference_number:"",notes:""})},onError:s=>{j({title:"Error",description:"Failed to record stock movement",variant:"destructive"})}}),le=Z({mutationFn:async s=>{const{data:o,error:p}=await q.from("stock_orders").insert([s]).select().single();if(p)throw p;return o},onSuccess:()=>{g.invalidateQueries({queryKey:["stock-orders"]}),j({title:"Success",description:"Stock order created successfully"}),Y(!1),y({quantity:0,unit_price:0,supplier:"",supplier_contact:"",expected_delivery:"",notes:""})},onError:s=>{j({title:"Error",description:"Failed to create stock order",variant:"destructive"})}}),de=P.filter(s=>!(K==="low_stock"&&s.quantity>s.min_quantity||K==="out_of_stock"&&s.quantity>0||K==="on_order"&&s.status!=="on_order"||H&&!s.name.toLowerCase().includes(H.toLowerCase())&&!s.part_number.toLowerCase().includes(H.toLowerCase())||te!=="all"&&s.category!==te||re!=="all"&&s.status!==re)),ue=s=>{switch(s){case"in_stock":return"bg-green-100 text-green-800 border-green-200";case"low_stock":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"out_of_stock":return"bg-red-100 text-red-800 border-red-200";case"on_order":return"bg-blue-100 text-blue-800 border-blue-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},xe=s=>{switch(s){case"in_stock":return e.jsx(is,{className:"w-4 h-4"});case"low_stock":return e.jsx(ve,{className:"w-4 h-4"});case"out_of_stock":return e.jsx(se,{className:"w-4 h-4"});case"on_order":return e.jsx(Xe,{className:"w-4 h-4"});default:return e.jsx(Q,{className:"w-4 h-4"})}},Le=()=>{ae.mutate({part_number:t.part_number,name:t.name,description:t.description,category:t.category,quantity:t.quantity,min_quantity:t.min_quantity,unit_price:t.unit_price,supplier:t.supplier,supplier_contact:t.supplier_contact,location:t.location,status:t.quantity>t.min_quantity?"in_stock":"low_stock"})},Qe=()=>{r&&ie.mutate({id:r.id,data:{part_number:t.part_number,name:t.name,description:t.description,category:t.category,quantity:t.quantity,min_quantity:t.min_quantity,unit_price:t.unit_price,supplier:t.supplier,supplier_contact:t.supplier_contact,location:t.location,status:t.quantity>t.min_quantity?"in_stock":"low_stock"}})},me=s=>{S(s),c({part_number:s.part_number,name:s.name,description:s.description,category:s.category,quantity:s.quantity,min_quantity:s.min_quantity,unit_price:s.unit_price,supplier:s.supplier,supplier_contact:s.supplier_contact,location:s.location,notes:""}),J(!0)},Re=s=>{S(s),v(!0)},he=s=>{S(s),f({quantity:0,unit_price:s.unit_price,reference_type:"manual",reference_number:"",notes:""}),$(!0)},pe=s=>{S(s),F({quantity:0,reference_type:"job",reference_number:"",notes:""}),W(!0)},je=s=>{S(s),y({quantity:s.min_quantity*2,unit_price:s.unit_price,supplier:s.supplier,supplier_contact:s.supplier_contact,expected_delivery:"",notes:""}),Y(!0)},Ue=()=>{ne(!0)},Ve=()=>{r&&D.mutate({part_id:r.id,movement_type:"stock_in",quantity:u.quantity,previous_quantity:r.quantity,new_quantity:r.quantity+u.quantity,unit_price:u.unit_price,total_value:u.quantity*u.unit_price,reference_type:u.reference_type,reference_number:u.reference_number,notes:u.notes,moved_by:m.id})},Be=()=>{if(r){if(h.quantity>r.quantity){j({title:"Error",description:"Insufficient stock available",variant:"destructive"});return}D.mutate({part_id:r.id,movement_type:"stock_out",quantity:h.quantity,previous_quantity:r.quantity,new_quantity:r.quantity-h.quantity,unit_price:r.unit_price,total_value:h.quantity*r.unit_price,reference_type:h.reference_type,reference_number:h.reference_number,notes:h.notes,moved_by:m.id})}},Ke=()=>{r&&le.mutate({part_id:r.id,supplier:d.supplier,supplier_contact:d.supplier_contact,quantity_ordered:d.quantity,unit_price:d.unit_price,total_cost:d.quantity*d.unit_price,expected_delivery:d.expected_delivery,notes:d.notes,ordered_by:m.id})};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-3",children:[e.jsx(Q,{className:"w-8 h-8 text-blue-600"}),"Parts & Supplies"]}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Manage inventory, track supplies, and handle orders"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(a,{variant:"outline",size:"sm",onClick:Ue,children:[e.jsx(ye,{className:"w-4 h-4 mr-2"}),"Stock Movements"]}),e.jsxs(a,{variant:"outline",size:"sm",children:[e.jsx(ss,{className:"w-4 h-4 mr-2"}),"Export"]}),e.jsxs(a,{variant:"outline",size:"sm",children:[e.jsx(ts,{className:"w-4 h-4 mr-2"}),"Import"]}),e.jsxs(a,{size:"sm",onClick:()=>z(!0),children:[e.jsx(ee,{className:"w-4 h-4 mr-2"}),"Add Part"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsxs(O,{children:[e.jsxs(E,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(G,{className:"text-sm font-medium",children:"Total Parts"}),e.jsx(Q,{className:"h-4 w-4 text-blue-600"})]}),e.jsxs(R,{children:[e.jsx("div",{className:"text-2xl font-bold",children:P.length}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[P.filter(s=>s.status==="in_stock").length," in stock"]})]})]}),e.jsxs(O,{children:[e.jsxs(E,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(G,{className:"text-sm font-medium",children:"Low Stock"}),e.jsx(ve,{className:"h-4 w-4 text-yellow-600"})]}),e.jsxs(R,{children:[e.jsx("div",{className:"text-2xl font-bold",children:P.filter(s=>s.status==="low_stock").length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Need reordering"})]})]}),e.jsxs(O,{children:[e.jsxs(E,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(G,{className:"text-sm font-medium",children:"Out of Stock"}),e.jsx(se,{className:"h-4 w-4 text-red-600"})]}),e.jsxs(R,{children:[e.jsx("div",{className:"text-2xl font-bold",children:P.filter(s=>s.status==="out_of_stock").length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Urgent orders needed"})]})]}),e.jsxs(O,{children:[e.jsxs(E,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(G,{className:"text-sm font-medium",children:"Total Value"}),e.jsx(fe,{className:"h-4 w-4 text-green-600"})]}),e.jsxs(R,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:["Â£",P.reduce((s,o)=>s+o.quantity*o.unit_price,0).toLocaleString()]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Inventory value"})]})]})]}),e.jsx(O,{children:e.jsx(E,{children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 items-start md:items-center justify-between",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 flex-1",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(rs,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx(i,{placeholder:"Search parts...",value:H,onChange:s=>Ce(s.target.value),className:"pl-10"})]}),e.jsxs(I,{value:te,onValueChange:qe,children:[e.jsx(A,{className:"w-[150px]",children:e.jsx(M,{placeholder:"Category"})}),e.jsxs(T,{children:[e.jsx(l,{value:"all",children:"All Categories"}),e.jsx(l,{value:"engine",children:"Engine"}),e.jsx(l,{value:"brakes",children:"Brakes"}),e.jsx(l,{value:"electrical",children:"Electrical"}),e.jsx(l,{value:"tires",children:"Tires"}),e.jsx(l,{value:"fluids",children:"Fluids"})]})]}),e.jsxs(I,{value:re,onValueChange:Se,children:[e.jsx(A,{className:"w-[150px]",children:e.jsx(M,{placeholder:"Status"})}),e.jsxs(T,{children:[e.jsx(l,{value:"all",children:"All Status"}),e.jsx(l,{value:"in_stock",children:"In Stock"}),e.jsx(l,{value:"low_stock",children:"Low Stock"}),e.jsx(l,{value:"out_of_stock",children:"Out of Stock"}),e.jsx(l,{value:"on_order",children:"On Order"})]})]})]}),e.jsxs(a,{variant:"outline",size:"sm",onClick:oe,children:[e.jsx(ns,{className:"w-4 h-4 mr-2"}),"Refresh"]})]})})}),e.jsxs(O,{children:[e.jsx(E,{children:e.jsx(Ze,{value:K,onValueChange:we,children:e.jsxs(es,{children:[e.jsx(X,{value:"inventory",children:"All Inventory"}),e.jsx(X,{value:"low_stock",children:"Low Stock"}),e.jsx(X,{value:"out_of_stock",children:"Out of Stock"}),e.jsx(X,{value:"on_order",children:"On Order"})]})})}),e.jsx(R,{children:Me?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx("div",{className:"inline-block animate-spin rounded-full h-6 w-6 border-b-2 border-primary"})}):de.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Q,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No parts found"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"Add your first part to get started"}),e.jsxs(a,{onClick:()=>z(!0),children:[e.jsx(ee,{className:"w-4 h-4 mr-2"}),"Add Part"]})]}):e.jsx("div",{className:"space-y-4",children:de.map(s=>e.jsx("div",{className:"border rounded-lg p-4 hover:bg-gray-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h4",{className:"font-semibold",children:s.part_number}),e.jsxs(U,{className:ue(s.status),children:[xe(s.status),s.status.replace("_"," ")]}),e.jsx(U,{variant:"outline",children:s.category})]}),e.jsx("h5",{className:"font-medium text-lg mb-1",children:s.name}),e.jsx("p",{className:"text-gray-600 text-sm mb-2",children:s.description}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Quantity:"}),e.jsxs("p",{className:"font-medium",children:[s.quantity," / ",s.min_quantity]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Unit Price:"}),e.jsxs("p",{className:"font-medium",children:["Â£",s.unit_price]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Supplier:"}),e.jsx("p",{className:"font-medium",children:s.supplier})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Location:"}),e.jsx("p",{className:"font-medium",children:s.location})]})]})]}),e.jsxs("div",{className:"flex gap-2 ml-4",children:[e.jsx(a,{variant:"outline",size:"sm",onClick:()=>Re(s),children:e.jsx(We,{className:"w-4 h-4"})}),e.jsx(a,{variant:"outline",size:"sm",onClick:()=>me(s),children:e.jsx(Ne,{className:"w-4 h-4"})}),e.jsx(a,{variant:"outline",size:"sm",onClick:()=>he(s),children:e.jsx(ee,{className:"w-4 h-4"})}),e.jsx(a,{variant:"outline",size:"sm",onClick:()=>pe(s),children:e.jsx(se,{className:"w-4 h-4"})}),(s.status==="low_stock"||s.status==="out_of_stock")&&e.jsxs(a,{size:"sm",onClick:()=>je(s),children:[e.jsx(be,{className:"w-4 h-4 mr-2"}),"Order"]})]})]})},s.id))})})]}),e.jsx(_,{open:Fe,onOpenChange:z,children:e.jsxs(N,{className:"max-w-2xl",children:[e.jsxs(b,{children:[e.jsx(k,{children:"Add New Part"}),e.jsx(w,{children:"Add a new part to the inventory"})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(n,{htmlFor:"part_number",children:"Part Number"}),e.jsx(i,{id:"part_number",value:t.part_number,onChange:s=>c({...t,part_number:s.target.value}),placeholder:"e.g., BRK-001"})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"category",children:"Category"}),e.jsxs(I,{value:t.category,onValueChange:s=>c({...t,category:s}),children:[e.jsx(A,{children:e.jsx(M,{})}),e.jsxs(T,{children:[e.jsx(l,{value:"engine",children:"Engine"}),e.jsx(l,{value:"brakes",children:"Brakes"}),e.jsx(l,{value:"electrical",children:"Electrical"}),e.jsx(l,{value:"tires",children:"Tires"}),e.jsx(l,{value:"fluids",children:"Fluids"})]})]})]})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"name",children:"Part Name"}),e.jsx(i,{id:"name",value:t.name,onChange:s=>c({...t,name:s.target.value}),placeholder:"e.g., Brake Pad Set"})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"description",children:"Description"}),e.jsx(V,{id:"description",value:t.description,onChange:s=>c({...t,description:s.target.value}),placeholder:"Describe the part...",rows:3})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(n,{htmlFor:"quantity",children:"Current Quantity"}),e.jsx(i,{id:"quantity",type:"number",value:t.quantity,onChange:s=>c({...t,quantity:parseInt(s.target.value)||0}),placeholder:"0"})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"min_quantity",children:"Min Quantity"}),e.jsx(i,{id:"min_quantity",type:"number",value:t.min_quantity,onChange:s=>c({...t,min_quantity:parseInt(s.target.value)||0}),placeholder:"0"})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"unit_price",children:"Unit Price (Â£)"}),e.jsx(i,{id:"unit_price",type:"number",step:"0.01",value:t.unit_price,onChange:s=>c({...t,unit_price:parseFloat(s.target.value)||0}),placeholder:"0.00"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(n,{htmlFor:"supplier",children:"Supplier"}),e.jsx(i,{id:"supplier",value:t.supplier,onChange:s=>c({...t,supplier:s.target.value}),placeholder:"Supplier name"})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"supplier_contact",children:"Supplier Contact"}),e.jsx(i,{id:"supplier_contact",value:t.supplier_contact,onChange:s=>c({...t,supplier_contact:s.target.value}),placeholder:"Phone or email"})]})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"location",children:"Storage Location"}),e.jsx(i,{id:"location",value:t.location,onChange:s=>c({...t,location:s.target.value}),placeholder:"e.g., Shelf A1, Bin 3"})]})]}),e.jsxs(C,{children:[e.jsx(a,{variant:"outline",onClick:()=>z(!1),children:"Cancel"}),e.jsx(a,{onClick:Le,disabled:ae.isPending,children:ae.isPending?"Adding...":"Add Part"})]})]})}),e.jsx(_,{open:Pe,onOpenChange:J,children:e.jsxs(N,{className:"max-w-2xl",children:[e.jsxs(b,{children:[e.jsx(k,{children:"Edit Part"}),e.jsx(w,{children:"Update part information"})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(n,{htmlFor:"edit-part_number",children:"Part Number"}),e.jsx(i,{id:"edit-part_number",value:t.part_number,onChange:s=>c({...t,part_number:s.target.value})})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"edit-category",children:"Category"}),e.jsxs(I,{value:t.category,onValueChange:s=>c({...t,category:s}),children:[e.jsx(A,{children:e.jsx(M,{})}),e.jsxs(T,{children:[e.jsx(l,{value:"engine",children:"Engine"}),e.jsx(l,{value:"brakes",children:"Brakes"}),e.jsx(l,{value:"electrical",children:"Electrical"}),e.jsx(l,{value:"tires",children:"Tires"}),e.jsx(l,{value:"fluids",children:"Fluids"})]})]})]})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"edit-name",children:"Part Name"}),e.jsx(i,{id:"edit-name",value:t.name,onChange:s=>c({...t,name:s.target.value})})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"edit-description",children:"Description"}),e.jsx(V,{id:"edit-description",value:t.description,onChange:s=>c({...t,description:s.target.value}),rows:3})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(n,{htmlFor:"edit-quantity",children:"Current Quantity"}),e.jsx(i,{id:"edit-quantity",type:"number",value:t.quantity,onChange:s=>c({...t,quantity:parseInt(s.target.value)||0})})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"edit-min_quantity",children:"Min Quantity"}),e.jsx(i,{id:"edit-min_quantity",type:"number",value:t.min_quantity,onChange:s=>c({...t,min_quantity:parseInt(s.target.value)||0})})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"edit-unit_price",children:"Unit Price (Â£)"}),e.jsx(i,{id:"edit-unit_price",type:"number",step:"0.01",value:t.unit_price,onChange:s=>c({...t,unit_price:parseFloat(s.target.value)||0})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(n,{htmlFor:"edit-supplier",children:"Supplier"}),e.jsx(i,{id:"edit-supplier",value:t.supplier,onChange:s=>c({...t,supplier:s.target.value})})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"edit-supplier_contact",children:"Supplier Contact"}),e.jsx(i,{id:"edit-supplier_contact",value:t.supplier_contact,onChange:s=>c({...t,supplier_contact:s.target.value})})]})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"edit-location",children:"Storage Location"}),e.jsx(i,{id:"edit-location",value:t.location,onChange:s=>c({...t,location:s.target.value})})]})]}),e.jsxs(C,{children:[e.jsx(a,{variant:"outline",onClick:()=>J(!1),children:"Cancel"}),e.jsx(a,{onClick:Qe,disabled:ie.isPending,children:ie.isPending?"Updating...":"Update Part"})]})]})}),e.jsx(_,{open:De,onOpenChange:v,children:e.jsxs(N,{className:"max-w-3xl max-h-[85vh] overflow-y-auto",children:[e.jsx(b,{className:"border-b pb-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(k,{className:"text-xl font-bold flex items-center gap-2",children:[e.jsx(Q,{className:"w-5 h-5 text-primary"}),r==null?void 0:r.name]}),e.jsxs(w,{className:"text-sm text-muted-foreground mt-1",children:["Part Number: ",r==null?void 0:r.part_number]})]}),r&&e.jsxs(U,{className:ue(r.status),children:[xe(r.status),r.status.replace("_"," ")]})]})}),r&&e.jsxs("div",{className:"space-y-6 py-4",children:[e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsxs("h3",{className:"font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[e.jsx(Ye,{className:"w-4 h-4"}),"Basic Information"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(n,{className:"text-sm font-medium text-gray-600",children:"Description"}),e.jsx("p",{className:"text-gray-900 mt-1",children:r.description||"No description available"})]}),e.jsxs("div",{children:[e.jsx(n,{className:"text-sm font-medium text-gray-600",children:"Category"}),e.jsx(U,{variant:"outline",className:"mt-1",children:r.category})]})]})]}),e.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[e.jsxs("h3",{className:"font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[e.jsx(ye,{className:"w-4 h-4"}),"Stock Information"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx(n,{className:"text-sm font-medium text-gray-600",children:"Current Stock"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600 mt-1",children:r.quantity}),e.jsx("p",{className:"text-xs text-gray-500",children:"units available"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx(n,{className:"text-sm font-medium text-gray-600",children:"Minimum Stock"}),e.jsx("p",{className:"text-lg font-semibold text-gray-900 mt-1",children:r.min_quantity}),e.jsx("p",{className:"text-xs text-gray-500",children:"reorder level"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx(n,{className:"text-sm font-medium text-gray-600",children:"Stock Level"}),e.jsxs("div",{className:"mt-2",children:[e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full transition-all ${r.quantity>r.min_quantity?"bg-green-500":r.quantity>0?"bg-yellow-500":"bg-red-500"}`,style:{width:`${Math.min(r.quantity/r.min_quantity*50,100)}%`}})}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[(r.quantity/r.min_quantity).toFixed(1),"x minimum"]})]})]})]})]}),e.jsxs("div",{className:"bg-green-50 rounded-lg p-4",children:[e.jsxs("h3",{className:"font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[e.jsx(fe,{className:"w-4 h-4"}),"Financial Information"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx(n,{className:"text-sm font-medium text-gray-600",children:"Unit Price"}),e.jsxs("p",{className:"text-xl font-bold text-green-600 mt-1",children:["Â£",r.unit_price.toFixed(2)]}),e.jsx("p",{className:"text-xs text-gray-500",children:"per unit"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx(n,{className:"text-sm font-medium text-gray-600",children:"Total Value"}),e.jsxs("p",{className:"text-xl font-bold text-blue-600 mt-1",children:["Â£",(r.quantity*r.unit_price).toFixed(2)]}),e.jsx("p",{className:"text-xs text-gray-500",children:"current inventory"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx(n,{className:"text-sm font-medium text-gray-600",children:"Reorder Value"}),e.jsxs("p",{className:"text-lg font-semibold text-gray-900 mt-1",children:["Â£",(r.min_quantity*r.unit_price).toFixed(2)]}),e.jsx("p",{className:"text-xs text-gray-500",children:"minimum order"})]})]})]}),e.jsxs("div",{className:"bg-purple-50 rounded-lg p-4",children:[e.jsxs("h3",{className:"font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[e.jsx(_e,{className:"w-4 h-4"}),"Location & Supplier"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx(n,{className:"text-sm font-medium text-gray-600",children:"Storage Location"}),e.jsxs("p",{className:"text-gray-900 mt-1 flex items-center gap-1",children:[e.jsx(_e,{className:"w-4 h-4 text-gray-500"}),r.location||"Not specified"]})]}),e.jsxs("div",{children:[e.jsx(n,{className:"text-sm font-medium text-gray-600",children:"Supplier"}),e.jsx("p",{className:"text-gray-900 mt-1 font-medium",children:r.supplier||"Not specified"}),r.supplier_contact&&e.jsxs("p",{className:"text-sm text-gray-600 mt-1 flex items-center gap-1",children:[e.jsx(as,{className:"w-4 h-4"}),r.supplier_contact]})]})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsxs("h3",{className:"font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[e.jsx(Ge,{className:"w-4 h-4"}),"Quick Actions"]}),e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsxs(a,{onClick:()=>{v(!1),me(r)},variant:"outline",size:"sm",children:[e.jsx(Ne,{className:"w-4 h-4 mr-2"}),"Edit Part"]}),e.jsxs(a,{onClick:()=>{v(!1),he(r)},variant:"outline",size:"sm",children:[e.jsx(ee,{className:"w-4 h-4 mr-2"}),"Stock In"]}),e.jsxs(a,{onClick:()=>{v(!1),pe(r)},variant:"outline",size:"sm",children:[e.jsx(se,{className:"w-4 h-4 mr-2"}),"Stock Out"]}),(r.status==="low_stock"||r.status==="out_of_stock")&&e.jsxs(a,{onClick:()=>{v(!1),je(r)},size:"sm",children:[e.jsx(be,{className:"w-4 h-4 mr-2"}),"Order More"]})]})]})]}),e.jsx(C,{className:"border-t pt-4",children:e.jsx(a,{variant:"outline",onClick:()=>v(!1),children:"Close"})})]})}),e.jsx(_,{open:Oe,onOpenChange:$,children:e.jsxs(N,{className:"max-w-md",children:[e.jsxs(b,{children:[e.jsx(k,{children:"Stock In"}),e.jsxs(w,{children:["Add stock for ",r==null?void 0:r.name]})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{children:[e.jsx(n,{htmlFor:"stock-in-quantity",children:"Quantity"}),e.jsx(i,{id:"stock-in-quantity",type:"number",value:u.quantity,onChange:s=>f({...u,quantity:parseInt(s.target.value)||0}),placeholder:"0"})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"stock-in-price",children:"Unit Price (Â£)"}),e.jsx(i,{id:"stock-in-price",type:"number",step:"0.01",value:u.unit_price,onChange:s=>f({...u,unit_price:parseFloat(s.target.value)||0}),placeholder:"0.00"})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"stock-in-reference",children:"Reference Type"}),e.jsxs(I,{value:u.reference_type,onValueChange:s=>f({...u,reference_type:s}),children:[e.jsx(A,{children:e.jsx(M,{})}),e.jsxs(T,{children:[e.jsx(l,{value:"manual",children:"Manual Entry"}),e.jsx(l,{value:"order",children:"Order"}),e.jsx(l,{value:"return",children:"Return"})]})]})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"stock-in-reference-number",children:"Reference Number"}),e.jsx(i,{id:"stock-in-reference-number",value:u.reference_number,onChange:s=>f({...u,reference_number:s.target.value}),placeholder:"e.g., ORD-001, Return-001"})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"stock-in-notes",children:"Notes"}),e.jsx(V,{id:"stock-in-notes",value:u.notes,onChange:s=>f({...u,notes:s.target.value}),placeholder:"Additional notes...",rows:3})]})]}),e.jsxs(C,{children:[e.jsx(a,{variant:"outline",onClick:()=>$(!1),children:"Cancel"}),e.jsx(a,{onClick:Ve,disabled:D.isPending,children:D.isPending?"Adding...":"Add Stock"})]})]})}),e.jsx(_,{open:Ee,onOpenChange:W,children:e.jsxs(N,{className:"max-w-md",children:[e.jsxs(b,{children:[e.jsx(k,{children:"Stock Out"}),e.jsxs(w,{children:["Remove stock for ",r==null?void 0:r.name]})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{children:[e.jsx(n,{htmlFor:"stock-out-quantity",children:"Quantity"}),e.jsx(i,{id:"stock-out-quantity",type:"number",value:h.quantity,onChange:s=>F({...h,quantity:parseInt(s.target.value)||0}),placeholder:"0"})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"stock-out-reference",children:"Reference Type"}),e.jsxs(I,{value:h.reference_type,onValueChange:s=>F({...h,reference_type:s}),children:[e.jsx(A,{children:e.jsx(M,{})}),e.jsxs(T,{children:[e.jsx(l,{value:"job",children:"Job"}),e.jsx(l,{value:"manual",children:"Manual Entry"}),e.jsx(l,{value:"adjustment",children:"Adjustment"})]})]})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"stock-out-reference-number",children:"Reference Number"}),e.jsx(i,{id:"stock-out-reference-number",value:h.reference_number,onChange:s=>F({...h,reference_number:s.target.value}),placeholder:"e.g., JOB-001, ADJ-001"})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"stock-out-notes",children:"Notes"}),e.jsx(V,{id:"stock-out-notes",value:h.notes,onChange:s=>F({...h,notes:s.target.value}),placeholder:"Additional notes...",rows:3})]})]}),e.jsxs(C,{children:[e.jsx(a,{variant:"outline",onClick:()=>W(!1),children:"Cancel"}),e.jsx(a,{onClick:Be,disabled:D.isPending,children:D.isPending?"Removing...":"Remove Stock"})]})]})}),e.jsx(_,{open:Ie,onOpenChange:Y,children:e.jsxs(N,{className:"max-w-md",children:[e.jsxs(b,{children:[e.jsx(k,{children:"Create Order"}),e.jsxs(w,{children:["Order ",r==null?void 0:r.name]})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{children:[e.jsx(n,{htmlFor:"order-quantity",children:"Quantity"}),e.jsx(i,{id:"order-quantity",type:"number",value:d.quantity,onChange:s=>y({...d,quantity:parseInt(s.target.value)||0}),placeholder:"0"})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"order-price",children:"Unit Price (Â£)"}),e.jsx(i,{id:"order-price",type:"number",step:"0.01",value:d.unit_price,onChange:s=>y({...d,unit_price:parseFloat(s.target.value)||0}),placeholder:"0.00"})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"order-supplier",children:"Supplier"}),e.jsx(i,{id:"order-supplier",value:d.supplier,onChange:s=>y({...d,supplier:s.target.value}),placeholder:"Supplier name"})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"order-contact",children:"Supplier Contact"}),e.jsx(i,{id:"order-contact",value:d.supplier_contact,onChange:s=>y({...d,supplier_contact:s.target.value}),placeholder:"Phone or email"})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"order-delivery",children:"Expected Delivery"}),e.jsx(i,{id:"order-delivery",type:"date",value:d.expected_delivery,onChange:s=>y({...d,expected_delivery:s.target.value})})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"order-notes",children:"Notes"}),e.jsx(V,{id:"order-notes",value:d.notes,onChange:s=>y({...d,notes:s.target.value}),placeholder:"Additional notes...",rows:3})]})]}),e.jsxs(C,{children:[e.jsx(a,{variant:"outline",onClick:()=>Y(!1),children:"Cancel"}),e.jsx(a,{onClick:Ke,disabled:le.isPending,children:le.isPending?"Creating...":"Create Order"})]})]})}),e.jsx(_,{open:Ae,onOpenChange:ne,children:e.jsxs(N,{className:"max-w-4xl",children:[e.jsxs(b,{children:[e.jsx(k,{children:"Stock Movements"}),e.jsx(w,{children:"Recent stock movements and audit trail"})]}),e.jsx("div",{className:"max-h-96 overflow-y-auto",children:e.jsx("div",{className:"space-y-4",children:ze.map(s=>{var o;return e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h4",{className:"font-semibold",children:s.movement_number}),e.jsx(U,{className:s.movement_type==="stock_in"?"bg-green-100 text-green-800":"bg-red-100 text-red-800",children:s.movement_type.replace("_"," ").toUpperCase()})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Part:"}),e.jsx("p",{className:"font-medium",children:((o=s.part)==null?void 0:o.name)||"N/A"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Quantity:"}),e.jsx("p",{className:"font-medium",children:s.quantity})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Reference:"}),e.jsx("p",{className:"font-medium",children:s.reference_number||"N/A"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Date:"}),e.jsx("p",{className:"font-medium",children:new Date(s.movement_date).toLocaleDateString()})]})]}),s.notes&&e.jsxs("div",{className:"mt-2",children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Notes:"}),e.jsx("p",{className:"text-sm",children:s.notes})]})]},s.id)})})}),e.jsx(C,{children:e.jsx(a,{variant:"outline",onClick:()=>ne(!1),children:"Close"})})]})})]})};export{bs as default};
