import{q as S,r as C,j as e,N as h,R as d,D,b as T,B as a,d as E,e as P,f as z,Y as t,I as n,i as l,n as i,U as F,a1 as L,k as O,l as $,E as j,a0 as B,o as I}from"./main-piTIAPSx.js";import{u as k,a as M}from"./useRoutes-vLWA0XVf.js";import{S as _,a as q,b as A,c as H,d as c}from"./select-Brm_N20Q.js";import{P as U}from"./plus-CMGcTuiR.js";import{N as g}from"./navigation-D0f2KySn.js";import{S as V}from"./square-pen-DnuZJKej.js";import{T as Y}from"./target-CwAJPPi1.js";import"./useQuery-Dbdyc74j.js";import"./useMutation-B8vlA97s.js";import"./index-Pp_niZQ8.js";const te=()=>{const{user:p,profile:x,loading:u}=S(),[N,f]=C.useState(!1),{data:v=[],isLoading:b}=k(),o=M();if(u||b)return e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-primary mb-4"}),e.jsx("p",{className:"text-lg",children:"Loading route planning..."})]})});if(!p||!x)return e.jsx(h,{to:"/auth",replace:!0});if(!["admin","council"].includes(x.role))return e.jsx(h,{to:"/unauthorized",replace:!0});const y=v.map(s=>({id:s.id,name:s.name||`${s.start_location} → ${s.end_location}`,status:s.status||"active",distance:`${(s.distance||0).toFixed(1)} km`,passengers:0,revenue:0,efficiency:0})),R=s=>{const w={active:"bg-green-100 text-green-800",draft:"bg-yellow-100 text-yellow-800",inactive:"bg-gray-100 text-gray-800"};return e.jsx(j,{className:w[s]||"bg-gray-100 text-gray-800",children:s})},m=s=>s>=90?"text-green-600":s>=75?"text-yellow-600":s===0?"text-gray-500":"text-red-600",r={totalRoutes:o.total,activeRoutes:o.active,totalPassengers:0,totalRevenue:0};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-3",children:[e.jsx(d,{className:"w-8 h-8 text-blue-600"}),"Route Planning & Optimization"]}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Plan, optimize, and manage transport routes"})]}),e.jsxs(D,{open:N,onOpenChange:f,children:[e.jsx(T,{asChild:!0,children:e.jsxs(a,{className:"bg-blue-600 hover:bg-blue-700",children:[e.jsx(U,{className:"w-4 h-4 mr-2"}),"Create Route"]})}),e.jsxs(E,{className:"max-w-2xl",children:[e.jsx(P,{children:e.jsx(z,{children:"Create New Route"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(t,{htmlFor:"route-name",children:"Route Name"}),e.jsx(n,{id:"route-name",placeholder:"Enter route name"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(t,{htmlFor:"route-type",children:"Route Type"}),e.jsxs(_,{children:[e.jsx(q,{children:e.jsx(A,{placeholder:"Select type"})}),e.jsxs(H,{children:[e.jsx(c,{value:"school_transport",children:"School Transport"}),e.jsx(c,{value:"medical",children:"Medical Transport"}),e.jsx(c,{value:"charter",children:"Charter Service"}),e.jsx(c,{value:"regular",children:"Regular Service"})]})]})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"max-passengers",children:"Max Passengers"}),e.jsx(n,{id:"max-passengers",type:"number",placeholder:"0"})]})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"start-location",children:"Start Location"}),e.jsx(n,{id:"start-location",placeholder:"Enter start address"})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"end-location",children:"End Location"}),e.jsx(n,{id:"end-location",placeholder:"Enter end address"})]}),e.jsx(a,{className:"w-full bg-blue-600 hover:bg-blue-700",children:"Create Route"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsx(l,{children:e.jsx(i,{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(d,{className:"w-8 h-8 text-blue-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Routes"}),e.jsx("p",{className:"text-2xl font-bold",children:r.totalRoutes})]})]})})}),e.jsx(l,{children:e.jsx(i,{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(g,{className:"w-8 h-8 text-green-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Active Routes"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:r.activeRoutes})]})]})})}),e.jsx(l,{children:e.jsx(i,{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(F,{className:"w-8 h-8 text-purple-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Passengers"}),e.jsx("p",{className:"text-2xl font-bold",children:r.totalPassengers})]})]})})}),e.jsx(l,{children:e.jsx(i,{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(L,{className:"w-8 h-8 text-green-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Revenue"}),e.jsxs("p",{className:"text-2xl font-bold",children:["£",r.totalRevenue.toFixed(2)]})]})]})})})]}),e.jsxs(l,{children:[e.jsx(O,{children:e.jsxs($,{className:"flex items-center gap-2",children:[e.jsx(d,{className:"w-5 h-5"}),"Route Management"]})}),e.jsx(i,{children:e.jsx("div",{className:"space-y-4",children:y.map(s=>e.jsxs("div",{className:"border rounded-lg p-4 hover:bg-gray-50",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsx("div",{children:e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h3",{className:"font-semibold text-lg",children:s.name}),R(s.status),s.efficiency>0&&e.jsxs(j,{variant:"outline",className:m(s.efficiency),children:[s.efficiency,"% Efficient"]})]})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(a,{variant:"outline",size:"sm",children:e.jsx(B,{className:"w-4 h-4"})}),e.jsx(a,{variant:"outline",size:"sm",children:e.jsx(V,{className:"w-4 h-4"})}),e.jsx(a,{variant:"outline",size:"sm",children:e.jsx(Y,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Distance:"}),e.jsx("p",{className:"font-medium",children:s.distance})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Passengers:"}),e.jsx("p",{className:"font-medium",children:s.passengers})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Revenue:"}),e.jsxs("p",{className:"font-medium text-green-600",children:["£",s.revenue.toFixed(2)]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Efficiency:"}),e.jsx("p",{className:`font-medium ${m(s.efficiency)}`,children:s.efficiency>0?`${s.efficiency}%`:"Not optimized"})]})]}),e.jsx("div",{className:"flex items-center justify-between mt-4 pt-4 border-t",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(a,{size:"sm",variant:"outline",children:[e.jsx(I,{className:"w-4 h-4 mr-1"}),"Configure"]}),e.jsxs(a,{size:"sm",className:"bg-blue-600 hover:bg-blue-700",children:[e.jsx(g,{className:"w-4 h-4 mr-1"}),"Optimize"]})]})})]},s.id))})})]})]})};export{te as default};
