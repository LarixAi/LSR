import{q as H,r as n,j as e,N as O,R as g,D as U,b as q,B as r,d as $,e as K,f as Y,Y as u,I as h,i as c,n as d,K as G,a1 as J,k as Q,l as W,M as X,T as Z,U as ee,a0 as se,E as v}from"./main-piTIAPSx.js";import{S as N,a as b,b as f,c as y,d as a}from"./select-Brm_N20Q.js";import{T as ae,a as te,b as w,c as t,d as le,e as l}from"./table-CV1HM_JF.js";import{u as ie,a as ne,b as re}from"./useRoutes-vLWA0XVf.js";import{P as ce}from"./plus-CMGcTuiR.js";import{N as S}from"./navigation-D0f2KySn.js";import{S as de}from"./search-HDsNrIL9.js";import{S as xe}from"./square-pen-DnuZJKej.js";import{C as oe}from"./copy-BKc1aBN8.js";import"./index-Pp_niZQ8.js";import"./useQuery-Dbdyc74j.js";import"./useMutation-B8vlA97s.js";const Re=()=>{const{user:C,profile:R,loading:T}=H(),[x,D]=n.useState(""),[m,L]=n.useState("all"),[j,F]=n.useState("all"),[A,_]=n.useState(!1);n.useState({name:"",start_location:"",end_location:"",distance:0,estimated_time:0,status:"active"});const{data:k=[],isLoading:E,error:he}=ie(),p=ne();if(re(),T||E)return e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-primary mb-4"}),e.jsx("p",{className:"text-lg",children:"Loading route management..."})]})});if(!C||!R)return e.jsx(O,{to:"/auth",replace:!0});const B=k.map(s=>({id:s.id,name:s.name||`${s.start_location} → ${s.end_location}`,type:"school",origin:s.start_location||"Unknown",destination:s.end_location||"Unknown",distance:s.distance||0,stops:0,assignedVehicle:void 0,assignedDriver:void 0,status:s.status==="active"?"active":"inactive",students:void 0,revenue:0})),M=s=>{const i={active:"bg-green-100 text-green-800",inactive:"bg-gray-100 text-gray-800",planned:"bg-blue-100 text-blue-800",completed:"bg-purple-100 text-purple-800"};return e.jsx(v,{className:i[s]||"bg-gray-100 text-gray-800",children:s})},V=s=>{const i={school:"bg-yellow-100 text-yellow-800",medical:"bg-red-100 text-red-800",charter:"bg-purple-100 text-purple-800",corporate:"bg-blue-100 text-blue-800"};return e.jsx(v,{className:i[s]||"bg-gray-100 text-gray-800",children:s})},I=B.filter(s=>{const i=s.name.toLowerCase().includes(x.toLowerCase())||s.origin.toLowerCase().includes(x.toLowerCase())||s.destination.toLowerCase().includes(x.toLowerCase()),P=m==="all"||s.status===m,z=j==="all"||s.type===j;return i&&P&&z}),o={totalRoutes:p.total,activeRoutes:p.active,totalRevenue:0,totalDistance:p.total_distance||0};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-3",children:[e.jsx(g,{className:"w-8 h-8 text-blue-600"}),"Route Management"]}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Manage and optimize transportation routes"})]}),e.jsxs(U,{open:A,onOpenChange:_,children:[e.jsx(q,{asChild:!0,children:e.jsxs(r,{className:"bg-blue-600 hover:bg-blue-700",children:[e.jsx(ce,{className:"w-4 h-4 mr-2"}),"Create Route"]})}),e.jsxs($,{className:"max-w-2xl",children:[e.jsx(K,{children:e.jsx(Y,{children:"Create New Route"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(u,{htmlFor:"route-name",children:"Route Name"}),e.jsx(h,{id:"route-name",placeholder:"Enter route name"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(u,{htmlFor:"origin",children:"Origin"}),e.jsx(h,{id:"origin",placeholder:"Starting location"})]}),e.jsxs("div",{children:[e.jsx(u,{htmlFor:"destination",children:"Destination"}),e.jsx(h,{id:"destination",placeholder:"End location"})]})]}),e.jsx(r,{className:"w-full bg-blue-600 hover:bg-blue-700",children:"Create Route"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsx(c,{children:e.jsx(d,{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(g,{className:"w-8 h-8 text-blue-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Routes"}),e.jsx("p",{className:"text-2xl font-bold",children:o.totalRoutes})]})]})})}),e.jsx(c,{children:e.jsx(d,{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(G,{className:"w-8 h-8 text-green-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Active Routes"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:o.activeRoutes})]})]})})}),e.jsx(c,{children:e.jsx(d,{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(J,{className:"w-8 h-8 text-emerald-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Revenue"}),e.jsxs("p",{className:"text-2xl font-bold text-emerald-600",children:["£",o.totalRevenue.toLocaleString()]})]})]})})}),e.jsx(c,{children:e.jsx(d,{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(S,{className:"w-8 h-8 text-purple-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Distance"}),e.jsxs("p",{className:"text-2xl font-bold text-purple-600",children:[o.totalDistance.toFixed(1)," km"]})]})]})})})]}),e.jsxs(c,{children:[e.jsxs(Q,{children:[e.jsxs(W,{className:"flex items-center gap-2",children:[e.jsx(g,{className:"w-5 h-5"}),"Route Management"]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(de,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx(h,{placeholder:"Search routes...",value:x,onChange:s=>D(s.target.value),className:"pl-10"})]}),e.jsxs(N,{value:m,onValueChange:L,children:[e.jsx(b,{className:"w-48",children:e.jsx(f,{})}),e.jsxs(y,{children:[e.jsx(a,{value:"all",children:"All Status"}),e.jsx(a,{value:"active",children:"Active"}),e.jsx(a,{value:"inactive",children:"Inactive"}),e.jsx(a,{value:"planned",children:"Planned"})]})]}),e.jsxs(N,{value:j,onValueChange:F,children:[e.jsx(b,{className:"w-48",children:e.jsx(f,{})}),e.jsxs(y,{children:[e.jsx(a,{value:"all",children:"All Types"}),e.jsx(a,{value:"school",children:"School Transport"}),e.jsx(a,{value:"medical",children:"Medical Transport"}),e.jsx(a,{value:"charter",children:"Charter Service"}),e.jsx(a,{value:"corporate",children:"Corporate Shuttle"})]})]})]})]}),e.jsx(d,{children:e.jsxs(ae,{children:[e.jsx(te,{children:e.jsxs(w,{children:[e.jsx(t,{children:"Route Name"}),e.jsx(t,{children:"Type"}),e.jsx(t,{children:"Route"}),e.jsx(t,{children:"Distance"}),e.jsx(t,{children:"Stops"}),e.jsx(t,{children:"Assigned"}),e.jsx(t,{children:"Status"}),e.jsx(t,{children:"Revenue"}),e.jsx(t,{children:"Actions"})]})}),e.jsx(le,{children:I.map(s=>e.jsxs(w,{children:[e.jsx(l,{children:e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s.name}),e.jsx("p",{className:"text-sm text-gray-500",children:s.id})]})}),e.jsx(l,{children:V(s.type)}),e.jsx(l,{children:e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(X,{className:"w-4 h-4 text-gray-400"}),e.jsxs("span",{className:"truncate",children:[s.origin," → ",s.destination]})]})}),e.jsx(l,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(S,{className:"w-4 h-4 text-gray-400"}),e.jsxs("span",{children:[s.distance," km"]})]})}),e.jsx(l,{children:s.stops}),e.jsx(l,{children:e.jsxs("div",{className:"text-sm",children:[s.assignedVehicle&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Z,{className:"w-3 h-3 text-gray-400"}),e.jsx("span",{children:s.assignedVehicle})]}),s.assignedDriver&&e.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[e.jsx(ee,{className:"w-3 h-3 text-gray-400"}),e.jsx("span",{children:s.assignedDriver})]})]})}),e.jsx(l,{children:M(s.status)}),e.jsx(l,{children:e.jsxs("span",{className:"font-medium",children:["£",s.revenue]})}),e.jsx(l,{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(r,{variant:"outline",size:"sm",children:e.jsx(se,{className:"w-4 h-4"})}),e.jsx(r,{variant:"outline",size:"sm",children:e.jsx(xe,{className:"w-4 h-4"})}),e.jsx(r,{variant:"outline",size:"sm",children:e.jsx(oe,{className:"w-4 h-4"})})]})})]},s.id))})]})})]})]})};export{Re as default};
