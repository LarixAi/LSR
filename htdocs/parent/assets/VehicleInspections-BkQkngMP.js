var Ae=Object.defineProperty;var De=(c,d,l)=>d in c?Ae(c,d,{enumerable:!0,configurable:!0,writable:!0,value:l}):c[d]=l;var ye=(c,d,l)=>De(c,typeof d!="symbol"?d+"":d,l);import{q as se,s as H,J as Ee,$ as ve,r as f,j as e,B as p,a as Ve,i as w,k as M,l as q,X as be,n as _,Y as Z,E as T,H as Q,ay as Le,F as Pe,I as Me,C as qe,v as Ne,a0 as Oe,D as Re,d as Be,e as He,f as Qe,g as We,a6 as Je}from"./main-piTIAPSx.js";import{S as W,a as J,b as K,c as z,d as m}from"./select-Brm_N20Q.js";import{T as Ke,a as ze,b as B,c as Ge}from"./tabs-N5TLptOb.js";import{u as we}from"./useQuery-Dbdyc74j.js";import{u as Ye}from"./useMutation-B8vlA97s.js";import{C as X}from"./circle-alert-9v4QUdZ6.js";import{T as _e}from"./textarea-mxcr8nPj.js";import{b as Ue}from"./useVehicles-C0CqQMfj.js";import{C as Ce}from"./car-B9KPzxYH.js";import{C as ee}from"./circle-check-big-CD0jvDn0.js";import{P as Xe}from"./plus-CMGcTuiR.js";import{S as $e}from"./search-HDsNrIL9.js";import{D as Se}from"./download-C4W0Vf38.js";import{f as P}from"./format-VbeFDANp.js";import"./index-Pp_niZQ8.js";const Ze=(c,d)=>{const{profile:l}=se(),{data:j=[],isLoading:y,error:S}=we({queryKey:["vehicle-inspections",c,d],queryFn:async()=>{if(!c)return[];try{let g=H.from("vehicle_inspections").select("*").order("created_at",{ascending:!1});d&&(g=g.eq("driver_id",d));const{data:t,error:b}=await g;if(b)return console.error("Error fetching vehicle inspections:",b),[];if(!t||t.length===0)return[];const a=[...new Set(t.map(h=>h.vehicle_id).filter(Boolean))],i=[...new Set(t.map(h=>h.driver_id).filter(Boolean))],[N,k]=await Promise.all([a.length>0?H.from("vehicles").select("id, vehicle_number, make, model, license_plate").in("id",a).eq("organization_id",c):{data:[]},i.length>0?H.from("profiles").select("id, first_name, last_name").in("id",i).eq("organization_id",c):{data:[]}]),F=new Map((N.data||[]).map(h=>[h.id,h])),C=new Map((k.data||[]).map(h=>[h.id,h]));return t.map(h=>({...h,vehicle:F.get(h.vehicle_id),driver:C.get(h.driver_id)}))}catch(g){return console.error("Error in vehicle inspections query:",g),[]}},enabled:!!c&&!!(l!=null&&l.id)}),{data:v}=we({queryKey:["vehicle-inspection-stats",c,d],queryFn:async()=>{if(!c)return null;try{let g=H.from("vehicle_inspections").select("status, inspection_type, defects_found, created_at");d&&(g=g.eq("driver_id",d));const{data:t,error:b}=await g;return b?(console.error("Error fetching inspection stats:",b),null):{total:(t==null?void 0:t.length)||0,byStatus:{pending:(t==null?void 0:t.filter(i=>i.status==="pending").length)||0,passed:(t==null?void 0:t.filter(i=>i.status==="passed").length)||0,flagged:(t==null?void 0:t.filter(i=>i.status==="flagged").length)||0,failed:(t==null?void 0:t.filter(i=>i.status==="failed").length)||0},byType:{daily_check:(t==null?void 0:t.filter(i=>i.inspection_type==="daily_check").length)||0,pre_trip:(t==null?void 0:t.filter(i=>i.inspection_type==="pre_trip").length)||0,post_trip:(t==null?void 0:t.filter(i=>i.inspection_type==="post_trip").length)||0,weekly:(t==null?void 0:t.filter(i=>i.inspection_type==="weekly").length)||0,monthly:(t==null?void 0:t.filter(i=>i.inspection_type==="monthly").length)||0,initial:(t==null?void 0:t.filter(i=>i.inspection_type==="initial").length)||0,recheck:(t==null?void 0:t.filter(i=>i.inspection_type==="recheck").length)||0,breakdown:(t==null?void 0:t.filter(i=>i.inspection_type==="breakdown").length)||0},defectsFound:(t==null?void 0:t.filter(i=>i.defects_found).length)||0,recentInspections:(t==null?void 0:t.filter(i=>{const N=new Date;return N.setDate(N.getDate()-7),new Date(i.created_at)>=N}).length)||0}}catch(g){return console.error("Error calculating inspection stats:",g),null}},enabled:!!c});return{inspections:j,isLoading:y,error:S,inspectionStats:v}},es=()=>{const c=Ee(),{profile:d}=se();return Ye({mutationFn:async l=>{const j={driver_id:d==null?void 0:d.id,vehicle_id:l.vehicle_id,inspection_type:l.inspection_type,inspection_date:new Date().toISOString().split("T")[0],start_time:new Date().toISOString(),overall_status:l.overall_status||"pending",defects_found:l.defects_found||!1,notes:l.notes||"",walkaround_data:l.walkaround_data||{},location_data:l.location_data||{},signature_data:l.signature_data||null},{data:y,error:S}=await H.from("vehicle_inspections").insert(j).select().single();if(S)throw S;return y},onSuccess:()=>{c.invalidateQueries({queryKey:["vehicle-inspections"]}),c.invalidateQueries({queryKey:["vehicle-inspection-stats"]}),ve.success("Inspection submitted successfully")},onError:l=>{console.error("Error submitting inspection:",l),ve.error("Failed to submit inspection")}})};class Ie extends f.Component{constructor(l){super(l);ye(this,"handleReset",()=>{this.setState({hasError:!1,error:void 0,errorInfo:void 0})});this.state={hasError:!1}}static getDerivedStateFromError(l){return{hasError:!0,error:l}}componentDidCatch(l,j){console.error("Error caught by boundary:",l,j),this.setState({error:l,errorInfo:j})}render(){return this.state.hasError?this.props.fallback?this.props.fallback:e.jsx("div",{className:"flex items-center justify-center min-h-[200px] p-6",children:e.jsxs("div",{className:"text-center max-w-md",children:[e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx(X,{className:"h-12 w-12 text-red-500"})}),e.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Something went wrong"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"We encountered an unexpected error. Please try refreshing the page."}),e.jsxs("div",{className:"space-x-3",children:[e.jsx(p,{onClick:this.handleReset,variant:"outline",children:"Try Again"}),e.jsx(p,{onClick:()=>window.location.reload(),variant:"default",children:"Refresh Page"})]}),!1]})}):this.props.children}}const ke=[{category:"Safety",questions:[{id:"brakes",text:"Are the brakes functioning properly?",critical:!0},{id:"lights",text:"Are all lights working (headlights, taillights, indicators)?",critical:!0},{id:"mirrors",text:"Are all mirrors clean and properly adjusted?",critical:!1},{id:"seatbelts",text:"Are seatbelts in good condition?",critical:!0}]},{category:"Exterior",questions:[{id:"tires",text:"Are tires properly inflated with adequate tread?",critical:!0},{id:"windows",text:"Are windows clean and free of cracks?",critical:!1},{id:"bodywork",text:"Is the vehicle body free from significant damage?",critical:!1}]},{category:"Interior",questions:[{id:"dashboard",text:"Are all dashboard warning lights off?",critical:!0},{id:"steering",text:"Is the steering responsive and aligned?",critical:!0},{id:"cleanliness",text:"Is the interior clean and professional?",critical:!1}]}],ss=({open:c,onOpenChange:d,onComplete:l})=>{const{toast:j}=Ve(),{data:y=[]}=Ue(),S=es(),[v,g]=f.useState(""),[t,b]=f.useState("initial"),[a,i]=f.useState({}),[N,k]=f.useState({}),[F,C]=f.useState(""),[I,h]=f.useState(!1),A=(r,n)=>{i(u=>({...u,[r]:n}))},$=(r,n)=>{k(u=>({...u,[r]:n}))},D=r=>{switch(r){case"pass":return"bg-green-100 text-green-800 border-green-300";case"fail":return"bg-red-100 text-red-800 border-red-300";case"flag":return"bg-yellow-100 text-yellow-800 border-yellow-300";default:return"bg-gray-100 text-gray-800 border-gray-300"}},G=r=>{switch(r){case"pass":return e.jsx(ee,{className:"w-4 h-4"});case"fail":return e.jsx(be,{className:"w-4 h-4"});case"flag":return e.jsx(Q,{className:"w-4 h-4"});default:return null}},E=()=>{const r=Object.values(a);return r.includes("fail")?"failed":r.includes("flag")?"flagged":r.length>0&&r.every(n=>n==="pass"||n==="n/a")?"passed":"pending"},o=async()=>{if(!v){j({title:"Vehicle Required",description:"Please select a vehicle for the inspection.",variant:"destructive"});return}if(ke.flatMap(n=>n.questions).filter(n=>!a[n.id]).length>0){j({title:"Incomplete Inspection",description:"Please answer all inspection questions before submitting.",variant:"destructive"});return}h(!0);try{const n={vehicle_id:v,inspection_type:t,notes:F||void 0,defects_found:Object.values(a).includes("fail"),overall_status:E()};await S.mutateAsync(n),j({title:"Inspection Submitted",description:"Smart inspection has been completed successfully."}),g(""),i({}),k({}),C(""),d(!1),l==null||l()}catch(n){j({title:"Submission Failed",description:n.message||"Failed to submit inspection.",variant:"destructive"})}finally{h(!1)}};return c?e.jsx(Ie,{children:e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:e.jsx("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-auto",children:e.jsxs(w,{className:"border-0 shadow-none",children:[e.jsx(M,{className:"border-b",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(q,{className:"text-2xl",children:"Smart Vehicle Inspection"}),e.jsx("p",{className:"text-muted-foreground",children:"Comprehensive digital inspection with automated scoring"})]}),e.jsx(p,{variant:"outline",onClick:()=>d(!1),children:e.jsx(be,{className:"w-4 h-4"})})]})}),e.jsxs(_,{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(Z,{htmlFor:"vehicle",children:"Vehicle *"}),e.jsxs(W,{value:v,onValueChange:g,children:[e.jsx(J,{children:e.jsx(K,{placeholder:"Select a vehicle"})}),e.jsx(z,{children:y.map(r=>e.jsx(m,{value:r.id,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ce,{className:"w-4 h-4"}),r.license_plate," - ",r.make," ",r.model]})},r.id))})]})]}),e.jsxs("div",{children:[e.jsx(Z,{htmlFor:"type",children:"Inspection Type"}),e.jsxs(W,{value:t,onValueChange:r=>b(r),children:[e.jsx(J,{children:e.jsx(K,{})}),e.jsxs(z,{children:[e.jsx(m,{value:"initial",children:"Initial Inspection"}),e.jsx(m,{value:"recheck",children:"Re-check Inspection"}),e.jsx(m,{value:"breakdown",children:"Breakdown Inspection"})]})]})]})]}),ke.map(r=>e.jsxs(w,{children:[e.jsx(M,{className:"pb-4",children:e.jsx(q,{className:"text-lg",children:r.category})}),e.jsx(_,{className:"space-y-4",children:r.questions.map(n=>e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsx("div",{className:"flex items-start justify-between mb-3",children:e.jsx("div",{className:"flex-1",children:e.jsxs("p",{className:"font-medium",children:[n.text,n.critical&&e.jsx(T,{variant:"destructive",className:"ml-2 text-xs",children:"Critical"})]})})}),e.jsx("div",{className:"flex gap-2 mb-3",children:["pass","fail","flag","n/a"].map(u=>e.jsxs(p,{variant:a[n.id]===u?"default":"outline",size:"sm",onClick:()=>A(n.id,u),className:a[n.id]===u?D(u):"",children:[G(u),e.jsx("span",{className:"ml-1 capitalize",children:u==="n/a"?"N/A":u})]},u))}),(a[n.id]==="fail"||a[n.id]==="flag")&&e.jsx(_e,{placeholder:"Add notes for this issue...",value:N[n.id]||"",onChange:u=>$(n.id,u.target.value),className:"mt-2"})]},n.id))})]},r.category)),e.jsxs("div",{children:[e.jsx(Z,{htmlFor:"notes",children:"General Notes"}),e.jsx(_e,{id:"notes",placeholder:"Add any additional notes or observations...",value:F,onChange:r=>C(r.target.value)})]}),Object.keys(a).length>0&&e.jsx(w,{className:"bg-gray-50",children:e.jsxs(_,{className:"p-4",children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Inspection Summary"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(T,{className:D(E()),children:[G(E()),e.jsx("span",{className:"ml-1 capitalize",children:E()})]}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[Object.values(a).filter(r=>r==="pass").length," Passed •"," ",Object.values(a).filter(r=>r==="fail").length," Failed •"," ",Object.values(a).filter(r=>r==="flag").length," Flagged"]})]})]})}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[e.jsx(p,{variant:"outline",onClick:()=>d(!1),children:"Cancel"}),e.jsx(p,{onClick:o,disabled:I,children:I?"Submitting...":"Submit Inspection"})]})]})]})})})}):null},ts=()=>{var ae,le,re,ie,ne,ce;const{profile:c}=se(),{selectedOrganizationId:d}=Le(),[l,j]=f.useState(""),[y,S]=f.useState("all"),[v,g]=f.useState("all"),[t,b]=f.useState("all"),[a,i]=f.useState(null),[N,k]=f.useState(!1),[F,C]=f.useState(!1),[I,h]=f.useState("all"),A=(c==null?void 0:c.role)==="driver",$=A?c==null?void 0:c.id:void 0,{inspections:D,isLoading:G,error:E,inspectionStats:o}=Ze(d,$),r=s=>{switch(s){case"passed":return e.jsx(ee,{className:"w-4 h-4 text-green-600"});case"failed":return e.jsx(X,{className:"w-4 h-4 text-red-600"});case"flagged":return e.jsx(Q,{className:"w-4 h-4 text-yellow-600"});default:return e.jsx(Ne,{className:"w-4 h-4 text-gray-600"})}},n=s=>{const x={passed:"bg-green-100 text-green-800 border-green-200",failed:"bg-red-100 text-red-800 border-red-200",flagged:"bg-yellow-100 text-yellow-800 border-yellow-200",pending:"bg-gray-100 text-gray-800 border-gray-200"};return x[s]||x.pending},u=s=>({daily_check:"bg-blue-100 text-blue-800 border-blue-200",pre_trip:"bg-purple-100 text-purple-800 border-purple-200",post_trip:"bg-indigo-100 text-indigo-800 border-indigo-200",weekly:"bg-cyan-100 text-cyan-800 border-cyan-200",monthly:"bg-teal-100 text-teal-800 border-teal-200",initial:"bg-orange-100 text-orange-800 border-orange-200",recheck:"bg-pink-100 text-pink-800 border-pink-200",breakdown:"bg-red-100 text-red-800 border-red-200"})[s]||"bg-gray-100 text-gray-800 border-gray-200",V=D.filter(s=>{var O,R,de,oe,me,xe,he,ue,ge,fe,je,pe;const x=!l||((R=(O=s.vehicle)==null?void 0:O.vehicle_number)==null?void 0:R.toLowerCase().includes(l.toLowerCase()))||((oe=(de=s.vehicle)==null?void 0:de.make)==null?void 0:oe.toLowerCase().includes(l.toLowerCase()))||((xe=(me=s.vehicle)==null?void 0:me.model)==null?void 0:xe.toLowerCase().includes(l.toLowerCase()))||((ue=(he=s.vehicle)==null?void 0:he.license_plate)==null?void 0:ue.toLowerCase().includes(l.toLowerCase()))||((fe=(ge=s.driver)==null?void 0:ge.first_name)==null?void 0:fe.toLowerCase().includes(l.toLowerCase()))||((pe=(je=s.driver)==null?void 0:je.last_name)==null?void 0:pe.toLowerCase().includes(l.toLowerCase())),L=y==="all"||s.status===y,Y=v==="all"||s.inspection_type===v,U=t==="all"||s.driver_id===t;return x&&L&&Y&&U}),Te=Array.from(new Set(D.map(s=>s.driver_id))).map(s=>{var x;return(x=D.find(L=>L.driver_id===s))==null?void 0:x.driver}).filter(Boolean),te=s=>{switch(s){case"pending":return V.filter(x=>x.status==="pending");case"passed":return V.filter(x=>x.status==="passed");case"flagged":return V.filter(x=>x.status==="flagged");case"failed":return V.filter(x=>x.status==="failed");default:return V}},Fe=s=>{i(s),C(!0)};return G?e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto"}),e.jsx("p",{className:"text-muted-foreground",children:"Loading inspections..."})]})}):E?e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx(X,{className:"h-12 w-12 text-red-500 mx-auto"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Error Loading Inspections"}),e.jsx("p",{className:"text-gray-600",children:"Failed to load vehicle inspections. Please try again."})]})}):e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Vehicle Inspections"}),e.jsx("p",{className:"text-gray-600 mt-2",children:A?"Your vehicle inspection history":"All vehicle inspections by drivers"})]}),!A&&e.jsxs(p,{onClick:()=>k(!0),children:[e.jsx(Xe,{className:"h-4 w-4 mr-2"}),"New Inspection"]})]}),o&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[e.jsxs(w,{children:[e.jsxs(M,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(q,{className:"text-sm font-medium",children:"Total Inspections"}),e.jsx(Pe,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold",children:o.total}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[o.recentInspections," in last 7 days"]})]})]}),e.jsxs(w,{children:[e.jsxs(M,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(q,{className:"text-sm font-medium",children:"Passed Inspections"}),e.jsx(ee,{className:"h-4 w-4 text-green-600"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:o.byStatus.passed}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[o.total>0?Math.round(o.byStatus.passed/o.total*100):0,"% pass rate"]})]})]}),e.jsxs(w,{children:[e.jsxs(M,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(q,{className:"text-sm font-medium",children:"Defects Found"}),e.jsx(Q,{className:"h-4 w-4 text-yellow-600"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:o.defectsFound}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Require attention"})]})]}),e.jsxs(w,{children:[e.jsxs(M,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(q,{className:"text-sm font-medium",children:"Failed Inspections"}),e.jsx(X,{className:"h-4 w-4 text-red-600"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:o.byStatus.failed}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Critical issues"})]})]})]}),e.jsx(w,{className:"mb-6",children:e.jsx(_,{className:"p-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Search"}),e.jsxs("div",{className:"relative",children:[e.jsx($e,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(Me,{placeholder:"Search inspections...",value:l,onChange:s=>j(s.target.value),className:"pl-10"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Status"}),e.jsxs(W,{value:y,onValueChange:S,children:[e.jsx(J,{children:e.jsx(K,{placeholder:"All statuses"})}),e.jsxs(z,{children:[e.jsx(m,{value:"all",children:"All Statuses"}),e.jsx(m,{value:"pending",children:"Pending"}),e.jsx(m,{value:"passed",children:"Passed"}),e.jsx(m,{value:"flagged",children:"Flagged"}),e.jsx(m,{value:"failed",children:"Failed"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Type"}),e.jsxs(W,{value:v,onValueChange:g,children:[e.jsx(J,{children:e.jsx(K,{placeholder:"All types"})}),e.jsxs(z,{children:[e.jsx(m,{value:"all",children:"All Types"}),e.jsx(m,{value:"daily_check",children:"Daily Check"}),e.jsx(m,{value:"pre_trip",children:"Pre-Trip"}),e.jsx(m,{value:"post_trip",children:"Post-Trip"}),e.jsx(m,{value:"weekly",children:"Weekly"}),e.jsx(m,{value:"monthly",children:"Monthly"}),e.jsx(m,{value:"initial",children:"Initial"}),e.jsx(m,{value:"recheck",children:"Recheck"}),e.jsx(m,{value:"breakdown",children:"Breakdown"})]})]})]}),!A&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Driver"}),e.jsxs(W,{value:t,onValueChange:b,children:[e.jsx(J,{children:e.jsx(K,{placeholder:"All drivers"})}),e.jsxs(z,{children:[e.jsx(m,{value:"all",children:"All Drivers"}),Te.map(s=>e.jsxs(m,{value:(s==null?void 0:s.id)||"",children:[s==null?void 0:s.first_name," ",s==null?void 0:s.last_name]},s==null?void 0:s.id))]})]})]})]})})}),e.jsxs(Ke,{value:I,onValueChange:h,className:"space-y-6",children:[e.jsxs(ze,{className:"grid w-full grid-cols-5",children:[e.jsxs(B,{value:"all",children:["All (",V.length,")"]}),e.jsxs(B,{value:"pending",children:["Pending (",(o==null?void 0:o.byStatus.pending)||0,")"]}),e.jsxs(B,{value:"passed",children:["Passed (",(o==null?void 0:o.byStatus.passed)||0,")"]}),e.jsxs(B,{value:"flagged",children:["Flagged (",(o==null?void 0:o.byStatus.flagged)||0,")"]}),e.jsxs(B,{value:"failed",children:["Failed (",(o==null?void 0:o.byStatus.failed)||0,")"]})]}),e.jsx(Ge,{value:I,className:"space-y-6",children:te(I).length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Ce,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Inspections Found"}),e.jsx("p",{className:"text-gray-600",children:l||y!=="all"||v!=="all"||t!=="all"?"No inspections match your current filters":"No vehicle inspections found. Start by conducting your first inspection."})]}):e.jsx("div",{className:"space-y-4",children:te(I).map(s=>{var x,L,Y,U,O,R;return e.jsx(w,{className:"hover:shadow-md transition-shadow",children:e.jsx(_,{className:"p-6",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[e.jsxs("h3",{className:"text-lg font-semibold",children:[(x=s.vehicle)==null?void 0:x.vehicle_number," - ",(L=s.vehicle)==null?void 0:L.make," ",(Y=s.vehicle)==null?void 0:Y.model]}),e.jsxs(T,{className:n(s.status),children:[r(s.status),s.status]}),e.jsx(T,{className:u(s.inspection_type),children:s.inspection_type.replace("_"," ")}),s.defects_found&&e.jsxs(T,{className:"bg-red-100 text-red-800 border-red-200",children:[e.jsx(Q,{className:"h-3 w-3 mr-1"}),"Defects Found"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 text-sm text-gray-600 mb-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Driver:"})," ",(U=s.driver)==null?void 0:U.first_name," ",(O=s.driver)==null?void 0:O.last_name]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Date:"})," ",s.inspection_date?P(new Date(s.inspection_date),"MMM dd, yyyy"):"N/A"]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Time:"})," ",s.start_time?P(new Date(s.start_time),"HH:mm"):"N/A"]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"License Plate:"})," ",(R=s.vehicle)==null?void 0:R.license_plate]})]}),s.notes&&e.jsx("p",{className:"text-gray-700 mb-4",children:s.notes}),e.jsxs("div",{className:"flex items-center space-x-4 text-sm",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(qe,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{className:"text-gray-600",children:s.created_at?P(new Date(s.created_at),"MMM dd, yyyy HH:mm"):"N/A"})]}),s.end_time&&s.start_time&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Ne,{className:"h-4 w-4 text-gray-400"}),e.jsxs("span",{className:"text-gray-600",children:["Duration: ",Math.round((new Date(s.end_time).getTime()-new Date(s.start_time).getTime())/6e4)," min"]})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2 ml-4",children:[e.jsx(p,{variant:"outline",size:"sm",onClick:()=>Fe(s),children:e.jsx(Oe,{className:"h-4 w-4"})}),e.jsx(p,{variant:"outline",size:"sm",children:e.jsx(Se,{className:"h-4 w-4"})})]})]})})},s.id)})})})]}),e.jsx(Re,{open:F,onOpenChange:C,children:e.jsxs(Be,{className:"max-w-2xl",children:[e.jsxs(He,{children:[e.jsx(Qe,{children:"Inspection Details"}),e.jsx(We,{children:"View complete inspection information"})]}),a&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Vehicle"}),e.jsxs("p",{className:"text-lg font-medium",children:[(ae=a.vehicle)==null?void 0:ae.vehicle_number," - ",(le=a.vehicle)==null?void 0:le.make," ",(re=a.vehicle)==null?void 0:re.model]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"License Plate"}),e.jsx("p",{className:"text-lg font-medium",children:(ie=a.vehicle)==null?void 0:ie.license_plate})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Driver"}),e.jsxs("p",{className:"text-lg font-medium",children:[(ne=a.driver)==null?void 0:ne.first_name," ",(ce=a.driver)==null?void 0:ce.last_name]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Status"}),e.jsxs(T,{className:n(a.status),children:[r(a.status),a.status]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Type"}),e.jsx(T,{className:u(a.inspection_type),children:a.inspection_type.replace("_"," ")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Date"}),e.jsx("p",{className:"text-lg font-medium",children:a.inspection_date?P(new Date(a.inspection_date),"MMM dd, yyyy"):"N/A"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Start Time"}),e.jsx("p",{className:"text-lg font-medium",children:a.start_time?P(new Date(a.start_time),"HH:mm"):"N/A"})]}),a.end_time&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"End Time"}),e.jsx("p",{className:"text-lg font-medium",children:a.end_time?P(new Date(a.end_time),"HH:mm"):"N/A"})]})]}),a.defects_found&&e.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Q,{className:"h-5 w-5 text-red-600"}),e.jsx("span",{className:"font-medium text-red-800",children:"Defects Found"})]}),e.jsx("p",{className:"text-red-700 mt-2",children:"This inspection identified defects that require attention."})]}),a.notes&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Notes"}),e.jsx("p",{className:"text-gray-700 mt-1",children:a.notes})]}),a.walkaround_data&&Object.keys(a.walkaround_data).length>0&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Walkaround Data"}),e.jsx("pre",{className:"text-sm text-gray-700 mt-1 bg-gray-50 p-3 rounded border overflow-auto",children:JSON.stringify(a.walkaround_data,null,2)})]}),a.location_data&&Object.keys(a.location_data).length>0&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Location Data"}),e.jsx("pre",{className:"text-sm text-gray-700 mt-1 bg-gray-50 p-3 rounded border overflow-auto",children:JSON.stringify(a.location_data,null,2)})]})]}),e.jsxs(Je,{children:[e.jsx(p,{variant:"outline",onClick:()=>C(!1),children:"Close"}),e.jsxs(p,{children:[e.jsx(Se,{className:"h-4 w-4 mr-2"}),"Export Report"]})]})]})}),N&&e.jsx(Ie,{children:e.jsx(ss,{onClose:()=>k(!1),onSuccess:()=>{k(!1)}})})]})},ys=()=>e.jsx(ts,{});export{ys as default};
