import{z as H,j as e,D as le,d as te,e as ne,f as ce,g as de,E as A,Y as s,I as n,S as Z,Z as oe,v as he,F as xe,_ as fe,B as m,V as me,P as v,H as Y,W as G,i as _,k,l as R,m as W,n as w,$ as ee,r as se,u as ye,o as re,O as be}from"./main-piTIAPSx.js";import{P as ie}from"./progress-nJfMQ3MC.js";import{u as Ne,a as Ve,b as ue,c as je,d as Ce}from"./useVehicles-C0CqQMfj.js";import{T as we,a as ke,b as ae,c as E,d as Re,e as q}from"./table-CV1HM_JF.js";import{u as pe}from"./index.esm-DU9ozG4y.js";import{S as g,a as f,b as y,c as b,d as r}from"./select-Brm_N20Q.js";import{T as $}from"./textarea-mxcr8nPj.js";import{C as j}from"./checkbox-DqvkB_ze.js";import{T as Se,a as Fe,b as z,c as U}from"./tabs-N5TLptOb.js";import{C as D}from"./car-B9KPzxYH.js";import{C as T}from"./circle-check-big-CD0jvDn0.js";import{P as J}from"./plus-CMGcTuiR.js";import{S as Oe}from"./square-pen-DnuZJKej.js";import{T as Ae}from"./trash-2-CMjiaIVh.js";import{D as De}from"./database-BK6ac866.js";import"./useQuery-Dbdyc74j.js";import"./useMutation-B8vlA97s.js";import"./index-Pp_niZQ8.js";const ve=({vehicle:l,open:C,onOpenChange:N,onSuccess:p})=>{const d=Ne(),{register:o,handleSubmit:V,reset:x,setValue:t,watch:c,formState:{errors:u,isSubmitting:S}}=pe({defaultValues:{make:"",model:"",year:new Date().getFullYear(),license_plate:"",vehicle_number:"",vehicle_type:"bus",status:"active",vin:"",capacity:0,fuel_type:"Diesel",mileage:0,orv_off_road_reason:"",orv_expected_return_date:"",orv_location:"",orv_responsible_person:"",orv_insurance_status:"covered",orv_maintenance_type:"planned",bor_return_ready:!1,bor_safety_inspection_complete:!1,bor_documentation_verified:!1,bor_driver_assigned:!1,bor_quality_assurance_complete:!1,bor_return_authorization:"pending"}});H.useEffect(()=>{l&&x({make:l.make||"",model:l.model||"",year:l.year||new Date().getFullYear(),license_plate:l.license_plate||"",vehicle_number:l.vehicle_number||"",vehicle_type:l.type||"bus",status:l.status||"active",vin:l.vin||"",capacity:l.capacity||0,fuel_type:l.fuel_type||"Diesel",mileage:l.mileage||0,orv_off_road_reason:"",orv_expected_return_date:"",orv_location:"",orv_responsible_person:"",orv_insurance_status:"covered",orv_maintenance_type:"planned",bor_return_ready:!1,bor_safety_inspection_complete:!1,bor_documentation_verified:!1,bor_driver_assigned:!1,bor_quality_assurance_complete:!1,bor_return_authorization:"pending"})},[l,x]);const h=async i=>{if(l){if(!i.make.trim()){v({title:"Validation Error",description:"Make is required",variant:"destructive"});return}if(!i.model.trim()){v({title:"Validation Error",description:"Model is required",variant:"destructive"});return}if(!i.license_plate.trim()){v({title:"Validation Error",description:"License plate is required",variant:"destructive"});return}if(!i.vehicle_number.trim()){v({title:"Validation Error",description:"Vehicle number is required",variant:"destructive"});return}try{await d.mutateAsync({id:l.id,updates:{make:i.make,model:i.model,year:i.year,license_plate:i.license_plate,vehicle_number:i.vehicle_number,type:i.vehicle_type,status:i.status,capacity:i.capacity,fuel_type:i.fuel_type,mileage:i.mileage}}),v({title:"Success",description:"Vehicle updated successfully!"}),N(!1),p==null||p()}catch(M){console.error("Error updating vehicle:",M),v({title:"Error",description:"Failed to update vehicle. Please try again.",variant:"destructive"})}}},a=()=>{x(),N(!1)},F=(()=>{if(!l)return{status:"unknown",icon:e.jsx(D,{className:"w-4 h-4 text-gray-400"}),color:"gray"};switch(l.status){case"active":return{status:"Compliant",icon:e.jsx(T,{className:"w-4 h-4 text-green-600"}),color:"green"};case"maintenance":return{status:"ORV: Maintenance",icon:e.jsx(G,{className:"w-4 h-4 text-yellow-600"}),color:"yellow"};case"out_of_service":return{status:"ORV: Off Road",icon:e.jsx(Y,{className:"w-4 h-4 text-red-600"}),color:"red"};default:return{status:"Unknown",icon:e.jsx(D,{className:"w-4 h-4 text-gray-400"}),color:"gray"}}})();return l?e.jsx(le,{open:C,onOpenChange:a,children:e.jsxs(te,{className:"sm:max-w-[900px] max-h-[90vh] overflow-y-auto",children:[e.jsxs(ne,{children:[e.jsxs(ce,{className:"flex items-center gap-2",children:[e.jsx(D,{className:"h-5 w-5"}),"Edit Vehicle - ",l.vehicle_number]}),e.jsxs(de,{className:"flex items-center gap-2",children:["Update vehicle details and ORV & BOR compliance settings",e.jsxs(A,{variant:"outline",className:`text-${F.color}-600 border-${F.color}-200`,children:[F.icon,F.status]})]})]}),e.jsxs("form",{onSubmit:V(h),className:"space-y-6",children:[e.jsxs(Se,{defaultValue:"basic",className:"w-full",children:[e.jsxs(Fe,{className:"grid w-full grid-cols-4",children:[e.jsx(z,{value:"basic",children:"Basic Info"}),e.jsx(z,{value:"orv",children:"ORV Status"}),e.jsx(z,{value:"bor",children:"BOR Status"}),e.jsx(z,{value:"compliance",children:"Compliance"})]}),e.jsx(U,{value:"basic",className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(s,{htmlFor:"vehicle_number",children:"Vehicle Number"}),e.jsx(n,{id:"vehicle_number",placeholder:"e.g., BUS001",...o("vehicle_number",{required:!0})}),u.vehicle_number&&e.jsx("p",{className:"text-sm text-destructive mt-1",children:"Vehicle number is required"})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"license_plate",children:"License Plate"}),e.jsx(n,{id:"license_plate",placeholder:"e.g., LDN 001A",...o("license_plate",{required:!0})}),u.license_plate&&e.jsx("p",{className:"text-sm text-destructive mt-1",children:"License plate is required"})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"make",children:"Make"}),e.jsx(n,{id:"make",placeholder:"e.g., Mercedes",...o("make",{required:!0})}),u.make&&e.jsx("p",{className:"text-sm text-destructive mt-1",children:"Make is required"})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"model",children:"Model"}),e.jsx(n,{id:"model",placeholder:"e.g., Citaro",...o("model",{required:!0})}),u.model&&e.jsx("p",{className:"text-sm text-destructive mt-1",children:"Model is required"})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"year",children:"Year"}),e.jsx(n,{id:"year",type:"number",placeholder:"e.g., 2023",...o("year",{required:!0,valueAsNumber:!0,min:1900,max:new Date().getFullYear()+1})}),u.year&&e.jsx("p",{className:"text-sm text-destructive mt-1",children:"Valid year is required"})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"capacity",children:"Capacity"}),e.jsx(n,{id:"capacity",type:"number",placeholder:"e.g., 50",...o("capacity",{valueAsNumber:!0,min:1})})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"vehicle_type",children:"Vehicle Type"}),e.jsxs(g,{onValueChange:i=>t("vehicle_type",i),defaultValue:c("vehicle_type"),children:[e.jsx(f,{children:e.jsx(y,{placeholder:"Select vehicle type"})}),e.jsxs(b,{children:[e.jsx(r,{value:"bus",children:"Bus"}),e.jsx(r,{value:"coach",children:"Coach"}),e.jsx(r,{value:"hgv",children:"HGV"}),e.jsx(r,{value:"minibus",children:"Minibus"}),e.jsx(r,{value:"double_decker_bus",children:"Double Decker Bus"})]})]})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"status",children:"Status"}),e.jsxs(g,{onValueChange:i=>t("status",i),defaultValue:c("status"),children:[e.jsx(f,{children:e.jsx(y,{placeholder:"Select status"})}),e.jsxs(b,{children:[e.jsx(r,{value:"active",children:"Active"}),e.jsx(r,{value:"maintenance",children:"Maintenance"}),e.jsx(r,{value:"out_of_service",children:"Out of Service"})]})]})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"fuel_type",children:"Fuel Type"}),e.jsxs(g,{onValueChange:i=>t("fuel_type",i),defaultValue:c("fuel_type"),children:[e.jsx(f,{children:e.jsx(y,{placeholder:"Select fuel type"})}),e.jsxs(b,{children:[e.jsx(r,{value:"Diesel",children:"Diesel"}),e.jsx(r,{value:"Petrol",children:"Petrol"}),e.jsx(r,{value:"Electric",children:"Electric"}),e.jsx(r,{value:"Hybrid",children:"Hybrid"}),e.jsx(r,{value:"LPG",children:"LPG"})]})]})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"mileage",children:"Mileage"}),e.jsx(n,{id:"mileage",type:"number",placeholder:"e.g., 50000",...o("mileage",{valueAsNumber:!0,min:0})})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx(s,{htmlFor:"vin",children:"VIN (Optional)"}),e.jsx(n,{id:"vin",placeholder:"Vehicle Identification Number",...o("vin")})]})]})}),e.jsxs(U,{value:"orv",className:"space-y-4",children:[e.jsxs("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Z,{className:"h-4 w-4 text-orange-600"}),e.jsx("span",{className:"font-semibold text-orange-800",children:"ORV (Off-Road Vehicle) Management"})]}),e.jsx("p",{className:"text-sm text-orange-700",children:"Manage off-road vehicle status, documentation, and compliance requirements."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(s,{htmlFor:"orv_off_road_reason",children:"Reason for Off-Road Usage"}),e.jsx($,{id:"orv_off_road_reason",placeholder:"e.g., Scheduled maintenance, Emergency repairs, Operational requirements",...o("orv_off_road_reason")})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"orv_expected_return_date",children:"Expected Return Date"}),e.jsx(n,{id:"orv_expected_return_date",type:"date",...o("orv_expected_return_date")})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"orv_location",children:"Location of Off-Road Usage"}),e.jsx(n,{id:"orv_location",placeholder:"e.g., Maintenance facility, Storage location",...o("orv_location")})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"orv_responsible_person",children:"Responsible Person"}),e.jsx(n,{id:"orv_responsible_person",placeholder:"e.g., Fleet Manager, Maintenance Supervisor",...o("orv_responsible_person")})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"orv_insurance_status",children:"Insurance Status"}),e.jsxs(g,{onValueChange:i=>t("orv_insurance_status",i),defaultValue:c("orv_insurance_status"),children:[e.jsx(f,{children:e.jsx(y,{placeholder:"Select insurance status"})}),e.jsxs(b,{children:[e.jsx(r,{value:"covered",children:"Covered"}),e.jsx(r,{value:"suspended",children:"Suspended"}),e.jsx(r,{value:"expired",children:"Expired"})]})]})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"orv_maintenance_type",children:"Maintenance Type"}),e.jsxs(g,{onValueChange:i=>t("orv_maintenance_type",i),defaultValue:c("orv_maintenance_type"),children:[e.jsx(f,{children:e.jsx(y,{placeholder:"Select maintenance type"})}),e.jsxs(b,{children:[e.jsx(r,{value:"planned",children:"Planned"}),e.jsx(r,{value:"unplanned",children:"Unplanned"}),e.jsx(r,{value:"operational",children:"Operational"}),e.jsx(r,{value:"regulatory",children:"Regulatory"})]})]})]})]})]}),e.jsxs(U,{value:"bor",className:"space-y-4",children:[e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(oe,{className:"h-4 w-4 text-blue-600"}),e.jsx("span",{className:"font-semibold text-blue-800",children:"BOR (Back On Road) Management"})]}),e.jsx("p",{className:"text-sm text-blue-700",children:"Manage vehicle return to service process and compliance verification."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx("div",{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(j,{id:"bor_return_ready",checked:c("bor_return_ready"),onCheckedChange:i=>t("bor_return_ready",i)}),e.jsx(s,{htmlFor:"bor_return_ready",children:"Return Ready"})]})}),e.jsx("div",{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(j,{id:"bor_safety_inspection_complete",checked:c("bor_safety_inspection_complete"),onCheckedChange:i=>t("bor_safety_inspection_complete",i)}),e.jsx(s,{htmlFor:"bor_safety_inspection_complete",children:"Safety Inspection Complete"})]})}),e.jsx("div",{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(j,{id:"bor_documentation_verified",checked:c("bor_documentation_verified"),onCheckedChange:i=>t("bor_documentation_verified",i)}),e.jsx(s,{htmlFor:"bor_documentation_verified",children:"Documentation Verified"})]})}),e.jsx("div",{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(j,{id:"bor_driver_assigned",checked:c("bor_driver_assigned"),onCheckedChange:i=>t("bor_driver_assigned",i)}),e.jsx(s,{htmlFor:"bor_driver_assigned",children:"Driver Assigned"})]})}),e.jsx("div",{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(j,{id:"bor_quality_assurance_complete",checked:c("bor_quality_assurance_complete"),onCheckedChange:i=>t("bor_quality_assurance_complete",i)}),e.jsx(s,{htmlFor:"bor_quality_assurance_complete",children:"Quality Assurance Complete"})]})}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"bor_return_authorization",children:"Return Authorization"}),e.jsxs(g,{onValueChange:i=>t("bor_return_authorization",i),defaultValue:c("bor_return_authorization"),children:[e.jsx(f,{children:e.jsx(y,{placeholder:"Select return authorization status"})}),e.jsxs(b,{children:[e.jsx(r,{value:"pending",children:"Pending"}),e.jsx(r,{value:"approved",children:"Approved"}),e.jsx(r,{value:"rejected",children:"Rejected"})]})]})]})]})]}),e.jsxs(U,{value:"compliance",className:"space-y-4",children:[e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(T,{className:"h-4 w-4 text-green-600"}),e.jsx("span",{className:"font-semibold text-green-800",children:"Compliance Overview"})]}),e.jsx("p",{className:"text-sm text-green-700",children:"View and manage overall compliance status and requirements."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center p-4 border rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:F.icon}),e.jsx("div",{className:"font-semibold mt-2",children:"Current Status"}),e.jsx("div",{className:"text-sm text-gray-600",children:F.status})]}),e.jsxs("div",{className:"text-center p-4 border rounded-lg",children:[e.jsx(he,{className:"w-8 h-8 mx-auto text-orange-600"}),e.jsx("div",{className:"font-semibold mt-2",children:"ORV Duration"}),e.jsx("div",{className:"text-sm text-gray-600",children:l.status==="active"?"N/A":"Tracked"})]}),e.jsxs("div",{className:"text-center p-4 border rounded-lg",children:[e.jsx(xe,{className:"w-8 h-8 mx-auto text-green-600"}),e.jsx("div",{className:"font-semibold mt-2",children:"Documentation"}),e.jsx("div",{className:"text-sm text-gray-600",children:l.status==="active"?"Complete":"Required"})]})]}),e.jsx(fe,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-semibold",children:"Compliance Checklist"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(j,{id:"check1",checked:l.status==="active",disabled:!0}),e.jsx(s,{htmlFor:"check1",children:"Vehicle Roadworthy"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(j,{id:"check2",checked:l.status==="active",disabled:!0}),e.jsx(s,{htmlFor:"check2",children:"Documentation Current"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(j,{id:"check3",checked:l.status==="active",disabled:!0}),e.jsx(s,{htmlFor:"check3",children:"Insurance Valid"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(j,{id:"check4",checked:l.status==="active",disabled:!0}),e.jsx(s,{htmlFor:"check4",children:"Driver Assigned"})]})]})]})]})]}),e.jsxs("div",{className:"flex justify-end space-x-2 pt-4",children:[e.jsx(m,{type:"button",variant:"outline",onClick:a,disabled:S,children:"Cancel"}),e.jsxs(m,{type:"submit",disabled:S,children:[S&&e.jsx(me,{className:"mr-2 h-4 w-4 animate-spin"}),"Update Vehicle"]})]})]})]})}):null},_e=({open:l,onOpenChange:C,onSuccess:N})=>{const p=Ve(),{register:d,handleSubmit:o,reset:V,setValue:x,watch:t,formState:{errors:c,isSubmitting:u}}=pe({defaultValues:{vehicle_number:"",license_plate:"",make:"",model:"",year:new Date().getFullYear(),vin:"",vehicle_type:"bus",fuel_type:"Diesel",color:"",capacity:1,status:"active",purchase_date:"",registration_expiry:"",insurance_expiry:"",service_interval_months:6,notes:"",orv_off_road_reason:"",orv_expected_return_date:"",orv_location:"",orv_responsible_person:"",orv_insurance_status:"covered",orv_maintenance_type:"planned",bor_return_ready:!1,bor_safety_inspection_complete:!1,bor_documentation_verified:!1,bor_driver_assigned:!1,bor_quality_assurance_complete:!1,bor_return_authorization:"pending"}}),S=async a=>{if(!a.vehicle_number.trim()){v({title:"Validation Error",description:"Vehicle number is required",variant:"destructive"});return}if(!a.license_plate.trim()){v({title:"Validation Error",description:"License plate is required",variant:"destructive"});return}if(a.capacity<1){v({title:"Validation Error",description:"Capacity must be at least 1",variant:"destructive"});return}try{await p.mutateAsync({vehicle_number:a.vehicle_number,license_plate:a.license_plate,make:a.make||null,model:a.model||null,year:a.year||null,type:a.vehicle_type,fuel_type:a.fuel_type||null,capacity:a.capacity,status:a.status}),v({title:"Success",description:"Vehicle added successfully!"}),C(!1),N==null||N(),V()}catch(P){console.error("Error adding vehicle:",P),v({title:"Error",description:"Failed to add vehicle. Please try again.",variant:"destructive"})}},h=()=>{V(),C(!1)};return e.jsx(le,{open:l,onOpenChange:h,children:e.jsxs(te,{className:"sm:max-w-[800px] max-h-[90vh] overflow-y-auto",children:[e.jsxs(ne,{children:[e.jsxs(ce,{className:"flex items-center gap-2",children:[e.jsx(D,{className:"h-5 w-5"}),"Add New Vehicle"]}),e.jsx(de,{children:"Register a new vehicle in your fleet management system."})]}),e.jsxs("form",{onSubmit:o(S),className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Basic Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(s,{htmlFor:"vehicle_number",children:"Vehicle Number *"}),e.jsx(n,{id:"vehicle_number",placeholder:"e.g., BUS001",...d("vehicle_number",{required:!0})}),c.vehicle_number&&e.jsx("p",{className:"text-sm text-destructive mt-1",children:"Vehicle number is required"})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"license_plate",children:"License Plate *"}),e.jsx(n,{id:"license_plate",placeholder:"e.g., LDN 001A",...d("license_plate",{required:!0})}),c.license_plate&&e.jsx("p",{className:"text-sm text-destructive mt-1",children:"License plate is required"})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"capacity",children:"Passenger Capacity *"}),e.jsx(n,{id:"capacity",type:"number",placeholder:"Number of seats",...d("capacity",{required:!0,valueAsNumber:!0,min:1})}),c.capacity&&e.jsx("p",{className:"text-sm text-destructive mt-1",children:"Valid capacity is required"})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"vehicle_type",children:"Vehicle Type *"}),e.jsxs(g,{onValueChange:a=>x("vehicle_type",a),defaultValue:t("vehicle_type"),children:[e.jsx(f,{children:e.jsx(y,{placeholder:"Select vehicle type"})}),e.jsxs(b,{children:[e.jsx(r,{value:"Bus",children:"Bus"}),e.jsx(r,{value:"Coach",children:"Coach"}),e.jsx(r,{value:"HGV",children:"HGV"}),e.jsx(r,{value:"Minibus",children:"Minibus"}),e.jsx(r,{value:"Van",children:"Van"})]})]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Vehicle Specifications"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(s,{htmlFor:"make",children:"Make"}),e.jsx(n,{id:"make",placeholder:"e.g., Mercedes",...d("make")})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"model",children:"Model"}),e.jsx(n,{id:"model",placeholder:"e.g., Citaro",...d("model")})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"year",children:"Year"}),e.jsx(n,{id:"year",type:"number",placeholder:"e.g., 2023",...d("year",{valueAsNumber:!0,min:1900,max:new Date().getFullYear()+1})})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"color",children:"Color"}),e.jsx(n,{id:"color",placeholder:"e.g., White",...d("color")})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"fuel_type",children:"Fuel Type"}),e.jsxs(g,{onValueChange:a=>x("fuel_type",a),defaultValue:t("fuel_type"),children:[e.jsx(f,{children:e.jsx(y,{placeholder:"Select fuel type"})}),e.jsxs(b,{children:[e.jsx(r,{value:"Diesel",children:"Diesel"}),e.jsx(r,{value:"Petrol",children:"Petrol"}),e.jsx(r,{value:"Electric",children:"Electric"}),e.jsx(r,{value:"Hybrid",children:"Hybrid"}),e.jsx(r,{value:"CNG",children:"CNG"})]})]})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"vin",children:"VIN (Vehicle Identification Number)"}),e.jsx(n,{id:"vin",placeholder:"17-character VIN",...d("vin")})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Compliance & Registration"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(s,{htmlFor:"purchase_date",children:"Purchase Date"}),e.jsx(n,{id:"purchase_date",type:"date",...d("purchase_date")})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"registration_expiry",children:"Registration Expiry"}),e.jsx(n,{id:"registration_expiry",type:"date",...d("registration_expiry")})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"insurance_expiry",children:"Insurance Expiry"}),e.jsx(n,{id:"insurance_expiry",type:"date",...d("insurance_expiry")})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"service_interval_months",children:"Service Interval (Months)"}),e.jsx(n,{id:"service_interval_months",type:"number",placeholder:"e.g., 6",...d("service_interval_months",{valueAsNumber:!0,min:1})})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"status",children:"Initial Status"}),e.jsxs(g,{onValueChange:a=>x("status",a),defaultValue:t("status"),children:[e.jsx(f,{children:e.jsx(y,{placeholder:"Select status"})}),e.jsxs(b,{children:[e.jsx(r,{value:"active",children:"Active"}),e.jsx(r,{value:"maintenance",children:"Maintenance"}),e.jsx(r,{value:"out_of_service",children:"Out of Service"})]})]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Off-Road Vehicle Compliance"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(s,{htmlFor:"orv_off_road_reason",children:"Reason for Off-Road Usage"}),e.jsx($,{id:"orv_off_road_reason",placeholder:"e.g., Construction site access, Emergency response, Site survey",...d("orv_off_road_reason")})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"orv_expected_return_date",children:"Expected Return Date"}),e.jsx(n,{id:"orv_expected_return_date",type:"date",...d("orv_expected_return_date")})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"orv_location",children:"Location of Off-Road Usage"}),e.jsx(n,{id:"orv_location",placeholder:"e.g., 123 Main St, City, Country",...d("orv_location")})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"orv_responsible_person",children:"Responsible Person"}),e.jsx(n,{id:"orv_responsible_person",placeholder:"e.g., John Doe, Manager",...d("orv_responsible_person")})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"orv_insurance_status",children:"Insurance Status"}),e.jsxs(g,{onValueChange:a=>x("orv_insurance_status",a),defaultValue:t("orv_insurance_status"),children:[e.jsx(f,{children:e.jsx(y,{placeholder:"Select insurance status"})}),e.jsxs(b,{children:[e.jsx(r,{value:"covered",children:"Covered"}),e.jsx(r,{value:"suspended",children:"Suspended"}),e.jsx(r,{value:"expired",children:"Expired"})]})]})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"orv_maintenance_type",children:"Maintenance Type"}),e.jsxs(g,{onValueChange:a=>x("orv_maintenance_type",a),defaultValue:t("orv_maintenance_type"),children:[e.jsx(f,{children:e.jsx(y,{placeholder:"Select maintenance type"})}),e.jsxs(b,{children:[e.jsx(r,{value:"planned",children:"Planned"}),e.jsx(r,{value:"unplanned",children:"Unplanned"}),e.jsx(r,{value:"operational",children:"Operational"}),e.jsx(r,{value:"regulatory",children:"Regulatory"})]})]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Back On Road Compliance"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(s,{htmlFor:"bor_return_ready",children:"Return Ready"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(j,{id:"bor_return_ready",checked:t("bor_return_ready"),onCheckedChange:a=>x("bor_return_ready",a)}),e.jsx(s,{htmlFor:"bor_return_ready",children:"Return Ready"})]})]}),e.jsx("div",{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(j,{id:"bor_safety_inspection_complete",checked:t("bor_safety_inspection_complete"),onCheckedChange:a=>x("bor_safety_inspection_complete",a)}),e.jsx(s,{htmlFor:"bor_safety_inspection_complete",children:"Safety Inspection Complete"})]})}),e.jsx("div",{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(j,{id:"bor_documentation_verified",checked:t("bor_documentation_verified"),onCheckedChange:a=>x("bor_documentation_verified",a)}),e.jsx(s,{htmlFor:"bor_documentation_verified",children:"Documentation Verified"})]})}),e.jsx("div",{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(j,{id:"bor_driver_assigned",checked:t("bor_driver_assigned"),onCheckedChange:a=>x("bor_driver_assigned",a)}),e.jsx(s,{htmlFor:"bor_driver_assigned",children:"Driver Assigned"})]})}),e.jsx("div",{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(j,{id:"bor_quality_assurance_complete",checked:t("bor_quality_assurance_complete"),onCheckedChange:a=>x("bor_quality_assurance_complete",a)}),e.jsx(s,{htmlFor:"bor_quality_assurance_complete",children:"Quality Assurance Complete"})]})}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"bor_return_authorization",children:"Return Authorization"}),e.jsxs(g,{onValueChange:a=>x("bor_return_authorization",a),defaultValue:t("bor_return_authorization"),children:[e.jsx(f,{children:e.jsx(y,{placeholder:"Select return authorization status"})}),e.jsxs(b,{children:[e.jsx(r,{value:"pending",children:"Pending"}),e.jsx(r,{value:"approved",children:"Approved"}),e.jsx(r,{value:"rejected",children:"Rejected"})]})]})]})]})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"notes",children:"Additional Notes"}),e.jsx($,{id:"notes",placeholder:"Any additional information about the vehicle...",...d("notes")})]}),e.jsxs("div",{className:"flex justify-end space-x-2 pt-4 border-t",children:[e.jsx(m,{type:"button",variant:"outline",onClick:h,disabled:u,children:"Cancel"}),e.jsxs(m,{type:"submit",disabled:u,children:[u&&e.jsx(me,{className:"mr-2 h-4 w-4 animate-spin"}),"Add Vehicle"]})]})]})]})})},Me=()=>{const{data:l=[],isLoading:C,error:N}=ue(),p=je(),[d,o]=H.useState(null),[V,x]=H.useState(null),[t,c]=H.useState(!1),u=async h=>{try{await p.mutateAsync(h.id),ee.success("Vehicle deleted successfully"),x(null)}catch(a){console.error("Error deleting vehicle:",a),ee.error("Failed to delete vehicle")}},S=h=>{const a=h.status||"active";switch(a){case"active":return e.jsxs(A,{variant:"default",className:"bg-green-100 text-green-800 border-green-200",children:[e.jsx(T,{className:"w-3 h-3 mr-1"}),"Active"]});case"maintenance":return e.jsxs(A,{variant:"outline",className:"text-yellow-600 border-yellow-200",children:[e.jsx(G,{className:"w-3 h-3 mr-1"}),"ORV: Maintenance"]});case"out_of_service":return e.jsxs(A,{variant:"destructive",className:"bg-red-100 text-red-800 border-red-200",children:[e.jsx(Y,{className:"w-3 h-3 mr-1"}),"ORV: Off Road"]});default:return e.jsxs(A,{variant:"secondary",children:[e.jsx(D,{className:"w-3 h-3 mr-1"}),a]})}};return C?e.jsx(_,{children:e.jsxs(k,{children:[e.jsx(R,{children:"Vehicles"}),e.jsx(W,{children:"Loading vehicles..."})]})}):N?e.jsx(_,{children:e.jsxs(k,{children:[e.jsx(R,{children:"Vehicles"}),e.jsxs(W,{children:["Error loading vehicles: ",N.message]})]})}):e.jsxs(e.Fragment,{children:[e.jsxs(_,{children:[e.jsxs(k,{children:[e.jsx(R,{children:"Vehicle Fleet"}),e.jsx(W,{children:"Manage your vehicle fleet with ORV & BOR roadworthiness compliance tracking"})]}),e.jsx(w,{children:l.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(D,{className:"mx-auto h-12 w-12 text-gray-400"}),e.jsx("h3",{className:"mt-2 text-sm font-semibold text-gray-900",children:"No vehicles"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Get started by adding your first vehicle to the fleet."}),e.jsx("div",{className:"mt-6",children:e.jsxs(m,{onClick:()=>c(!0),children:[e.jsx(J,{className:"mr-2 h-4 w-4"}),"Add Vehicle"]})})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Z,{className:"h-4 w-4 text-orange-600"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"ORV: Off-Road Vehicle | BOR: Back On Road"})]}),e.jsxs(m,{onClick:()=>c(!0),children:[e.jsx(J,{className:"mr-2 h-4 w-4"}),"Add Vehicle"]})]}),e.jsx("div",{className:"border rounded-lg",children:e.jsxs(we,{children:[e.jsx(ke,{children:e.jsxs(ae,{children:[e.jsx(E,{children:"Vehicle"}),e.jsx(E,{children:"Type"}),e.jsx(E,{children:"Status"}),e.jsx(E,{children:"Capacity"}),e.jsx(E,{children:"Actions"})]})}),e.jsx(Re,{children:l.map(h=>e.jsxs(ae,{children:[e.jsx(q,{children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:h.vehicle_number}),e.jsx("div",{className:"text-sm text-gray-500",children:h.license_plate}),e.jsxs("div",{className:"text-xs text-gray-400",children:[h.make," ",h.model," (",h.year,")"]})]})}),e.jsx(q,{children:e.jsx(A,{variant:"outline",className:"capitalize",children:h.type||"bus"})}),e.jsx(q,{children:S(h)}),e.jsx(q,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium",children:h.capacity||0}),e.jsx("span",{className:"text-xs text-gray-500",children:"seats"})]})}),e.jsx(q,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(m,{variant:"outline",size:"sm",onClick:()=>o(h),children:e.jsx(Oe,{className:"h-4 w-4"})}),e.jsx(m,{variant:"outline",size:"sm",onClick:()=>x(h),children:e.jsx(Ae,{className:"h-4 w-4"})})]})})]},h.id))})]})}),e.jsx("div",{className:"text-xs text-gray-500 text-center",children:e.jsxs("div",{className:"flex items-center justify-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(T,{className:"w-3 h-3 text-green-600"}),e.jsx("span",{children:"Active"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(G,{className:"w-3 h-3 text-yellow-600"}),e.jsx("span",{children:"ORV: Maintenance"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Y,{className:"w-3 h-3 text-red-600"}),e.jsx("span",{children:"ORV: Off Road"})]})]})})]})})]}),e.jsx(_e,{open:t,onOpenChange:c,onSuccess:()=>{c(!1)}}),e.jsx(ve,{vehicle:d,open:!!d,onOpenChange:h=>{h||o(null)},onSuccess:()=>{o(null)}}),V&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Delete Vehicle"}),e.jsxs("p",{className:"text-gray-600 mb-6",children:["Are you sure you want to delete ",V.vehicle_number,"? This action cannot be undone."]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx(m,{variant:"outline",onClick:()=>x(null),disabled:p.isPending,children:"Cancel"}),e.jsx(m,{variant:"destructive",onClick:()=>u(V),disabled:p.isPending,children:p.isPending?"Deleting...":"Delete"})]})]})})]})};function Xe(){const[l,C]=se.useState(null),[N,p]=se.useState(!1),d=ye(),{data:o=[],isLoading:V,error:x}=ue(),t=Ce(),c=je(),u=()=>{p(!0)},S=()=>{},h=O=>{C(O)},a=async O=>{if(confirm("Are you sure you want to delete this vehicle?"))try{await c.mutateAsync(O)}catch(ge){console.error("Error deleting vehicle:",ge)}},P=async()=>{if(confirm("Are you sure you want to delete ALL vehicles? This action cannot be undone."))try{for(const O of o)await c.mutateAsync(O.id);v({title:"Success!",description:"All vehicles have been removed from your fleet."})}catch(O){console.error("Error clearing vehicles:",O),v({title:"Error",description:"Failed to clear all vehicles. Please try again.",variant:"destructive"})}},F=()=>{d("/vehicle-settings")},i=t.total,M=t.active,Q=t.maintenance,B=t.out_of_service,K=i>0?Math.round(M/i*100):0,X=i>0?Math.round((i-B)/i*100):0,L=Q+B,I=Math.floor(L*.3);return x?e.jsxs("div",{className:"space-y-6",children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Vehicle Management"}),e.jsx(_,{children:e.jsx(w,{className:"p-8",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("p",{className:"text-destructive",children:["Error loading vehicles: ",x.message]}),e.jsx(m,{onClick:()=>window.location.reload(),className:"mt-4",children:"Try Again"})]})})})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Vehicle Management"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Fleet management with ORV & BOR roadworthiness compliance"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(m,{onClick:F,variant:"outline",className:"inline-flex items-center",children:[e.jsx(re,{className:"mr-2 h-4 w-4"}),"Fleet Settings"]}),o.length>0&&e.jsxs(m,{onClick:P,variant:"destructive",className:"inline-flex items-center",disabled:c.isPending,children:[e.jsx(De,{className:"mr-2 h-4 w-4"}),c.isPending?"Clearing...":"Clear All Vehicles"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs(_,{className:"border-orange-200 bg-orange-50",children:[e.jsxs(k,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsxs(R,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(Z,{className:"h-4 w-4 text-orange-600"}),"ORV (Off-Road Vehicle) Status"]}),e.jsxs(A,{variant:L>0?"destructive":"default",children:[L," Off-Road"]})]}),e.jsx(w,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Compliance Rate"}),e.jsxs("span",{className:"font-semibold",children:[K,"%"]})]}),e.jsx(ie,{value:K,className:"h-2"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs text-gray-600",children:[e.jsxs("div",{children:["Maintenance: ",Q]}),e.jsxs("div",{children:["Out of Service: ",B]})]})]})})]}),e.jsxs(_,{className:"border-blue-200 bg-blue-50",children:[e.jsxs(k,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsxs(R,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(oe,{className:"h-4 w-4 text-blue-600"}),"BOR (Back On Road) Status"]}),e.jsxs(A,{variant:I>0?"default":"secondary",children:[I," Returning Soon"]})]}),e.jsx(w,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Return Readiness"}),e.jsxs("span",{className:"font-semibold",children:[X,"%"]})]}),e.jsx(ie,{value:X,className:"h-2"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs text-gray-600",children:[e.jsxs("div",{children:["Ready to Return: ",I]}),e.jsxs("div",{children:["In Process: ",L-I]})]})]})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs(_,{children:[e.jsxs(k,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(R,{className:"text-sm font-medium",children:"Total Vehicles"}),e.jsx(D,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(w,{children:[e.jsx("div",{className:"text-2xl font-bold",children:i}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Fleet size"})]})]}),e.jsxs(_,{children:[e.jsxs(k,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(R,{className:"text-sm font-medium",children:"Active"}),e.jsx(T,{className:"h-4 w-4 text-green-600"})]}),e.jsxs(w,{children:[e.jsx("div",{className:"text-2xl font-bold",children:M}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[i>0?Math.round(M/i*100):0,"% of fleet"]})]})]}),e.jsxs(_,{children:[e.jsxs(k,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(R,{className:"text-sm font-medium",children:"In Maintenance"}),e.jsx(G,{className:"h-4 w-4 text-yellow-600"})]}),e.jsxs(w,{children:[e.jsx("div",{className:"text-2xl font-bold",children:Q}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"ORV: Planned/Unplanned"})]})]}),e.jsxs(_,{children:[e.jsxs(k,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(R,{className:"text-sm font-medium",children:"Out of Service"}),e.jsx(Y,{className:"h-4 w-4 text-red-600"})]}),e.jsxs(w,{children:[e.jsx("div",{className:"text-2xl font-bold",children:B}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"ORV: Regulatory/Operational"})]})]})]}),o.length>0&&e.jsxs(_,{children:[e.jsx(k,{children:e.jsx(R,{className:"text-lg",children:"Compliance Quick Actions"})}),e.jsx(w,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs(m,{variant:"outline",className:"h-auto p-4 flex flex-col items-center gap-2",children:[e.jsx(xe,{className:"h-6 w-6 text-blue-600"}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-semibold",children:"ORV Documentation"}),e.jsx("div",{className:"text-xs text-gray-600",children:"Manage off-road declarations"})]})]}),e.jsxs(m,{variant:"outline",className:"h-auto p-4 flex flex-col items-center gap-2",children:[e.jsx(he,{className:"h-6 w-6 text-orange-600"}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-semibold",children:"BOR Return Process"}),e.jsx("div",{className:"text-xs text-gray-600",children:"Vehicle return to service"})]})]}),e.jsxs(m,{variant:"outline",className:"h-auto p-4 flex flex-col items-center gap-2",children:[e.jsx(be,{className:"h-6 w-6 text-green-600"}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-semibold",children:"Compliance Reports"}),e.jsx("div",{className:"text-xs text-gray-600",children:"View compliance analytics"})]})]})]})})]}),!V&&o.length===0?e.jsx(_,{children:e.jsx(w,{className:"p-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx(D,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No Vehicles Found"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"You haven't added any vehicles to your fleet yet. Start by adding your first vehicle to get started with vehicle management and ORV/BOR compliance tracking."}),e.jsxs("div",{className:"flex gap-2 justify-center",children:[e.jsxs(m,{onClick:u,className:"inline-flex items-center",children:[e.jsx(J,{className:"mr-2 h-4 w-4"}),"Add Your First Vehicle"]}),e.jsxs(m,{onClick:F,variant:"outline",className:"inline-flex items-center",children:[e.jsx(re,{className:"mr-2 h-4 w-4"}),"Configure Fleet Settings"]})]})]})})}):e.jsx(Me,{vehicles:o,isLoading:V,onAddVehicle:u,onEditVehicle:h,onDeleteVehicle:a}),e.jsx(_e,{open:N,onOpenChange:p,onSuccess:S}),e.jsx(ve,{vehicle:l,open:!!l,onOpenChange:O=>!O&&C(null),onSuccess:()=>{C(null)}})]})}export{Xe as default};
